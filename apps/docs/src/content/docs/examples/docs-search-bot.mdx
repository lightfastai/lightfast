---
title: Documentation Search Bot
description: Build a documentation search bot similar to Fumadocs with Mixedbread
---

# Documentation Search Bot

Create a smart search experience for your documentation site using Lightfast, similar to Fumadocs with Mixedbread integration.

## Overview

This guide shows you how to build a documentation search system that:

- Indexes your docs automatically on build
- Provides semantic search across all content
- Returns relevant snippets with highlights
- Integrates seamlessly with your docs framework

## Prerequisites

- Lightfast API key (`lf_sk_live_...`)
- Documentation built with Next.js, Fumadocs, Nextra, or similar
- Node.js 18+

## Architecture

```
Documentation Site
├── Build Time: Index all docs to Lightfast
├── Runtime: Search API endpoint
└── Frontend: Search UI component
```

## Setup

### Install Dependencies

```bash
pnpm add @lightfast/sdk
pnpm add -D gray-matter markdown-it
```

### Configure Environment

```bash
# .env.local
LIGHTFAST_API_KEY=lf_sk_live_...
```

## Indexing Your Docs

### Build-time Indexing Script

Create `scripts/index-docs.ts`:

```typescript
import { LightfastClient } from '@lightfast/sdk'
import fs from 'fs'
import path from 'path'
import matter from 'gray-matter'

const lightfast = new LightfastClient({
  apiKey: process.env.LIGHTFAST_API_KEY!
})

async function indexDocs() {
  const docsDir = path.join(process.cwd(), 'content/docs')
  const files = getAllMdxFiles(docsDir)

  for (const file of files) {
    const content = fs.readFileSync(file, 'utf-8')
    const { data, content: body } = matter(content)

    await lightfast.index({
      id: getDocId(file),
      title: data.title,
      body,
      metadata: {
        type: 'doc',
        path: getDocPath(file),
        category: data.category,
        tags: data.tags || []
      }
    })

    console.log(`Indexed: ${data.title}`)
  }
}

function getAllMdxFiles(dir: string): string[] {
  // Recursively find all .mdx files
  // Implementation details...
}

function getDocId(filePath: string): string {
  // Generate unique ID from file path
  // Implementation details...
}

function getDocPath(filePath: string): string {
  // Convert file path to URL path
  // Implementation details...
}

indexDocs()
```

### Add to Build Process

Update `package.json`:

```json
{
  "scripts": {
    "build": "pnpm index:docs && next build",
    "index:docs": "tsx scripts/index-docs.ts"
  }
}
```

## Search API Endpoint

Create `app/api/search/route.ts`:

```typescript
import { LightfastClient } from '@lightfast/sdk'
import { NextRequest, NextResponse } from 'next/server'

const lightfast = new LightfastClient({
  apiKey: process.env.LIGHTFAST_API_KEY!
})

export async function POST(request: NextRequest) {
  const { query } = await request.json()

  const results = await lightfast.search({
    query,
    filters: {
      type: ['doc']
    },
    limit: 10,
    includeHighlights: true
  })

  return NextResponse.json(results)
}
```

## Search UI Component

### Search Dialog

```tsx
'use client'

import { useState } from 'react'
import { Dialog, DialogContent } from '@/components/ui/dialog'
import { Input } from '@/components/ui/input'

export function SearchDialog() {
  const [query, setQuery] = useState('')
  const [results, setResults] = useState([])
  const [loading, setLoading] = useState(false)

  const search = async (q: string) => {
    if (!q.trim()) return

    setLoading(true)
    const res = await fetch('/api/search', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ query: q })
    })

    const data = await res.json()
    setResults(data.results)
    setLoading(false)
  }

  return (
    <Dialog>
      <DialogContent>
        <Input
          placeholder="Search documentation..."
          value={query}
          onChange={(e) => {
            setQuery(e.target.value)
            search(e.target.value)
          }}
        />

        {loading && <div>Searching...</div>}

        <div className="space-y-4">
          {results.map((result) => (
            <SearchResult key={result.id} result={result} />
          ))}
        </div>
      </DialogContent>
    </Dialog>
  )
}
```

### Search Result Item

```tsx
function SearchResult({ result }) {
  return (
    <a
      href={result.metadata.path}
      className="block p-4 rounded-lg hover:bg-accent"
    >
      <h3 className="font-semibold">{result.title}</h3>
      {result.highlights && (
        <p
          className="text-sm text-muted-foreground mt-2"
          dangerouslySetInnerHTML={{ __html: result.highlights[0] }}
        />
      )}
      <div className="flex gap-2 mt-2">
        {result.metadata.tags?.map((tag) => (
          <span key={tag} className="text-xs bg-secondary px-2 py-1 rounded">
            {tag}
          </span>
        ))}
      </div>
    </a>
  )
}
```

## Advanced Features

### Keyboard Shortcuts

Add Cmd+K to open search:

```tsx
useEffect(() => {
  const down = (e: KeyboardEvent) => {
    if (e.key === 'k' && (e.metaKey || e.ctrlKey)) {
      e.preventDefault()
      setOpen(true)
    }
  }

  document.addEventListener('keydown', down)
  return () => document.removeEventListener('keydown', down)
}, [])
```

### Recent Searches

Track and display recent searches:

```tsx
const [recentSearches, setRecentSearches] = useState<string[]>([])

const addRecentSearch = (query: string) => {
  const updated = [query, ...recentSearches.filter(q => q !== query)].slice(0, 5)
  setRecentSearches(updated)
  localStorage.setItem('recent-searches', JSON.stringify(updated))
}
```

### Search Analytics

Track popular queries:

```typescript
await fetch('/api/analytics', {
  method: 'POST',
  body: JSON.stringify({
    event: 'search',
    query,
    resultCount: results.length
  })
})
```

## Integration Examples

### Fumadocs

```tsx
import { DocsLayout } from 'fumadocs-ui/layout'
import { SearchDialog } from '@/components/search-dialog'

export default function Layout({ children }) {
  return (
    <DocsLayout
      nav={{
        title: 'My Docs',
        search: <SearchDialog />
      }}
    >
      {children}
    </DocsLayout>
  )
}
```

### Nextra

```tsx
import { useConfig } from 'nextra-theme-docs'
import { SearchDialog } from '@/components/search-dialog'

export default {
  search: {
    component: <SearchDialog />
  }
}
```

## Performance Optimization

### Debounced Search

```tsx
import { useDebouncedCallback } from 'use-debounce'

const debouncedSearch = useDebouncedCallback(
  (query: string) => search(query),
  300
)
```

### Cached Results

```typescript
const cache = new Map<string, any>()

const searchWithCache = async (query: string) => {
  if (cache.has(query)) {
    return cache.get(query)
  }

  const results = await search(query)
  cache.set(query, results)
  return results
}
```

### Prefetch Popular Pages

```typescript
// Prefetch top 10 most searched docs
const popularDocs = await lightfast.search({
  query: '',
  filters: { type: ['doc'] },
  sort: 'popularity',
  limit: 10
})
```

## Best Practices

### Indexing Strategy

- **Build time**: Index all docs during build
- **Incremental**: Only re-index changed files
- **Versioning**: Separate indexes per docs version

### Search Quality

- **Use synonyms**: Map common terms to official terms
- **Boost important docs**: Increase relevance of key pages
- **Filter by recency**: Prefer newer docs when relevant

### User Experience

- **Show loading states**: Display skeleton while searching
- **Highlight matches**: Use highlights for context
- **Keyboard navigation**: Support arrow keys to navigate results

## Troubleshooting

### Docs Not Appearing in Search

Check indexing logs:

```bash
pnpm index:docs
```

Verify in Lightfast dashboard that docs are indexed.

### Search Results Not Relevant

Improve query quality:

```typescript
// Add context to query
const enhancedQuery = `${query} in documentation`

// Use filters
filters: {
  type: ['doc'],
  category: ['guides', 'api-reference']
}
```

### Slow Search Response

Enable caching:

```typescript
export const revalidate = 60 // Cache for 60 seconds

export async function GET(request: NextRequest) {
  // Add cache headers
  return NextResponse.json(results, {
    headers: {
      'Cache-Control': 'public, s-maxage=60, stale-while-revalidate=120'
    }
  })
}
```

## Next Steps

- **[Search Strategies](/docs/guides/search-strategies)** - Optimize search queries
- **[Answer Quality](/docs/guides/answer-quality)** - Improve search relevance
- **[API Reference](/api/search)** - Learn about search parameters
- **[Fumadocs Search](https://fumadocs.dev/docs/headless/search/mixedbread)** - Alternative approaches
