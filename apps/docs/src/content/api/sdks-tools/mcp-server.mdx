---
title: MCP Server
description: Model Context Protocol server API reference for AI assistant integration
---

# MCP Server Reference

The `@lightfastai/mcp` package provides a Model Context Protocol server that exposes Lightfast tools to AI assistants.

## Installation

```bash
npx @lightfastai/mcp
# or
npm install -g @lightfastai/mcp
```

## CLI Options

```bash
npx @lightfastai/mcp [options]
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `--api-key` | `string` | `$LIGHTFAST_API_KEY` | Lightfast API key |
| `--base-url` | `string` | `https://lightfast.ai` | API base URL |
| `--help, -h` | - | - | Show help message |
| `--version, -v` | - | - | Show version |

## Environment Variables

| Variable | Description |
|----------|-------------|
| `LIGHTFAST_API_KEY` | API key (alternative to `--api-key` flag) |

---

## Tools

The MCP server exposes five tools to AI assistants.

### lightfast_search

Search through workspace memory for relevant documents and observations.

#### Parameters

| Name | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `query` | `string` | Yes | - | The search query text to find relevant documents |
| `limit` | `number` | No | `10` | Maximum number of results to return (1-100) |
| `offset` | `number` | No | `0` | Result offset for pagination |
| `mode` | `string` | No | `"balanced"` | Search quality mode: `"fast"` (speed), `"balanced"` (default), `"thorough"` (quality) |
| `filters` | `object` | No | - | Optional filters to scope results |
| `includeContext` | `boolean` | No | `true` | Include contextual information like topic clusters |
| `includeHighlights` | `boolean` | No | `true` | Include highlighted text snippets |

**Filters object structure:**
- `sourceTypes`: `string[]` - Source types to include (e.g., `["github", "linear"]`)
- `observationTypes`: `string[]` - Observation types to include (e.g., `["commit", "issue"]`)
- `actorNames`: `string[]` - Actor names to filter by (e.g., `["@sarah", "@mike"]`)
- `dateRange`: `object` - Date range filter with `start` and `end` ISO datetime strings

#### Example Request
```json
{
  "name": "lightfast_search",
  "arguments": {
    "query": "how does authentication work",
    "limit": 5,
    "mode": "thorough",
    "filters": {
      "sourceTypes": ["github"],
      "dateRange": {
        "start": "2024-01-01T00:00:00Z",
        "end": "2024-12-31T23:59:59Z"
      }
    }
  }
}
```

#### Response Schema
```json
{
  "data": [
    {
      "id": "string",
      "title": "string",
      "url": "string",
      "snippet": "string",
      "score": 0.95,
      "source": "string",
      "type": "string",
      "occurredAt": "string",
      "entities": [
        {
          "key": "string",
          "category": "string"
        }
      ],
      "references": [
        {
          "type": "string",
          "id": "string",
          "url": "string",
          "label": "string"
        }
      ],
      "highlights": {
        "title": "string",
        "snippet": "string"
      }
    }
  ],
  "context": {
    "clusters": [
      {
        "topic": "string",
        "summary": "string",
        "keywords": ["string"]
      }
    ],
    "relevantActors": [
      {
        "displayName": "string",
        "expertiseDomains": ["string"]
      }
    ]
  },
  "meta": {
    "total": 100,
    "limit": 10,
    "offset": 0,
    "took": 150,
    "mode": "balanced",
    "paths": {
      "vector": true,
      "entity": true,
      "cluster": true,
      "actor": true
    }
  },
  "latency": {
    "total": 150,
    "retrieval": 50,
    "rerank": 30
  },
  "requestId": "string"
}
```

---

### lightfast_contents

Fetch full content for documents by their IDs.

#### Parameters

| Name | Type | Required | Description |
|------|------|----------|-------------|
| `ids` | `string[]` | Yes | Array of document or observation IDs to fetch (1-50 IDs) |

#### Example Request
```json
{
  "name": "lightfast_contents",
  "arguments": {
    "ids": ["obs_abc123", "doc_def456"]
  }
}
```

#### Response Schema
```json
{
  "items": [
    {
      "id": "string",
      "title": "string",
      "url": "string",
      "snippet": "string",
      "content": "string",
      "source": "string",
      "type": "string",
      "occurredAt": "string",
      "metadata": {}
    }
  ],
  "missing": ["string"],
  "requestId": "string"
}
```

---

### lightfast_find_similar

Find content semantically similar to a given document or URL.

#### Parameters

| Name | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `id` | `string` | One of `id`/`url` | - | Document ID to find similar content for |
| `url` | `string` | One of `id`/`url` | - | URL to find similar content for (alternative to id) |
| `limit` | `number` | No | `10` | Maximum number of similar items to return (1-50) |
| `threshold` | `number` | No | `0.5` | Minimum similarity score (0-1) |
| `sameSourceOnly` | `boolean` | No | `false` | Only return results from the same source type |
| `excludeIds` | `string[]` | No | - | Array of IDs to exclude from results |
| `filters` | `object` | No | - | Optional filters to scope results (same structure as lightfast_search) |

#### Example Request
```json
{
  "name": "lightfast_find_similar",
  "arguments": {
    "url": "https://github.com/org/repo/pull/123",
    "limit": 5,
    "threshold": 0.7
  }
}
```

#### Response Schema
```json
{
  "source": {
    "id": "string",
    "title": "string",
    "type": "string",
    "cluster": {
      "topic": "string",
      "memberCount": 10
    }
  },
  "similar": [
    {
      "id": "string",
      "title": "string",
      "url": "string",
      "snippet": "string",
      "score": 0.85,
      "vectorSimilarity": 0.90,
      "entityOverlap": 0.75,
      "sameCluster": true,
      "source": "string",
      "type": "string",
      "occurredAt": "string"
    }
  ],
  "meta": {
    "total": 50,
    "took": 120,
    "inputEmbedding": {
      "found": true,
      "generated": false
    }
  },
  "requestId": "string"
}
```

---

### lightfast_graph

Traverse the relationship graph from a starting observation. Returns connected observations with relationship edges. Supports depth control (1-3) and relationship type filtering.

#### Parameters

| Name | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| `id` | `string` | Yes | - | Observation ID to start graph traversal from |
| `depth` | `number` | No | `2` | Traversal depth (1-3) |
| `types` | `string[]` | No | - | Filter by relationship types |

#### Example Request
```json
{
  "name": "lightfast_graph",
  "arguments": {
    "id": "obs_abc123",
    "depth": 2
  }
}
```

#### Response Schema
```json
{
  "data": {
    "root": {
      "id": "string",
      "title": "string",
      "source": "string",
      "type": "string"
    },
    "nodes": [
      {
        "id": "string",
        "title": "string",
        "source": "string",
        "type": "string",
        "occurredAt": "string",
        "url": "string",
        "isRoot": false
      }
    ],
    "edges": [
      {
        "source": "string",
        "target": "string",
        "type": "string",
        "linkingKey": "string",
        "confidence": 0.95
      }
    ]
  },
  "meta": {
    "depth": 2,
    "nodeCount": 15,
    "edgeCount": 20,
    "took": 100
  },
  "requestId": "string"
}
```

---

### lightfast_related

Find observations directly connected to a given observation via relationships. Returns related events grouped by source system with relationship types and directions.

#### Parameters

| Name | Type | Required | Description |
|------|------|----------|-------------|
| `id` | `string` | Yes | Observation ID to find related events for |

#### Example Request
```json
{
  "name": "lightfast_related",
  "arguments": {
    "id": "obs_abc123"
  }
}
```

#### Response Schema
```json
{
  "data": {
    "source": {
      "id": "string",
      "title": "string",
      "source": "string"
    },
    "related": [
      {
        "id": "string",
        "title": "string",
        "source": "string",
        "type": "string",
        "occurredAt": "string",
        "url": "string",
        "relationshipType": "string",
        "direction": "outgoing"
      }
    ],
    "bySource": {
      "github": [
        {
          "id": "string",
          "title": "string",
          "source": "github",
          "type": "commit",
          "occurredAt": "string",
          "url": "string",
          "relationshipType": "references",
          "direction": "incoming"
        }
      ]
    }
  },
  "meta": {
    "total": 25,
    "took": 80
  },
  "requestId": "string"
}
```

---

## Error Responses

All tools return errors in the following format:

```json
{
  "error": "ERROR_CODE",
  "message": "Human-readable error message",
  "requestId": "req_abc123"
}
```

| Error Code | Description |
|------------|-------------|
| `UNAUTHORIZED` | Invalid or missing API key |
| `VALIDATION_ERROR` | Invalid parameters |
| `NOT_FOUND` | Resource not found |
| `INTERNAL_ERROR` | Server error |

---

## Related

- [MCP Setup Guide](/docs/integrate/mcp) - Configuration for Claude, Cursor, Codex
- [POST /v1/search](/docs/api-reference/endpoints/search) - REST API endpoint reference
- [GitHub Repository](https://github.com/lightfastai/lightfast/tree/main/core/mcp) - MCP server source code
