{
  "$schema": "./webhook-schema.json",
  "name": "security",
  "description": "Security-focused webhook events for testing significance scoring and entity extraction",
  "webhooks": [
    {
      "source": "github",
      "eventType": "pull_request",
      "payload": {
        "action": "closed",
        "number": 101,
        "pull_request": {
          "id": 1234567890,
          "node_id": "PR_kwDOtest101",
          "number": 101,
          "state": "closed",
          "locked": false,
          "title": "feat(auth): Implement OAuth2 PKCE flow for secure authentication",
          "user": {
            "login": "alice",
            "id": 12345,
            "node_id": "U_alice",
            "avatar_url": "https://avatars.githubusercontent.com/u/12345",
            "type": "User",
            "site_admin": false
          },
          "body": "## Summary\nImplements PKCE (Proof Key for Code Exchange) extension to OAuth2 flow.\nThis prevents authorization code interception attacks.\n\n## Changes\n- Added PKCE challenge generation in `src/lib/auth/pkce.ts`\n- Updated OAuth callback to verify code_verifier\n- Added @security-team as reviewer for audit\n\n## Security Impact\n- Mitigates CVE-2019-XXXX class vulnerabilities\n- Required for mobile clients per IETF RFC 7636\n\nFixes #45",
          "created_at": "2024-01-10T10:00:00Z",
          "updated_at": "2024-01-12T15:30:00Z",
          "closed_at": "2024-01-12T15:30:00Z",
          "merged_at": "2024-01-12T15:30:00Z",
          "merge_commit_sha": "abc123def456789",
          "assignee": null,
          "assignees": [],
          "requested_reviewers": [
            {
              "login": "security-team",
              "id": 99999,
              "node_id": "U_security",
              "avatar_url": "https://avatars.githubusercontent.com/u/99999",
              "type": "User",
              "site_admin": false
            }
          ],
          "requested_teams": [],
          "labels": [
            { "id": 1, "node_id": "L_1", "name": "security", "color": "ff0000", "default": false },
            { "id": 2, "node_id": "L_2", "name": "auth", "color": "0000ff", "default": false }
          ],
          "milestone": null,
          "draft": false,
          "commits": 3,
          "additions": 150,
          "deletions": 20,
          "changed_files": 5,
          "head": {
            "label": "test:feature/oauth-pkce",
            "ref": "feature/oauth-pkce",
            "sha": "abc123def456",
            "user": {
              "login": "alice",
              "id": 12345,
              "node_id": "U_alice",
              "avatar_url": "https://avatars.githubusercontent.com/u/12345",
              "type": "User",
              "site_admin": false
            },
            "repo": {
              "id": 123456,
              "node_id": "R_test",
              "name": "repo",
              "full_name": "test/repo",
              "private": false,
              "owner": {
                "login": "test",
                "id": 11111,
                "node_id": "O_test",
                "avatar_url": "https://avatars.githubusercontent.com/u/11111",
                "type": "Organization",
                "site_admin": false
              },
              "html_url": "https://github.com/test/repo",
              "description": "Test repository",
              "fork": false,
              "url": "https://api.github.com/repos/test/repo",
              "created_at": "2023-01-01T00:00:00Z",
              "updated_at": "2024-01-12T15:30:00Z",
              "pushed_at": "2024-01-12T15:30:00Z",
              "homepage": null,
              "size": 1000,
              "stargazers_count": 50,
              "watchers_count": 50,
              "language": "TypeScript",
              "forks_count": 10,
              "open_issues_count": 5,
              "default_branch": "main",
              "topics": [],
              "visibility": "public"
            }
          },
          "base": {
            "label": "test:main",
            "ref": "main",
            "sha": "000000000000",
            "user": {
              "login": "test",
              "id": 11111,
              "node_id": "O_test",
              "avatar_url": "https://avatars.githubusercontent.com/u/11111",
              "type": "Organization",
              "site_admin": false
            },
            "repo": {
              "id": 123456,
              "node_id": "R_test",
              "name": "repo",
              "full_name": "test/repo",
              "private": false,
              "owner": {
                "login": "test",
                "id": 11111,
                "node_id": "O_test",
                "avatar_url": "https://avatars.githubusercontent.com/u/11111",
                "type": "Organization",
                "site_admin": false
              },
              "html_url": "https://github.com/test/repo",
              "description": "Test repository",
              "fork": false,
              "url": "https://api.github.com/repos/test/repo",
              "created_at": "2023-01-01T00:00:00Z",
              "updated_at": "2024-01-12T15:30:00Z",
              "pushed_at": "2024-01-12T15:30:00Z",
              "homepage": null,
              "size": 1000,
              "stargazers_count": 50,
              "watchers_count": 50,
              "language": "TypeScript",
              "forks_count": 10,
              "open_issues_count": 5,
              "default_branch": "main",
              "topics": [],
              "visibility": "public"
            }
          },
          "html_url": "https://github.com/test/repo/pull/101",
          "diff_url": "https://github.com/test/repo/pull/101.diff",
          "patch_url": "https://github.com/test/repo/pull/101.patch",
          "merged": true,
          "mergeable": null,
          "rebaseable": null,
          "mergeable_state": "unknown",
          "merged_by": {
            "login": "alice",
            "id": 12345,
            "node_id": "U_alice",
            "avatar_url": "https://avatars.githubusercontent.com/u/12345",
            "type": "User",
            "site_admin": false
          },
          "comments": 2,
          "review_comments": 1,
          "maintainer_can_modify": false,
          "author_association": "MEMBER",
          "auto_merge": null,
          "active_lock_reason": null
        },
        "repository": {
          "id": 123456,
          "node_id": "R_test",
          "name": "repo",
          "full_name": "test/repo",
          "private": false,
          "owner": {
            "login": "test",
            "id": 11111,
            "node_id": "O_test",
            "avatar_url": "https://avatars.githubusercontent.com/u/11111",
            "type": "Organization",
            "site_admin": false
          },
          "html_url": "https://github.com/test/repo",
          "description": "Test repository",
          "fork": false,
          "url": "https://api.github.com/repos/test/repo",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": "2024-01-12T15:30:00Z",
          "pushed_at": "2024-01-12T15:30:00Z",
          "homepage": null,
          "size": 1000,
          "stargazers_count": 50,
          "watchers_count": 50,
          "language": "TypeScript",
          "forks_count": 10,
          "open_issues_count": 5,
          "default_branch": "main",
          "topics": [],
          "visibility": "public"
        },
        "sender": {
          "login": "alice",
          "id": 12345,
          "node_id": "U_alice",
          "avatar_url": "https://avatars.githubusercontent.com/u/12345",
          "type": "User",
          "site_admin": false
        }
      }
    },
    {
      "source": "github",
      "eventType": "issues",
      "payload": {
        "action": "opened",
        "issue": {
          "id": 987654321,
          "node_id": "I_kwDOtest102",
          "number": 102,
          "title": "Critical: API keys exposed in client bundle",
          "user": {
            "login": "bob",
            "id": 23456,
            "node_id": "U_bob",
            "avatar_url": "https://avatars.githubusercontent.com/u/23456",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            { "id": 3, "node_id": "L_3", "name": "security", "color": "ff0000", "default": false },
            { "id": 4, "node_id": "L_4", "name": "critical", "color": "000000", "default": false },
            { "id": 5, "node_id": "L_5", "name": "bug", "color": "d73a4a", "default": false }
          ],
          "state": "open",
          "locked": false,
          "assignee": null,
          "assignees": [],
          "milestone": null,
          "comments": 0,
          "created_at": "2024-01-11T09:00:00Z",
          "updated_at": "2024-01-11T09:00:00Z",
          "closed_at": null,
          "author_association": "MEMBER",
          "active_lock_reason": null,
          "body": "## Problem\nFound API_KEY and JWT_SECRET exposed in the production bundle.\n\n## Steps to Reproduce\n1. Open browser DevTools\n2. Search for \"API_KEY\" in Sources\n\n## Impact\nAttackers could impersonate the server or forge JWTs.\n\n## Suggested Fix\nMove secrets to server-side environment variables.\nReference: src/config/keys.ts:15",
          "reactions": {
            "url": "https://api.github.com/repos/test/repo/issues/102/reactions",
            "total_count": 0,
            "+1": 0,
            "-1": 0,
            "laugh": 0,
            "hooray": 0,
            "confused": 0,
            "heart": 0,
            "rocket": 0,
            "eyes": 0
          },
          "html_url": "https://github.com/test/repo/issues/102",
          "timeline_url": "https://api.github.com/repos/test/repo/issues/102/timeline",
          "state_reason": null
        },
        "repository": {
          "id": 123456,
          "node_id": "R_test",
          "name": "repo",
          "full_name": "test/repo",
          "private": false,
          "owner": {
            "login": "test",
            "id": 11111,
            "node_id": "O_test",
            "avatar_url": "https://avatars.githubusercontent.com/u/11111",
            "type": "Organization",
            "site_admin": false
          },
          "html_url": "https://github.com/test/repo",
          "description": "Test repository",
          "fork": false,
          "url": "https://api.github.com/repos/test/repo",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": "2024-01-11T09:00:00Z",
          "pushed_at": "2024-01-11T09:00:00Z",
          "homepage": null,
          "size": 1000,
          "stargazers_count": 50,
          "watchers_count": 50,
          "language": "TypeScript",
          "forks_count": 10,
          "open_issues_count": 6,
          "default_branch": "main",
          "topics": [],
          "visibility": "public"
        },
        "sender": {
          "login": "bob",
          "id": 23456,
          "node_id": "U_bob",
          "avatar_url": "https://avatars.githubusercontent.com/u/23456",
          "type": "User",
          "site_admin": false
        }
      }
    },
    {
      "source": "github",
      "eventType": "push",
      "payload": {
        "ref": "refs/heads/main",
        "before": "aaa111bbb222",
        "after": "def789abc012",
        "created": false,
        "deleted": false,
        "forced": false,
        "base_ref": null,
        "compare": "https://github.com/test/repo/compare/aaa111bbb222...def789abc012",
        "commits": [
          {
            "id": "def789abc012",
            "tree_id": "tree123",
            "distinct": true,
            "message": "fix(security): Rotate compromised credentials\n\n- Regenerated DATABASE_URL with new password\n- Updated Redis connection string\n- Invalidated all existing JWT tokens\n\nBREAKING: All users will need to re-authenticate",
            "timestamp": "2024-01-12T16:00:00Z",
            "url": "https://github.com/test/repo/commit/def789abc012",
            "author": {
              "name": "charlie",
              "email": "charlie@example.com",
              "username": "charlie"
            },
            "committer": {
              "name": "charlie",
              "email": "charlie@example.com",
              "username": "charlie"
            },
            "added": ["src/config/new-secrets.ts"],
            "removed": [],
            "modified": ["src/config/database.ts", "src/config/redis.ts"]
          }
        ],
        "head_commit": {
          "id": "def789abc012",
          "tree_id": "tree123",
          "distinct": true,
          "message": "fix(security): Rotate compromised credentials\n\n- Regenerated DATABASE_URL with new password\n- Updated Redis connection string\n- Invalidated all existing JWT tokens\n\nBREAKING: All users will need to re-authenticate",
          "timestamp": "2024-01-12T16:00:00Z",
          "url": "https://github.com/test/repo/commit/def789abc012",
          "author": {
            "name": "charlie",
            "email": "charlie@example.com",
            "username": "charlie"
          },
          "committer": {
            "name": "charlie",
            "email": "charlie@example.com",
            "username": "charlie"
          },
          "added": ["src/config/new-secrets.ts"],
          "removed": [],
          "modified": ["src/config/database.ts", "src/config/redis.ts"]
        },
        "repository": {
          "id": 123456,
          "node_id": "R_test",
          "name": "repo",
          "full_name": "test/repo",
          "private": false,
          "owner": {
            "login": "test",
            "id": 11111,
            "node_id": "O_test",
            "avatar_url": "https://avatars.githubusercontent.com/u/11111",
            "type": "Organization",
            "site_admin": false
          },
          "html_url": "https://github.com/test/repo",
          "description": "Test repository",
          "fork": false,
          "url": "https://api.github.com/repos/test/repo",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": "2024-01-12T16:00:00Z",
          "pushed_at": "2024-01-12T16:00:00Z",
          "homepage": null,
          "size": 1000,
          "stargazers_count": 50,
          "watchers_count": 50,
          "language": "TypeScript",
          "forks_count": 10,
          "open_issues_count": 5,
          "default_branch": "main",
          "topics": [],
          "visibility": "public",
          "master_branch": "main"
        },
        "pusher": {
          "name": "charlie",
          "email": "charlie@example.com"
        },
        "sender": {
          "login": "charlie",
          "id": 34567,
          "node_id": "U_charlie",
          "avatar_url": "https://avatars.githubusercontent.com/u/34567",
          "type": "User",
          "site_admin": false
        }
      }
    }
  ]
}
