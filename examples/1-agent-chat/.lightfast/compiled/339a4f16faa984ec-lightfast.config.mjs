// Generated by Lightfast CLI from lightfast.config.ts
// lightfast.config.ts
import { createLightfast } from "lightfast/client";
import { createAgent } from "lightfast/agent";

// ../../node_modules/@ai-sdk/gateway/node_modules/@ai-sdk/provider/dist/index.mjs
var marker = "vercel.ai.error";
var symbol = Symbol.for(marker);
var _a;
var _AISDKError = class _AISDKError2 extends Error {
  /**
   * Creates an AI SDK Error.
   *
   * @param {Object} params - The parameters for creating the error.
   * @param {string} params.name - The name of the error.
   * @param {string} params.message - The error message.
   * @param {unknown} [params.cause] - The underlying cause of the error.
   */
  constructor({
    name: name143,
    message,
    cause
  }) {
    super(message);
    this[_a] = true;
    this.name = name143;
    this.cause = cause;
  }
  /**
   * Checks if the given error is an AI SDK Error.
   * @param {unknown} error - The error to check.
   * @returns {boolean} True if the error is an AI SDK Error, false otherwise.
   */
  static isInstance(error) {
    return _AISDKError2.hasMarker(error, marker);
  }
  static hasMarker(error, marker153) {
    const markerSymbol = Symbol.for(marker153);
    return error != null && typeof error === "object" && markerSymbol in error && typeof error[markerSymbol] === "boolean" && error[markerSymbol] === true;
  }
};
_a = symbol;
var AISDKError = _AISDKError;
var name = "AI_APICallError";
var marker2 = `vercel.ai.error.${name}`;
var symbol2 = Symbol.for(marker2);
var _a2;
var APICallError = class extends AISDKError {
  constructor({
    message,
    url,
    requestBodyValues,
    statusCode,
    responseHeaders,
    responseBody,
    cause,
    isRetryable = statusCode != null && (statusCode === 408 || // request timeout
    statusCode === 409 || // conflict
    statusCode === 429 || // too many requests
    statusCode >= 500),
    // server error
    data
  }) {
    super({ name, message, cause });
    this[_a2] = true;
    this.url = url;
    this.requestBodyValues = requestBodyValues;
    this.statusCode = statusCode;
    this.responseHeaders = responseHeaders;
    this.responseBody = responseBody;
    this.isRetryable = isRetryable;
    this.data = data;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker2);
  }
};
_a2 = symbol2;
var name2 = "AI_EmptyResponseBodyError";
var marker3 = `vercel.ai.error.${name2}`;
var symbol3 = Symbol.for(marker3);
var _a3;
var EmptyResponseBodyError = class extends AISDKError {
  // used in isInstance
  constructor({ message = "Empty response body" } = {}) {
    super({ name: name2, message });
    this[_a3] = true;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker3);
  }
};
_a3 = symbol3;
function getErrorMessage(error) {
  if (error == null) {
    return "unknown error";
  }
  if (typeof error === "string") {
    return error;
  }
  if (error instanceof Error) {
    return error.message;
  }
  return JSON.stringify(error);
}
var name3 = "AI_InvalidArgumentError";
var marker4 = `vercel.ai.error.${name3}`;
var symbol4 = Symbol.for(marker4);
var _a4;
var InvalidArgumentError = class extends AISDKError {
  constructor({
    message,
    cause,
    argument
  }) {
    super({ name: name3, message, cause });
    this[_a4] = true;
    this.argument = argument;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker4);
  }
};
_a4 = symbol4;
var name4 = "AI_InvalidPromptError";
var marker5 = `vercel.ai.error.${name4}`;
var symbol5 = Symbol.for(marker5);
var _a5;
_a5 = symbol5;
var name5 = "AI_InvalidResponseDataError";
var marker6 = `vercel.ai.error.${name5}`;
var symbol6 = Symbol.for(marker6);
var _a6;
_a6 = symbol6;
var name6 = "AI_JSONParseError";
var marker7 = `vercel.ai.error.${name6}`;
var symbol7 = Symbol.for(marker7);
var _a7;
var JSONParseError = class extends AISDKError {
  constructor({ text: text2, cause }) {
    super({
      name: name6,
      message: `JSON parsing failed: Text: ${text2}.
Error message: ${getErrorMessage(cause)}`,
      cause
    });
    this[_a7] = true;
    this.text = text2;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker7);
  }
};
_a7 = symbol7;
var name7 = "AI_LoadAPIKeyError";
var marker8 = `vercel.ai.error.${name7}`;
var symbol8 = Symbol.for(marker8);
var _a8;
_a8 = symbol8;
var name8 = "AI_LoadSettingError";
var marker9 = `vercel.ai.error.${name8}`;
var symbol9 = Symbol.for(marker9);
var _a9;
_a9 = symbol9;
var name9 = "AI_NoContentGeneratedError";
var marker10 = `vercel.ai.error.${name9}`;
var symbol10 = Symbol.for(marker10);
var _a10;
_a10 = symbol10;
var name10 = "AI_NoSuchModelError";
var marker11 = `vercel.ai.error.${name10}`;
var symbol11 = Symbol.for(marker11);
var _a11;
var NoSuchModelError = class extends AISDKError {
  constructor({
    errorName = name10,
    modelId,
    modelType,
    message = `No such ${modelType}: ${modelId}`
  }) {
    super({ name: errorName, message });
    this[_a11] = true;
    this.modelId = modelId;
    this.modelType = modelType;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker11);
  }
};
_a11 = symbol11;
var name11 = "AI_TooManyEmbeddingValuesForCallError";
var marker12 = `vercel.ai.error.${name11}`;
var symbol12 = Symbol.for(marker12);
var _a12;
_a12 = symbol12;
var name12 = "AI_TypeValidationError";
var marker13 = `vercel.ai.error.${name12}`;
var symbol13 = Symbol.for(marker13);
var _a13;
var _TypeValidationError = class _TypeValidationError2 extends AISDKError {
  constructor({ value, cause }) {
    super({
      name: name12,
      message: `Type validation failed: Value: ${JSON.stringify(value)}.
Error message: ${getErrorMessage(cause)}`,
      cause
    });
    this[_a13] = true;
    this.value = value;
  }
  static isInstance(error) {
    return AISDKError.hasMarker(error, marker13);
  }
  /**
   * Wraps an error into a TypeValidationError.
   * If the cause is already a TypeValidationError with the same value, it returns the cause.
   * Otherwise, it creates a new TypeValidationError.
   *
   * @param {Object} params - The parameters for wrapping the error.
   * @param {unknown} params.value - The value that failed validation.
   * @param {unknown} params.cause - The original error or cause of the validation failure.
   * @returns {TypeValidationError} A TypeValidationError instance.
   */
  static wrap({
    value,
    cause
  }) {
    return _TypeValidationError2.isInstance(cause) && cause.value === value ? cause : new _TypeValidationError2({ value, cause });
  }
};
_a13 = symbol13;
var TypeValidationError = _TypeValidationError;
var name13 = "AI_UnsupportedFunctionalityError";
var marker14 = `vercel.ai.error.${name13}`;
var symbol14 = Symbol.for(marker14);
var _a14;
_a14 = symbol14;

// ../../node_modules/@ai-sdk/gateway/node_modules/eventsource-parser/dist/index.js
var ParseError = class extends Error {
  constructor(message, options) {
    super(message), this.name = "ParseError", this.type = options.type, this.field = options.field, this.value = options.value, this.line = options.line;
  }
};
function noop(_arg) {
}
function createParser(callbacks) {
  if (typeof callbacks == "function")
    throw new TypeError(
      "`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?"
    );
  const { onEvent = noop, onError = noop, onRetry = noop, onComment } = callbacks;
  let incompleteLine = "", isFirstChunk = true, id, data = "", eventType = "";
  function feed(newChunk) {
    const chunk = isFirstChunk ? newChunk.replace(/^\xEF\xBB\xBF/, "") : newChunk, [complete, incomplete] = splitLines(`${incompleteLine}${chunk}`);
    for (const line of complete)
      parseLine(line);
    incompleteLine = incomplete, isFirstChunk = false;
  }
  function parseLine(line) {
    if (line === "") {
      dispatchEvent();
      return;
    }
    if (line.startsWith(":")) {
      onComment && onComment(line.slice(line.startsWith(": ") ? 2 : 1));
      return;
    }
    const fieldSeparatorIndex = line.indexOf(":");
    if (fieldSeparatorIndex !== -1) {
      const field = line.slice(0, fieldSeparatorIndex), offset = line[fieldSeparatorIndex + 1] === " " ? 2 : 1, value = line.slice(fieldSeparatorIndex + offset);
      processField(field, value, line);
      return;
    }
    processField(line, "", line);
  }
  function processField(field, value, line) {
    switch (field) {
      case "event":
        eventType = value;
        break;
      case "data":
        data = `${data}${value}
`;
        break;
      case "id":
        id = value.includes("\0") ? void 0 : value;
        break;
      case "retry":
        /^\d+$/.test(value) ? onRetry(parseInt(value, 10)) : onError(
          new ParseError(`Invalid \`retry\` value: "${value}"`, {
            type: "invalid-retry",
            value,
            line
          })
        );
        break;
      default:
        onError(
          new ParseError(
            `Unknown field "${field.length > 20 ? `${field.slice(0, 20)}\u2026` : field}"`,
            { type: "unknown-field", field, value, line }
          )
        );
        break;
    }
  }
  function dispatchEvent() {
    data.length > 0 && onEvent({
      id,
      event: eventType || void 0,
      // If the data buffer's last character is a U+000A LINE FEED (LF) character,
      // then remove the last character from the data buffer.
      data: data.endsWith(`
`) ? data.slice(0, -1) : data
    }), id = void 0, data = "", eventType = "";
  }
  function reset(options = {}) {
    incompleteLine && options.consume && parseLine(incompleteLine), isFirstChunk = true, id = void 0, data = "", eventType = "", incompleteLine = "";
  }
  return { feed, reset };
}
function splitLines(chunk) {
  const lines = [];
  let incompleteLine = "", searchIndex = 0;
  for (; searchIndex < chunk.length; ) {
    const crIndex = chunk.indexOf("\r", searchIndex), lfIndex = chunk.indexOf(`
`, searchIndex);
    let lineEnd = -1;
    if (crIndex !== -1 && lfIndex !== -1 ? lineEnd = Math.min(crIndex, lfIndex) : crIndex !== -1 ? lineEnd = crIndex : lfIndex !== -1 && (lineEnd = lfIndex), lineEnd === -1) {
      incompleteLine = chunk.slice(searchIndex);
      break;
    } else {
      const line = chunk.slice(searchIndex, lineEnd);
      lines.push(line), searchIndex = lineEnd + 1, chunk[searchIndex - 1] === "\r" && chunk[searchIndex] === `
` && searchIndex++;
    }
  }
  return [lines, incompleteLine];
}

// ../../node_modules/@ai-sdk/gateway/node_modules/eventsource-parser/dist/stream.js
var EventSourceParserStream = class extends TransformStream {
  constructor({ onError, onRetry, onComment } = {}) {
    let parser;
    super({
      start(controller) {
        parser = createParser({
          onEvent: (event) => {
            controller.enqueue(event);
          },
          onError(error) {
            onError === "terminate" ? controller.error(error) : typeof onError == "function" && onError(error);
          },
          onRetry,
          onComment
        });
      },
      transform(chunk) {
        parser.feed(chunk);
      }
    });
  }
};

// ../../node_modules/@ai-sdk/gateway/node_modules/@ai-sdk/provider-utils/dist/index.mjs
import * as z4 from "zod/v4";

// ../../node_modules/zod-to-json-schema/dist/esm/Options.js
var ignoreOverride = Symbol("Let zodToJsonSchema decide on which parser to use");
var defaultOptions = {
  name: void 0,
  $refStrategy: "root",
  basePath: ["#"],
  effectStrategy: "input",
  pipeStrategy: "all",
  dateStrategy: "format:date-time",
  mapStrategy: "entries",
  removeAdditionalStrategy: "passthrough",
  allowedAdditionalProperties: true,
  rejectedAdditionalProperties: false,
  definitionPath: "definitions",
  target: "jsonSchema7",
  strictUnions: false,
  definitions: {},
  errorMessages: false,
  markdownDescription: false,
  patternStrategy: "escape",
  applyRegexFlags: false,
  emailStrategy: "format:email",
  base64Strategy: "contentEncoding:base64",
  nameStrategy: "ref",
  openAiAnyTypeName: "OpenAiAnyType"
};
var getDefaultOptions = (options) => typeof options === "string" ? {
  ...defaultOptions,
  name: options
} : {
  ...defaultOptions,
  ...options
};

// ../../node_modules/zod-to-json-schema/dist/esm/Refs.js
var getRefs = (options) => {
  const _options = getDefaultOptions(options);
  const currentPath = _options.name !== void 0 ? [..._options.basePath, _options.definitionPath, _options.name] : _options.basePath;
  return {
    ..._options,
    flags: { hasReferencedOpenAiAnyType: false },
    currentPath,
    propertyPath: void 0,
    seen: new Map(Object.entries(_options.definitions).map(([name17, def]) => [
      def._def,
      {
        def: def._def,
        path: [..._options.basePath, _options.definitionPath, name17],
        // Resolution of references will be forced even though seen, so it's ok that the schema is undefined here for now.
        jsonSchema: void 0
      }
    ]))
  };
};

// ../../node_modules/zod-to-json-schema/dist/esm/errorMessages.js
function addErrorMessage(res, key, errorMessage, refs) {
  if (!refs?.errorMessages)
    return;
  if (errorMessage) {
    res.errorMessage = {
      ...res.errorMessage,
      [key]: errorMessage
    };
  }
}
function setResponseValueAndErrors(res, key, value, errorMessage, refs) {
  res[key] = value;
  addErrorMessage(res, key, errorMessage, refs);
}

// ../../node_modules/zod-to-json-schema/dist/esm/getRelativePath.js
var getRelativePath = (pathA, pathB) => {
  let i = 0;
  for (; i < pathA.length && i < pathB.length; i++) {
    if (pathA[i] !== pathB[i])
      break;
  }
  return [(pathA.length - i).toString(), ...pathB.slice(i)].join("/");
};

// ../../node_modules/zod-to-json-schema/dist/esm/selectParser.js
import { ZodFirstPartyTypeKind as ZodFirstPartyTypeKind3 } from "zod";

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/any.js
function parseAnyDef(refs) {
  if (refs.target !== "openAi") {
    return {};
  }
  const anyDefinitionPath = [
    ...refs.basePath,
    refs.definitionPath,
    refs.openAiAnyTypeName
  ];
  refs.flags.hasReferencedOpenAiAnyType = true;
  return {
    $ref: refs.$refStrategy === "relative" ? getRelativePath(anyDefinitionPath, refs.currentPath) : anyDefinitionPath.join("/")
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/array.js
import { ZodFirstPartyTypeKind } from "zod";
function parseArrayDef(def, refs) {
  const res = {
    type: "array"
  };
  if (def.type?._def && def.type?._def?.typeName !== ZodFirstPartyTypeKind.ZodAny) {
    res.items = parseDef(def.type._def, {
      ...refs,
      currentPath: [...refs.currentPath, "items"]
    });
  }
  if (def.minLength) {
    setResponseValueAndErrors(res, "minItems", def.minLength.value, def.minLength.message, refs);
  }
  if (def.maxLength) {
    setResponseValueAndErrors(res, "maxItems", def.maxLength.value, def.maxLength.message, refs);
  }
  if (def.exactLength) {
    setResponseValueAndErrors(res, "minItems", def.exactLength.value, def.exactLength.message, refs);
    setResponseValueAndErrors(res, "maxItems", def.exactLength.value, def.exactLength.message, refs);
  }
  return res;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/bigint.js
function parseBigintDef(def, refs) {
  const res = {
    type: "integer",
    format: "int64"
  };
  if (!def.checks)
    return res;
  for (const check of def.checks) {
    switch (check.kind) {
      case "min":
        if (refs.target === "jsonSchema7") {
          if (check.inclusive) {
            setResponseValueAndErrors(res, "minimum", check.value, check.message, refs);
          } else {
            setResponseValueAndErrors(res, "exclusiveMinimum", check.value, check.message, refs);
          }
        } else {
          if (!check.inclusive) {
            res.exclusiveMinimum = true;
          }
          setResponseValueAndErrors(res, "minimum", check.value, check.message, refs);
        }
        break;
      case "max":
        if (refs.target === "jsonSchema7") {
          if (check.inclusive) {
            setResponseValueAndErrors(res, "maximum", check.value, check.message, refs);
          } else {
            setResponseValueAndErrors(res, "exclusiveMaximum", check.value, check.message, refs);
          }
        } else {
          if (!check.inclusive) {
            res.exclusiveMaximum = true;
          }
          setResponseValueAndErrors(res, "maximum", check.value, check.message, refs);
        }
        break;
      case "multipleOf":
        setResponseValueAndErrors(res, "multipleOf", check.value, check.message, refs);
        break;
    }
  }
  return res;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/boolean.js
function parseBooleanDef() {
  return {
    type: "boolean"
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/branded.js
function parseBrandedDef(_def, refs) {
  return parseDef(_def.type._def, refs);
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/catch.js
var parseCatchDef = (def, refs) => {
  return parseDef(def.innerType._def, refs);
};

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/date.js
function parseDateDef(def, refs, overrideDateStrategy) {
  const strategy = overrideDateStrategy ?? refs.dateStrategy;
  if (Array.isArray(strategy)) {
    return {
      anyOf: strategy.map((item, i) => parseDateDef(def, refs, item))
    };
  }
  switch (strategy) {
    case "string":
    case "format:date-time":
      return {
        type: "string",
        format: "date-time"
      };
    case "format:date":
      return {
        type: "string",
        format: "date"
      };
    case "integer":
      return integerDateParser(def, refs);
  }
}
var integerDateParser = (def, refs) => {
  const res = {
    type: "integer",
    format: "unix-time"
  };
  if (refs.target === "openApi3") {
    return res;
  }
  for (const check of def.checks) {
    switch (check.kind) {
      case "min":
        setResponseValueAndErrors(
          res,
          "minimum",
          check.value,
          // This is in milliseconds
          check.message,
          refs
        );
        break;
      case "max":
        setResponseValueAndErrors(
          res,
          "maximum",
          check.value,
          // This is in milliseconds
          check.message,
          refs
        );
        break;
    }
  }
  return res;
};

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/default.js
function parseDefaultDef(_def, refs) {
  return {
    ...parseDef(_def.innerType._def, refs),
    default: _def.defaultValue()
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/effects.js
function parseEffectsDef(_def, refs) {
  return refs.effectStrategy === "input" ? parseDef(_def.schema._def, refs) : parseAnyDef(refs);
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/enum.js
function parseEnumDef(def) {
  return {
    type: "string",
    enum: Array.from(def.values)
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/intersection.js
var isJsonSchema7AllOfType = (type) => {
  if ("type" in type && type.type === "string")
    return false;
  return "allOf" in type;
};
function parseIntersectionDef(def, refs) {
  const allOf = [
    parseDef(def.left._def, {
      ...refs,
      currentPath: [...refs.currentPath, "allOf", "0"]
    }),
    parseDef(def.right._def, {
      ...refs,
      currentPath: [...refs.currentPath, "allOf", "1"]
    })
  ].filter((x) => !!x);
  let unevaluatedProperties = refs.target === "jsonSchema2019-09" ? { unevaluatedProperties: false } : void 0;
  const mergedAllOf = [];
  allOf.forEach((schema) => {
    if (isJsonSchema7AllOfType(schema)) {
      mergedAllOf.push(...schema.allOf);
      if (schema.unevaluatedProperties === void 0) {
        unevaluatedProperties = void 0;
      }
    } else {
      let nestedSchema = schema;
      if ("additionalProperties" in schema && schema.additionalProperties === false) {
        const { additionalProperties, ...rest } = schema;
        nestedSchema = rest;
      } else {
        unevaluatedProperties = void 0;
      }
      mergedAllOf.push(nestedSchema);
    }
  });
  return mergedAllOf.length ? {
    allOf: mergedAllOf,
    ...unevaluatedProperties
  } : void 0;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/literal.js
function parseLiteralDef(def, refs) {
  const parsedType = typeof def.value;
  if (parsedType !== "bigint" && parsedType !== "number" && parsedType !== "boolean" && parsedType !== "string") {
    return {
      type: Array.isArray(def.value) ? "array" : "object"
    };
  }
  if (refs.target === "openApi3") {
    return {
      type: parsedType === "bigint" ? "integer" : parsedType,
      enum: [def.value]
    };
  }
  return {
    type: parsedType === "bigint" ? "integer" : parsedType,
    const: def.value
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/record.js
import { ZodFirstPartyTypeKind as ZodFirstPartyTypeKind2 } from "zod";

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/string.js
var emojiRegex = void 0;
var zodPatterns = {
  /**
   * `c` was changed to `[cC]` to replicate /i flag
   */
  cuid: /^[cC][^\s-]{8,}$/,
  cuid2: /^[0-9a-z]+$/,
  ulid: /^[0-9A-HJKMNP-TV-Z]{26}$/,
  /**
   * `a-z` was added to replicate /i flag
   */
  email: /^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,
  /**
   * Constructed a valid Unicode RegExp
   *
   * Lazily instantiate since this type of regex isn't supported
   * in all envs (e.g. React Native).
   *
   * See:
   * https://github.com/colinhacks/zod/issues/2433
   * Fix in Zod:
   * https://github.com/colinhacks/zod/commit/9340fd51e48576a75adc919bff65dbc4a5d4c99b
   */
  emoji: () => {
    if (emojiRegex === void 0) {
      emojiRegex = RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$", "u");
    }
    return emojiRegex;
  },
  /**
   * Unused
   */
  uuid: /^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,
  /**
   * Unused
   */
  ipv4: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,
  ipv4Cidr: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,
  /**
   * Unused
   */
  ipv6: /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,
  ipv6Cidr: /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,
  base64: /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,
  base64url: /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,
  nanoid: /^[a-zA-Z0-9_-]{21}$/,
  jwt: /^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/
};
function parseStringDef(def, refs) {
  const res = {
    type: "string"
  };
  if (def.checks) {
    for (const check of def.checks) {
      switch (check.kind) {
        case "min":
          setResponseValueAndErrors(res, "minLength", typeof res.minLength === "number" ? Math.max(res.minLength, check.value) : check.value, check.message, refs);
          break;
        case "max":
          setResponseValueAndErrors(res, "maxLength", typeof res.maxLength === "number" ? Math.min(res.maxLength, check.value) : check.value, check.message, refs);
          break;
        case "email":
          switch (refs.emailStrategy) {
            case "format:email":
              addFormat(res, "email", check.message, refs);
              break;
            case "format:idn-email":
              addFormat(res, "idn-email", check.message, refs);
              break;
            case "pattern:zod":
              addPattern(res, zodPatterns.email, check.message, refs);
              break;
          }
          break;
        case "url":
          addFormat(res, "uri", check.message, refs);
          break;
        case "uuid":
          addFormat(res, "uuid", check.message, refs);
          break;
        case "regex":
          addPattern(res, check.regex, check.message, refs);
          break;
        case "cuid":
          addPattern(res, zodPatterns.cuid, check.message, refs);
          break;
        case "cuid2":
          addPattern(res, zodPatterns.cuid2, check.message, refs);
          break;
        case "startsWith":
          addPattern(res, RegExp(`^${escapeLiteralCheckValue(check.value, refs)}`), check.message, refs);
          break;
        case "endsWith":
          addPattern(res, RegExp(`${escapeLiteralCheckValue(check.value, refs)}$`), check.message, refs);
          break;
        case "datetime":
          addFormat(res, "date-time", check.message, refs);
          break;
        case "date":
          addFormat(res, "date", check.message, refs);
          break;
        case "time":
          addFormat(res, "time", check.message, refs);
          break;
        case "duration":
          addFormat(res, "duration", check.message, refs);
          break;
        case "length":
          setResponseValueAndErrors(res, "minLength", typeof res.minLength === "number" ? Math.max(res.minLength, check.value) : check.value, check.message, refs);
          setResponseValueAndErrors(res, "maxLength", typeof res.maxLength === "number" ? Math.min(res.maxLength, check.value) : check.value, check.message, refs);
          break;
        case "includes": {
          addPattern(res, RegExp(escapeLiteralCheckValue(check.value, refs)), check.message, refs);
          break;
        }
        case "ip": {
          if (check.version !== "v6") {
            addFormat(res, "ipv4", check.message, refs);
          }
          if (check.version !== "v4") {
            addFormat(res, "ipv6", check.message, refs);
          }
          break;
        }
        case "base64url":
          addPattern(res, zodPatterns.base64url, check.message, refs);
          break;
        case "jwt":
          addPattern(res, zodPatterns.jwt, check.message, refs);
          break;
        case "cidr": {
          if (check.version !== "v6") {
            addPattern(res, zodPatterns.ipv4Cidr, check.message, refs);
          }
          if (check.version !== "v4") {
            addPattern(res, zodPatterns.ipv6Cidr, check.message, refs);
          }
          break;
        }
        case "emoji":
          addPattern(res, zodPatterns.emoji(), check.message, refs);
          break;
        case "ulid": {
          addPattern(res, zodPatterns.ulid, check.message, refs);
          break;
        }
        case "base64": {
          switch (refs.base64Strategy) {
            case "format:binary": {
              addFormat(res, "binary", check.message, refs);
              break;
            }
            case "contentEncoding:base64": {
              setResponseValueAndErrors(res, "contentEncoding", "base64", check.message, refs);
              break;
            }
            case "pattern:zod": {
              addPattern(res, zodPatterns.base64, check.message, refs);
              break;
            }
          }
          break;
        }
        case "nanoid": {
          addPattern(res, zodPatterns.nanoid, check.message, refs);
        }
        case "toLowerCase":
        case "toUpperCase":
        case "trim":
          break;
        default:
          /* @__PURE__ */ ((_) => {
          })(check);
      }
    }
  }
  return res;
}
function escapeLiteralCheckValue(literal, refs) {
  return refs.patternStrategy === "escape" ? escapeNonAlphaNumeric(literal) : literal;
}
var ALPHA_NUMERIC = new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");
function escapeNonAlphaNumeric(source) {
  let result = "";
  for (let i = 0; i < source.length; i++) {
    if (!ALPHA_NUMERIC.has(source[i])) {
      result += "\\";
    }
    result += source[i];
  }
  return result;
}
function addFormat(schema, value, message, refs) {
  if (schema.format || schema.anyOf?.some((x) => x.format)) {
    if (!schema.anyOf) {
      schema.anyOf = [];
    }
    if (schema.format) {
      schema.anyOf.push({
        format: schema.format,
        ...schema.errorMessage && refs.errorMessages && {
          errorMessage: { format: schema.errorMessage.format }
        }
      });
      delete schema.format;
      if (schema.errorMessage) {
        delete schema.errorMessage.format;
        if (Object.keys(schema.errorMessage).length === 0) {
          delete schema.errorMessage;
        }
      }
    }
    schema.anyOf.push({
      format: value,
      ...message && refs.errorMessages && { errorMessage: { format: message } }
    });
  } else {
    setResponseValueAndErrors(schema, "format", value, message, refs);
  }
}
function addPattern(schema, regex, message, refs) {
  if (schema.pattern || schema.allOf?.some((x) => x.pattern)) {
    if (!schema.allOf) {
      schema.allOf = [];
    }
    if (schema.pattern) {
      schema.allOf.push({
        pattern: schema.pattern,
        ...schema.errorMessage && refs.errorMessages && {
          errorMessage: { pattern: schema.errorMessage.pattern }
        }
      });
      delete schema.pattern;
      if (schema.errorMessage) {
        delete schema.errorMessage.pattern;
        if (Object.keys(schema.errorMessage).length === 0) {
          delete schema.errorMessage;
        }
      }
    }
    schema.allOf.push({
      pattern: stringifyRegExpWithFlags(regex, refs),
      ...message && refs.errorMessages && { errorMessage: { pattern: message } }
    });
  } else {
    setResponseValueAndErrors(schema, "pattern", stringifyRegExpWithFlags(regex, refs), message, refs);
  }
}
function stringifyRegExpWithFlags(regex, refs) {
  if (!refs.applyRegexFlags || !regex.flags) {
    return regex.source;
  }
  const flags = {
    i: regex.flags.includes("i"),
    m: regex.flags.includes("m"),
    s: regex.flags.includes("s")
    // `.` matches newlines
  };
  const source = flags.i ? regex.source.toLowerCase() : regex.source;
  let pattern = "";
  let isEscaped = false;
  let inCharGroup = false;
  let inCharRange = false;
  for (let i = 0; i < source.length; i++) {
    if (isEscaped) {
      pattern += source[i];
      isEscaped = false;
      continue;
    }
    if (flags.i) {
      if (inCharGroup) {
        if (source[i].match(/[a-z]/)) {
          if (inCharRange) {
            pattern += source[i];
            pattern += `${source[i - 2]}-${source[i]}`.toUpperCase();
            inCharRange = false;
          } else if (source[i + 1] === "-" && source[i + 2]?.match(/[a-z]/)) {
            pattern += source[i];
            inCharRange = true;
          } else {
            pattern += `${source[i]}${source[i].toUpperCase()}`;
          }
          continue;
        }
      } else if (source[i].match(/[a-z]/)) {
        pattern += `[${source[i]}${source[i].toUpperCase()}]`;
        continue;
      }
    }
    if (flags.m) {
      if (source[i] === "^") {
        pattern += `(^|(?<=[\r
]))`;
        continue;
      } else if (source[i] === "$") {
        pattern += `($|(?=[\r
]))`;
        continue;
      }
    }
    if (flags.s && source[i] === ".") {
      pattern += inCharGroup ? `${source[i]}\r
` : `[${source[i]}\r
]`;
      continue;
    }
    pattern += source[i];
    if (source[i] === "\\") {
      isEscaped = true;
    } else if (inCharGroup && source[i] === "]") {
      inCharGroup = false;
    } else if (!inCharGroup && source[i] === "[") {
      inCharGroup = true;
    }
  }
  try {
    new RegExp(pattern);
  } catch {
    console.warn(`Could not convert regex pattern at ${refs.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`);
    return regex.source;
  }
  return pattern;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/record.js
function parseRecordDef(def, refs) {
  if (refs.target === "openAi") {
    console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead.");
  }
  if (refs.target === "openApi3" && def.keyType?._def.typeName === ZodFirstPartyTypeKind2.ZodEnum) {
    return {
      type: "object",
      required: def.keyType._def.values,
      properties: def.keyType._def.values.reduce((acc, key) => ({
        ...acc,
        [key]: parseDef(def.valueType._def, {
          ...refs,
          currentPath: [...refs.currentPath, "properties", key]
        }) ?? parseAnyDef(refs)
      }), {}),
      additionalProperties: refs.rejectedAdditionalProperties
    };
  }
  const schema = {
    type: "object",
    additionalProperties: parseDef(def.valueType._def, {
      ...refs,
      currentPath: [...refs.currentPath, "additionalProperties"]
    }) ?? refs.allowedAdditionalProperties
  };
  if (refs.target === "openApi3") {
    return schema;
  }
  if (def.keyType?._def.typeName === ZodFirstPartyTypeKind2.ZodString && def.keyType._def.checks?.length) {
    const { type, ...keyType } = parseStringDef(def.keyType._def, refs);
    return {
      ...schema,
      propertyNames: keyType
    };
  } else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind2.ZodEnum) {
    return {
      ...schema,
      propertyNames: {
        enum: def.keyType._def.values
      }
    };
  } else if (def.keyType?._def.typeName === ZodFirstPartyTypeKind2.ZodBranded && def.keyType._def.type._def.typeName === ZodFirstPartyTypeKind2.ZodString && def.keyType._def.type._def.checks?.length) {
    const { type, ...keyType } = parseBrandedDef(def.keyType._def, refs);
    return {
      ...schema,
      propertyNames: keyType
    };
  }
  return schema;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/map.js
function parseMapDef(def, refs) {
  if (refs.mapStrategy === "record") {
    return parseRecordDef(def, refs);
  }
  const keys = parseDef(def.keyType._def, {
    ...refs,
    currentPath: [...refs.currentPath, "items", "items", "0"]
  }) || parseAnyDef(refs);
  const values = parseDef(def.valueType._def, {
    ...refs,
    currentPath: [...refs.currentPath, "items", "items", "1"]
  }) || parseAnyDef(refs);
  return {
    type: "array",
    maxItems: 125,
    items: {
      type: "array",
      items: [keys, values],
      minItems: 2,
      maxItems: 2
    }
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/nativeEnum.js
function parseNativeEnumDef(def) {
  const object2 = def.values;
  const actualKeys = Object.keys(def.values).filter((key) => {
    return typeof object2[object2[key]] !== "number";
  });
  const actualValues = actualKeys.map((key) => object2[key]);
  const parsedTypes = Array.from(new Set(actualValues.map((values) => typeof values)));
  return {
    type: parsedTypes.length === 1 ? parsedTypes[0] === "string" ? "string" : "number" : ["string", "number"],
    enum: actualValues
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/never.js
function parseNeverDef(refs) {
  return refs.target === "openAi" ? void 0 : {
    not: parseAnyDef({
      ...refs,
      currentPath: [...refs.currentPath, "not"]
    })
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/null.js
function parseNullDef(refs) {
  return refs.target === "openApi3" ? {
    enum: ["null"],
    nullable: true
  } : {
    type: "null"
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/union.js
var primitiveMappings = {
  ZodString: "string",
  ZodNumber: "number",
  ZodBigInt: "integer",
  ZodBoolean: "boolean",
  ZodNull: "null"
};
function parseUnionDef(def, refs) {
  if (refs.target === "openApi3")
    return asAnyOf(def, refs);
  const options = def.options instanceof Map ? Array.from(def.options.values()) : def.options;
  if (options.every((x) => x._def.typeName in primitiveMappings && (!x._def.checks || !x._def.checks.length))) {
    const types = options.reduce((types2, x) => {
      const type = primitiveMappings[x._def.typeName];
      return type && !types2.includes(type) ? [...types2, type] : types2;
    }, []);
    return {
      type: types.length > 1 ? types : types[0]
    };
  } else if (options.every((x) => x._def.typeName === "ZodLiteral" && !x.description)) {
    const types = options.reduce((acc, x) => {
      const type = typeof x._def.value;
      switch (type) {
        case "string":
        case "number":
        case "boolean":
          return [...acc, type];
        case "bigint":
          return [...acc, "integer"];
        case "object":
          if (x._def.value === null)
            return [...acc, "null"];
        case "symbol":
        case "undefined":
        case "function":
        default:
          return acc;
      }
    }, []);
    if (types.length === options.length) {
      const uniqueTypes = types.filter((x, i, a) => a.indexOf(x) === i);
      return {
        type: uniqueTypes.length > 1 ? uniqueTypes : uniqueTypes[0],
        enum: options.reduce((acc, x) => {
          return acc.includes(x._def.value) ? acc : [...acc, x._def.value];
        }, [])
      };
    }
  } else if (options.every((x) => x._def.typeName === "ZodEnum")) {
    return {
      type: "string",
      enum: options.reduce((acc, x) => [
        ...acc,
        ...x._def.values.filter((x2) => !acc.includes(x2))
      ], [])
    };
  }
  return asAnyOf(def, refs);
}
var asAnyOf = (def, refs) => {
  const anyOf = (def.options instanceof Map ? Array.from(def.options.values()) : def.options).map((x, i) => parseDef(x._def, {
    ...refs,
    currentPath: [...refs.currentPath, "anyOf", `${i}`]
  })).filter((x) => !!x && (!refs.strictUnions || typeof x === "object" && Object.keys(x).length > 0));
  return anyOf.length ? { anyOf } : void 0;
};

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/nullable.js
function parseNullableDef(def, refs) {
  if (["ZodString", "ZodNumber", "ZodBigInt", "ZodBoolean", "ZodNull"].includes(def.innerType._def.typeName) && (!def.innerType._def.checks || !def.innerType._def.checks.length)) {
    if (refs.target === "openApi3") {
      return {
        type: primitiveMappings[def.innerType._def.typeName],
        nullable: true
      };
    }
    return {
      type: [
        primitiveMappings[def.innerType._def.typeName],
        "null"
      ]
    };
  }
  if (refs.target === "openApi3") {
    const base2 = parseDef(def.innerType._def, {
      ...refs,
      currentPath: [...refs.currentPath]
    });
    if (base2 && "$ref" in base2)
      return { allOf: [base2], nullable: true };
    return base2 && { ...base2, nullable: true };
  }
  const base = parseDef(def.innerType._def, {
    ...refs,
    currentPath: [...refs.currentPath, "anyOf", "0"]
  });
  return base && { anyOf: [base, { type: "null" }] };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/number.js
function parseNumberDef(def, refs) {
  const res = {
    type: "number"
  };
  if (!def.checks)
    return res;
  for (const check of def.checks) {
    switch (check.kind) {
      case "int":
        res.type = "integer";
        addErrorMessage(res, "type", check.message, refs);
        break;
      case "min":
        if (refs.target === "jsonSchema7") {
          if (check.inclusive) {
            setResponseValueAndErrors(res, "minimum", check.value, check.message, refs);
          } else {
            setResponseValueAndErrors(res, "exclusiveMinimum", check.value, check.message, refs);
          }
        } else {
          if (!check.inclusive) {
            res.exclusiveMinimum = true;
          }
          setResponseValueAndErrors(res, "minimum", check.value, check.message, refs);
        }
        break;
      case "max":
        if (refs.target === "jsonSchema7") {
          if (check.inclusive) {
            setResponseValueAndErrors(res, "maximum", check.value, check.message, refs);
          } else {
            setResponseValueAndErrors(res, "exclusiveMaximum", check.value, check.message, refs);
          }
        } else {
          if (!check.inclusive) {
            res.exclusiveMaximum = true;
          }
          setResponseValueAndErrors(res, "maximum", check.value, check.message, refs);
        }
        break;
      case "multipleOf":
        setResponseValueAndErrors(res, "multipleOf", check.value, check.message, refs);
        break;
    }
  }
  return res;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/object.js
function parseObjectDef(def, refs) {
  const forceOptionalIntoNullable = refs.target === "openAi";
  const result = {
    type: "object",
    properties: {}
  };
  const required = [];
  const shape = def.shape();
  for (const propName in shape) {
    let propDef = shape[propName];
    if (propDef === void 0 || propDef._def === void 0) {
      continue;
    }
    let propOptional = safeIsOptional(propDef);
    if (propOptional && forceOptionalIntoNullable) {
      if (propDef._def.typeName === "ZodOptional") {
        propDef = propDef._def.innerType;
      }
      if (!propDef.isNullable()) {
        propDef = propDef.nullable();
      }
      propOptional = false;
    }
    const parsedDef = parseDef(propDef._def, {
      ...refs,
      currentPath: [...refs.currentPath, "properties", propName],
      propertyPath: [...refs.currentPath, "properties", propName]
    });
    if (parsedDef === void 0) {
      continue;
    }
    result.properties[propName] = parsedDef;
    if (!propOptional) {
      required.push(propName);
    }
  }
  if (required.length) {
    result.required = required;
  }
  const additionalProperties = decideAdditionalProperties(def, refs);
  if (additionalProperties !== void 0) {
    result.additionalProperties = additionalProperties;
  }
  return result;
}
function decideAdditionalProperties(def, refs) {
  if (def.catchall._def.typeName !== "ZodNever") {
    return parseDef(def.catchall._def, {
      ...refs,
      currentPath: [...refs.currentPath, "additionalProperties"]
    });
  }
  switch (def.unknownKeys) {
    case "passthrough":
      return refs.allowedAdditionalProperties;
    case "strict":
      return refs.rejectedAdditionalProperties;
    case "strip":
      return refs.removeAdditionalStrategy === "strict" ? refs.allowedAdditionalProperties : refs.rejectedAdditionalProperties;
  }
}
function safeIsOptional(schema) {
  try {
    return schema.isOptional();
  } catch {
    return true;
  }
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/optional.js
var parseOptionalDef = (def, refs) => {
  if (refs.currentPath.toString() === refs.propertyPath?.toString()) {
    return parseDef(def.innerType._def, refs);
  }
  const innerSchema = parseDef(def.innerType._def, {
    ...refs,
    currentPath: [...refs.currentPath, "anyOf", "1"]
  });
  return innerSchema ? {
    anyOf: [
      {
        not: parseAnyDef(refs)
      },
      innerSchema
    ]
  } : parseAnyDef(refs);
};

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/pipeline.js
var parsePipelineDef = (def, refs) => {
  if (refs.pipeStrategy === "input") {
    return parseDef(def.in._def, refs);
  } else if (refs.pipeStrategy === "output") {
    return parseDef(def.out._def, refs);
  }
  const a = parseDef(def.in._def, {
    ...refs,
    currentPath: [...refs.currentPath, "allOf", "0"]
  });
  const b = parseDef(def.out._def, {
    ...refs,
    currentPath: [...refs.currentPath, "allOf", a ? "1" : "0"]
  });
  return {
    allOf: [a, b].filter((x) => x !== void 0)
  };
};

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/promise.js
function parsePromiseDef(def, refs) {
  return parseDef(def.type._def, refs);
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/set.js
function parseSetDef(def, refs) {
  const items = parseDef(def.valueType._def, {
    ...refs,
    currentPath: [...refs.currentPath, "items"]
  });
  const schema = {
    type: "array",
    uniqueItems: true,
    items
  };
  if (def.minSize) {
    setResponseValueAndErrors(schema, "minItems", def.minSize.value, def.minSize.message, refs);
  }
  if (def.maxSize) {
    setResponseValueAndErrors(schema, "maxItems", def.maxSize.value, def.maxSize.message, refs);
  }
  return schema;
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/tuple.js
function parseTupleDef(def, refs) {
  if (def.rest) {
    return {
      type: "array",
      minItems: def.items.length,
      items: def.items.map((x, i) => parseDef(x._def, {
        ...refs,
        currentPath: [...refs.currentPath, "items", `${i}`]
      })).reduce((acc, x) => x === void 0 ? acc : [...acc, x], []),
      additionalItems: parseDef(def.rest._def, {
        ...refs,
        currentPath: [...refs.currentPath, "additionalItems"]
      })
    };
  } else {
    return {
      type: "array",
      minItems: def.items.length,
      maxItems: def.items.length,
      items: def.items.map((x, i) => parseDef(x._def, {
        ...refs,
        currentPath: [...refs.currentPath, "items", `${i}`]
      })).reduce((acc, x) => x === void 0 ? acc : [...acc, x], [])
    };
  }
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/undefined.js
function parseUndefinedDef(refs) {
  return {
    not: parseAnyDef(refs)
  };
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/unknown.js
function parseUnknownDef(refs) {
  return parseAnyDef(refs);
}

// ../../node_modules/zod-to-json-schema/dist/esm/parsers/readonly.js
var parseReadonlyDef = (def, refs) => {
  return parseDef(def.innerType._def, refs);
};

// ../../node_modules/zod-to-json-schema/dist/esm/selectParser.js
var selectParser = (def, typeName, refs) => {
  switch (typeName) {
    case ZodFirstPartyTypeKind3.ZodString:
      return parseStringDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodNumber:
      return parseNumberDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodObject:
      return parseObjectDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodBigInt:
      return parseBigintDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodBoolean:
      return parseBooleanDef();
    case ZodFirstPartyTypeKind3.ZodDate:
      return parseDateDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodUndefined:
      return parseUndefinedDef(refs);
    case ZodFirstPartyTypeKind3.ZodNull:
      return parseNullDef(refs);
    case ZodFirstPartyTypeKind3.ZodArray:
      return parseArrayDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodUnion:
    case ZodFirstPartyTypeKind3.ZodDiscriminatedUnion:
      return parseUnionDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodIntersection:
      return parseIntersectionDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodTuple:
      return parseTupleDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodRecord:
      return parseRecordDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodLiteral:
      return parseLiteralDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodEnum:
      return parseEnumDef(def);
    case ZodFirstPartyTypeKind3.ZodNativeEnum:
      return parseNativeEnumDef(def);
    case ZodFirstPartyTypeKind3.ZodNullable:
      return parseNullableDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodOptional:
      return parseOptionalDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodMap:
      return parseMapDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodSet:
      return parseSetDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodLazy:
      return () => def.getter()._def;
    case ZodFirstPartyTypeKind3.ZodPromise:
      return parsePromiseDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodNaN:
    case ZodFirstPartyTypeKind3.ZodNever:
      return parseNeverDef(refs);
    case ZodFirstPartyTypeKind3.ZodEffects:
      return parseEffectsDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodAny:
      return parseAnyDef(refs);
    case ZodFirstPartyTypeKind3.ZodUnknown:
      return parseUnknownDef(refs);
    case ZodFirstPartyTypeKind3.ZodDefault:
      return parseDefaultDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodBranded:
      return parseBrandedDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodReadonly:
      return parseReadonlyDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodCatch:
      return parseCatchDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodPipeline:
      return parsePipelineDef(def, refs);
    case ZodFirstPartyTypeKind3.ZodFunction:
    case ZodFirstPartyTypeKind3.ZodVoid:
    case ZodFirstPartyTypeKind3.ZodSymbol:
      return void 0;
    default:
      return /* @__PURE__ */ ((_) => void 0)(typeName);
  }
};

// ../../node_modules/zod-to-json-schema/dist/esm/parseDef.js
function parseDef(def, refs, forceResolution = false) {
  const seenItem = refs.seen.get(def);
  if (refs.override) {
    const overrideResult = refs.override?.(def, refs, seenItem, forceResolution);
    if (overrideResult !== ignoreOverride) {
      return overrideResult;
    }
  }
  if (seenItem && !forceResolution) {
    const seenSchema = get$ref(seenItem, refs);
    if (seenSchema !== void 0) {
      return seenSchema;
    }
  }
  const newItem = { def, path: refs.currentPath, jsonSchema: void 0 };
  refs.seen.set(def, newItem);
  const jsonSchemaOrGetter = selectParser(def, def.typeName, refs);
  const jsonSchema2 = typeof jsonSchemaOrGetter === "function" ? parseDef(jsonSchemaOrGetter(), refs) : jsonSchemaOrGetter;
  if (jsonSchema2) {
    addMeta(def, refs, jsonSchema2);
  }
  if (refs.postProcess) {
    const postProcessResult = refs.postProcess(jsonSchema2, def, refs);
    newItem.jsonSchema = jsonSchema2;
    return postProcessResult;
  }
  newItem.jsonSchema = jsonSchema2;
  return jsonSchema2;
}
var get$ref = (item, refs) => {
  switch (refs.$refStrategy) {
    case "root":
      return { $ref: item.path.join("/") };
    case "relative":
      return { $ref: getRelativePath(refs.currentPath, item.path) };
    case "none":
    case "seen": {
      if (item.path.length < refs.currentPath.length && item.path.every((value, index) => refs.currentPath[index] === value)) {
        console.warn(`Recursive reference detected at ${refs.currentPath.join("/")}! Defaulting to any`);
        return parseAnyDef(refs);
      }
      return refs.$refStrategy === "seen" ? parseAnyDef(refs) : void 0;
    }
  }
};
var addMeta = (def, refs, jsonSchema2) => {
  if (def.description) {
    jsonSchema2.description = def.description;
    if (refs.markdownDescription) {
      jsonSchema2.markdownDescription = def.description;
    }
  }
  return jsonSchema2;
};

// ../../node_modules/zod-to-json-schema/dist/esm/zodToJsonSchema.js
var zodToJsonSchema = (schema, options) => {
  const refs = getRefs(options);
  let definitions = typeof options === "object" && options.definitions ? Object.entries(options.definitions).reduce((acc, [name18, schema2]) => ({
    ...acc,
    [name18]: parseDef(schema2._def, {
      ...refs,
      currentPath: [...refs.basePath, refs.definitionPath, name18]
    }, true) ?? parseAnyDef(refs)
  }), {}) : void 0;
  const name17 = typeof options === "string" ? options : options?.nameStrategy === "title" ? void 0 : options?.name;
  const main = parseDef(schema._def, name17 === void 0 ? refs : {
    ...refs,
    currentPath: [...refs.basePath, refs.definitionPath, name17]
  }, false) ?? parseAnyDef(refs);
  const title = typeof options === "object" && options.name !== void 0 && options.nameStrategy === "title" ? options.name : void 0;
  if (title !== void 0) {
    main.title = title;
  }
  if (refs.flags.hasReferencedOpenAiAnyType) {
    if (!definitions) {
      definitions = {};
    }
    if (!definitions[refs.openAiAnyTypeName]) {
      definitions[refs.openAiAnyTypeName] = {
        // Skipping "object" as no properties can be defined and additionalProperties must be "false"
        type: ["string", "number", "integer", "boolean", "array", "null"],
        items: {
          $ref: refs.$refStrategy === "relative" ? "1" : [
            ...refs.basePath,
            refs.definitionPath,
            refs.openAiAnyTypeName
          ].join("/")
        }
      };
    }
  }
  const combined = name17 === void 0 ? definitions ? {
    ...main,
    [refs.definitionPath]: definitions
  } : main : {
    $ref: [
      ...refs.$refStrategy === "relative" ? [] : refs.basePath,
      refs.definitionPath,
      name17
    ].join("/"),
    [refs.definitionPath]: {
      ...definitions,
      [name17]: main
    }
  };
  if (refs.target === "jsonSchema7") {
    combined.$schema = "http://json-schema.org/draft-07/schema#";
  } else if (refs.target === "jsonSchema2019-09" || refs.target === "openAi") {
    combined.$schema = "https://json-schema.org/draft/2019-09/schema#";
  }
  if (refs.target === "openAi" && ("anyOf" in combined || "oneOf" in combined || "allOf" in combined || "type" in combined && Array.isArray(combined.type))) {
    console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property.");
  }
  return combined;
};

// ../../node_modules/zod-to-json-schema/dist/esm/index.js
var esm_default = zodToJsonSchema;

// ../../node_modules/@ai-sdk/gateway/node_modules/@ai-sdk/provider-utils/dist/index.mjs
function combineHeaders(...headers) {
  return headers.reduce(
    (combinedHeaders, currentHeaders) => ({
      ...combinedHeaders,
      ...currentHeaders != null ? currentHeaders : {}
    }),
    {}
  );
}
function extractResponseHeaders(response) {
  return Object.fromEntries([...response.headers]);
}
var createIdGenerator = ({
  prefix,
  size = 16,
  alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
  separator = "-"
} = {}) => {
  const generator = () => {
    const alphabetLength = alphabet.length;
    const chars = new Array(size);
    for (let i = 0; i < size; i++) {
      chars[i] = alphabet[Math.random() * alphabetLength | 0];
    }
    return chars.join("");
  };
  if (prefix == null) {
    return generator;
  }
  if (alphabet.includes(separator)) {
    throw new InvalidArgumentError({
      argument: "separator",
      message: `The separator "${separator}" must not be part of the alphabet "${alphabet}".`
    });
  }
  return () => `${prefix}${separator}${generator()}`;
};
var generateId = createIdGenerator();
function isAbortError(error) {
  return (error instanceof Error || error instanceof DOMException) && (error.name === "AbortError" || error.name === "ResponseAborted" || // Next.js
  error.name === "TimeoutError");
}
var FETCH_FAILED_ERROR_MESSAGES = ["fetch failed", "failed to fetch"];
function handleFetchError({
  error,
  url,
  requestBodyValues
}) {
  if (isAbortError(error)) {
    return error;
  }
  if (error instanceof TypeError && FETCH_FAILED_ERROR_MESSAGES.includes(error.message.toLowerCase())) {
    const cause = error.cause;
    if (cause != null) {
      return new APICallError({
        message: `Cannot connect to API: ${cause.message}`,
        cause,
        url,
        requestBodyValues,
        isRetryable: true
        // retry when network error
      });
    }
  }
  return error;
}
function removeUndefinedEntries(record) {
  return Object.fromEntries(
    Object.entries(record).filter(([_key, value]) => value != null)
  );
}
var getOriginalFetch = () => globalThis.fetch;
var getFromApi = async ({
  url,
  headers = {},
  successfulResponseHandler,
  failedResponseHandler,
  abortSignal,
  fetch: fetch2 = getOriginalFetch()
}) => {
  try {
    const response = await fetch2(url, {
      method: "GET",
      headers: removeUndefinedEntries(headers),
      signal: abortSignal
    });
    const responseHeaders = extractResponseHeaders(response);
    if (!response.ok) {
      let errorInformation;
      try {
        errorInformation = await failedResponseHandler({
          response,
          url,
          requestBodyValues: {}
        });
      } catch (error) {
        if (isAbortError(error) || APICallError.isInstance(error)) {
          throw error;
        }
        throw new APICallError({
          message: "Failed to process error response",
          cause: error,
          statusCode: response.status,
          url,
          responseHeaders,
          requestBodyValues: {}
        });
      }
      throw errorInformation.value;
    }
    try {
      return await successfulResponseHandler({
        response,
        url,
        requestBodyValues: {}
      });
    } catch (error) {
      if (error instanceof Error) {
        if (isAbortError(error) || APICallError.isInstance(error)) {
          throw error;
        }
      }
      throw new APICallError({
        message: "Failed to process successful response",
        cause: error,
        statusCode: response.status,
        url,
        responseHeaders,
        requestBodyValues: {}
      });
    }
  } catch (error) {
    throw handleFetchError({ error, url, requestBodyValues: {} });
  }
};
function loadOptionalSetting({
  settingValue,
  environmentVariableName
}) {
  if (typeof settingValue === "string") {
    return settingValue;
  }
  if (settingValue != null || typeof process === "undefined") {
    return void 0;
  }
  settingValue = process.env[environmentVariableName];
  if (settingValue == null || typeof settingValue !== "string") {
    return void 0;
  }
  return settingValue;
}
var suspectProtoRx = /"__proto__"\s*:/;
var suspectConstructorRx = /"constructor"\s*:/;
function _parse(text2) {
  const obj = JSON.parse(text2);
  if (obj === null || typeof obj !== "object") {
    return obj;
  }
  if (suspectProtoRx.test(text2) === false && suspectConstructorRx.test(text2) === false) {
    return obj;
  }
  return filter(obj);
}
function filter(obj) {
  let next = [obj];
  while (next.length) {
    const nodes = next;
    next = [];
    for (const node of nodes) {
      if (Object.prototype.hasOwnProperty.call(node, "__proto__")) {
        throw new SyntaxError("Object contains forbidden prototype property");
      }
      if (Object.prototype.hasOwnProperty.call(node, "constructor") && Object.prototype.hasOwnProperty.call(node.constructor, "prototype")) {
        throw new SyntaxError("Object contains forbidden prototype property");
      }
      for (const key in node) {
        const value = node[key];
        if (value && typeof value === "object") {
          next.push(value);
        }
      }
    }
  }
  return obj;
}
function secureJsonParse(text2) {
  const { stackTraceLimit } = Error;
  Error.stackTraceLimit = 0;
  try {
    return _parse(text2);
  } finally {
    Error.stackTraceLimit = stackTraceLimit;
  }
}
var validatorSymbol = Symbol.for("vercel.ai.validator");
function validator(validate) {
  return { [validatorSymbol]: true, validate };
}
function isValidator(value) {
  return typeof value === "object" && value !== null && validatorSymbol in value && value[validatorSymbol] === true && "validate" in value;
}
function asValidator(value) {
  return isValidator(value) ? value : standardSchemaValidator(value);
}
function standardSchemaValidator(standardSchema) {
  return validator(async (value) => {
    const result = await standardSchema["~standard"].validate(value);
    return result.issues == null ? { success: true, value: result.value } : {
      success: false,
      error: new TypeValidationError({
        value,
        cause: result.issues
      })
    };
  });
}
async function validateTypes({
  value,
  schema
}) {
  const result = await safeValidateTypes({ value, schema });
  if (!result.success) {
    throw TypeValidationError.wrap({ value, cause: result.error });
  }
  return result.value;
}
async function safeValidateTypes({
  value,
  schema
}) {
  const validator22 = asValidator(schema);
  try {
    if (validator22.validate == null) {
      return { success: true, value, rawValue: value };
    }
    const result = await validator22.validate(value);
    if (result.success) {
      return { success: true, value: result.value, rawValue: value };
    }
    return {
      success: false,
      error: TypeValidationError.wrap({ value, cause: result.error }),
      rawValue: value
    };
  } catch (error) {
    return {
      success: false,
      error: TypeValidationError.wrap({ value, cause: error }),
      rawValue: value
    };
  }
}
async function parseJSON({
  text: text2,
  schema
}) {
  try {
    const value = secureJsonParse(text2);
    if (schema == null) {
      return value;
    }
    return validateTypes({ value, schema });
  } catch (error) {
    if (JSONParseError.isInstance(error) || TypeValidationError.isInstance(error)) {
      throw error;
    }
    throw new JSONParseError({ text: text2, cause: error });
  }
}
async function safeParseJSON({
  text: text2,
  schema
}) {
  try {
    const value = secureJsonParse(text2);
    if (schema == null) {
      return { success: true, value, rawValue: value };
    }
    return await safeValidateTypes({ value, schema });
  } catch (error) {
    return {
      success: false,
      error: JSONParseError.isInstance(error) ? error : new JSONParseError({ text: text2, cause: error }),
      rawValue: void 0
    };
  }
}
function parseJsonEventStream({
  stream,
  schema
}) {
  return stream.pipeThrough(new TextDecoderStream()).pipeThrough(new EventSourceParserStream()).pipeThrough(
    new TransformStream({
      async transform({ data }, controller) {
        if (data === "[DONE]") {
          return;
        }
        controller.enqueue(await safeParseJSON({ text: data, schema }));
      }
    })
  );
}
var getOriginalFetch2 = () => globalThis.fetch;
var postJsonToApi = async ({
  url,
  headers,
  body,
  failedResponseHandler,
  successfulResponseHandler,
  abortSignal,
  fetch: fetch2
}) => postToApi({
  url,
  headers: {
    "Content-Type": "application/json",
    ...headers
  },
  body: {
    content: JSON.stringify(body),
    values: body
  },
  failedResponseHandler,
  successfulResponseHandler,
  abortSignal,
  fetch: fetch2
});
var postToApi = async ({
  url,
  headers = {},
  body,
  successfulResponseHandler,
  failedResponseHandler,
  abortSignal,
  fetch: fetch2 = getOriginalFetch2()
}) => {
  try {
    const response = await fetch2(url, {
      method: "POST",
      headers: removeUndefinedEntries(headers),
      body: body.content,
      signal: abortSignal
    });
    const responseHeaders = extractResponseHeaders(response);
    if (!response.ok) {
      let errorInformation;
      try {
        errorInformation = await failedResponseHandler({
          response,
          url,
          requestBodyValues: body.values
        });
      } catch (error) {
        if (isAbortError(error) || APICallError.isInstance(error)) {
          throw error;
        }
        throw new APICallError({
          message: "Failed to process error response",
          cause: error,
          statusCode: response.status,
          url,
          responseHeaders,
          requestBodyValues: body.values
        });
      }
      throw errorInformation.value;
    }
    try {
      return await successfulResponseHandler({
        response,
        url,
        requestBodyValues: body.values
      });
    } catch (error) {
      if (error instanceof Error) {
        if (isAbortError(error) || APICallError.isInstance(error)) {
          throw error;
        }
      }
      throw new APICallError({
        message: "Failed to process successful response",
        cause: error,
        statusCode: response.status,
        url,
        responseHeaders,
        requestBodyValues: body.values
      });
    }
  } catch (error) {
    throw handleFetchError({ error, url, requestBodyValues: body.values });
  }
};
async function resolve(value) {
  if (typeof value === "function") {
    value = value();
  }
  return Promise.resolve(value);
}
var createJsonErrorResponseHandler = ({
  errorSchema,
  errorToMessage,
  isRetryable
}) => async ({ response, url, requestBodyValues }) => {
  const responseBody = await response.text();
  const responseHeaders = extractResponseHeaders(response);
  if (responseBody.trim() === "") {
    return {
      responseHeaders,
      value: new APICallError({
        message: response.statusText,
        url,
        requestBodyValues,
        statusCode: response.status,
        responseHeaders,
        responseBody,
        isRetryable: isRetryable == null ? void 0 : isRetryable(response)
      })
    };
  }
  try {
    const parsedError = await parseJSON({
      text: responseBody,
      schema: errorSchema
    });
    return {
      responseHeaders,
      value: new APICallError({
        message: errorToMessage(parsedError),
        url,
        requestBodyValues,
        statusCode: response.status,
        responseHeaders,
        responseBody,
        data: parsedError,
        isRetryable: isRetryable == null ? void 0 : isRetryable(response, parsedError)
      })
    };
  } catch (parseError) {
    return {
      responseHeaders,
      value: new APICallError({
        message: response.statusText,
        url,
        requestBodyValues,
        statusCode: response.status,
        responseHeaders,
        responseBody,
        isRetryable: isRetryable == null ? void 0 : isRetryable(response)
      })
    };
  }
};
var createEventSourceResponseHandler = (chunkSchema) => async ({ response }) => {
  const responseHeaders = extractResponseHeaders(response);
  if (response.body == null) {
    throw new EmptyResponseBodyError({});
  }
  return {
    responseHeaders,
    value: parseJsonEventStream({
      stream: response.body,
      schema: chunkSchema
    })
  };
};
var createJsonResponseHandler = (responseSchema) => async ({ response, url, requestBodyValues }) => {
  const responseBody = await response.text();
  const parsedResult = await safeParseJSON({
    text: responseBody,
    schema: responseSchema
  });
  const responseHeaders = extractResponseHeaders(response);
  if (!parsedResult.success) {
    throw new APICallError({
      message: "Invalid JSON response",
      cause: parsedResult.error,
      statusCode: response.status,
      responseHeaders,
      responseBody,
      url,
      requestBodyValues
    });
  }
  return {
    responseHeaders,
    value: parsedResult.value,
    rawValue: parsedResult.rawValue
  };
};
var schemaSymbol = Symbol.for("vercel.ai.schema");
var { btoa, atob } = globalThis;
function withoutTrailingSlash(url) {
  return url == null ? void 0 : url.replace(/\/$/, "");
}

// ../../node_modules/@ai-sdk/gateway/dist/index.mjs
import { z as z2 } from "zod/v4";
import { z } from "zod/v4";
import { z as z3 } from "zod/v4";
import { z as z42 } from "zod/v4";
import { z as z5 } from "zod/v4";
import { z as z6 } from "zod/v4";
var marker15 = "vercel.ai.gateway.error";
var symbol15 = Symbol.for(marker15);
var _a15;
var _b;
var GatewayError = class _GatewayError extends (_b = Error, _a15 = symbol15, _b) {
  constructor({
    message,
    statusCode = 500,
    cause
  }) {
    super(message);
    this[_a15] = true;
    this.statusCode = statusCode;
    this.cause = cause;
  }
  /**
   * Checks if the given error is a Gateway Error.
   * @param {unknown} error - The error to check.
   * @returns {boolean} True if the error is a Gateway Error, false otherwise.
   */
  static isInstance(error) {
    return _GatewayError.hasMarker(error);
  }
  static hasMarker(error) {
    return typeof error === "object" && error !== null && symbol15 in error && error[symbol15] === true;
  }
};
var name14 = "GatewayAuthenticationError";
var marker22 = `vercel.ai.gateway.error.${name14}`;
var symbol22 = Symbol.for(marker22);
var _a22;
var _b2;
var GatewayAuthenticationError = class _GatewayAuthenticationError extends (_b2 = GatewayError, _a22 = symbol22, _b2) {
  constructor({
    message = "Authentication failed",
    statusCode = 401,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a22] = true;
    this.name = name14;
    this.type = "authentication_error";
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol22 in error;
  }
  /**
   * Creates a contextual error message when authentication fails
   */
  static createContextualError({
    apiKeyProvided,
    oidcTokenProvided,
    message = "Authentication failed",
    statusCode = 401,
    cause
  }) {
    let contextualMessage;
    if (apiKeyProvided) {
      contextualMessage = `AI Gateway authentication failed: Invalid API key provided.

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`;
    } else if (oidcTokenProvided) {
      contextualMessage = `AI Gateway authentication failed: Invalid OIDC token provided.

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed

Alternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`;
    } else {
      contextualMessage = `AI Gateway authentication failed: No authentication provided.

Provide either an API key or OIDC token.

API key instructions:

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

OIDC token instructions:

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed`;
    }
    return new _GatewayAuthenticationError({
      message: contextualMessage,
      statusCode,
      cause
    });
  }
};
var name22 = "GatewayInvalidRequestError";
var marker32 = `vercel.ai.gateway.error.${name22}`;
var symbol32 = Symbol.for(marker32);
var _a32;
var _b3;
var GatewayInvalidRequestError = class extends (_b3 = GatewayError, _a32 = symbol32, _b3) {
  constructor({
    message = "Invalid request",
    statusCode = 400,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a32] = true;
    this.name = name22;
    this.type = "invalid_request_error";
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol32 in error;
  }
};
var name32 = "GatewayRateLimitError";
var marker42 = `vercel.ai.gateway.error.${name32}`;
var symbol42 = Symbol.for(marker42);
var _a42;
var _b4;
var GatewayRateLimitError = class extends (_b4 = GatewayError, _a42 = symbol42, _b4) {
  constructor({
    message = "Rate limit exceeded",
    statusCode = 429,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a42] = true;
    this.name = name32;
    this.type = "rate_limit_exceeded";
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol42 in error;
  }
};
var name42 = "GatewayModelNotFoundError";
var marker52 = `vercel.ai.gateway.error.${name42}`;
var symbol52 = Symbol.for(marker52);
var modelNotFoundParamSchema = z.object({
  modelId: z.string()
});
var _a52;
var _b5;
var GatewayModelNotFoundError = class extends (_b5 = GatewayError, _a52 = symbol52, _b5) {
  constructor({
    message = "Model not found",
    statusCode = 404,
    modelId,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a52] = true;
    this.name = name42;
    this.type = "model_not_found";
    this.modelId = modelId;
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol52 in error;
  }
};
var name52 = "GatewayInternalServerError";
var marker62 = `vercel.ai.gateway.error.${name52}`;
var symbol62 = Symbol.for(marker62);
var _a62;
var _b6;
var GatewayInternalServerError = class extends (_b6 = GatewayError, _a62 = symbol62, _b6) {
  constructor({
    message = "Internal server error",
    statusCode = 500,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a62] = true;
    this.name = name52;
    this.type = "internal_server_error";
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol62 in error;
  }
};
var name62 = "GatewayResponseError";
var marker72 = `vercel.ai.gateway.error.${name62}`;
var symbol72 = Symbol.for(marker72);
var _a72;
var _b7;
var GatewayResponseError = class extends (_b7 = GatewayError, _a72 = symbol72, _b7) {
  constructor({
    message = "Invalid response from Gateway",
    statusCode = 502,
    response,
    validationError,
    cause
  } = {}) {
    super({ message, statusCode, cause });
    this[_a72] = true;
    this.name = name62;
    this.type = "response_error";
    this.response = response;
    this.validationError = validationError;
  }
  static isInstance(error) {
    return GatewayError.hasMarker(error) && symbol72 in error;
  }
};
function createGatewayErrorFromResponse({
  response,
  statusCode,
  defaultMessage = "Gateway request failed",
  cause,
  authMethod
}) {
  const parseResult = gatewayErrorResponseSchema.safeParse(response);
  if (!parseResult.success) {
    return new GatewayResponseError({
      message: `Invalid error response format: ${defaultMessage}`,
      statusCode,
      response,
      validationError: parseResult.error,
      cause
    });
  }
  const validatedResponse = parseResult.data;
  const errorType = validatedResponse.error.type;
  const message = validatedResponse.error.message;
  switch (errorType) {
    case "authentication_error":
      return GatewayAuthenticationError.createContextualError({
        apiKeyProvided: authMethod === "api-key",
        oidcTokenProvided: authMethod === "oidc",
        statusCode,
        cause
      });
    case "invalid_request_error":
      return new GatewayInvalidRequestError({ message, statusCode, cause });
    case "rate_limit_exceeded":
      return new GatewayRateLimitError({ message, statusCode, cause });
    case "model_not_found": {
      const modelResult = modelNotFoundParamSchema.safeParse(
        validatedResponse.error.param
      );
      return new GatewayModelNotFoundError({
        message,
        statusCode,
        modelId: modelResult.success ? modelResult.data.modelId : void 0,
        cause
      });
    }
    case "internal_server_error":
      return new GatewayInternalServerError({ message, statusCode, cause });
    default:
      return new GatewayInternalServerError({ message, statusCode, cause });
  }
}
var gatewayErrorResponseSchema = z2.object({
  error: z2.object({
    message: z2.string(),
    type: z2.string().nullish(),
    param: z2.unknown().nullish(),
    code: z2.union([z2.string(), z2.number()]).nullish()
  })
});
function asGatewayError(error, authMethod) {
  var _a84;
  if (GatewayError.isInstance(error)) {
    return error;
  }
  if (APICallError.isInstance(error)) {
    return createGatewayErrorFromResponse({
      response: extractApiCallResponse(error),
      statusCode: (_a84 = error.statusCode) != null ? _a84 : 500,
      defaultMessage: "Gateway request failed",
      cause: error,
      authMethod
    });
  }
  return createGatewayErrorFromResponse({
    response: {},
    statusCode: 500,
    defaultMessage: error instanceof Error ? `Gateway request failed: ${error.message}` : "Unknown Gateway error",
    cause: error,
    authMethod
  });
}
function extractApiCallResponse(error) {
  if (error.data !== void 0) {
    return error.data;
  }
  if (error.responseBody != null) {
    try {
      return JSON.parse(error.responseBody);
    } catch (e) {
      return error.responseBody;
    }
  }
  return {};
}
var GATEWAY_AUTH_METHOD_HEADER = "ai-gateway-auth-method";
function parseAuthMethod(headers) {
  const result = gatewayAuthMethodSchema.safeParse(
    headers[GATEWAY_AUTH_METHOD_HEADER]
  );
  return result.success ? result.data : void 0;
}
var gatewayAuthMethodSchema = z3.union([
  z3.literal("api-key"),
  z3.literal("oidc")
]);
var GatewayFetchMetadata = class {
  constructor(config) {
    this.config = config;
  }
  async getAvailableModels() {
    try {
      const { value } = await getFromApi({
        url: `${this.config.baseURL}/config`,
        headers: await resolve(this.config.headers()),
        successfulResponseHandler: createJsonResponseHandler(
          gatewayFetchMetadataSchema
        ),
        failedResponseHandler: createJsonErrorResponseHandler({
          errorSchema: z42.any(),
          errorToMessage: (data) => data
        }),
        fetch: this.config.fetch
      });
      return value;
    } catch (error) {
      throw asGatewayError(error);
    }
  }
};
var gatewayLanguageModelSpecificationSchema = z42.object({
  specificationVersion: z42.literal("v2"),
  provider: z42.string(),
  modelId: z42.string()
});
var gatewayLanguageModelPricingSchema = z42.object({
  input: z42.string(),
  output: z42.string()
});
var gatewayLanguageModelEntrySchema = z42.object({
  id: z42.string(),
  name: z42.string(),
  description: z42.string().nullish(),
  pricing: gatewayLanguageModelPricingSchema.nullish(),
  specification: gatewayLanguageModelSpecificationSchema
});
var gatewayFetchMetadataSchema = z42.object({
  models: z42.array(gatewayLanguageModelEntrySchema)
});
var GatewayLanguageModel = class {
  constructor(modelId, config) {
    this.modelId = modelId;
    this.config = config;
    this.specificationVersion = "v2";
    this.supportedUrls = { "*/*": [/.*/] };
  }
  get provider() {
    return this.config.provider;
  }
  async getArgs(options) {
    const { abortSignal: _abortSignal, ...optionsWithoutSignal } = options;
    return {
      args: this.maybeEncodeFileParts(optionsWithoutSignal),
      warnings: []
    };
  }
  async doGenerate(options) {
    const { args, warnings } = await this.getArgs(options);
    const { abortSignal } = options;
    const resolvedHeaders = await resolve(this.config.headers());
    try {
      const {
        responseHeaders,
        value: responseBody,
        rawValue: rawResponse
      } = await postJsonToApi({
        url: this.getUrl(),
        headers: combineHeaders(
          resolvedHeaders,
          options.headers,
          this.getModelConfigHeaders(this.modelId, false),
          await resolve(this.config.o11yHeaders)
        ),
        body: args,
        successfulResponseHandler: createJsonResponseHandler(z5.any()),
        failedResponseHandler: createJsonErrorResponseHandler({
          errorSchema: z5.any(),
          errorToMessage: (data) => data
        }),
        ...abortSignal && { abortSignal },
        fetch: this.config.fetch
      });
      return {
        ...responseBody,
        request: { body: args },
        response: { headers: responseHeaders, body: rawResponse },
        warnings
      };
    } catch (error) {
      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));
    }
  }
  async doStream(options) {
    const { args, warnings } = await this.getArgs(options);
    const { abortSignal } = options;
    const resolvedHeaders = await resolve(this.config.headers());
    try {
      const { value: response, responseHeaders } = await postJsonToApi({
        url: this.getUrl(),
        headers: combineHeaders(
          resolvedHeaders,
          options.headers,
          this.getModelConfigHeaders(this.modelId, true),
          await resolve(this.config.o11yHeaders)
        ),
        body: args,
        successfulResponseHandler: createEventSourceResponseHandler(z5.any()),
        failedResponseHandler: createJsonErrorResponseHandler({
          errorSchema: z5.any(),
          errorToMessage: (data) => data
        }),
        ...abortSignal && { abortSignal },
        fetch: this.config.fetch
      });
      return {
        stream: response.pipeThrough(
          new TransformStream({
            start(controller) {
              if (warnings.length > 0) {
                controller.enqueue({ type: "stream-start", warnings });
              }
            },
            transform(chunk, controller) {
              if (chunk.success) {
                const streamPart = chunk.value;
                if (streamPart.type === "raw" && !options.includeRawChunks) {
                  return;
                }
                if (streamPart.type === "response-metadata" && streamPart.timestamp && typeof streamPart.timestamp === "string") {
                  streamPart.timestamp = new Date(streamPart.timestamp);
                }
                controller.enqueue(streamPart);
              } else {
                controller.error(
                  chunk.error
                );
              }
            }
          })
        ),
        request: { body: args },
        response: { headers: responseHeaders }
      };
    } catch (error) {
      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));
    }
  }
  isFilePart(part) {
    return part && typeof part === "object" && "type" in part && part.type === "file";
  }
  /**
   * Encodes file parts in the prompt to base64. Mutates the passed options
   * instance directly to avoid copying the file data.
   * @param options - The options to encode.
   * @returns The options with the file parts encoded.
   */
  maybeEncodeFileParts(options) {
    for (const message of options.prompt) {
      for (const part of message.content) {
        if (this.isFilePart(part)) {
          const filePart = part;
          if (filePart.data instanceof Uint8Array) {
            const buffer = Uint8Array.from(filePart.data);
            const base64Data = Buffer.from(buffer).toString("base64");
            filePart.data = new URL(
              `data:${filePart.mediaType || "application/octet-stream"};base64,${base64Data}`
            );
          }
        }
      }
    }
    return options;
  }
  getUrl() {
    return `${this.config.baseURL}/language-model`;
  }
  getModelConfigHeaders(modelId, streaming) {
    return {
      "ai-language-model-specification-version": "2",
      "ai-language-model-id": modelId,
      "ai-language-model-streaming": String(streaming)
    };
  }
};
var GatewayEmbeddingModel = class {
  constructor(modelId, config) {
    this.modelId = modelId;
    this.config = config;
    this.specificationVersion = "v2";
    this.maxEmbeddingsPerCall = 2048;
    this.supportsParallelCalls = true;
  }
  get provider() {
    return this.config.provider;
  }
  async doEmbed({
    values,
    headers,
    abortSignal,
    providerOptions
  }) {
    var _a84;
    const resolvedHeaders = await resolve(this.config.headers());
    try {
      const {
        responseHeaders,
        value: responseBody,
        rawValue
      } = await postJsonToApi({
        url: this.getUrl(),
        headers: combineHeaders(
          resolvedHeaders,
          headers != null ? headers : {},
          this.getModelConfigHeaders(),
          await resolve(this.config.o11yHeaders)
        ),
        body: {
          input: values.length === 1 ? values[0] : values,
          ...providerOptions != null ? providerOptions : {}
        },
        successfulResponseHandler: createJsonResponseHandler(
          gatewayEmbeddingResponseSchema
        ),
        failedResponseHandler: createJsonErrorResponseHandler({
          errorSchema: z6.any(),
          errorToMessage: (data) => data
        }),
        ...abortSignal && { abortSignal },
        fetch: this.config.fetch
      });
      return {
        embeddings: responseBody.embeddings,
        usage: (_a84 = responseBody.usage) != null ? _a84 : void 0,
        providerMetadata: responseBody.providerMetadata,
        response: { headers: responseHeaders, body: rawValue }
      };
    } catch (error) {
      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));
    }
  }
  getUrl() {
    return `${this.config.baseURL}/embedding-model`;
  }
  getModelConfigHeaders() {
    return {
      "ai-embedding-model-specification-version": "2",
      "ai-model-id": this.modelId
    };
  }
};
var gatewayEmbeddingResponseSchema = z6.object({
  embeddings: z6.array(z6.array(z6.number())),
  usage: z6.object({ tokens: z6.number() }).nullish(),
  providerMetadata: z6.record(z6.string(), z6.record(z6.string(), z6.unknown())).optional()
});
async function getVercelOidcToken() {
  var _a84, _b8;
  const token = (_b8 = (_a84 = getContext().headers) == null ? void 0 : _a84["x-vercel-oidc-token"]) != null ? _b8 : process.env.VERCEL_OIDC_TOKEN;
  if (!token) {
    throw new GatewayAuthenticationError({
      message: "OIDC token not available",
      statusCode: 401
    });
  }
  return token;
}
async function getVercelRequestId() {
  var _a84;
  return (_a84 = getContext().headers) == null ? void 0 : _a84["x-vercel-id"];
}
var SYMBOL_FOR_REQ_CONTEXT = Symbol.for("@vercel/request-context");
function getContext() {
  var _a84, _b8, _c;
  const fromSymbol = globalThis;
  return (_c = (_b8 = (_a84 = fromSymbol[SYMBOL_FOR_REQ_CONTEXT]) == null ? void 0 : _a84.get) == null ? void 0 : _b8.call(_a84)) != null ? _c : {};
}
var AI_GATEWAY_PROTOCOL_VERSION = "0.0.1";
function createGatewayProvider(options = {}) {
  var _a84, _b8;
  let pendingMetadata = null;
  let metadataCache = null;
  const cacheRefreshMillis = (_a84 = options.metadataCacheRefreshMillis) != null ? _a84 : 1e3 * 60 * 5;
  let lastFetchTime = 0;
  const baseURL = (_b8 = withoutTrailingSlash(options.baseURL)) != null ? _b8 : "https://ai-gateway.vercel.sh/v1/ai";
  const getHeaders = async () => {
    const auth = await getGatewayAuthToken(options);
    if (auth) {
      return {
        Authorization: `Bearer ${auth.token}`,
        "ai-gateway-protocol-version": AI_GATEWAY_PROTOCOL_VERSION,
        [GATEWAY_AUTH_METHOD_HEADER]: auth.authMethod,
        ...options.headers
      };
    }
    throw GatewayAuthenticationError.createContextualError({
      apiKeyProvided: false,
      oidcTokenProvided: false,
      statusCode: 401
    });
  };
  const createO11yHeaders = () => {
    const deploymentId = loadOptionalSetting({
      settingValue: void 0,
      environmentVariableName: "VERCEL_DEPLOYMENT_ID"
    });
    const environment = loadOptionalSetting({
      settingValue: void 0,
      environmentVariableName: "VERCEL_ENV"
    });
    const region = loadOptionalSetting({
      settingValue: void 0,
      environmentVariableName: "VERCEL_REGION"
    });
    return async () => {
      const requestId = await getVercelRequestId();
      return {
        ...deploymentId && { "ai-o11y-deployment-id": deploymentId },
        ...environment && { "ai-o11y-environment": environment },
        ...region && { "ai-o11y-region": region },
        ...requestId && { "ai-o11y-request-id": requestId }
      };
    };
  };
  const createLanguageModel = (modelId) => {
    return new GatewayLanguageModel(modelId, {
      provider: "gateway",
      baseURL,
      headers: getHeaders,
      fetch: options.fetch,
      o11yHeaders: createO11yHeaders()
    });
  };
  const getAvailableModels = async () => {
    var _a94, _b9, _c;
    const now = (_c = (_b9 = (_a94 = options._internal) == null ? void 0 : _a94.currentDate) == null ? void 0 : _b9.call(_a94).getTime()) != null ? _c : Date.now();
    if (!pendingMetadata || now - lastFetchTime > cacheRefreshMillis) {
      lastFetchTime = now;
      pendingMetadata = new GatewayFetchMetadata({
        baseURL,
        headers: getHeaders,
        fetch: options.fetch
      }).getAvailableModels().then((metadata) => {
        metadataCache = metadata;
        return metadata;
      }).catch(async (error) => {
        throw asGatewayError(error, parseAuthMethod(await getHeaders()));
      });
    }
    return metadataCache ? Promise.resolve(metadataCache) : pendingMetadata;
  };
  const provider = function(modelId) {
    if (new.target) {
      throw new Error(
        "The Gateway Provider model function cannot be called with the new keyword."
      );
    }
    return createLanguageModel(modelId);
  };
  provider.getAvailableModels = getAvailableModels;
  provider.imageModel = (modelId) => {
    throw new NoSuchModelError({ modelId, modelType: "imageModel" });
  };
  provider.languageModel = createLanguageModel;
  provider.textEmbeddingModel = (modelId) => {
    return new GatewayEmbeddingModel(modelId, {
      provider: "gateway",
      baseURL,
      headers: getHeaders,
      fetch: options.fetch,
      o11yHeaders: createO11yHeaders()
    });
  };
  return provider;
}
var gateway = createGatewayProvider();
async function getGatewayAuthToken(options) {
  const apiKey = loadOptionalSetting({
    settingValue: options.apiKey,
    environmentVariableName: "AI_GATEWAY_API_KEY"
  });
  if (apiKey) {
    return {
      token: apiKey,
      authMethod: "api-key"
    };
  }
  try {
    const oidcToken = await getVercelOidcToken();
    return {
      token: oidcToken,
      authMethod: "oidc"
    };
  } catch (e) {
    return null;
  }
}

// ../../node_modules/ai/node_modules/@ai-sdk/provider/dist/index.mjs
var marker16 = "vercel.ai.error";
var symbol16 = Symbol.for(marker16);
var _a16;
var _AISDKError3 = class _AISDKError4 extends Error {
  /**
   * Creates an AI SDK Error.
   *
   * @param {Object} params - The parameters for creating the error.
   * @param {string} params.name - The name of the error.
   * @param {string} params.message - The error message.
   * @param {unknown} [params.cause] - The underlying cause of the error.
   */
  constructor({
    name: name143,
    message,
    cause
  }) {
    super(message);
    this[_a16] = true;
    this.name = name143;
    this.cause = cause;
  }
  /**
   * Checks if the given error is an AI SDK Error.
   * @param {unknown} error - The error to check.
   * @returns {boolean} True if the error is an AI SDK Error, false otherwise.
   */
  static isInstance(error) {
    return _AISDKError4.hasMarker(error, marker16);
  }
  static hasMarker(error, marker153) {
    const markerSymbol = Symbol.for(marker153);
    return error != null && typeof error === "object" && markerSymbol in error && typeof error[markerSymbol] === "boolean" && error[markerSymbol] === true;
  }
};
_a16 = symbol16;
var AISDKError2 = _AISDKError3;
var name15 = "AI_APICallError";
var marker23 = `vercel.ai.error.${name15}`;
var symbol23 = Symbol.for(marker23);
var _a23;
_a23 = symbol23;
var name23 = "AI_EmptyResponseBodyError";
var marker33 = `vercel.ai.error.${name23}`;
var symbol33 = Symbol.for(marker33);
var _a33;
_a33 = symbol33;
function getErrorMessage2(error) {
  if (error == null) {
    return "unknown error";
  }
  if (typeof error === "string") {
    return error;
  }
  if (error instanceof Error) {
    return error.message;
  }
  return JSON.stringify(error);
}
var name33 = "AI_InvalidArgumentError";
var marker43 = `vercel.ai.error.${name33}`;
var symbol43 = Symbol.for(marker43);
var _a43;
var InvalidArgumentError2 = class extends AISDKError2 {
  constructor({
    message,
    cause,
    argument
  }) {
    super({ name: name33, message, cause });
    this[_a43] = true;
    this.argument = argument;
  }
  static isInstance(error) {
    return AISDKError2.hasMarker(error, marker43);
  }
};
_a43 = symbol43;
var name43 = "AI_InvalidPromptError";
var marker53 = `vercel.ai.error.${name43}`;
var symbol53 = Symbol.for(marker53);
var _a53;
_a53 = symbol53;
var name53 = "AI_InvalidResponseDataError";
var marker63 = `vercel.ai.error.${name53}`;
var symbol63 = Symbol.for(marker63);
var _a63;
_a63 = symbol63;
var name63 = "AI_JSONParseError";
var marker73 = `vercel.ai.error.${name63}`;
var symbol73 = Symbol.for(marker73);
var _a73;
var JSONParseError2 = class extends AISDKError2 {
  constructor({ text: text2, cause }) {
    super({
      name: name63,
      message: `JSON parsing failed: Text: ${text2}.
Error message: ${getErrorMessage2(cause)}`,
      cause
    });
    this[_a73] = true;
    this.text = text2;
  }
  static isInstance(error) {
    return AISDKError2.hasMarker(error, marker73);
  }
};
_a73 = symbol73;
var name72 = "AI_LoadAPIKeyError";
var marker82 = `vercel.ai.error.${name72}`;
var symbol82 = Symbol.for(marker82);
var _a82;
_a82 = symbol82;
var name82 = "AI_LoadSettingError";
var marker92 = `vercel.ai.error.${name82}`;
var symbol92 = Symbol.for(marker92);
var _a92;
_a92 = symbol92;
var name92 = "AI_NoContentGeneratedError";
var marker102 = `vercel.ai.error.${name92}`;
var symbol102 = Symbol.for(marker102);
var _a102;
_a102 = symbol102;
var name102 = "AI_NoSuchModelError";
var marker112 = `vercel.ai.error.${name102}`;
var symbol112 = Symbol.for(marker112);
var _a112;
_a112 = symbol112;
var name112 = "AI_TooManyEmbeddingValuesForCallError";
var marker122 = `vercel.ai.error.${name112}`;
var symbol122 = Symbol.for(marker122);
var _a122;
_a122 = symbol122;
var name122 = "AI_TypeValidationError";
var marker132 = `vercel.ai.error.${name122}`;
var symbol132 = Symbol.for(marker132);
var _a132;
var _TypeValidationError3 = class _TypeValidationError4 extends AISDKError2 {
  constructor({ value, cause }) {
    super({
      name: name122,
      message: `Type validation failed: Value: ${JSON.stringify(value)}.
Error message: ${getErrorMessage2(cause)}`,
      cause
    });
    this[_a132] = true;
    this.value = value;
  }
  static isInstance(error) {
    return AISDKError2.hasMarker(error, marker132);
  }
  /**
   * Wraps an error into a TypeValidationError.
   * If the cause is already a TypeValidationError with the same value, it returns the cause.
   * Otherwise, it creates a new TypeValidationError.
   *
   * @param {Object} params - The parameters for wrapping the error.
   * @param {unknown} params.value - The value that failed validation.
   * @param {unknown} params.cause - The original error or cause of the validation failure.
   * @returns {TypeValidationError} A TypeValidationError instance.
   */
  static wrap({
    value,
    cause
  }) {
    return _TypeValidationError4.isInstance(cause) && cause.value === value ? cause : new _TypeValidationError4({ value, cause });
  }
};
_a132 = symbol132;
var TypeValidationError2 = _TypeValidationError3;
var name132 = "AI_UnsupportedFunctionalityError";
var marker142 = `vercel.ai.error.${name132}`;
var symbol142 = Symbol.for(marker142);
var _a142;
_a142 = symbol142;

// ../../node_modules/ai/node_modules/@ai-sdk/provider-utils/dist/index.mjs
import * as z43 from "zod/v4";
var createIdGenerator2 = ({
  prefix,
  size = 16,
  alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",
  separator = "-"
} = {}) => {
  const generator = () => {
    const alphabetLength = alphabet.length;
    const chars = new Array(size);
    for (let i = 0; i < size; i++) {
      chars[i] = alphabet[Math.random() * alphabetLength | 0];
    }
    return chars.join("");
  };
  if (prefix == null) {
    return generator;
  }
  if (alphabet.includes(separator)) {
    throw new InvalidArgumentError2({
      argument: "separator",
      message: `The separator "${separator}" must not be part of the alphabet "${alphabet}".`
    });
  }
  return () => `${prefix}${separator}${generator()}`;
};
var generateId2 = createIdGenerator2();
var suspectProtoRx2 = /"__proto__"\s*:/;
var suspectConstructorRx2 = /"constructor"\s*:/;
function _parse2(text2) {
  const obj = JSON.parse(text2);
  if (obj === null || typeof obj !== "object") {
    return obj;
  }
  if (suspectProtoRx2.test(text2) === false && suspectConstructorRx2.test(text2) === false) {
    return obj;
  }
  return filter2(obj);
}
function filter2(obj) {
  let next = [obj];
  while (next.length) {
    const nodes = next;
    next = [];
    for (const node of nodes) {
      if (Object.prototype.hasOwnProperty.call(node, "__proto__")) {
        throw new SyntaxError("Object contains forbidden prototype property");
      }
      if (Object.prototype.hasOwnProperty.call(node, "constructor") && Object.prototype.hasOwnProperty.call(node.constructor, "prototype")) {
        throw new SyntaxError("Object contains forbidden prototype property");
      }
      for (const key in node) {
        const value = node[key];
        if (value && typeof value === "object") {
          next.push(value);
        }
      }
    }
  }
  return obj;
}
function secureJsonParse2(text2) {
  const { stackTraceLimit } = Error;
  Error.stackTraceLimit = 0;
  try {
    return _parse2(text2);
  } finally {
    Error.stackTraceLimit = stackTraceLimit;
  }
}
var validatorSymbol2 = Symbol.for("vercel.ai.validator");
function validator2(validate) {
  return { [validatorSymbol2]: true, validate };
}
function isValidator2(value) {
  return typeof value === "object" && value !== null && validatorSymbol2 in value && value[validatorSymbol2] === true && "validate" in value;
}
function asValidator2(value) {
  return isValidator2(value) ? value : standardSchemaValidator2(value);
}
function standardSchemaValidator2(standardSchema) {
  return validator2(async (value) => {
    const result = await standardSchema["~standard"].validate(value);
    return result.issues == null ? { success: true, value: result.value } : {
      success: false,
      error: new TypeValidationError2({
        value,
        cause: result.issues
      })
    };
  });
}
async function safeValidateTypes2({
  value,
  schema
}) {
  const validator22 = asValidator2(schema);
  try {
    if (validator22.validate == null) {
      return { success: true, value, rawValue: value };
    }
    const result = await validator22.validate(value);
    if (result.success) {
      return { success: true, value: result.value, rawValue: value };
    }
    return {
      success: false,
      error: TypeValidationError2.wrap({ value, cause: result.error }),
      rawValue: value
    };
  } catch (error) {
    return {
      success: false,
      error: TypeValidationError2.wrap({ value, cause: error }),
      rawValue: value
    };
  }
}
async function safeParseJSON2({
  text: text2,
  schema
}) {
  try {
    const value = secureJsonParse2(text2);
    if (schema == null) {
      return { success: true, value, rawValue: value };
    }
    return await safeValidateTypes2({ value, schema });
  } catch (error) {
    return {
      success: false,
      error: JSONParseError2.isInstance(error) ? error : new JSONParseError2({ text: text2, cause: error }),
      rawValue: void 0
    };
  }
}
function zod3Schema(zodSchema2, options) {
  var _a18;
  const useReferences = (_a18 = options == null ? void 0 : options.useReferences) != null ? _a18 : false;
  return jsonSchema(
    esm_default(zodSchema2, {
      $refStrategy: useReferences ? "root" : "none",
      target: "jsonSchema7"
      // note: openai mode breaks various gemini conversions
    }),
    {
      validate: async (value) => {
        const result = await zodSchema2.safeParseAsync(value);
        return result.success ? { success: true, value: result.data } : { success: false, error: result.error };
      }
    }
  );
}
function zod4Schema(zodSchema2, options) {
  var _a18;
  const useReferences = (_a18 = options == null ? void 0 : options.useReferences) != null ? _a18 : false;
  const z4JSONSchema = z43.toJSONSchema(zodSchema2, {
    target: "draft-7",
    io: "output",
    reused: useReferences ? "ref" : "inline"
  });
  return jsonSchema(z4JSONSchema, {
    validate: async (value) => {
      const result = await z43.safeParseAsync(zodSchema2, value);
      return result.success ? { success: true, value: result.data } : { success: false, error: result.error };
    }
  });
}
function isZod4Schema(zodSchema2) {
  return "_zod" in zodSchema2;
}
function zodSchema(zodSchema2, options) {
  if (isZod4Schema(zodSchema2)) {
    return zod4Schema(zodSchema2, options);
  } else {
    return zod3Schema(zodSchema2, options);
  }
}
var schemaSymbol2 = Symbol.for("vercel.ai.schema");
function jsonSchema(jsonSchema2, {
  validate
} = {}) {
  return {
    [schemaSymbol2]: true,
    _type: void 0,
    // should never be used directly
    [validatorSymbol2]: true,
    jsonSchema: jsonSchema2,
    validate
  };
}
function isSchema(value) {
  return typeof value === "object" && value !== null && schemaSymbol2 in value && value[schemaSymbol2] === true && "jsonSchema" in value && "validate" in value;
}
function asSchema(schema) {
  return schema == null ? jsonSchema({
    properties: {},
    additionalProperties: false
  }) : isSchema(schema) ? schema : zodSchema(schema);
}
var { btoa: btoa2, atob: atob2 } = globalThis;

// ../../node_modules/ai/dist/index.mjs
import { z as z7 } from "zod/v4";
import { z as z62 } from "zod/v4";
import { z as z52 } from "zod/v4";
import { z as z32 } from "zod/v4";
import { z as z22 } from "zod/v4";
import { z as z44 } from "zod/v4";
import { z as z72 } from "zod/v4";
import { z as z9 } from "zod/v4";
import { z as z8 } from "zod/v4";
import { z as z10 } from "zod/v4";
var __defProp = Object.defineProperty;
var __export = (target, all) => {
  for (var name17 in all)
    __defProp(target, name17, { get: all[name17], enumerable: true });
};
var name16 = "AI_NoOutputSpecifiedError";
var marker17 = `vercel.ai.error.${name16}`;
var symbol17 = Symbol.for(marker17);
var _a17;
_a17 = symbol17;
var name24 = "AI_InvalidArgumentError";
var marker24 = `vercel.ai.error.${name24}`;
var symbol24 = Symbol.for(marker24);
var _a24;
_a24 = symbol24;
var name34 = "AI_InvalidStreamPartError";
var marker34 = `vercel.ai.error.${name34}`;
var symbol34 = Symbol.for(marker34);
var _a34;
_a34 = symbol34;
var name44 = "AI_InvalidToolInputError";
var marker44 = `vercel.ai.error.${name44}`;
var symbol44 = Symbol.for(marker44);
var _a44;
_a44 = symbol44;
var name54 = "AI_MCPClientError";
var marker54 = `vercel.ai.error.${name54}`;
var symbol54 = Symbol.for(marker54);
var _a54;
_a54 = symbol54;
var name64 = "AI_NoImageGeneratedError";
var marker64 = `vercel.ai.error.${name64}`;
var symbol64 = Symbol.for(marker64);
var _a64;
_a64 = symbol64;
var name73 = "AI_NoObjectGeneratedError";
var marker74 = `vercel.ai.error.${name73}`;
var symbol74 = Symbol.for(marker74);
var _a74;
var NoObjectGeneratedError = class extends AISDKError2 {
  constructor({
    message = "No object generated.",
    cause,
    text: text2,
    response,
    usage,
    finishReason
  }) {
    super({ name: name73, message, cause });
    this[_a74] = true;
    this.text = text2;
    this.response = response;
    this.usage = usage;
    this.finishReason = finishReason;
  }
  static isInstance(error) {
    return AISDKError2.hasMarker(error, marker74);
  }
};
_a74 = symbol74;
var name83 = "AI_NoOutputGeneratedError";
var marker83 = `vercel.ai.error.${name83}`;
var symbol83 = Symbol.for(marker83);
var _a83;
_a83 = symbol83;
var name93 = "AI_NoSuchToolError";
var marker93 = `vercel.ai.error.${name93}`;
var symbol93 = Symbol.for(marker93);
var _a93;
_a93 = symbol93;
var name103 = "AI_ToolCallRepairError";
var marker103 = `vercel.ai.error.${name103}`;
var symbol103 = Symbol.for(marker103);
var _a103;
_a103 = symbol103;
var name113 = "AI_InvalidDataContentError";
var marker113 = `vercel.ai.error.${name113}`;
var symbol113 = Symbol.for(marker113);
var _a113;
_a113 = symbol113;
var name123 = "AI_InvalidMessageRoleError";
var marker123 = `vercel.ai.error.${name123}`;
var symbol123 = Symbol.for(marker123);
var _a123;
_a123 = symbol123;
var name133 = "AI_MessageConversionError";
var marker133 = `vercel.ai.error.${name133}`;
var symbol133 = Symbol.for(marker133);
var _a133;
_a133 = symbol133;
var name142 = "AI_DownloadError";
var marker143 = `vercel.ai.error.${name142}`;
var symbol143 = Symbol.for(marker143);
var _a143;
_a143 = symbol143;
var name152 = "AI_RetryError";
var marker152 = `vercel.ai.error.${name152}`;
var symbol152 = Symbol.for(marker152);
var _a152;
_a152 = symbol152;
var dataContentSchema = z7.union([
  z7.string(),
  z7.instanceof(Uint8Array),
  z7.instanceof(ArrayBuffer),
  z7.custom(
    // Buffer might not be available in some environments such as CloudFlare:
    (value) => {
      var _a172, _b8;
      return (_b8 = (_a172 = globalThis.Buffer) == null ? void 0 : _a172.isBuffer(value)) != null ? _b8 : false;
    },
    { message: "Must be a Buffer" }
  )
]);
var jsonValueSchema = z22.lazy(
  () => z22.union([
    z22.null(),
    z22.string(),
    z22.number(),
    z22.boolean(),
    z22.record(z22.string(), jsonValueSchema),
    z22.array(jsonValueSchema)
  ])
);
var providerMetadataSchema = z32.record(
  z32.string(),
  z32.record(z32.string(), jsonValueSchema)
);
var textPartSchema = z44.object({
  type: z44.literal("text"),
  text: z44.string(),
  providerOptions: providerMetadataSchema.optional()
});
var imagePartSchema = z44.object({
  type: z44.literal("image"),
  image: z44.union([dataContentSchema, z44.instanceof(URL)]),
  mediaType: z44.string().optional(),
  providerOptions: providerMetadataSchema.optional()
});
var filePartSchema = z44.object({
  type: z44.literal("file"),
  data: z44.union([dataContentSchema, z44.instanceof(URL)]),
  filename: z44.string().optional(),
  mediaType: z44.string(),
  providerOptions: providerMetadataSchema.optional()
});
var reasoningPartSchema = z44.object({
  type: z44.literal("reasoning"),
  text: z44.string(),
  providerOptions: providerMetadataSchema.optional()
});
var toolCallPartSchema = z44.object({
  type: z44.literal("tool-call"),
  toolCallId: z44.string(),
  toolName: z44.string(),
  input: z44.unknown(),
  providerOptions: providerMetadataSchema.optional(),
  providerExecuted: z44.boolean().optional()
});
var outputSchema = z44.discriminatedUnion("type", [
  z44.object({
    type: z44.literal("text"),
    value: z44.string()
  }),
  z44.object({
    type: z44.literal("json"),
    value: jsonValueSchema
  }),
  z44.object({
    type: z44.literal("error-text"),
    value: z44.string()
  }),
  z44.object({
    type: z44.literal("error-json"),
    value: jsonValueSchema
  }),
  z44.object({
    type: z44.literal("content"),
    value: z44.array(
      z44.union([
        z44.object({
          type: z44.literal("text"),
          text: z44.string()
        }),
        z44.object({
          type: z44.literal("media"),
          data: z44.string(),
          mediaType: z44.string()
        })
      ])
    )
  })
]);
var toolResultPartSchema = z44.object({
  type: z44.literal("tool-result"),
  toolCallId: z44.string(),
  toolName: z44.string(),
  output: outputSchema,
  providerOptions: providerMetadataSchema.optional()
});
var systemModelMessageSchema = z52.object(
  {
    role: z52.literal("system"),
    content: z52.string(),
    providerOptions: providerMetadataSchema.optional()
  }
);
var userModelMessageSchema = z52.object({
  role: z52.literal("user"),
  content: z52.union([
    z52.string(),
    z52.array(z52.union([textPartSchema, imagePartSchema, filePartSchema]))
  ]),
  providerOptions: providerMetadataSchema.optional()
});
var assistantModelMessageSchema = z52.object({
  role: z52.literal("assistant"),
  content: z52.union([
    z52.string(),
    z52.array(
      z52.union([
        textPartSchema,
        filePartSchema,
        reasoningPartSchema,
        toolCallPartSchema,
        toolResultPartSchema
      ])
    )
  ]),
  providerOptions: providerMetadataSchema.optional()
});
var toolModelMessageSchema = z52.object({
  role: z52.literal("tool"),
  content: z52.array(toolResultPartSchema),
  providerOptions: providerMetadataSchema.optional()
});
var modelMessageSchema = z52.union([
  systemModelMessageSchema,
  userModelMessageSchema,
  assistantModelMessageSchema,
  toolModelMessageSchema
]);
function asArray(value) {
  return value === void 0 ? [] : Array.isArray(value) ? value : [value];
}
var originalGenerateId = createIdGenerator2({
  prefix: "aitxt",
  size: 24
});
var JsonToSseTransformStream = class extends TransformStream {
  constructor() {
    super({
      transform(part, controller) {
        controller.enqueue(`data: ${JSON.stringify(part)}

`);
      },
      flush(controller) {
        controller.enqueue("data: [DONE]\n\n");
      }
    });
  }
};
var uiMessageChunkSchema = z72.union([
  z72.strictObject({
    type: z72.literal("text-start"),
    id: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("text-delta"),
    id: z72.string(),
    delta: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("text-end"),
    id: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("error"),
    errorText: z72.string()
  }),
  z72.strictObject({
    type: z72.literal("tool-input-start"),
    toolCallId: z72.string(),
    toolName: z72.string(),
    providerExecuted: z72.boolean().optional(),
    dynamic: z72.boolean().optional()
  }),
  z72.strictObject({
    type: z72.literal("tool-input-delta"),
    toolCallId: z72.string(),
    inputTextDelta: z72.string()
  }),
  z72.strictObject({
    type: z72.literal("tool-input-available"),
    toolCallId: z72.string(),
    toolName: z72.string(),
    input: z72.unknown(),
    providerExecuted: z72.boolean().optional(),
    providerMetadata: providerMetadataSchema.optional(),
    dynamic: z72.boolean().optional()
  }),
  z72.strictObject({
    type: z72.literal("tool-input-error"),
    toolCallId: z72.string(),
    toolName: z72.string(),
    input: z72.unknown(),
    providerExecuted: z72.boolean().optional(),
    providerMetadata: providerMetadataSchema.optional(),
    dynamic: z72.boolean().optional(),
    errorText: z72.string()
  }),
  z72.strictObject({
    type: z72.literal("tool-output-available"),
    toolCallId: z72.string(),
    output: z72.unknown(),
    providerExecuted: z72.boolean().optional(),
    dynamic: z72.boolean().optional(),
    preliminary: z72.boolean().optional()
  }),
  z72.strictObject({
    type: z72.literal("tool-output-error"),
    toolCallId: z72.string(),
    errorText: z72.string(),
    providerExecuted: z72.boolean().optional(),
    dynamic: z72.boolean().optional()
  }),
  z72.strictObject({
    type: z72.literal("reasoning"),
    text: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("reasoning-start"),
    id: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("reasoning-delta"),
    id: z72.string(),
    delta: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("reasoning-end"),
    id: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("reasoning-part-finish")
  }),
  z72.strictObject({
    type: z72.literal("source-url"),
    sourceId: z72.string(),
    url: z72.string(),
    title: z72.string().optional(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("source-document"),
    sourceId: z72.string(),
    mediaType: z72.string(),
    title: z72.string(),
    filename: z72.string().optional(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.literal("file"),
    url: z72.string(),
    mediaType: z72.string(),
    providerMetadata: providerMetadataSchema.optional()
  }),
  z72.strictObject({
    type: z72.string().startsWith("data-"),
    id: z72.string().optional(),
    data: z72.unknown(),
    transient: z72.boolean().optional()
  }),
  z72.strictObject({
    type: z72.literal("start-step")
  }),
  z72.strictObject({
    type: z72.literal("finish-step")
  }),
  z72.strictObject({
    type: z72.literal("start"),
    messageId: z72.string().optional(),
    messageMetadata: z72.unknown().optional()
  }),
  z72.strictObject({
    type: z72.literal("finish"),
    messageMetadata: z72.unknown().optional()
  }),
  z72.strictObject({
    type: z72.literal("abort")
  }),
  z72.strictObject({
    type: z72.literal("message-metadata"),
    messageMetadata: z72.unknown()
  })
]);
function fixJson(input) {
  const stack = ["ROOT"];
  let lastValidIndex = -1;
  let literalStart = null;
  function processValueStart(char, i, swapState) {
    {
      switch (char) {
        case '"': {
          lastValidIndex = i;
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_STRING");
          break;
        }
        case "f":
        case "t":
        case "n": {
          lastValidIndex = i;
          literalStart = i;
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_LITERAL");
          break;
        }
        case "-": {
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_NUMBER");
          break;
        }
        case "0":
        case "1":
        case "2":
        case "3":
        case "4":
        case "5":
        case "6":
        case "7":
        case "8":
        case "9": {
          lastValidIndex = i;
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_NUMBER");
          break;
        }
        case "{": {
          lastValidIndex = i;
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_OBJECT_START");
          break;
        }
        case "[": {
          lastValidIndex = i;
          stack.pop();
          stack.push(swapState);
          stack.push("INSIDE_ARRAY_START");
          break;
        }
      }
    }
  }
  function processAfterObjectValue(char, i) {
    switch (char) {
      case ",": {
        stack.pop();
        stack.push("INSIDE_OBJECT_AFTER_COMMA");
        break;
      }
      case "}": {
        lastValidIndex = i;
        stack.pop();
        break;
      }
    }
  }
  function processAfterArrayValue(char, i) {
    switch (char) {
      case ",": {
        stack.pop();
        stack.push("INSIDE_ARRAY_AFTER_COMMA");
        break;
      }
      case "]": {
        lastValidIndex = i;
        stack.pop();
        break;
      }
    }
  }
  for (let i = 0; i < input.length; i++) {
    const char = input[i];
    const currentState = stack[stack.length - 1];
    switch (currentState) {
      case "ROOT":
        processValueStart(char, i, "FINISH");
        break;
      case "INSIDE_OBJECT_START": {
        switch (char) {
          case '"': {
            stack.pop();
            stack.push("INSIDE_OBJECT_KEY");
            break;
          }
          case "}": {
            lastValidIndex = i;
            stack.pop();
            break;
          }
        }
        break;
      }
      case "INSIDE_OBJECT_AFTER_COMMA": {
        switch (char) {
          case '"': {
            stack.pop();
            stack.push("INSIDE_OBJECT_KEY");
            break;
          }
        }
        break;
      }
      case "INSIDE_OBJECT_KEY": {
        switch (char) {
          case '"': {
            stack.pop();
            stack.push("INSIDE_OBJECT_AFTER_KEY");
            break;
          }
        }
        break;
      }
      case "INSIDE_OBJECT_AFTER_KEY": {
        switch (char) {
          case ":": {
            stack.pop();
            stack.push("INSIDE_OBJECT_BEFORE_VALUE");
            break;
          }
        }
        break;
      }
      case "INSIDE_OBJECT_BEFORE_VALUE": {
        processValueStart(char, i, "INSIDE_OBJECT_AFTER_VALUE");
        break;
      }
      case "INSIDE_OBJECT_AFTER_VALUE": {
        processAfterObjectValue(char, i);
        break;
      }
      case "INSIDE_STRING": {
        switch (char) {
          case '"': {
            stack.pop();
            lastValidIndex = i;
            break;
          }
          case "\\": {
            stack.push("INSIDE_STRING_ESCAPE");
            break;
          }
          default: {
            lastValidIndex = i;
          }
        }
        break;
      }
      case "INSIDE_ARRAY_START": {
        switch (char) {
          case "]": {
            lastValidIndex = i;
            stack.pop();
            break;
          }
          default: {
            lastValidIndex = i;
            processValueStart(char, i, "INSIDE_ARRAY_AFTER_VALUE");
            break;
          }
        }
        break;
      }
      case "INSIDE_ARRAY_AFTER_VALUE": {
        switch (char) {
          case ",": {
            stack.pop();
            stack.push("INSIDE_ARRAY_AFTER_COMMA");
            break;
          }
          case "]": {
            lastValidIndex = i;
            stack.pop();
            break;
          }
          default: {
            lastValidIndex = i;
            break;
          }
        }
        break;
      }
      case "INSIDE_ARRAY_AFTER_COMMA": {
        processValueStart(char, i, "INSIDE_ARRAY_AFTER_VALUE");
        break;
      }
      case "INSIDE_STRING_ESCAPE": {
        stack.pop();
        lastValidIndex = i;
        break;
      }
      case "INSIDE_NUMBER": {
        switch (char) {
          case "0":
          case "1":
          case "2":
          case "3":
          case "4":
          case "5":
          case "6":
          case "7":
          case "8":
          case "9": {
            lastValidIndex = i;
            break;
          }
          case "e":
          case "E":
          case "-":
          case ".": {
            break;
          }
          case ",": {
            stack.pop();
            if (stack[stack.length - 1] === "INSIDE_ARRAY_AFTER_VALUE") {
              processAfterArrayValue(char, i);
            }
            if (stack[stack.length - 1] === "INSIDE_OBJECT_AFTER_VALUE") {
              processAfterObjectValue(char, i);
            }
            break;
          }
          case "}": {
            stack.pop();
            if (stack[stack.length - 1] === "INSIDE_OBJECT_AFTER_VALUE") {
              processAfterObjectValue(char, i);
            }
            break;
          }
          case "]": {
            stack.pop();
            if (stack[stack.length - 1] === "INSIDE_ARRAY_AFTER_VALUE") {
              processAfterArrayValue(char, i);
            }
            break;
          }
          default: {
            stack.pop();
            break;
          }
        }
        break;
      }
      case "INSIDE_LITERAL": {
        const partialLiteral = input.substring(literalStart, i + 1);
        if (!"false".startsWith(partialLiteral) && !"true".startsWith(partialLiteral) && !"null".startsWith(partialLiteral)) {
          stack.pop();
          if (stack[stack.length - 1] === "INSIDE_OBJECT_AFTER_VALUE") {
            processAfterObjectValue(char, i);
          } else if (stack[stack.length - 1] === "INSIDE_ARRAY_AFTER_VALUE") {
            processAfterArrayValue(char, i);
          }
        } else {
          lastValidIndex = i;
        }
        break;
      }
    }
  }
  let result = input.slice(0, lastValidIndex + 1);
  for (let i = stack.length - 1; i >= 0; i--) {
    const state = stack[i];
    switch (state) {
      case "INSIDE_STRING": {
        result += '"';
        break;
      }
      case "INSIDE_OBJECT_KEY":
      case "INSIDE_OBJECT_AFTER_KEY":
      case "INSIDE_OBJECT_AFTER_COMMA":
      case "INSIDE_OBJECT_START":
      case "INSIDE_OBJECT_BEFORE_VALUE":
      case "INSIDE_OBJECT_AFTER_VALUE": {
        result += "}";
        break;
      }
      case "INSIDE_ARRAY_START":
      case "INSIDE_ARRAY_AFTER_COMMA":
      case "INSIDE_ARRAY_AFTER_VALUE": {
        result += "]";
        break;
      }
      case "INSIDE_LITERAL": {
        const partialLiteral = input.substring(literalStart, input.length);
        if ("true".startsWith(partialLiteral)) {
          result += "true".slice(partialLiteral.length);
        } else if ("false".startsWith(partialLiteral)) {
          result += "false".slice(partialLiteral.length);
        } else if ("null".startsWith(partialLiteral)) {
          result += "null".slice(partialLiteral.length);
        }
      }
    }
  }
  return result;
}
async function parsePartialJson(jsonText) {
  if (jsonText === void 0) {
    return { value: void 0, state: "undefined-input" };
  }
  let result = await safeParseJSON2({ text: jsonText });
  if (result.success) {
    return { value: result.value, state: "successful-parse" };
  }
  result = await safeParseJSON2({ text: fixJson(jsonText) });
  if (result.success) {
    return { value: result.value, state: "repaired-parse" };
  }
  return { value: void 0, state: "failed-parse" };
}
var originalGenerateId2 = createIdGenerator2({
  prefix: "aitxt",
  size: 24
});
var originalGenerateId3 = createIdGenerator2({ prefix: "aiobj", size: 24 });
var originalGenerateId4 = createIdGenerator2({ prefix: "aiobj", size: 24 });
var output_exports = {};
__export(output_exports, {
  object: () => object,
  text: () => text
});
var text = () => ({
  type: "text",
  responseFormat: { type: "text" },
  async parsePartial({ text: text2 }) {
    return { partial: text2 };
  },
  async parseOutput({ text: text2 }) {
    return text2;
  }
});
var object = ({
  schema: inputSchema
}) => {
  const schema = asSchema(inputSchema);
  return {
    type: "object",
    responseFormat: {
      type: "json",
      schema: schema.jsonSchema
    },
    async parsePartial({ text: text2 }) {
      const result = await parsePartialJson(text2);
      switch (result.state) {
        case "failed-parse":
        case "undefined-input":
          return void 0;
        case "repaired-parse":
        case "successful-parse":
          return {
            // Note: currently no validation of partial results:
            partial: result.value
          };
        default: {
          const _exhaustiveCheck = result.state;
          throw new Error(`Unsupported parse state: ${_exhaustiveCheck}`);
        }
      }
    },
    async parseOutput({ text: text2 }, context) {
      const parseResult = await safeParseJSON2({ text: text2 });
      if (!parseResult.success) {
        throw new NoObjectGeneratedError({
          message: "No object generated: could not parse the response.",
          cause: parseResult.error,
          text: text2,
          response: context.response,
          usage: context.usage,
          finishReason: context.finishReason
        });
      }
      const validationResult = await safeValidateTypes2({
        value: parseResult.value,
        schema
      });
      if (!validationResult.success) {
        throw new NoObjectGeneratedError({
          message: "No object generated: response did not match schema.",
          cause: validationResult.error,
          text: text2,
          response: context.response,
          usage: context.usage,
          finishReason: context.finishReason
        });
      }
      return validationResult.value;
    }
  };
};
var wrapLanguageModel = ({
  model,
  middleware: middlewareArg,
  modelId,
  providerId
}) => {
  return asArray(middlewareArg).reverse().reduce((wrappedModel, middleware) => {
    return doWrap({ model: wrappedModel, middleware, modelId, providerId });
  }, model);
};
var doWrap = ({
  model,
  middleware: {
    transformParams,
    wrapGenerate,
    wrapStream,
    overrideProvider,
    overrideModelId,
    overrideSupportedUrls
  },
  modelId,
  providerId
}) => {
  var _a172, _b8, _c;
  async function doTransform({
    params,
    type
  }) {
    return transformParams ? await transformParams({ params, type, model }) : params;
  }
  return {
    specificationVersion: "v2",
    provider: (_a172 = providerId != null ? providerId : overrideProvider == null ? void 0 : overrideProvider({ model })) != null ? _a172 : model.provider,
    modelId: (_b8 = modelId != null ? modelId : overrideModelId == null ? void 0 : overrideModelId({ model })) != null ? _b8 : model.modelId,
    supportedUrls: (_c = overrideSupportedUrls == null ? void 0 : overrideSupportedUrls({ model })) != null ? _c : model.supportedUrls,
    async doGenerate(params) {
      const transformedParams = await doTransform({ params, type: "generate" });
      const doGenerate = async () => model.doGenerate(transformedParams);
      const doStream = async () => model.doStream(transformedParams);
      return wrapGenerate ? wrapGenerate({
        doGenerate,
        doStream,
        params: transformedParams,
        model
      }) : doGenerate();
    },
    async doStream(params) {
      const transformedParams = await doTransform({ params, type: "stream" });
      const doGenerate = async () => model.doGenerate(transformedParams);
      const doStream = async () => model.doStream(transformedParams);
      return wrapStream ? wrapStream({ doGenerate, doStream, params: transformedParams, model }) : doStream();
    }
  };
};
var name162 = "AI_NoSuchProviderError";
var marker162 = `vercel.ai.error.${name162}`;
var symbol162 = Symbol.for(marker162);
var _a162;
_a162 = symbol162;
var ClientOrServerImplementationSchema = z8.looseObject({
  name: z8.string(),
  version: z8.string()
});
var BaseParamsSchema = z8.looseObject({
  _meta: z8.optional(z8.object({}).loose())
});
var ResultSchema = BaseParamsSchema;
var RequestSchema = z8.object({
  method: z8.string(),
  params: z8.optional(BaseParamsSchema)
});
var ServerCapabilitiesSchema = z8.looseObject({
  experimental: z8.optional(z8.object({}).loose()),
  logging: z8.optional(z8.object({}).loose()),
  prompts: z8.optional(
    z8.looseObject({
      listChanged: z8.optional(z8.boolean())
    })
  ),
  resources: z8.optional(
    z8.looseObject({
      subscribe: z8.optional(z8.boolean()),
      listChanged: z8.optional(z8.boolean())
    })
  ),
  tools: z8.optional(
    z8.looseObject({
      listChanged: z8.optional(z8.boolean())
    })
  )
});
var InitializeResultSchema = ResultSchema.extend({
  protocolVersion: z8.string(),
  capabilities: ServerCapabilitiesSchema,
  serverInfo: ClientOrServerImplementationSchema,
  instructions: z8.optional(z8.string())
});
var PaginatedResultSchema = ResultSchema.extend({
  nextCursor: z8.optional(z8.string())
});
var ToolSchema = z8.object({
  name: z8.string(),
  description: z8.optional(z8.string()),
  inputSchema: z8.object({
    type: z8.literal("object"),
    properties: z8.optional(z8.object({}).loose())
  }).loose()
}).loose();
var ListToolsResultSchema = PaginatedResultSchema.extend({
  tools: z8.array(ToolSchema)
});
var TextContentSchema = z8.object({
  type: z8.literal("text"),
  text: z8.string()
}).loose();
var ImageContentSchema = z8.object({
  type: z8.literal("image"),
  data: z8.base64(),
  mimeType: z8.string()
}).loose();
var ResourceContentsSchema = z8.object({
  /**
   * The URI of this resource.
   */
  uri: z8.string(),
  /**
   * The MIME type of this resource, if known.
   */
  mimeType: z8.optional(z8.string())
}).loose();
var TextResourceContentsSchema = ResourceContentsSchema.extend({
  text: z8.string()
});
var BlobResourceContentsSchema = ResourceContentsSchema.extend({
  blob: z8.base64()
});
var EmbeddedResourceSchema = z8.object({
  type: z8.literal("resource"),
  resource: z8.union([TextResourceContentsSchema, BlobResourceContentsSchema])
}).loose();
var CallToolResultSchema = ResultSchema.extend({
  content: z8.array(
    z8.union([TextContentSchema, ImageContentSchema, EmbeddedResourceSchema])
  ),
  isError: z8.boolean().default(false).optional()
}).or(
  ResultSchema.extend({
    toolResult: z8.unknown()
  })
);
var JSONRPC_VERSION = "2.0";
var JSONRPCRequestSchema = z9.object({
  jsonrpc: z9.literal(JSONRPC_VERSION),
  id: z9.union([z9.string(), z9.number().int()])
}).merge(RequestSchema).strict();
var JSONRPCResponseSchema = z9.object({
  jsonrpc: z9.literal(JSONRPC_VERSION),
  id: z9.union([z9.string(), z9.number().int()]),
  result: ResultSchema
}).strict();
var JSONRPCErrorSchema = z9.object({
  jsonrpc: z9.literal(JSONRPC_VERSION),
  id: z9.union([z9.string(), z9.number().int()]),
  error: z9.object({
    code: z9.number().int(),
    message: z9.string(),
    data: z9.optional(z9.unknown())
  })
}).strict();
var JSONRPCNotificationSchema = z9.object({
  jsonrpc: z9.literal(JSONRPC_VERSION)
}).merge(
  z9.object({
    method: z9.string(),
    params: z9.optional(BaseParamsSchema)
  })
).strict();
var JSONRPCMessageSchema = z9.union([
  JSONRPCRequestSchema,
  JSONRPCNotificationSchema,
  JSONRPCResponseSchema,
  JSONRPCErrorSchema
]);
var textUIPartSchema = z10.object({
  type: z10.literal("text"),
  text: z10.string(),
  state: z10.enum(["streaming", "done"]).optional(),
  providerMetadata: providerMetadataSchema.optional()
});
var reasoningUIPartSchema = z10.object({
  type: z10.literal("reasoning"),
  text: z10.string(),
  state: z10.enum(["streaming", "done"]).optional(),
  providerMetadata: providerMetadataSchema.optional()
});
var sourceUrlUIPartSchema = z10.object({
  type: z10.literal("source-url"),
  sourceId: z10.string(),
  url: z10.string(),
  title: z10.string().optional(),
  providerMetadata: providerMetadataSchema.optional()
});
var sourceDocumentUIPartSchema = z10.object({
  type: z10.literal("source-document"),
  sourceId: z10.string(),
  mediaType: z10.string(),
  title: z10.string(),
  filename: z10.string().optional(),
  providerMetadata: providerMetadataSchema.optional()
});
var fileUIPartSchema = z10.object({
  type: z10.literal("file"),
  mediaType: z10.string(),
  filename: z10.string().optional(),
  url: z10.string(),
  providerMetadata: providerMetadataSchema.optional()
});
var stepStartUIPartSchema = z10.object({
  type: z10.literal("step-start")
});
var dataUIPartSchema = z10.object({
  type: z10.string().startsWith("data-"),
  id: z10.string().optional(),
  data: z10.unknown()
});
var dynamicToolUIPartSchemas = [
  z10.object({
    type: z10.literal("dynamic-tool"),
    toolName: z10.string(),
    toolCallId: z10.string(),
    state: z10.literal("input-streaming"),
    input: z10.unknown().optional(),
    output: z10.never().optional(),
    errorText: z10.never().optional()
  }),
  z10.object({
    type: z10.literal("dynamic-tool"),
    toolName: z10.string(),
    toolCallId: z10.string(),
    state: z10.literal("input-available"),
    input: z10.unknown(),
    output: z10.never().optional(),
    errorText: z10.never().optional(),
    callProviderMetadata: providerMetadataSchema.optional()
  }),
  z10.object({
    type: z10.literal("dynamic-tool"),
    toolName: z10.string(),
    toolCallId: z10.string(),
    state: z10.literal("output-available"),
    input: z10.unknown(),
    output: z10.unknown(),
    errorText: z10.never().optional(),
    callProviderMetadata: providerMetadataSchema.optional(),
    preliminary: z10.boolean().optional()
  }),
  z10.object({
    type: z10.literal("dynamic-tool"),
    toolName: z10.string(),
    toolCallId: z10.string(),
    state: z10.literal("output-error"),
    input: z10.unknown(),
    output: z10.never().optional(),
    errorText: z10.string(),
    callProviderMetadata: providerMetadataSchema.optional()
  })
];
var toolUIPartSchemas = [
  z10.object({
    type: z10.string().startsWith("tool-"),
    toolCallId: z10.string(),
    state: z10.literal("input-streaming"),
    input: z10.unknown().optional(),
    output: z10.never().optional(),
    errorText: z10.never().optional()
  }),
  z10.object({
    type: z10.string().startsWith("tool-"),
    toolCallId: z10.string(),
    state: z10.literal("input-available"),
    input: z10.unknown(),
    output: z10.never().optional(),
    errorText: z10.never().optional(),
    callProviderMetadata: providerMetadataSchema.optional()
  }),
  z10.object({
    type: z10.string().startsWith("tool-"),
    toolCallId: z10.string(),
    state: z10.literal("output-available"),
    input: z10.unknown(),
    output: z10.unknown(),
    errorText: z10.never().optional(),
    callProviderMetadata: providerMetadataSchema.optional(),
    preliminary: z10.boolean().optional()
  }),
  z10.object({
    type: z10.string().startsWith("tool-"),
    toolCallId: z10.string(),
    state: z10.literal("output-error"),
    input: z10.unknown(),
    output: z10.never().optional(),
    errorText: z10.string(),
    callProviderMetadata: providerMetadataSchema.optional()
  })
];
var uiMessageSchema = z10.object({
  id: z10.string(),
  role: z10.enum(["system", "user", "assistant"]),
  metadata: z10.unknown().optional(),
  parts: z10.array(
    z10.union([
      textUIPartSchema,
      reasoningUIPartSchema,
      sourceUrlUIPartSchema,
      sourceDocumentUIPartSchema,
      fileUIPartSchema,
      stepStartUIPartSchema,
      dataUIPartSchema,
      ...dynamicToolUIPartSchemas,
      ...toolUIPartSchemas
    ])
  )
});

// lightfast.config.ts
var customerSupportAgent = createAgent({
  name: "customer-support",
  system: `You are a helpful customer support agent. 
Be polite, professional, and solution-oriented.
Always aim to resolve customer issues efficiently.`,
  model: wrapLanguageModel({
    model: gateway("claude-3-5-sonnet-20241022")
  })
  // Tools would be added here in a real implementation
  // tools: { searchKB: searchKnowledgeBaseTool },
});
var codeReviewAgent = createAgent({
  name: "code-reviewer",
  system: `You are an expert code reviewer. 
Focus on code quality, security vulnerabilities, and best practices.
Provide constructive feedback with specific suggestions for improvement.`,
  model: wrapLanguageModel({
    model: gateway("claude-3-5-sonnet-20241022")
  })
  // Tools for code analysis would be added here
  // tools: { analyzeCode: codeAnalysisTool },
});
var dataAnalystAgent = createAgent({
  name: "data-analyst",
  system: `You are a data analyst specialized in business intelligence.
Analyze data patterns, create visualizations, and provide actionable insights.
Always back your conclusions with data.`,
  model: wrapLanguageModel({
    model: gateway("gpt-4-turbo")
  })
  // Data processing tools would be added here
  // tools: { queryData: databaseQueryTool, createChart: chartTool },
});
var contentWriterAgent = createAgent({
  name: "content-writer",
  system: `You are a creative content writer.
Create engaging, SEO-friendly content that resonates with the target audience.
Use a clear, compelling writing style.`,
  model: wrapLanguageModel({
    model: gateway("claude-3-5-sonnet-20241022")
  })
  // No tools for this agent - pure generation
});
var codeGeneratorAgent = createAgent({
  name: "code-generator",
  system: `You are an expert programmer.
Generate clean, efficient, and well-documented code.
Always follow best practices and include proper error handling.

IMPORTANT: When displaying code, ALWAYS use triple backticks:
\`\`\`language
code here
\`\`\``,
  model: wrapLanguageModel({
    model: gateway("claude-3-5-sonnet-20241022")
  })
  // Code manipulation tools would be added here
  // tools: { writeFile: fileWriterTool, runTests: testRunnerTool },
});
var qaTestAgent = createAgent({
  name: "qa-tester",
  system: `You are a QA engineer.
Find bugs, edge cases, and ensure quality.
Create comprehensive test plans and report issues clearly.`,
  model: wrapLanguageModel({
    model: gateway("gpt-4")
  })
  // Testing tools would be added here
  // tools: { runTests: testSuiteTool, fileReport: bugReportTool },
});
var lightfast = createLightfast({
  agents: {
    customerSupport: customerSupportAgent,
    codeReviewer: codeReviewAgent,
    dataAnalyst: dataAnalystAgent,
    contentWriter: contentWriterAgent,
    codeGenerator: codeGeneratorAgent,
    qaTester: qaTestAgent
  },
  metadata: {
    name: "Agent Chat Example",
    version: "1.0.0",
    description: "Example project demonstrating multiple AI agents with Lightfast"
  },
  dev: {
    port: 3e3,
    hotReload: true,
    verbose: false
  }
});
var lightfast_config_default = lightfast;
export {
  lightfast_config_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibGlnaHRmYXN0LmNvbmZpZy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvYWktc2RrLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9hcGktY2FsbC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvZW1wdHktcmVzcG9uc2UtYm9keS1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvZ2V0LWVycm9yLW1lc3NhZ2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2ludmFsaWQtYXJndW1lbnQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2ludmFsaWQtcHJvbXB0LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9pbnZhbGlkLXJlc3BvbnNlLWRhdGEtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2pzb24tcGFyc2UtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2xvYWQtYXBpLWtleS1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvbG9hZC1zZXR0aW5nLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9uby1jb250ZW50LWdlbmVyYXRlZC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvbm8tc3VjaC1tb2RlbC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvdG9vLW1hbnktZW1iZWRkaW5nLXZhbHVlcy1mb3ItY2FsbC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvdHlwZS12YWxpZGF0aW9uLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy91bnN1cHBvcnRlZC1mdW5jdGlvbmFsaXR5LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2pzb24tdmFsdWUvaXMtanNvbi50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9ldmVudHNvdXJjZS1wYXJzZXIvc3JjL2Vycm9ycy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9ldmVudHNvdXJjZS1wYXJzZXIvc3JjL3BhcnNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL2V2ZW50c291cmNlLXBhcnNlci9zcmMvc3RyZWFtLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2NvbWJpbmUtaGVhZGVycy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9jb252ZXJ0LWFzeW5jLWl0ZXJhdG9yLXRvLXJlYWRhYmxlLXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9kZWxheS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9leHRyYWN0LXJlc3BvbnNlLWhlYWRlcnMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvZ2VuZXJhdGUtaWQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvZ2V0LWVycm9yLW1lc3NhZ2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvZ2V0LWZyb20tYXBpLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2hhbmRsZS1mZXRjaC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9pcy1hYm9ydC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9yZW1vdmUtdW5kZWZpbmVkLWVudHJpZXMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvaXMtdXJsLXN1cHBvcnRlZC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9sb2FkLWFwaS1rZXkudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvbG9hZC1vcHRpb25hbC1zZXR0aW5nLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2xvYWQtc2V0dGluZy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wYXJzZS1qc29uLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3NlY3VyZS1qc29uLXBhcnNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3ZhbGlkYXRlLXR5cGVzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3ZhbGlkYXRvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wYXJzZS1qc29uLWV2ZW50LXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wYXJzZS1wcm92aWRlci1vcHRpb25zLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3Bvc3QtdG8tYXBpLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3R5cGVzL3Rvb2wudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvcHJvdmlkZXItZGVmaW5lZC10b29sLWZhY3RvcnkudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvcmVzb2x2ZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9yZXNwb25zZS1oYW5kbGVyLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3pvZC1zY2hlbWEudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvc2NoZW1hLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3VpbnQ4LXV0aWxzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3dpdGhvdXQtdHJhaWxpbmctc2xhc2gudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvaXMtYXN5bmMtaXRlcmFibGUudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvdHlwZXMvZXhlY3V0ZS10b29sLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2luZGV4LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vT3B0aW9ucy5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL1JlZnMuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9lcnJvck1lc3NhZ2VzLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vZ2V0UmVsYXRpdmVQYXRoLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vc2VsZWN0UGFyc2VyLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9hbnkuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL2FycmF5LmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9iaWdpbnQuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL2Jvb2xlYW4uanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL2JyYW5kZWQuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL2NhdGNoLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9kYXRlLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9kZWZhdWx0LmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9lZmZlY3RzLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9lbnVtLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9pbnRlcnNlY3Rpb24uanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL2xpdGVyYWwuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL3JlY29yZC5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvc3RyaW5nLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9tYXAuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL25hdGl2ZUVudW0uanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL25ldmVyLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9udWxsLmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy91bmlvbi5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvbnVsbGFibGUuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL251bWJlci5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvb2JqZWN0LmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy96b2QtdG8tanNvbi1zY2hlbWEvZGlzdC9lc20vcGFyc2Vycy9vcHRpb25hbC5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvcGlwZWxpbmUuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL3Byb21pc2UuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL3NldC5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvdHVwbGUuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZXJzL3VuZGVmaW5lZC5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvdW5rbm93bi5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3BhcnNlcnMvcmVhZG9ubHkuanMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL3pvZC10by1qc29uLXNjaGVtYS9kaXN0L2VzbS9wYXJzZURlZi5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL3pvZFRvSnNvblNjaGVtYS5qcyIsICIuLi8uLi9ub2RlX21vZHVsZXMvem9kLXRvLWpzb24tc2NoZW1hL2Rpc3QvZXNtL2luZGV4LmpzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2dhdGV3YXktcHJvdmlkZXIudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZXJyb3JzL2FzLWdhdGV3YXktZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZXJyb3JzL2NyZWF0ZS1nYXRld2F5LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2Vycm9ycy9nYXRld2F5LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2Vycm9ycy9nYXRld2F5LWF1dGhlbnRpY2F0aW9uLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2Vycm9ycy9nYXRld2F5LWludmFsaWQtcmVxdWVzdC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L3NyYy9lcnJvcnMvZ2F0ZXdheS1yYXRlLWxpbWl0LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2Vycm9ycy9nYXRld2F5LW1vZGVsLW5vdC1mb3VuZC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L3NyYy9lcnJvcnMvZ2F0ZXdheS1pbnRlcm5hbC1zZXJ2ZXItZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZXJyb3JzL2dhdGV3YXktcmVzcG9uc2UtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZXJyb3JzL2V4dHJhY3QtYXBpLWNhbGwtcmVzcG9uc2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZXJyb3JzL3BhcnNlLWF1dGgtbWV0aG9kLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9AYWktc2RrL2dhdGV3YXkvc3JjL2dhdGV3YXktZmV0Y2gtbWV0YWRhdGEudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9zcmMvZ2F0ZXdheS1sYW5ndWFnZS1tb2RlbC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L3NyYy9nYXRld2F5LWVtYmVkZGluZy1tb2RlbC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvQGFpLXNkay9nYXRld2F5L3NyYy92ZXJjZWwtZW52aXJvbm1lbnQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvYWktc2RrLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2FwaS1jYWxsLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL2VtcHR5LXJlc3BvbnNlLWJvZHktZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvZ2V0LWVycm9yLW1lc3NhZ2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvaW52YWxpZC1hcmd1bWVudC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9pbnZhbGlkLXByb21wdC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9pbnZhbGlkLXJlc3BvbnNlLWRhdGEtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvanNvbi1wYXJzZS1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy9sb2FkLWFwaS1rZXktZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvbG9hZC1zZXR0aW5nLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL25vLWNvbnRlbnQtZ2VuZXJhdGVkLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci9zcmMvZXJyb3JzL25vLXN1Y2gtbW9kZWwtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvdG9vLW1hbnktZW1iZWRkaW5nLXZhbHVlcy1mb3ItY2FsbC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2Vycm9ycy90eXBlLXZhbGlkYXRpb24tZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyL3NyYy9lcnJvcnMvdW5zdXBwb3J0ZWQtZnVuY3Rpb25hbGl0eS1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXIvc3JjL2pzb24tdmFsdWUvaXMtanNvbi50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2NvbWJpbmUtaGVhZGVycy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2NvbnZlcnQtYXN5bmMtaXRlcmF0b3ItdG8tcmVhZGFibGUtc3RyZWFtLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvZGVsYXkudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9leHRyYWN0LXJlc3BvbnNlLWhlYWRlcnMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9nZW5lcmF0ZS1pZC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2dldC1lcnJvci1tZXNzYWdlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvZ2V0LWZyb20tYXBpLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvaGFuZGxlLWZldGNoLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvaXMtYWJvcnQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9yZW1vdmUtdW5kZWZpbmVkLWVudHJpZXMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9pcy11cmwtc3VwcG9ydGVkLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvbG9hZC1hcGkta2V5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvbG9hZC1vcHRpb25hbC1zZXR0aW5nLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvbG9hZC1zZXR0aW5nLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvcGFyc2UtanNvbi50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3NlY3VyZS1qc29uLXBhcnNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvdmFsaWRhdGUtdHlwZXMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy92YWxpZGF0b3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wYXJzZS1qc29uLWV2ZW50LXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3BhcnNlLXByb3ZpZGVyLW9wdGlvbnMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wb3N0LXRvLWFwaS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3R5cGVzL3Rvb2wudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9wcm92aWRlci1kZWZpbmVkLXRvb2wtZmFjdG9yeS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3Jlc29sdmUudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL25vZGVfbW9kdWxlcy9AYWktc2RrL3Byb3ZpZGVyLXV0aWxzL3NyYy9yZXNwb25zZS1oYW5kbGVyLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvem9kLXNjaGVtYS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3NjaGVtYS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL3VpbnQ4LXV0aWxzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvd2l0aG91dC10cmFpbGluZy1zbGFzaC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvbm9kZV9tb2R1bGVzL0BhaS1zZGsvcHJvdmlkZXItdXRpbHMvc3JjL2lzLWFzeW5jLWl0ZXJhYmxlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvdHlwZXMvZXhlY3V0ZS10b29sLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9ub2RlX21vZHVsZXMvQGFpLXNkay9wcm92aWRlci11dGlscy9zcmMvaW5kZXgudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9pbmRleC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2dlbmVyYXRlLXRleHQvZ2VuZXJhdGUtdGV4dC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL25vLW91dHB1dC1zcGVjaWZpZWQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9tb2RlbC9yZXNvbHZlLW1vZGVsLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZXJyb3IvaW5kZXgudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9lcnJvci9pbnZhbGlkLWFyZ3VtZW50LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZXJyb3IvaW52YWxpZC1zdHJlYW0tcGFydC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL2ludmFsaWQtdG9vbC1pbnB1dC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL21jcC1jbGllbnQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9lcnJvci9uby1pbWFnZS1nZW5lcmF0ZWQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9lcnJvci9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZXJyb3Ivbm8tb3V0cHV0LWdlbmVyYXRlZC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL25vLXN1Y2gtdG9vbC1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL3Rvb2wtY2FsbC1yZXBhaXItZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9lcnJvci91bnN1cHBvcnRlZC1tb2RlbC12ZXJzaW9uLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L2ludmFsaWQtZGF0YS1jb250ZW50LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L2ludmFsaWQtbWVzc2FnZS1yb2xlLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L21lc3NhZ2UtY29udmVyc2lvbi1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvZG93bmxvYWQtZXJyb3IudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL3JldHJ5LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L2NvbnZlcnQtdG8tbGFuZ3VhZ2UtbW9kZWwtcHJvbXB0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9kZXRlY3QtbWVkaWEtdHlwZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvZG93bmxvYWQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9wcm9tcHQvZGF0YS1jb250ZW50LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L3NwbGl0LWRhdGEtdXJsLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcHJvbXB0L3ByZXBhcmUtY2FsbC1zZXR0aW5ncy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Byb21wdC9wcmVwYXJlLXRvb2xzLWFuZC10b29sLWNob2ljZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvaXMtbm9uLWVtcHR5LW9iamVjdC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Byb21wdC9zdGFuZGFyZGl6ZS1wcm9tcHQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9wcm9tcHQvbWVzc2FnZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3R5cGVzL3Byb3ZpZGVyLW1ldGFkYXRhLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdHlwZXMvanNvbi12YWx1ZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Byb21wdC9jb250ZW50LXBhcnQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9wcm9tcHQvd3JhcC1nYXRld2F5LWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdGVsZW1ldHJ5L2Fzc2VtYmxlLW9wZXJhdGlvbi1uYW1lLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdGVsZW1ldHJ5L2dldC1iYXNlLXRlbGVtZXRyeS1hdHRyaWJ1dGVzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdGVsZW1ldHJ5L2dldC10cmFjZXIudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy90ZWxlbWV0cnkvbm9vcC10cmFjZXIudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy90ZWxlbWV0cnkvcmVjb3JkLXNwYW4udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy90ZWxlbWV0cnkvc2VsZWN0LXRlbGVtZXRyeS1hdHRyaWJ1dGVzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdGVsZW1ldHJ5L3N0cmluZ2lmeS1mb3ItdGVsZW1ldHJ5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdHlwZXMvdXNhZ2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2FzLWFycmF5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9yZXRyeS13aXRoLWV4cG9uZW50aWFsLWJhY2tvZmYudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL3ByZXBhcmUtcmV0cmllcy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2dlbmVyYXRlLXRleHQvZXh0cmFjdC1jb250ZW50LXRleHQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9nZW5lcmF0ZS10ZXh0L2dlbmVyYXRlZC1maWxlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtdGV4dC9wYXJzZS10b29sLWNhbGwudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9nZW5lcmF0ZS10ZXh0L3N0ZXAtcmVzdWx0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtdGV4dC9zdG9wLWNvbmRpdGlvbi50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Byb21wdC9jcmVhdGUtdG9vbC1tb2RlbC1vdXRwdXQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9nZW5lcmF0ZS10ZXh0L3RvLXJlc3BvbnNlLW1lc3NhZ2VzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtdGV4dC9zdHJlYW0tdGV4dC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvcHJlcGFyZS1oZWFkZXJzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdGV4dC1zdHJlYW0vY3JlYXRlLXRleHQtc3RyZWFtLXJlc3BvbnNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC93cml0ZS10by1zZXJ2ZXItcmVzcG9uc2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy90ZXh0LXN0cmVhbS9waXBlLXRleHQtc3RyZWFtLXRvLXJlc3BvbnNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWktbWVzc2FnZS1zdHJlYW0vanNvbi10by1zc2UtdHJhbnNmb3JtLXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpLW1lc3NhZ2Utc3RyZWFtL3VpLW1lc3NhZ2Utc3RyZWFtLWhlYWRlcnMudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS1tZXNzYWdlLXN0cmVhbS9jcmVhdGUtdWktbWVzc2FnZS1zdHJlYW0tcmVzcG9uc2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS1tZXNzYWdlLXN0cmVhbS9nZXQtcmVzcG9uc2UtdWktbWVzc2FnZS1pZC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL3Byb2Nlc3MtdWktbWVzc2FnZS1zdHJlYW0udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS1tZXNzYWdlLXN0cmVhbS91aS1tZXNzYWdlLWNodW5rcy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvbWVyZ2Utb2JqZWN0cy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvcGFyc2UtcGFydGlhbC1qc29uLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9maXgtanNvbi50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL3VpLW1lc3NhZ2VzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWktbWVzc2FnZS1zdHJlYW0vaGFuZGxlLXVpLW1lc3NhZ2Utc3RyZWFtLWZpbmlzaC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpLW1lc3NhZ2Utc3RyZWFtL3BpcGUtdWktbWVzc2FnZS1zdHJlYW0tdG8tcmVzcG9uc2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2FzeW5jLWl0ZXJhYmxlLXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvY29uc3VtZS1zdHJlYW0udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2NyZWF0ZS1yZXNvbHZhYmxlLXByb21pc2UudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2NyZWF0ZS1zdGl0Y2hhYmxlLXN0cmVhbS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvZGVsYXllZC1wcm9taXNlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9maWx0ZXItc3RyZWFtLWVycm9ycy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvbm93LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtdGV4dC9ydW4tdG9vbHMtdHJhbnNmb3JtYXRpb24udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9hZ2VudC9hZ2VudC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2VtYmVkL2VtYmVkLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9zcGxpdC1hcnJheS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2VtYmVkL2VtYmVkLW1hbnkudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9nZW5lcmF0ZS1pbWFnZS9nZW5lcmF0ZS1pbWFnZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2dlbmVyYXRlLW9iamVjdC9nZW5lcmF0ZS1vYmplY3QudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9nZW5lcmF0ZS1vYmplY3Qvb3V0cHV0LXN0cmF0ZWd5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtb2JqZWN0L3BhcnNlLWFuZC12YWxpZGF0ZS1vYmplY3QtcmVzdWx0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtb2JqZWN0L3ZhbGlkYXRlLW9iamVjdC1nZW5lcmF0aW9uLWlucHV0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtb2JqZWN0L3N0cmVhbS1vYmplY3QudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2Nvc2luZS1zaW1pbGFyaXR5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9kYXRhLXVybC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3V0aWwvaXMtZGVlcC1lcXVhbC1kYXRhLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9zZXJpYWwtam9iLWV4ZWN1dG9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdXRpbC9zaW11bGF0ZS1yZWFkYWJsZS1zdHJlYW0udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9lcnJvci9uby1zcGVlY2gtZ2VuZXJhdGVkLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtc3BlZWNoL2dlbmVyYXRlZC1hdWRpby1maWxlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtc3BlZWNoL2dlbmVyYXRlLXNwZWVjaC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2dlbmVyYXRlLXRleHQvb3V0cHV0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvZ2VuZXJhdGUtdGV4dC9zbW9vdGgtc3RyZWFtLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvbWlkZGxld2FyZS9kZWZhdWx0LXNldHRpbmdzLW1pZGRsZXdhcmUudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91dGlsL2dldC1wb3RlbnRpYWwtc3RhcnQtaW5kZXgudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9taWRkbGV3YXJlL2V4dHJhY3QtcmVhc29uaW5nLW1pZGRsZXdhcmUudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy9taWRkbGV3YXJlL3NpbXVsYXRlLXN0cmVhbWluZy1taWRkbGV3YXJlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvbWlkZGxld2FyZS93cmFwLWxhbmd1YWdlLW1vZGVsLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvbWlkZGxld2FyZS93cmFwLXByb3ZpZGVyLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcmVnaXN0cnkvY3VzdG9tLXByb3ZpZGVyLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvcmVnaXN0cnkvbm8tc3VjaC1wcm92aWRlci1lcnJvci50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3JlZ2lzdHJ5L3Byb3ZpZGVyLXJlZ2lzdHJ5LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdG9vbC9tY3AvbWNwLWNsaWVudC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Rvb2wvbWNwL21jcC1zc2UtdHJhbnNwb3J0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdG9vbC9tY3AvanNvbi1ycGMtbWVzc2FnZS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3Rvb2wvbWNwL3R5cGVzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdG9vbC9tY3AvbWNwLXRyYW5zcG9ydC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL2Vycm9yL25vLXRyYW5zY3JpcHQtZ2VuZXJhdGVkLWVycm9yLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdHJhbnNjcmliZS90cmFuc2NyaWJlLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWkvY2FsbC1jb21wbGV0aW9uLWFwaS50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL3Byb2Nlc3MtdGV4dC1zdHJlYW0udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS9jaGF0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWkvY29udmVydC1maWxlLWxpc3QtdG8tZmlsZS11aS1wYXJ0cy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL2RlZmF1bHQtY2hhdC10cmFuc3BvcnQudHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS9odHRwLWNoYXQtdHJhbnNwb3J0LnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWkvY29udmVydC10by1tb2RlbC1tZXNzYWdlcy50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL2xhc3QtYXNzaXN0YW50LW1lc3NhZ2UtaXMtY29tcGxldGUtd2l0aC10b29sLWNhbGxzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWkvdHJhbnNmb3JtLXRleHQtdG8tdWktbWVzc2FnZS1zdHJlYW0udHMiLCAiLi4vLi4vbm9kZV9tb2R1bGVzL2FpL3NyYy91aS90ZXh0LXN0cmVhbS1jaGF0LXRyYW5zcG9ydC50cyIsICIuLi8uLi9ub2RlX21vZHVsZXMvYWkvc3JjL3VpL3ZhbGlkYXRlLXVpLW1lc3NhZ2VzLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWktbWVzc2FnZS1zdHJlYW0vY3JlYXRlLXVpLW1lc3NhZ2Utc3RyZWFtLnRzIiwgIi4uLy4uL25vZGVfbW9kdWxlcy9haS9zcmMvdWktbWVzc2FnZS1zdHJlYW0vcmVhZC11aS1tZXNzYWdlLXN0cmVhbS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgY3JlYXRlTGlnaHRmYXN0IH0gZnJvbSBcImxpZ2h0ZmFzdC9jbGllbnRcIjtcbmltcG9ydCB7IGNyZWF0ZUFnZW50IH0gZnJvbSBcImxpZ2h0ZmFzdC9hZ2VudFwiO1xuaW1wb3J0IHsgZ2F0ZXdheSB9IGZyb20gXCJAYWktc2RrL2dhdGV3YXlcIjtcbmltcG9ydCB7IHdyYXBMYW5ndWFnZU1vZGVsIH0gZnJvbSBcImFpXCI7XG5cbi8qKlxuICogRXhhbXBsZSBMaWdodGZhc3QgY29uZmlndXJhdGlvbiB3aXRoIG11bHRpcGxlIGFnZW50c1xuICogQmFzZWQgb24gdGhlIHJlYWwgaW1wbGVtZW50YXRpb24gZnJvbSBhcHBzL2NoYXRcbiAqL1xuXG4vLyBDdXN0b21lciBTdXBwb3J0IEFnZW50XG5jb25zdCBjdXN0b21lclN1cHBvcnRBZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiAgbmFtZTogXCJjdXN0b21lci1zdXBwb3J0XCIsXG4gIHN5c3RlbTogYFlvdSBhcmUgYSBoZWxwZnVsIGN1c3RvbWVyIHN1cHBvcnQgYWdlbnQuIFxuQmUgcG9saXRlLCBwcm9mZXNzaW9uYWwsIGFuZCBzb2x1dGlvbi1vcmllbnRlZC5cbkFsd2F5cyBhaW0gdG8gcmVzb2x2ZSBjdXN0b21lciBpc3N1ZXMgZWZmaWNpZW50bHkuYCxcbiAgbW9kZWw6IHdyYXBMYW5ndWFnZU1vZGVsKHtcbiAgICBtb2RlbDogZ2F0ZXdheShcImNsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyXCIpLFxuICB9KSxcbiAgLy8gVG9vbHMgd291bGQgYmUgYWRkZWQgaGVyZSBpbiBhIHJlYWwgaW1wbGVtZW50YXRpb25cbiAgLy8gdG9vbHM6IHsgc2VhcmNoS0I6IHNlYXJjaEtub3dsZWRnZUJhc2VUb29sIH0sXG59KTtcblxuLy8gQ29kZSBSZXZpZXcgQXNzaXN0YW50XG5jb25zdCBjb2RlUmV2aWV3QWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4gIG5hbWU6IFwiY29kZS1yZXZpZXdlclwiLFxuICBzeXN0ZW06IGBZb3UgYXJlIGFuIGV4cGVydCBjb2RlIHJldmlld2VyLiBcbkZvY3VzIG9uIGNvZGUgcXVhbGl0eSwgc2VjdXJpdHkgdnVsbmVyYWJpbGl0aWVzLCBhbmQgYmVzdCBwcmFjdGljZXMuXG5Qcm92aWRlIGNvbnN0cnVjdGl2ZSBmZWVkYmFjayB3aXRoIHNwZWNpZmljIHN1Z2dlc3Rpb25zIGZvciBpbXByb3ZlbWVudC5gLFxuICBtb2RlbDogd3JhcExhbmd1YWdlTW9kZWwoe1xuICAgIG1vZGVsOiBnYXRld2F5KFwiY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjJcIiksXG4gIH0pLFxuICAvLyBUb29scyBmb3IgY29kZSBhbmFseXNpcyB3b3VsZCBiZSBhZGRlZCBoZXJlXG4gIC8vIHRvb2xzOiB7IGFuYWx5emVDb2RlOiBjb2RlQW5hbHlzaXNUb29sIH0sXG59KTtcblxuLy8gRGF0YSBBbmFseXNpcyBBZ2VudFxuY29uc3QgZGF0YUFuYWx5c3RBZ2VudCA9IGNyZWF0ZUFnZW50KHtcbiAgbmFtZTogXCJkYXRhLWFuYWx5c3RcIixcbiAgc3lzdGVtOiBgWW91IGFyZSBhIGRhdGEgYW5hbHlzdCBzcGVjaWFsaXplZCBpbiBidXNpbmVzcyBpbnRlbGxpZ2VuY2UuXG5BbmFseXplIGRhdGEgcGF0dGVybnMsIGNyZWF0ZSB2aXN1YWxpemF0aW9ucywgYW5kIHByb3ZpZGUgYWN0aW9uYWJsZSBpbnNpZ2h0cy5cbkFsd2F5cyBiYWNrIHlvdXIgY29uY2x1c2lvbnMgd2l0aCBkYXRhLmAsXG4gIG1vZGVsOiB3cmFwTGFuZ3VhZ2VNb2RlbCh7XG4gICAgbW9kZWw6IGdhdGV3YXkoXCJncHQtNC10dXJib1wiKSxcbiAgfSksXG4gIC8vIERhdGEgcHJvY2Vzc2luZyB0b29scyB3b3VsZCBiZSBhZGRlZCBoZXJlXG4gIC8vIHRvb2xzOiB7IHF1ZXJ5RGF0YTogZGF0YWJhc2VRdWVyeVRvb2wsIGNyZWF0ZUNoYXJ0OiBjaGFydFRvb2wgfSxcbn0pO1xuXG4vLyBDb250ZW50IFdyaXRlciBBZ2VudFxuY29uc3QgY29udGVudFdyaXRlckFnZW50ID0gY3JlYXRlQWdlbnQoe1xuICBuYW1lOiBcImNvbnRlbnQtd3JpdGVyXCIsXG4gIHN5c3RlbTogYFlvdSBhcmUgYSBjcmVhdGl2ZSBjb250ZW50IHdyaXRlci5cbkNyZWF0ZSBlbmdhZ2luZywgU0VPLWZyaWVuZGx5IGNvbnRlbnQgdGhhdCByZXNvbmF0ZXMgd2l0aCB0aGUgdGFyZ2V0IGF1ZGllbmNlLlxuVXNlIGEgY2xlYXIsIGNvbXBlbGxpbmcgd3JpdGluZyBzdHlsZS5gLFxuICBtb2RlbDogd3JhcExhbmd1YWdlTW9kZWwoe1xuICAgIG1vZGVsOiBnYXRld2F5KFwiY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjJcIiksXG4gIH0pLFxuICAvLyBObyB0b29scyBmb3IgdGhpcyBhZ2VudCAtIHB1cmUgZ2VuZXJhdGlvblxufSk7XG5cbi8vIENvZGUgR2VuZXJhdG9yIEFnZW50XG5jb25zdCBjb2RlR2VuZXJhdG9yQWdlbnQgPSBjcmVhdGVBZ2VudCh7XG4gIG5hbWU6IFwiY29kZS1nZW5lcmF0b3JcIixcbiAgc3lzdGVtOiBgWW91IGFyZSBhbiBleHBlcnQgcHJvZ3JhbW1lci5cbkdlbmVyYXRlIGNsZWFuLCBlZmZpY2llbnQsIGFuZCB3ZWxsLWRvY3VtZW50ZWQgY29kZS5cbkFsd2F5cyBmb2xsb3cgYmVzdCBwcmFjdGljZXMgYW5kIGluY2x1ZGUgcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXG5JTVBPUlRBTlQ6IFdoZW4gZGlzcGxheWluZyBjb2RlLCBBTFdBWVMgdXNlIHRyaXBsZSBiYWNrdGlja3M6XG5cXGBcXGBcXGBsYW5ndWFnZVxuY29kZSBoZXJlXG5cXGBcXGBcXGBgLFxuICBtb2RlbDogd3JhcExhbmd1YWdlTW9kZWwoe1xuICAgIG1vZGVsOiBnYXRld2F5KFwiY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjJcIiksXG4gIH0pLFxuICAvLyBDb2RlIG1hbmlwdWxhdGlvbiB0b29scyB3b3VsZCBiZSBhZGRlZCBoZXJlXG4gIC8vIHRvb2xzOiB7IHdyaXRlRmlsZTogZmlsZVdyaXRlclRvb2wsIHJ1blRlc3RzOiB0ZXN0UnVubmVyVG9vbCB9LFxufSk7XG5cbi8vIFFBIFRlc3QgQWdlbnRcbmNvbnN0IHFhVGVzdEFnZW50ID0gY3JlYXRlQWdlbnQoe1xuICBuYW1lOiBcInFhLXRlc3RlclwiLFxuICBzeXN0ZW06IGBZb3UgYXJlIGEgUUEgZW5naW5lZXIuXG5GaW5kIGJ1Z3MsIGVkZ2UgY2FzZXMsIGFuZCBlbnN1cmUgcXVhbGl0eS5cbkNyZWF0ZSBjb21wcmVoZW5zaXZlIHRlc3QgcGxhbnMgYW5kIHJlcG9ydCBpc3N1ZXMgY2xlYXJseS5gLFxuICBtb2RlbDogd3JhcExhbmd1YWdlTW9kZWwoe1xuICAgIG1vZGVsOiBnYXRld2F5KFwiZ3B0LTRcIiksXG4gIH0pLFxuICAvLyBUZXN0aW5nIHRvb2xzIHdvdWxkIGJlIGFkZGVkIGhlcmVcbiAgLy8gdG9vbHM6IHsgcnVuVGVzdHM6IHRlc3RTdWl0ZVRvb2wsIGZpbGVSZXBvcnQ6IGJ1Z1JlcG9ydFRvb2wgfSxcbn0pO1xuXG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgTGlnaHRmYXN0IGNvbmZpZ3VyYXRpb25cbmNvbnN0IGxpZ2h0ZmFzdCA9IGNyZWF0ZUxpZ2h0ZmFzdCh7XG4gIGFnZW50czoge1xuICAgIGN1c3RvbWVyU3VwcG9ydDogY3VzdG9tZXJTdXBwb3J0QWdlbnQsXG4gICAgY29kZVJldmlld2VyOiBjb2RlUmV2aWV3QWdlbnQsXG4gICAgZGF0YUFuYWx5c3Q6IGRhdGFBbmFseXN0QWdlbnQsXG4gICAgY29udGVudFdyaXRlcjogY29udGVudFdyaXRlckFnZW50LFxuICAgIGNvZGVHZW5lcmF0b3I6IGNvZGVHZW5lcmF0b3JBZ2VudCxcbiAgICBxYVRlc3RlcjogcWFUZXN0QWdlbnQsXG4gIH0sXG4gIG1ldGFkYXRhOiB7XG4gICAgbmFtZTogXCJBZ2VudCBDaGF0IEV4YW1wbGVcIixcbiAgICB2ZXJzaW9uOiBcIjEuMC4wXCIsXG4gICAgZGVzY3JpcHRpb246IFwiRXhhbXBsZSBwcm9qZWN0IGRlbW9uc3RyYXRpbmcgbXVsdGlwbGUgQUkgYWdlbnRzIHdpdGggTGlnaHRmYXN0XCIsXG4gIH0sXG4gIGRldjoge1xuICAgIHBvcnQ6IDMwMDAsXG4gICAgaG90UmVsb2FkOiB0cnVlLFxuICAgIHZlcmJvc2U6IGZhbHNlLFxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGxpZ2h0ZmFzdDsiLCAiLyoqXG4gKiBTeW1ib2wgdXNlZCBmb3IgaWRlbnRpZnlpbmcgQUkgU0RLIEVycm9yIGluc3RhbmNlcy5cbiAqIEVuYWJsZXMgY2hlY2tpbmcgaWYgYW4gZXJyb3IgaXMgYW4gaW5zdGFuY2Ugb2YgQUlTREtFcnJvciBhY3Jvc3MgcGFja2FnZSB2ZXJzaW9ucy5cbiAqL1xuY29uc3QgbWFya2VyID0gJ3ZlcmNlbC5haS5lcnJvcic7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogQ3VzdG9tIGVycm9yIGNsYXNzIGZvciBBSSBTREsgcmVsYXRlZCBlcnJvcnMuXG4gKiBAZXh0ZW5kcyBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgQUlTREtFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIC8qKlxuICAgKiBUaGUgdW5kZXJseWluZyBjYXVzZSBvZiB0aGUgZXJyb3IsIGlmIGFueS5cbiAgICovXG4gIHJlYWRvbmx5IGNhdXNlPzogdW5rbm93bjtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBBSSBTREsgRXJyb3IuXG4gICAqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBUaGUgcGFyYW1ldGVycyBmb3IgY3JlYXRpbmcgdGhlIGVycm9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zLm5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgZXJyb3IuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMubWVzc2FnZSAtIFRoZSBlcnJvciBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3Vua25vd259IFtwYXJhbXMuY2F1c2VdIC0gVGhlIHVuZGVybHlpbmcgY2F1c2Ugb2YgdGhlIGVycm9yLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG5hbWUsXG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVycm9yIGlzIGFuIEFJIFNESyBFcnJvci5cbiAgICogQHBhcmFtIHt1bmtub3dufSBlcnJvciAtIFRoZSBlcnJvciB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVycm9yIGlzIGFuIEFJIFNESyBFcnJvciwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBBSVNES0Vycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cblxuICBwcm90ZWN0ZWQgc3RhdGljIGhhc01hcmtlcihlcnJvcjogdW5rbm93biwgbWFya2VyOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBtYXJrZXJTeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG4gICAgcmV0dXJuIChcbiAgICAgIGVycm9yICE9IG51bGwgJiZcbiAgICAgIHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiZcbiAgICAgIG1hcmtlclN5bWJvbCBpbiBlcnJvciAmJlxuICAgICAgdHlwZW9mIGVycm9yW21hcmtlclN5bWJvbF0gPT09ICdib29sZWFuJyAmJlxuICAgICAgZXJyb3JbbWFya2VyU3ltYm9sXSA9PT0gdHJ1ZVxuICAgICk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0FJX0FQSUNhbGxFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgQVBJQ2FsbEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSB1cmw6IHN0cmluZztcbiAgcmVhZG9ubHkgcmVxdWVzdEJvZHlWYWx1ZXM6IHVua25vd247XG4gIHJlYWRvbmx5IHN0YXR1c0NvZGU/OiBudW1iZXI7XG5cbiAgcmVhZG9ubHkgcmVzcG9uc2VIZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgcmVhZG9ubHkgcmVzcG9uc2VCb2R5Pzogc3RyaW5nO1xuXG4gIHJlYWRvbmx5IGlzUmV0cnlhYmxlOiBib29sZWFuO1xuICByZWFkb25seSBkYXRhPzogdW5rbm93bjtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSxcbiAgICB1cmwsXG4gICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgc3RhdHVzQ29kZSxcbiAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgcmVzcG9uc2VCb2R5LFxuICAgIGNhdXNlLFxuICAgIGlzUmV0cnlhYmxlID0gc3RhdHVzQ29kZSAhPSBudWxsICYmXG4gICAgICAoc3RhdHVzQ29kZSA9PT0gNDA4IHx8IC8vIHJlcXVlc3QgdGltZW91dFxuICAgICAgICBzdGF0dXNDb2RlID09PSA0MDkgfHwgLy8gY29uZmxpY3RcbiAgICAgICAgc3RhdHVzQ29kZSA9PT0gNDI5IHx8IC8vIHRvbyBtYW55IHJlcXVlc3RzXG4gICAgICAgIHN0YXR1c0NvZGUgPj0gNTAwKSwgLy8gc2VydmVyIGVycm9yXG4gICAgZGF0YSxcbiAgfToge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgICByZXF1ZXN0Qm9keVZhbHVlczogdW5rbm93bjtcbiAgICBzdGF0dXNDb2RlPzogbnVtYmVyO1xuICAgIHJlc3BvbnNlSGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgcmVzcG9uc2VCb2R5Pzogc3RyaW5nO1xuICAgIGNhdXNlPzogdW5rbm93bjtcbiAgICBpc1JldHJ5YWJsZT86IGJvb2xlYW47XG4gICAgZGF0YT86IHVua25vd247XG4gIH0pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UsIGNhdXNlIH0pO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5yZXF1ZXN0Qm9keVZhbHVlcyA9IHJlcXVlc3RCb2R5VmFsdWVzO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgdGhpcy5yZXNwb25zZUhlYWRlcnMgPSByZXNwb25zZUhlYWRlcnM7XG4gICAgdGhpcy5yZXNwb25zZUJvZHkgPSByZXNwb25zZUJvZHk7XG4gICAgdGhpcy5pc1JldHJ5YWJsZSA9IGlzUmV0cnlhYmxlO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEFQSUNhbGxFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9FbXB0eVJlc3BvbnNlQm9keUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBFbXB0eVJlc3BvbnNlQm9keUVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgPSAnRW1wdHkgcmVzcG9uc2UgYm9keScgfTogeyBtZXNzYWdlPzogc3RyaW5nIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgRW1wdHlSZXNwb25zZUJvZHlFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZShlcnJvcjogdW5rbm93biB8IHVuZGVmaW5lZCkge1xuICBpZiAoZXJyb3IgPT0gbnVsbCkge1xuICAgIHJldHVybiAndW5rbm93biBlcnJvcic7XG4gIH1cblxuICBpZiAodHlwZW9mIGVycm9yID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgcmV0dXJuIGVycm9yLm1lc3NhZ2U7XG4gIH1cblxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZXJyb3IpO1xufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZEFyZ3VtZW50RXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIGFyZ3VtZW50IGlzIGludmFsaWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnZhbGlkQXJndW1lbnRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgYXJndW1lbnQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgICBhcmd1bWVudCxcbiAgfToge1xuICAgIGFyZ3VtZW50OiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIGNhdXNlPzogdW5rbm93bjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLmFyZ3VtZW50ID0gYXJndW1lbnQ7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEludmFsaWRBcmd1bWVudEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0FJX0ludmFsaWRQcm9tcHRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG4vKipcbiAqIEEgcHJvbXB0IGlzIGludmFsaWQuIFRoaXMgZXJyb3Igc2hvdWxkIGJlIHRocm93biBieSBwcm92aWRlcnMgd2hlbiB0aGV5IGNhbm5vdFxuICogcHJvY2VzcyBhIHByb21wdC5cbiAqL1xuZXhwb3J0IGNsYXNzIEludmFsaWRQcm9tcHRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcHJvbXB0OiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBwcm9tcHQsXG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIHByb21wdDogdW5rbm93bjtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlOiBgSW52YWxpZCBwcm9tcHQ6ICR7bWVzc2FnZX1gLCBjYXVzZSB9KTtcblxuICAgIHRoaXMucHJvbXB0ID0gcHJvbXB0O1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBJbnZhbGlkUHJvbXB0RXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogU2VydmVyIHJldHVybmVkIGEgcmVzcG9uc2Ugd2l0aCBpbnZhbGlkIGRhdGEgY29udGVudC5cbiAqIFRoaXMgc2hvdWxkIGJlIHRocm93biBieSBwcm92aWRlcnMgd2hlbiB0aGV5IGNhbm5vdCBwYXJzZSB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgQVBJLlxuICovXG5leHBvcnQgY2xhc3MgSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBkYXRhOiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBkYXRhLFxuICAgIG1lc3NhZ2UgPSBgSW52YWxpZCByZXNwb25zZSBkYXRhOiAke0pTT04uc3RyaW5naWZ5KGRhdGEpfS5gLFxuICB9OiB7XG4gICAgZGF0YTogdW5rbm93bjtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuXG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuaW1wb3J0IHsgZ2V0RXJyb3JNZXNzYWdlIH0gZnJvbSAnLi9nZXQtZXJyb3ItbWVzc2FnZSc7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSlNPTlBhcnNlRXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLy8gVE9ETyB2NTogcmVuYW1lIHRvIFBhcnNlRXJyb3JcbmV4cG9ydCBjbGFzcyBKU09OUGFyc2VFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdGV4dDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHsgdGV4dCwgY2F1c2UgfTogeyB0ZXh0OiBzdHJpbmc7IGNhdXNlOiB1bmtub3duIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lLFxuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYEpTT04gcGFyc2luZyBmYWlsZWQ6IGAgK1xuICAgICAgICBgVGV4dDogJHt0ZXh0fS5cXG5gICtcbiAgICAgICAgYEVycm9yIG1lc3NhZ2U6ICR7Z2V0RXJyb3JNZXNzYWdlKGNhdXNlKX1gLFxuICAgICAgY2F1c2UsXG4gICAgfSk7XG5cbiAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBKU09OUGFyc2VFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Mb2FkQVBJS2V5RXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGNsYXNzIExvYWRBUElLZXlFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgY29uc3RydWN0b3IoeyBtZXNzYWdlIH06IHsgbWVzc2FnZTogc3RyaW5nIH0pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UgfSk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIExvYWRBUElLZXlFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Mb2FkU2V0dGluZ0Vycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBMb2FkU2V0dGluZ0Vycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgfTogeyBtZXNzYWdlOiBzdHJpbmcgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgTG9hZFNldHRpbmdFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob0NvbnRlbnRHZW5lcmF0ZWRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG4vKipcblRocm93biB3aGVuIHRoZSBBSSBwcm92aWRlciBmYWlscyB0byBnZW5lcmF0ZSBhbnkgY29udGVudC5cbiAqL1xuZXhwb3J0IGNsYXNzIE5vQ29udGVudEdlbmVyYXRlZEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdObyBjb250ZW50IGdlbmVyYXRlZC4nLFxuICB9OiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSA9IHt9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBOb0NvbnRlbnRHZW5lcmF0ZWRFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob1N1Y2hNb2RlbEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBOb1N1Y2hNb2RlbEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBtb2RlbElkOiBzdHJpbmc7XG4gIHJlYWRvbmx5IG1vZGVsVHlwZTpcbiAgICB8ICdsYW5ndWFnZU1vZGVsJ1xuICAgIHwgJ3RleHRFbWJlZGRpbmdNb2RlbCdcbiAgICB8ICdpbWFnZU1vZGVsJ1xuICAgIHwgJ3RyYW5zY3JpcHRpb25Nb2RlbCdcbiAgICB8ICdzcGVlY2hNb2RlbCc7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIGVycm9yTmFtZSA9IG5hbWUsXG4gICAgbW9kZWxJZCxcbiAgICBtb2RlbFR5cGUsXG4gICAgbWVzc2FnZSA9IGBObyBzdWNoICR7bW9kZWxUeXBlfTogJHttb2RlbElkfWAsXG4gIH06IHtcbiAgICBlcnJvck5hbWU/OiBzdHJpbmc7XG4gICAgbW9kZWxJZDogc3RyaW5nO1xuICAgIG1vZGVsVHlwZTpcbiAgICAgIHwgJ2xhbmd1YWdlTW9kZWwnXG4gICAgICB8ICd0ZXh0RW1iZWRkaW5nTW9kZWwnXG4gICAgICB8ICdpbWFnZU1vZGVsJ1xuICAgICAgfCAndHJhbnNjcmlwdGlvbk1vZGVsJ1xuICAgICAgfCAnc3BlZWNoTW9kZWwnO1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gIH0pIHtcbiAgICBzdXBlcih7IG5hbWU6IGVycm9yTmFtZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5tb2RlbFR5cGUgPSBtb2RlbFR5cGU7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vU3VjaE1vZGVsRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcHJvdmlkZXI6IHN0cmluZztcbiAgcmVhZG9ubHkgbW9kZWxJZDogc3RyaW5nO1xuICByZWFkb25seSBtYXhFbWJlZGRpbmdzUGVyQ2FsbDogbnVtYmVyO1xuICByZWFkb25seSB2YWx1ZXM6IEFycmF5PHVua25vd24+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHtcbiAgICBwcm92aWRlcjogc3RyaW5nO1xuICAgIG1vZGVsSWQ6IHN0cmluZztcbiAgICBtYXhFbWJlZGRpbmdzUGVyQ2FsbDogbnVtYmVyO1xuICAgIHZhbHVlczogQXJyYXk8dW5rbm93bj47XG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lLFxuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYFRvbyBtYW55IHZhbHVlcyBmb3IgYSBzaW5nbGUgZW1iZWRkaW5nIGNhbGwuIGAgK1xuICAgICAgICBgVGhlICR7b3B0aW9ucy5wcm92aWRlcn0gbW9kZWwgXCIke29wdGlvbnMubW9kZWxJZH1cIiBjYW4gb25seSBlbWJlZCB1cCB0byBgICtcbiAgICAgICAgYCR7b3B0aW9ucy5tYXhFbWJlZGRpbmdzUGVyQ2FsbH0gdmFsdWVzIHBlciBjYWxsLCBidXQgJHtvcHRpb25zLnZhbHVlcy5sZW5ndGh9IHZhbHVlcyB3ZXJlIHByb3ZpZGVkLmAsXG4gICAgfSk7XG5cbiAgICB0aGlzLnByb3ZpZGVyID0gb3B0aW9ucy5wcm92aWRlcjtcbiAgICB0aGlzLm1vZGVsSWQgPSBvcHRpb25zLm1vZGVsSWQ7XG4gICAgdGhpcy5tYXhFbWJlZGRpbmdzUGVyQ2FsbCA9IG9wdGlvbnMubWF4RW1iZWRkaW5nc1BlckNhbGw7XG4gICAgdGhpcy52YWx1ZXMgPSBvcHRpb25zLnZhbHVlcztcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKFxuICAgIGVycm9yOiB1bmtub3duLFxuICApOiBlcnJvciBpcyBUb29NYW55RW1iZWRkaW5nVmFsdWVzRm9yQ2FsbEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuaW1wb3J0IHsgZ2V0RXJyb3JNZXNzYWdlIH0gZnJvbSAnLi9nZXQtZXJyb3ItbWVzc2FnZSc7XG5cbmNvbnN0IG5hbWUgPSAnQUlfVHlwZVZhbGlkYXRpb25FcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVHlwZVZhbGlkYXRpb25FcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdmFsdWU6IHVua25vd247XG5cbiAgY29uc3RydWN0b3IoeyB2YWx1ZSwgY2F1c2UgfTogeyB2YWx1ZTogdW5rbm93bjsgY2F1c2U6IHVua25vd24gfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG5hbWUsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICBgVHlwZSB2YWxpZGF0aW9uIGZhaWxlZDogYCArXG4gICAgICAgIGBWYWx1ZTogJHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9LlxcbmAgK1xuICAgICAgICBgRXJyb3IgbWVzc2FnZTogJHtnZXRFcnJvck1lc3NhZ2UoY2F1c2UpfWAsXG4gICAgICBjYXVzZSxcbiAgICB9KTtcblxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgVHlwZVZhbGlkYXRpb25FcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdyYXBzIGFuIGVycm9yIGludG8gYSBUeXBlVmFsaWRhdGlvbkVycm9yLlxuICAgKiBJZiB0aGUgY2F1c2UgaXMgYWxyZWFkeSBhIFR5cGVWYWxpZGF0aW9uRXJyb3Igd2l0aCB0aGUgc2FtZSB2YWx1ZSwgaXQgcmV0dXJucyB0aGUgY2F1c2UuXG4gICAqIE90aGVyd2lzZSwgaXQgY3JlYXRlcyBhIG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yLlxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gVGhlIHBhcmFtZXRlcnMgZm9yIHdyYXBwaW5nIHRoZSBlcnJvci5cbiAgICogQHBhcmFtIHt1bmtub3dufSBwYXJhbXMudmFsdWUgLSBUaGUgdmFsdWUgdGhhdCBmYWlsZWQgdmFsaWRhdGlvbi5cbiAgICogQHBhcmFtIHt1bmtub3dufSBwYXJhbXMuY2F1c2UgLSBUaGUgb3JpZ2luYWwgZXJyb3Igb3IgY2F1c2Ugb2YgdGhlIHZhbGlkYXRpb24gZmFpbHVyZS5cbiAgICogQHJldHVybnMge1R5cGVWYWxpZGF0aW9uRXJyb3J9IEEgVHlwZVZhbGlkYXRpb25FcnJvciBpbnN0YW5jZS5cbiAgICovXG4gIHN0YXRpYyB3cmFwKHtcbiAgICB2YWx1ZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIHZhbHVlOiB1bmtub3duO1xuICAgIGNhdXNlOiB1bmtub3duO1xuICB9KTogVHlwZVZhbGlkYXRpb25FcnJvciB7XG4gICAgcmV0dXJuIFR5cGVWYWxpZGF0aW9uRXJyb3IuaXNJbnN0YW5jZShjYXVzZSkgJiYgY2F1c2UudmFsdWUgPT09IHZhbHVlXG4gICAgICA/IGNhdXNlXG4gICAgICA6IG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yKHsgdmFsdWUsIGNhdXNlIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9VbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVW5zdXBwb3J0ZWRGdW5jdGlvbmFsaXR5RXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIHJlYWRvbmx5IGZ1bmN0aW9uYWxpdHk6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgZnVuY3Rpb25hbGl0eSxcbiAgICBtZXNzYWdlID0gYCcke2Z1bmN0aW9uYWxpdHl9JyBmdW5jdGlvbmFsaXR5IG5vdCBzdXBwb3J0ZWQuYCxcbiAgfToge1xuICAgIGZ1bmN0aW9uYWxpdHk6IHN0cmluZztcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuICAgIHRoaXMuZnVuY3Rpb25hbGl0eSA9IGZ1bmN0aW9uYWxpdHk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBKU09OQXJyYXksIEpTT05PYmplY3QsIEpTT05WYWx1ZSB9IGZyb20gJy4vanNvbi12YWx1ZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0pTT05WYWx1ZSh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEpTT05WYWx1ZSB7XG4gIGlmIChcbiAgICB2YWx1ZSA9PT0gbnVsbCB8fFxuICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHxcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8XG4gICAgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbidcbiAgKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWUuZXZlcnkoaXNKU09OVmFsdWUpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXModmFsdWUpLmV2ZXJ5KFxuICAgICAgKFtrZXksIHZhbF0pID0+IHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGlzSlNPTlZhbHVlKHZhbCksXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSlNPTkFycmF5KHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgSlNPTkFycmF5IHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmV2ZXJ5KGlzSlNPTlZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSlNPTk9iamVjdCh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEpTT05PYmplY3Qge1xuICByZXR1cm4gKFxuICAgIHZhbHVlICE9IG51bGwgJiZcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgT2JqZWN0LmVudHJpZXModmFsdWUpLmV2ZXJ5KFxuICAgICAgKFtrZXksIHZhbF0pID0+IHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGlzSlNPTlZhbHVlKHZhbCksXG4gICAgKVxuICApO1xufVxuIiwgIi8qKlxuICogVGhlIHR5cGUgb2YgZXJyb3IgdGhhdCBvY2N1cnJlZC5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IHR5cGUgRXJyb3JUeXBlID0gJ2ludmFsaWQtcmV0cnknIHwgJ3Vua25vd24tZmllbGQnXG5cbi8qKlxuICogRXJyb3IgdGhyb3duIHdoZW4gZW5jb3VudGVyaW5nIGFuIGlzc3VlIGR1cmluZyBwYXJzaW5nLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFBhcnNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBlcnJvciB0aGF0IG9jY3VycmVkLlxuICAgKi9cbiAgdHlwZTogRXJyb3JUeXBlXG5cbiAgLyoqXG4gICAqIEluIHRoZSBjYXNlIG9mIGFuIHVua25vd24gZmllbGQgZW5jb3VudGVyZWQgaW4gdGhlIHN0cmVhbSwgdGhpcyB3aWxsIGJlIHRoZSBmaWVsZCBuYW1lLlxuICAgKi9cbiAgZmllbGQ/OiBzdHJpbmdcblxuICAvKipcbiAgICogSW4gdGhlIGNhc2Ugb2YgYW4gdW5rbm93biBmaWVsZCBlbmNvdW50ZXJlZCBpbiB0aGUgc3RyZWFtLCB0aGlzIHdpbGwgYmUgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZC5cbiAgICovXG4gIHZhbHVlPzogc3RyaW5nXG5cbiAgLyoqXG4gICAqIFRoZSBsaW5lIHRoYXQgY2F1c2VkIHRoZSBlcnJvciwgaWYgYXZhaWxhYmxlLlxuICAgKi9cbiAgbGluZT86IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBvcHRpb25zOiB7dHlwZTogRXJyb3JUeXBlOyBmaWVsZD86IHN0cmluZzsgdmFsdWU/OiBzdHJpbmc7IGxpbmU/OiBzdHJpbmd9LFxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKVxuICAgIHRoaXMubmFtZSA9ICdQYXJzZUVycm9yJ1xuICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZVxuICAgIHRoaXMuZmllbGQgPSBvcHRpb25zLmZpZWxkXG4gICAgdGhpcy52YWx1ZSA9IG9wdGlvbnMudmFsdWVcbiAgICB0aGlzLmxpbmUgPSBvcHRpb25zLmxpbmVcbiAgfVxufVxuIiwgIi8qKlxuICogRXZlbnRTb3VyY2UvU2VydmVyLVNlbnQgRXZlbnRzIHBhcnNlclxuICogQHNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zZXJ2ZXItc2VudC1ldmVudHMuaHRtbFxuICovXG5pbXBvcnQge1BhcnNlRXJyb3J9IGZyb20gJy4vZXJyb3JzLnRzJ1xuaW1wb3J0IHR5cGUge0V2ZW50U291cmNlUGFyc2VyLCBQYXJzZXJDYWxsYmFja3N9IGZyb20gJy4vdHlwZXMudHMnXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbmZ1bmN0aW9uIG5vb3AoX2FyZzogdW5rbm93bikge1xuICAvLyBpbnRlbnRpb25hbCBub29wXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBFdmVudFNvdXJjZSBwYXJzZXIuXG4gKlxuICogQHBhcmFtIGNhbGxiYWNrcyAtIENhbGxiYWNrcyB0byBpbnZva2Ugb24gZGlmZmVyZW50IHBhcnNpbmcgZXZlbnRzOlxuICogICAtIGBvbkV2ZW50YCB3aGVuIGEgbmV3IGV2ZW50IGlzIHBhcnNlZFxuICogICAtIGBvbkVycm9yYCB3aGVuIGFuIGVycm9yIG9jY3Vyc1xuICogICAtIGBvblJldHJ5YCB3aGVuIGEgbmV3IHJlY29ubmVjdGlvbiBpbnRlcnZhbCBoYXMgYmVlbiBzZW50IGZyb20gdGhlIHNlcnZlclxuICogICAtIGBvbkNvbW1lbnRgIHdoZW4gYSBjb21tZW50IGlzIGVuY291bnRlcmVkIGluIHRoZSBzdHJlYW1cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyBFdmVudFNvdXJjZSBwYXJzZXIsIHdpdGggYHBhcnNlYCBhbmQgYHJlc2V0YCBtZXRob2RzLlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUGFyc2VyKGNhbGxiYWNrczogUGFyc2VyQ2FsbGJhY2tzKTogRXZlbnRTb3VyY2VQYXJzZXIge1xuICBpZiAodHlwZW9mIGNhbGxiYWNrcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAnYGNhbGxiYWNrc2AgbXVzdCBiZSBhbiBvYmplY3QsIGdvdCBhIGZ1bmN0aW9uIGluc3RlYWQuIERpZCB5b3UgbWVhbiBge29uRXZlbnQ6IGZufWA/JyxcbiAgICApXG4gIH1cblxuICBjb25zdCB7b25FdmVudCA9IG5vb3AsIG9uRXJyb3IgPSBub29wLCBvblJldHJ5ID0gbm9vcCwgb25Db21tZW50fSA9IGNhbGxiYWNrc1xuXG4gIGxldCBpbmNvbXBsZXRlTGluZSA9ICcnXG5cbiAgbGV0IGlzRmlyc3RDaHVuayA9IHRydWVcbiAgbGV0IGlkOiBzdHJpbmcgfCB1bmRlZmluZWRcbiAgbGV0IGRhdGEgPSAnJ1xuICBsZXQgZXZlbnRUeXBlID0gJydcblxuICBmdW5jdGlvbiBmZWVkKG5ld0NodW5rOiBzdHJpbmcpIHtcbiAgICAvLyBTdHJpcCBhbnkgVVRGOCBieXRlIG9yZGVyIG1hcmsgKEJPTSkgYXQgdGhlIHN0YXJ0IG9mIHRoZSBzdHJlYW1cbiAgICBjb25zdCBjaHVuayA9IGlzRmlyc3RDaHVuayA/IG5ld0NodW5rLnJlcGxhY2UoL15cXHhFRlxceEJCXFx4QkYvLCAnJykgOiBuZXdDaHVua1xuXG4gICAgLy8gSWYgdGhlcmUgd2FzIGEgcHJldmlvdXMgaW5jb21wbGV0ZSBsaW5lLCBhcHBlbmQgaXQgdG8gdGhlIG5ldyBjaHVuayxcbiAgICAvLyBzbyB3ZSBtYXkgcHJvY2VzcyBpdCB0b2dldGhlciBhcyBhIG5ldyAoaG9wZWZ1bGx5IGNvbXBsZXRlKSBjaHVuay5cbiAgICBjb25zdCBbY29tcGxldGUsIGluY29tcGxldGVdID0gc3BsaXRMaW5lcyhgJHtpbmNvbXBsZXRlTGluZX0ke2NodW5rfWApXG5cbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgY29tcGxldGUpIHtcbiAgICAgIHBhcnNlTGluZShsaW5lKVxuICAgIH1cblxuICAgIGluY29tcGxldGVMaW5lID0gaW5jb21wbGV0ZVxuICAgIGlzRmlyc3RDaHVuayA9IGZhbHNlXG4gIH1cblxuICBmdW5jdGlvbiBwYXJzZUxpbmUobGluZTogc3RyaW5nKSB7XG4gICAgLy8gSWYgdGhlIGxpbmUgaXMgZW1wdHkgKGEgYmxhbmsgbGluZSksIGRpc3BhdGNoIHRoZSBldmVudFxuICAgIGlmIChsaW5lID09PSAnJykge1xuICAgICAgZGlzcGF0Y2hFdmVudCgpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgbGluZSBzdGFydHMgd2l0aCBhIFUrMDAzQSBDT0xPTiBjaGFyYWN0ZXIgKDopLCBpZ25vcmUgdGhlIGxpbmUuXG4gICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnOicpKSB7XG4gICAgICBpZiAob25Db21tZW50KSB7XG4gICAgICAgIG9uQ29tbWVudChsaW5lLnNsaWNlKGxpbmUuc3RhcnRzV2l0aCgnOiAnKSA/IDIgOiAxKSlcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIElmIHRoZSBsaW5lIGNvbnRhaW5zIGEgVSswMDNBIENPTE9OIGNoYXJhY3RlciAoOilcbiAgICBjb25zdCBmaWVsZFNlcGFyYXRvckluZGV4ID0gbGluZS5pbmRleE9mKCc6JylcbiAgICBpZiAoZmllbGRTZXBhcmF0b3JJbmRleCAhPT0gLTEpIHtcbiAgICAgIC8vIENvbGxlY3QgdGhlIGNoYXJhY3RlcnMgb24gdGhlIGxpbmUgYmVmb3JlIHRoZSBmaXJzdCBVKzAwM0EgQ09MT04gY2hhcmFjdGVyICg6KSxcbiAgICAgIC8vIGFuZCBsZXQgYGZpZWxkYCBiZSB0aGF0IHN0cmluZy5cbiAgICAgIGNvbnN0IGZpZWxkID0gbGluZS5zbGljZSgwLCBmaWVsZFNlcGFyYXRvckluZGV4KVxuXG4gICAgICAvLyBDb2xsZWN0IHRoZSBjaGFyYWN0ZXJzIG9uIHRoZSBsaW5lIGFmdGVyIHRoZSBmaXJzdCBVKzAwM0EgQ09MT04gY2hhcmFjdGVyICg6KSxcbiAgICAgIC8vIGFuZCBsZXQgYHZhbHVlYCBiZSB0aGF0IHN0cmluZy4gSWYgdmFsdWUgc3RhcnRzIHdpdGggYSBVKzAwMjAgU1BBQ0UgY2hhcmFjdGVyLFxuICAgICAgLy8gcmVtb3ZlIGl0IGZyb20gdmFsdWUuXG4gICAgICBjb25zdCBvZmZzZXQgPSBsaW5lW2ZpZWxkU2VwYXJhdG9ySW5kZXggKyAxXSA9PT0gJyAnID8gMiA6IDFcbiAgICAgIGNvbnN0IHZhbHVlID0gbGluZS5zbGljZShmaWVsZFNlcGFyYXRvckluZGV4ICsgb2Zmc2V0KVxuXG4gICAgICBwcm9jZXNzRmllbGQoZmllbGQsIHZhbHVlLCBsaW5lKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlLCB0aGUgc3RyaW5nIGlzIG5vdCBlbXB0eSBidXQgZG9lcyBub3QgY29udGFpbiBhIFUrMDAzQSBDT0xPTiBjaGFyYWN0ZXIgKDopXG4gICAgLy8gUHJvY2VzcyB0aGUgZmllbGQgdXNpbmcgdGhlIHdob2xlIGxpbmUgYXMgdGhlIGZpZWxkIG5hbWUsIGFuZCBhbiBlbXB0eSBzdHJpbmcgYXMgdGhlIGZpZWxkIHZhbHVlLlxuICAgIC8vIPCfkYYgVGhpcyBpcyBhY2NvcmRpbmcgdG8gc3BlYy4gVGhhdCBtZWFucyB0aGF0IGEgbGluZSB0aGF0IGhhcyB0aGUgdmFsdWUgYGRhdGFgIHdpbGwgcmVzdWx0IGluXG4gICAgLy8gYSBuZXdsaW5lIGJlaW5nIGFkZGVkIHRvIHRoZSBjdXJyZW50IGBkYXRhYCBidWZmZXIsIGZvciBpbnN0YW5jZS5cbiAgICBwcm9jZXNzRmllbGQobGluZSwgJycsIGxpbmUpXG4gIH1cblxuICBmdW5jdGlvbiBwcm9jZXNzRmllbGQoZmllbGQ6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZTogc3RyaW5nKSB7XG4gICAgLy8gRmllbGQgbmFtZXMgbXVzdCBiZSBjb21wYXJlZCBsaXRlcmFsbHksIHdpdGggbm8gY2FzZSBmb2xkaW5nIHBlcmZvcm1lZC5cbiAgICBzd2l0Y2ggKGZpZWxkKSB7XG4gICAgICBjYXNlICdldmVudCc6XG4gICAgICAgIC8vIFNldCB0aGUgYGV2ZW50IHR5cGVgIGJ1ZmZlciB0byBmaWVsZCB2YWx1ZVxuICAgICAgICBldmVudFR5cGUgPSB2YWx1ZVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZGF0YSc6XG4gICAgICAgIC8vIEFwcGVuZCB0aGUgZmllbGQgdmFsdWUgdG8gdGhlIGBkYXRhYCBidWZmZXIsIHRoZW4gYXBwZW5kIGEgc2luZ2xlIFUrMDAwQSBMSU5FIEZFRUQoTEYpXG4gICAgICAgIC8vIGNoYXJhY3RlciB0byB0aGUgYGRhdGFgIGJ1ZmZlci5cbiAgICAgICAgZGF0YSA9IGAke2RhdGF9JHt2YWx1ZX1cXG5gXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdpZCc6XG4gICAgICAgIC8vIElmIHRoZSBmaWVsZCB2YWx1ZSBkb2VzIG5vdCBjb250YWluIFUrMDAwMCBOVUxMLCB0aGVuIHNldCB0aGUgYElEYCBidWZmZXIgdG9cbiAgICAgICAgLy8gdGhlIGZpZWxkIHZhbHVlLiBPdGhlcndpc2UsIGlnbm9yZSB0aGUgZmllbGQuXG4gICAgICAgIGlkID0gdmFsdWUuaW5jbHVkZXMoJ1xcMCcpID8gdW5kZWZpbmVkIDogdmFsdWVcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3JldHJ5JzpcbiAgICAgICAgLy8gSWYgdGhlIGZpZWxkIHZhbHVlIGNvbnNpc3RzIG9mIG9ubHkgQVNDSUkgZGlnaXRzLCB0aGVuIGludGVycHJldCB0aGUgZmllbGQgdmFsdWUgYXMgYW5cbiAgICAgICAgLy8gaW50ZWdlciBpbiBiYXNlIHRlbiwgYW5kIHNldCB0aGUgZXZlbnQgc3RyZWFtJ3MgcmVjb25uZWN0aW9uIHRpbWUgdG8gdGhhdCBpbnRlZ2VyLlxuICAgICAgICAvLyBPdGhlcndpc2UsIGlnbm9yZSB0aGUgZmllbGQuXG4gICAgICAgIGlmICgvXlxcZCskLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgIG9uUmV0cnkocGFyc2VJbnQodmFsdWUsIDEwKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvbkVycm9yKFxuICAgICAgICAgICAgbmV3IFBhcnNlRXJyb3IoYEludmFsaWQgXFxgcmV0cnlcXGAgdmFsdWU6IFwiJHt2YWx1ZX1cImAsIHtcbiAgICAgICAgICAgICAgdHlwZTogJ2ludmFsaWQtcmV0cnknLFxuICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgbGluZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGUgZmllbGQgaXMgaWdub3JlZC5cbiAgICAgICAgb25FcnJvcihcbiAgICAgICAgICBuZXcgUGFyc2VFcnJvcihcbiAgICAgICAgICAgIGBVbmtub3duIGZpZWxkIFwiJHtmaWVsZC5sZW5ndGggPiAyMCA/IGAke2ZpZWxkLnNsaWNlKDAsIDIwKX3igKZgIDogZmllbGR9XCJgLFxuICAgICAgICAgICAge3R5cGU6ICd1bmtub3duLWZpZWxkJywgZmllbGQsIHZhbHVlLCBsaW5lfSxcbiAgICAgICAgICApLFxuICAgICAgICApXG4gICAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZGlzcGF0Y2hFdmVudCgpIHtcbiAgICBjb25zdCBzaG91bGREaXNwYXRjaCA9IGRhdGEubGVuZ3RoID4gMFxuICAgIGlmIChzaG91bGREaXNwYXRjaCkge1xuICAgICAgb25FdmVudCh7XG4gICAgICAgIGlkLFxuICAgICAgICBldmVudDogZXZlbnRUeXBlIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgLy8gSWYgdGhlIGRhdGEgYnVmZmVyJ3MgbGFzdCBjaGFyYWN0ZXIgaXMgYSBVKzAwMEEgTElORSBGRUVEIChMRikgY2hhcmFjdGVyLFxuICAgICAgICAvLyB0aGVuIHJlbW92ZSB0aGUgbGFzdCBjaGFyYWN0ZXIgZnJvbSB0aGUgZGF0YSBidWZmZXIuXG4gICAgICAgIGRhdGE6IGRhdGEuZW5kc1dpdGgoJ1xcbicpID8gZGF0YS5zbGljZSgwLCAtMSkgOiBkYXRhLFxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBSZXNldCBmb3IgdGhlIG5leHQgZXZlbnRcbiAgICBpZCA9IHVuZGVmaW5lZFxuICAgIGRhdGEgPSAnJ1xuICAgIGV2ZW50VHlwZSA9ICcnXG4gIH1cblxuICBmdW5jdGlvbiByZXNldChvcHRpb25zOiB7Y29uc3VtZT86IGJvb2xlYW59ID0ge30pIHtcbiAgICBpZiAoaW5jb21wbGV0ZUxpbmUgJiYgb3B0aW9ucy5jb25zdW1lKSB7XG4gICAgICBwYXJzZUxpbmUoaW5jb21wbGV0ZUxpbmUpXG4gICAgfVxuXG4gICAgaXNGaXJzdENodW5rID0gdHJ1ZVxuICAgIGlkID0gdW5kZWZpbmVkXG4gICAgZGF0YSA9ICcnXG4gICAgZXZlbnRUeXBlID0gJydcbiAgICBpbmNvbXBsZXRlTGluZSA9ICcnXG4gIH1cblxuICByZXR1cm4ge2ZlZWQsIHJlc2V0fVxufVxuXG4vKipcbiAqIEZvciB0aGUgZ2l2ZW4gYGNodW5rYCwgc3BsaXQgaXQgaW50byBsaW5lcyBhY2NvcmRpbmcgdG8gc3BlYywgYW5kIHJldHVybiBhbnkgcmVtYWluaW5nIGluY29tcGxldGUgbGluZS5cbiAqXG4gKiBAcGFyYW0gY2h1bmsgLSBUaGUgY2h1bmsgdG8gc3BsaXQgaW50byBsaW5lc1xuICogQHJldHVybnMgQSB0dXBsZSBjb250YWluaW5nIGFuIGFycmF5IG9mIGNvbXBsZXRlIGxpbmVzLCBhbmQgYW55IHJlbWFpbmluZyBpbmNvbXBsZXRlIGxpbmVcbiAqIEBpbnRlcm5hbFxuICovXG5mdW5jdGlvbiBzcGxpdExpbmVzKGNodW5rOiBzdHJpbmcpOiBbY29tcGxldGU6IEFycmF5PHN0cmluZz4sIGluY29tcGxldGU6IHN0cmluZ10ge1xuICAvKipcbiAgICogQWNjb3JkaW5nIHRvIHRoZSBzcGVjLCBhIGxpbmUgaXMgdGVybWluYXRlZCBieSBlaXRoZXI6XG4gICAqIC0gVSswMDBEIENBUlJJQUdFIFJFVFVSTiBVKzAwMEEgTElORSBGRUVEIChDUkxGKSBjaGFyYWN0ZXIgcGFpclxuICAgKiAtIGEgc2luZ2xlIFUrMDAwQSBMSU5FIEZFRUQoTEYpIGNoYXJhY3RlciBub3QgcHJlY2VkZWQgYnkgYSBVKzAwMEQgQ0FSUklBR0UgUkVUVVJOKENSKSBjaGFyYWN0ZXJcbiAgICogLSBhIHNpbmdsZSBVKzAwMEQgQ0FSUklBR0UgUkVUVVJOKENSKSBjaGFyYWN0ZXIgbm90IGZvbGxvd2VkIGJ5IGEgVSswMDBBIExJTkUgRkVFRChMRikgY2hhcmFjdGVyXG4gICAqL1xuICBjb25zdCBsaW5lczogQXJyYXk8c3RyaW5nPiA9IFtdXG4gIGxldCBpbmNvbXBsZXRlTGluZSA9ICcnXG4gIGxldCBzZWFyY2hJbmRleCA9IDBcblxuICB3aGlsZSAoc2VhcmNoSW5kZXggPCBjaHVuay5sZW5ndGgpIHtcbiAgICAvLyBGaW5kIG5leHQgbGluZSB0ZXJtaW5hdG9yXG4gICAgY29uc3QgY3JJbmRleCA9IGNodW5rLmluZGV4T2YoJ1xccicsIHNlYXJjaEluZGV4KVxuICAgIGNvbnN0IGxmSW5kZXggPSBjaHVuay5pbmRleE9mKCdcXG4nLCBzZWFyY2hJbmRleClcblxuICAgIC8vIERldGVybWluZSBsaW5lIGVuZFxuICAgIGxldCBsaW5lRW5kID0gLTFcbiAgICBpZiAoY3JJbmRleCAhPT0gLTEgJiYgbGZJbmRleCAhPT0gLTEpIHtcbiAgICAgIC8vIENSTEYgY2FzZVxuICAgICAgbGluZUVuZCA9IE1hdGgubWluKGNySW5kZXgsIGxmSW5kZXgpXG4gICAgfSBlbHNlIGlmIChjckluZGV4ICE9PSAtMSkge1xuICAgICAgbGluZUVuZCA9IGNySW5kZXhcbiAgICB9IGVsc2UgaWYgKGxmSW5kZXggIT09IC0xKSB7XG4gICAgICBsaW5lRW5kID0gbGZJbmRleFxuICAgIH1cblxuICAgIC8vIEV4dHJhY3QgbGluZSBpZiB0ZXJtaW5hdG9yIGZvdW5kXG4gICAgaWYgKGxpbmVFbmQgPT09IC0xKSB7XG4gICAgICAvLyBObyB0ZXJtaW5hdG9yIGZvdW5kLCByZXN0IGlzIGluY29tcGxldGVcbiAgICAgIGluY29tcGxldGVMaW5lID0gY2h1bmsuc2xpY2Uoc2VhcmNoSW5kZXgpXG4gICAgICBicmVha1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsaW5lID0gY2h1bmsuc2xpY2Uoc2VhcmNoSW5kZXgsIGxpbmVFbmQpXG4gICAgICBsaW5lcy5wdXNoKGxpbmUpXG5cbiAgICAgIC8vIE1vdmUgcGFzdCBsaW5lIHRlcm1pbmF0b3JcbiAgICAgIHNlYXJjaEluZGV4ID0gbGluZUVuZCArIDFcbiAgICAgIGlmIChjaHVua1tzZWFyY2hJbmRleCAtIDFdID09PSAnXFxyJyAmJiBjaHVua1tzZWFyY2hJbmRleF0gPT09ICdcXG4nKSB7XG4gICAgICAgIHNlYXJjaEluZGV4KytcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gW2xpbmVzLCBpbmNvbXBsZXRlTGluZV1cbn1cbiIsICJpbXBvcnQge2NyZWF0ZVBhcnNlcn0gZnJvbSAnLi9wYXJzZS50cydcbmltcG9ydCB0eXBlIHtFdmVudFNvdXJjZU1lc3NhZ2UsIEV2ZW50U291cmNlUGFyc2VyfSBmcm9tICcuL3R5cGVzLnRzJ1xuXG4vKipcbiAqIE9wdGlvbnMgZm9yIHRoZSBFdmVudFNvdXJjZVBhcnNlclN0cmVhbS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RyZWFtT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBCZWhhdmlvciB3aGVuIGEgcGFyc2luZyBlcnJvciBvY2N1cnMuXG4gICAqXG4gICAqIC0gQSBjdXN0b20gZnVuY3Rpb24gY2FuIGJlIHByb3ZpZGVkIHRvIGhhbmRsZSB0aGUgZXJyb3IuXG4gICAqIC0gYCd0ZXJtaW5hdGUnYCB3aWxsIGVycm9yIHRoZSBzdHJlYW0gYW5kIHN0b3AgcGFyc2luZy5cbiAgICogLSBBbnkgb3RoZXIgdmFsdWUgd2lsbCBpZ25vcmUgdGhlIGVycm9yIGFuZCBjb250aW51ZSBwYXJzaW5nLlxuICAgKlxuICAgKiBAZGVmYXVsdFZhbHVlIGB1bmRlZmluZWRgXG4gICAqL1xuICBvbkVycm9yPzogJ3Rlcm1pbmF0ZScgfCAoKGVycm9yOiBFcnJvcikgPT4gdm9pZClcblxuICAvKipcbiAgICogQ2FsbGJhY2sgZm9yIHdoZW4gYSByZWNvbm5lY3Rpb24gaW50ZXJ2YWwgaXMgc2VudCBmcm9tIHRoZSBzZXJ2ZXIuXG4gICAqXG4gICAqIEBwYXJhbSByZXRyeSAtIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHJlY29ubmVjdGluZy5cbiAgICovXG4gIG9uUmV0cnk/OiAocmV0cnk6IG51bWJlcikgPT4gdm9pZFxuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3Igd2hlbiBhIGNvbW1lbnQgaXMgZW5jb3VudGVyZWQgaW4gdGhlIHN0cmVhbS5cbiAgICpcbiAgICogQHBhcmFtIGNvbW1lbnQgLSBUaGUgY29tbWVudCBlbmNvdW50ZXJlZCBpbiB0aGUgc3RyZWFtLlxuICAgKi9cbiAgb25Db21tZW50PzogKGNvbW1lbnQ6IHN0cmluZykgPT4gdm9pZFxufVxuXG4vKipcbiAqIEEgVHJhbnNmb3JtU3RyZWFtIHRoYXQgaW5nZXN0cyBhIHN0cmVhbSBvZiBzdHJpbmdzIGFuZCBwcm9kdWNlcyBhIHN0cmVhbSBvZiBgRXZlbnRTb3VyY2VNZXNzYWdlYC5cbiAqXG4gKiBAZXhhbXBsZSBCYXNpYyB1c2FnZVxuICogYGBgXG4gKiBjb25zdCBldmVudFN0cmVhbSA9XG4gKiAgIHJlc3BvbnNlLmJvZHlcbiAqICAgICAucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKCkpXG4gKiAgICAgLnBpcGVUaHJvdWdoKG5ldyBFdmVudFNvdXJjZVBhcnNlclN0cmVhbSgpKVxuICogYGBgXG4gKlxuICogQGV4YW1wbGUgVGVybWluYXRlIHN0cmVhbSBvbiBwYXJzaW5nIGVycm9yc1xuICogYGBgXG4gKiBjb25zdCBldmVudFN0cmVhbSA9XG4gKiAgcmVzcG9uc2UuYm9keVxuICogICAucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKCkpXG4gKiAgIC5waXBlVGhyb3VnaChuZXcgRXZlbnRTb3VyY2VQYXJzZXJTdHJlYW0oe3Rlcm1pbmF0ZU9uRXJyb3I6IHRydWV9KSlcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIEV2ZW50U291cmNlUGFyc2VyU3RyZWFtIGV4dGVuZHMgVHJhbnNmb3JtU3RyZWFtPHN0cmluZywgRXZlbnRTb3VyY2VNZXNzYWdlPiB7XG4gIGNvbnN0cnVjdG9yKHtvbkVycm9yLCBvblJldHJ5LCBvbkNvbW1lbnR9OiBTdHJlYW1PcHRpb25zID0ge30pIHtcbiAgICBsZXQgcGFyc2VyITogRXZlbnRTb3VyY2VQYXJzZXJcblxuICAgIHN1cGVyKHtcbiAgICAgIHN0YXJ0KGNvbnRyb2xsZXIpIHtcbiAgICAgICAgcGFyc2VyID0gY3JlYXRlUGFyc2VyKHtcbiAgICAgICAgICBvbkV2ZW50OiAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShldmVudClcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yID09PSAndGVybWluYXRlJykge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVycm9yKGVycm9yKVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb25FcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJZ25vcmUgYnkgZGVmYXVsdFxuICAgICAgICAgIH0sXG4gICAgICAgICAgb25SZXRyeSxcbiAgICAgICAgICBvbkNvbW1lbnQsXG4gICAgICAgIH0pXG4gICAgICB9LFxuICAgICAgdHJhbnNmb3JtKGNodW5rKSB7XG4gICAgICAgIHBhcnNlci5mZWVkKGNodW5rKVxuICAgICAgfSxcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCB7dHlwZSBFcnJvclR5cGUsIFBhcnNlRXJyb3J9IGZyb20gJy4vZXJyb3JzLnRzJ1xuZXhwb3J0IHR5cGUge0V2ZW50U291cmNlTWVzc2FnZX0gZnJvbSAnLi90eXBlcy50cydcbiIsICJleHBvcnQgZnVuY3Rpb24gY29tYmluZUhlYWRlcnMoXG4gIC4uLmhlYWRlcnM6IEFycmF5PFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD4gfCB1bmRlZmluZWQ+XG4pOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgcmV0dXJuIGhlYWRlcnMucmVkdWNlKFxuICAgIChjb21iaW5lZEhlYWRlcnMsIGN1cnJlbnRIZWFkZXJzKSA9PiAoe1xuICAgICAgLi4uY29tYmluZWRIZWFkZXJzLFxuICAgICAgLi4uKGN1cnJlbnRIZWFkZXJzID8/IHt9KSxcbiAgICB9KSxcbiAgICB7fSxcbiAgKSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+O1xufVxuIiwgIi8qKlxuICogQ29udmVydHMgYW4gQXN5bmNJdGVyYXRvciB0byBhIFJlYWRhYmxlU3RyZWFtLlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZWxlbWVudHMgcHJvZHVjZWQgYnkgdGhlIEFzeW5jSXRlcmF0b3IuXG4gKiBAcGFyYW0geyA8VD59IGl0ZXJhdG9yIC0gVGhlIEFzeW5jSXRlcmF0b3IgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtSZWFkYWJsZVN0cmVhbTxUPn0gLSBBIFJlYWRhYmxlU3RyZWFtIHRoYXQgcHJvdmlkZXMgdGhlIHNhbWUgZGF0YSBhcyB0aGUgQXN5bmNJdGVyYXRvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRBc3luY0l0ZXJhdG9yVG9SZWFkYWJsZVN0cmVhbTxUPihcbiAgaXRlcmF0b3I6IEFzeW5jSXRlcmF0b3I8VD4sXG4pOiBSZWFkYWJsZVN0cmVhbTxUPiB7XG4gIHJldHVybiBuZXcgUmVhZGFibGVTdHJlYW08VD4oe1xuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBjb25zdW1lciB3YW50cyB0byBwdWxsIG1vcmUgZGF0YSBmcm9tIHRoZSBzdHJlYW0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1JlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXI8VD59IGNvbnRyb2xsZXIgLSBUaGUgY29udHJvbGxlciB0byBlbnF1ZXVlIGRhdGEgaW50byB0aGUgc3RyZWFtLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIGFzeW5jIHB1bGwoY29udHJvbGxlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyB2YWx1ZSwgZG9uZSB9ID0gYXdhaXQgaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb250cm9sbGVyLmVycm9yKGVycm9yKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHRoZSBjb25zdW1lciBjYW5jZWxzIHRoZSBzdHJlYW0uXG4gICAgICovXG4gICAgY2FuY2VsKCkge30sXG4gIH0pO1xufVxuIiwgIi8qKlxuICogQ3JlYXRlcyBhIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciBhIHNwZWNpZmllZCBkZWxheVxuICogQHBhcmFtIGRlbGF5SW5NcyAtIFRoZSBkZWxheSBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMuIElmIG51bGwgb3IgdW5kZWZpbmVkLCByZXNvbHZlcyBpbW1lZGlhdGVseS5cbiAqIEBwYXJhbSBzaWduYWwgLSBPcHRpb25hbCBBYm9ydFNpZ25hbCB0byBjYW5jZWwgdGhlIGRlbGF5XG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB0aGUgc3BlY2lmaWVkIGRlbGF5XG4gKiBAdGhyb3dzIHtET01FeGNlcHRpb259IFdoZW4gdGhlIHNpZ25hbCBpcyBhYm9ydGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxheShcbiAgZGVsYXlJbk1zPzogbnVtYmVyIHwgbnVsbCxcbiAgb3B0aW9ucz86IHtcbiAgICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuICB9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChkZWxheUluTXMgPT0gbnVsbCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIGNvbnN0IHNpZ25hbCA9IG9wdGlvbnM/LmFib3J0U2lnbmFsO1xuXG4gIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaWYgKHNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgcmVqZWN0KGNyZWF0ZUFib3J0RXJyb3IoKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjbGVhbnVwKCk7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfSwgZGVsYXlJbk1zKTtcblxuICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgIHNpZ25hbD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBvbkFib3J0KTtcbiAgICB9O1xuXG4gICAgY29uc3Qgb25BYm9ydCA9ICgpID0+IHtcbiAgICAgIGNsZWFudXAoKTtcbiAgICAgIHJlamVjdChjcmVhdGVBYm9ydEVycm9yKCkpO1xuICAgIH07XG5cbiAgICBzaWduYWw/LmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0Jywgb25BYm9ydCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBYm9ydEVycm9yKCk6IERPTUV4Y2VwdGlvbiB7XG4gIHJldHVybiBuZXcgRE9NRXhjZXB0aW9uKCdEZWxheSB3YXMgYWJvcnRlZCcsICdBYm9ydEVycm9yJyk7XG59XG4iLCAiLyoqXG5FeHRyYWN0cyB0aGUgaGVhZGVycyBmcm9tIGEgcmVzcG9uc2Ugb2JqZWN0IGFuZCByZXR1cm5zIHRoZW0gYXMgYSBrZXktdmFsdWUgb2JqZWN0LlxuXG5AcGFyYW0gcmVzcG9uc2UgLSBUaGUgcmVzcG9uc2Ugb2JqZWN0IHRvIGV4dHJhY3QgaGVhZGVycyBmcm9tLlxuQHJldHVybnMgVGhlIGhlYWRlcnMgYXMgYSBrZXktdmFsdWUgb2JqZWN0LlxuKi9cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlOiBSZXNwb25zZSkge1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzPHN0cmluZz4oWy4uLnJlc3BvbnNlLmhlYWRlcnNdKTtcbn1cbiIsICJpbXBvcnQgeyBJbnZhbGlkQXJndW1lbnRFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG4vKipcbkNyZWF0ZXMgYW4gSUQgZ2VuZXJhdG9yLlxuVGhlIHRvdGFsIGxlbmd0aCBvZiB0aGUgSUQgaXMgdGhlIHN1bSBvZiB0aGUgcHJlZml4LCBzZXBhcmF0b3IsIGFuZCByYW5kb20gcGFydCBsZW5ndGguXG5Ob3QgY3J5cHRvZ3JhcGhpY2FsbHkgc2VjdXJlLlxuXG5AcGFyYW0gYWxwaGFiZXQgLSBUaGUgYWxwaGFiZXQgdG8gdXNlIGZvciB0aGUgSUQuIERlZmF1bHQ6ICcwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicuXG5AcGFyYW0gcHJlZml4IC0gVGhlIHByZWZpeCBvZiB0aGUgSUQgdG8gZ2VuZXJhdGUuIE9wdGlvbmFsLlxuQHBhcmFtIHNlcGFyYXRvciAtIFRoZSBzZXBhcmF0b3IgYmV0d2VlbiB0aGUgcHJlZml4IGFuZCB0aGUgcmFuZG9tIHBhcnQgb2YgdGhlIElELiBEZWZhdWx0OiAnLScuXG5AcGFyYW0gc2l6ZSAtIFRoZSBzaXplIG9mIHRoZSByYW5kb20gcGFydCBvZiB0aGUgSUQgdG8gZ2VuZXJhdGUuIERlZmF1bHQ6IDE2LlxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlSWRHZW5lcmF0b3IgPSAoe1xuICBwcmVmaXgsXG4gIHNpemUgPSAxNixcbiAgYWxwaGFiZXQgPSAnMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLFxuICBzZXBhcmF0b3IgPSAnLScsXG59OiB7XG4gIHByZWZpeD86IHN0cmluZztcbiAgc2VwYXJhdG9yPzogc3RyaW5nO1xuICBzaXplPzogbnVtYmVyO1xuICBhbHBoYWJldD86IHN0cmluZztcbn0gPSB7fSk6IElkR2VuZXJhdG9yID0+IHtcbiAgY29uc3QgZ2VuZXJhdG9yID0gKCkgPT4ge1xuICAgIGNvbnN0IGFscGhhYmV0TGVuZ3RoID0gYWxwaGFiZXQubGVuZ3RoO1xuICAgIGNvbnN0IGNoYXJzID0gbmV3IEFycmF5KHNpemUpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICBjaGFyc1tpXSA9IGFscGhhYmV0WyhNYXRoLnJhbmRvbSgpICogYWxwaGFiZXRMZW5ndGgpIHwgMF07XG4gICAgfVxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKTtcbiAgfTtcblxuICBpZiAocHJlZml4ID09IG51bGwpIHtcbiAgICByZXR1cm4gZ2VuZXJhdG9yO1xuICB9XG5cbiAgLy8gY2hlY2sgdGhhdCB0aGUgcHJlZml4IGlzIG5vdCBwYXJ0IG9mIHRoZSBhbHBoYWJldCAob3RoZXJ3aXNlIHByZWZpeCBjaGVja2luZyBjYW4gZmFpbCByYW5kb21seSlcbiAgaWYgKGFscGhhYmV0LmluY2x1ZGVzKHNlcGFyYXRvcikpIHtcbiAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgYXJndW1lbnQ6ICdzZXBhcmF0b3InLFxuICAgICAgbWVzc2FnZTogYFRoZSBzZXBhcmF0b3IgXCIke3NlcGFyYXRvcn1cIiBtdXN0IG5vdCBiZSBwYXJ0IG9mIHRoZSBhbHBoYWJldCBcIiR7YWxwaGFiZXR9XCIuYCxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiAoKSA9PiBgJHtwcmVmaXh9JHtzZXBhcmF0b3J9JHtnZW5lcmF0b3IoKX1gO1xufTtcblxuLyoqXG5BIGZ1bmN0aW9uIHRoYXQgZ2VuZXJhdGVzIGFuIElELlxuICovXG5leHBvcnQgdHlwZSBJZEdlbmVyYXRvciA9ICgpID0+IHN0cmluZztcblxuLyoqXG5HZW5lcmF0ZXMgYSAxNi1jaGFyYWN0ZXIgcmFuZG9tIHN0cmluZyB0byB1c2UgZm9yIElEcy5cbk5vdCBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUuXG4gKi9cbmV4cG9ydCBjb25zdCBnZW5lcmF0ZUlkID0gY3JlYXRlSWRHZW5lcmF0b3IoKTtcbiIsICJleHBvcnQgZnVuY3Rpb24gZ2V0RXJyb3JNZXNzYWdlKGVycm9yOiB1bmtub3duIHwgdW5kZWZpbmVkKSB7XG4gIGlmIChlcnJvciA9PSBudWxsKSB7XG4gICAgcmV0dXJuICd1bmtub3duIGVycm9yJztcbiAgfVxuXG4gIGlmICh0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICByZXR1cm4gZXJyb3IubWVzc2FnZTtcbiAgfVxuXG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShlcnJvcik7XG59XG4iLCAiaW1wb3J0IHsgQVBJQ2FsbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBleHRyYWN0UmVzcG9uc2VIZWFkZXJzIH0gZnJvbSAnLi9leHRyYWN0LXJlc3BvbnNlLWhlYWRlcnMnO1xuaW1wb3J0IHsgRmV0Y2hGdW5jdGlvbiB9IGZyb20gJy4vZmV0Y2gtZnVuY3Rpb24nO1xuaW1wb3J0IHsgaGFuZGxlRmV0Y2hFcnJvciB9IGZyb20gJy4vaGFuZGxlLWZldGNoLWVycm9yJztcbmltcG9ydCB7IGlzQWJvcnRFcnJvciB9IGZyb20gJy4vaXMtYWJvcnQtZXJyb3InO1xuaW1wb3J0IHsgcmVtb3ZlVW5kZWZpbmVkRW50cmllcyB9IGZyb20gJy4vcmVtb3ZlLXVuZGVmaW5lZC1lbnRyaWVzJztcbmltcG9ydCB7IFJlc3BvbnNlSGFuZGxlciB9IGZyb20gJy4vcmVzcG9uc2UtaGFuZGxlcic7XG5cbi8vIHVzZSBmdW5jdGlvbiB0byBhbGxvdyBmb3IgbW9ja2luZyBpbiB0ZXN0czpcbmNvbnN0IGdldE9yaWdpbmFsRmV0Y2ggPSAoKSA9PiBnbG9iYWxUaGlzLmZldGNoO1xuXG5leHBvcnQgY29uc3QgZ2V0RnJvbUFwaSA9IGFzeW5jIDxUPih7XG4gIHVybCxcbiAgaGVhZGVycyA9IHt9LFxuICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyLFxuICBmYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gIGFib3J0U2lnbmFsLFxuICBmZXRjaCA9IGdldE9yaWdpbmFsRmV0Y2goKSxcbn06IHtcbiAgdXJsOiBzdHJpbmc7XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+O1xuICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxFcnJvcj47XG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxUPjtcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgZmV0Y2g/OiBGZXRjaEZ1bmN0aW9uO1xufSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgaGVhZGVyczogcmVtb3ZlVW5kZWZpbmVkRW50cmllcyhoZWFkZXJzKSxcbiAgICAgIHNpZ25hbDogYWJvcnRTaWduYWwsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGxldCBlcnJvckluZm9ybWF0aW9uOiB7XG4gICAgICAgIHZhbHVlOiBFcnJvcjtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDtcbiAgICAgIH07XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGVycm9ySW5mb3JtYXRpb24gPSBhd2FpdCBmYWlsZWRSZXNwb25zZUhhbmRsZXIoe1xuICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczoge30sXG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGlzQWJvcnRFcnJvcihlcnJvcikgfHwgQVBJQ2FsbEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpKSB7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHByb2Nlc3MgZXJyb3IgcmVzcG9uc2UnLFxuICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczoge30sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBlcnJvckluZm9ybWF0aW9uLnZhbHVlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcih7XG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiB7fSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBpZiAoaXNBYm9ydEVycm9yKGVycm9yKSB8fCBBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBwcm9jZXNzIHN1Y2Nlc3NmdWwgcmVzcG9uc2UnLFxuICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiB7fSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBoYW5kbGVGZXRjaEVycm9yKHsgZXJyb3IsIHVybCwgcmVxdWVzdEJvZHlWYWx1ZXM6IHt9IH0pO1xuICB9XG59O1xuIiwgImltcG9ydCB7IEFQSUNhbGxFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgaXNBYm9ydEVycm9yIH0gZnJvbSAnLi9pcy1hYm9ydC1lcnJvcic7XG5cbmNvbnN0IEZFVENIX0ZBSUxFRF9FUlJPUl9NRVNTQUdFUyA9IFsnZmV0Y2ggZmFpbGVkJywgJ2ZhaWxlZCB0byBmZXRjaCddO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlRmV0Y2hFcnJvcih7XG4gIGVycm9yLFxuICB1cmwsXG4gIHJlcXVlc3RCb2R5VmFsdWVzLFxufToge1xuICBlcnJvcjogdW5rbm93bjtcbiAgdXJsOiBzdHJpbmc7XG4gIHJlcXVlc3RCb2R5VmFsdWVzOiB1bmtub3duO1xufSkge1xuICBpZiAoaXNBYm9ydEVycm9yKGVycm9yKSkge1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIC8vIHVud3JhcCBvcmlnaW5hbCBlcnJvciB3aGVuIGZldGNoIGZhaWxlZCAoZm9yIGVhc2llciBkZWJ1Z2dpbmcpOlxuICBpZiAoXG4gICAgZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IgJiZcbiAgICBGRVRDSF9GQUlMRURfRVJST1JfTUVTU0FHRVMuaW5jbHVkZXMoZXJyb3IubWVzc2FnZS50b0xvd2VyQ2FzZSgpKVxuICApIHtcbiAgICBjb25zdCBjYXVzZSA9IChlcnJvciBhcyBhbnkpLmNhdXNlO1xuXG4gICAgaWYgKGNhdXNlICE9IG51bGwpIHtcbiAgICAgIC8vIEZhaWxlZCB0byBjb25uZWN0IHRvIHNlcnZlcjpcbiAgICAgIHJldHVybiBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogYENhbm5vdCBjb25uZWN0IHRvIEFQSTogJHtjYXVzZS5tZXNzYWdlfWAsXG4gICAgICAgIGNhdXNlLFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzLFxuICAgICAgICBpc1JldHJ5YWJsZTogdHJ1ZSwgLy8gcmV0cnkgd2hlbiBuZXR3b3JrIGVycm9yXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZXJyb3I7XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGlzQWJvcnRFcnJvcihlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEVycm9yIHtcbiAgcmV0dXJuIChcbiAgICAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciB8fCBlcnJvciBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbikgJiZcbiAgICAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InIHx8XG4gICAgICBlcnJvci5uYW1lID09PSAnUmVzcG9uc2VBYm9ydGVkJyB8fCAvLyBOZXh0LmpzXG4gICAgICBlcnJvci5uYW1lID09PSAnVGltZW91dEVycm9yJylcbiAgKTtcbn1cbiIsICIvKipcbiAqIFJlbW92ZXMgZW50cmllcyBmcm9tIGEgcmVjb3JkIHdoZXJlIHRoZSB2YWx1ZSBpcyBudWxsIG9yIHVuZGVmaW5lZC5cbiAqIEBwYXJhbSByZWNvcmQgLSBUaGUgaW5wdXQgb2JqZWN0IHdob3NlIGVudHJpZXMgbWF5IGJlIG51bGwgb3IgdW5kZWZpbmVkLlxuICogQHJldHVybnMgQSBuZXcgb2JqZWN0IGNvbnRhaW5pbmcgb25seSBlbnRyaWVzIHdpdGggbm9uLW51bGwgYW5kIG5vbi11bmRlZmluZWQgdmFsdWVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVW5kZWZpbmVkRW50cmllczxUPihcbiAgcmVjb3JkOiBSZWNvcmQ8c3RyaW5nLCBUIHwgdW5kZWZpbmVkPixcbik6IFJlY29yZDxzdHJpbmcsIFQ+IHtcbiAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBPYmplY3QuZW50cmllcyhyZWNvcmQpLmZpbHRlcigoW19rZXksIHZhbHVlXSkgPT4gdmFsdWUgIT0gbnVsbCksXG4gICkgYXMgUmVjb3JkPHN0cmluZywgVD47XG59XG4iLCAiLyoqXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIFVSTCBpcyBzdXBwb3J0ZWQgbmF0aXZlbHkgYnkgdGhlIG1vZGVsLlxuICpcbiAqIEBwYXJhbSBtZWRpYVR5cGUgLSBUaGUgbWVkaWEgdHlwZSBvZiB0aGUgVVJMLiBDYXNlLXNlbnNpdGl2ZS5cbiAqIEBwYXJhbSB1cmwgLSBUaGUgVVJMIHRvIGNoZWNrLlxuICogQHBhcmFtIHN1cHBvcnRlZFVybHMgLSBBIHJlY29yZCB3aGVyZSBrZXlzIGFyZSBjYXNlLXNlbnNpdGl2ZSBtZWRpYSB0eXBlcyAob3IgJyonKVxuICogICAgICAgICAgICAgICAgICAgICAgICBhbmQgdmFsdWVzIGFyZSBhcnJheXMgb2YgUmVnRXhwIHBhdHRlcm5zIGZvciBVUkxzLlxuICpcbiAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgVVJMIG1hdGNoZXMgYSBwYXR0ZXJuIHVuZGVyIHRoZSBzcGVjaWZpYyBtZWRpYSB0eXBlXG4gKiAgICAgICAgICBvciB0aGUgd2lsZGNhcmQgJyonLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVXJsU3VwcG9ydGVkKHtcbiAgbWVkaWFUeXBlLFxuICB1cmwsXG4gIHN1cHBvcnRlZFVybHMsXG59OiB7XG4gIG1lZGlhVHlwZTogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgc3VwcG9ydGVkVXJsczogUmVjb3JkPHN0cmluZywgUmVnRXhwW10+O1xufSk6IGJvb2xlYW4ge1xuICAvLyBzdGFuZGFyZGl6ZSBtZWRpYSB0eXBlIGFuZCB1cmwgdG8gbG93ZXIgY2FzZVxuICB1cmwgPSB1cmwudG9Mb3dlckNhc2UoKTtcbiAgbWVkaWFUeXBlID0gbWVkaWFUeXBlLnRvTG93ZXJDYXNlKCk7XG5cbiAgcmV0dXJuIChcbiAgICBPYmplY3QuZW50cmllcyhzdXBwb3J0ZWRVcmxzKVxuICAgICAgLy8gc3RhbmRhcmRpemUgc3VwcG9ydGVkIHVybCBtYXAgaW50byBsb3dlcmNhc2UgcHJlZml4ZXM6XG4gICAgICAubWFwKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgY29uc3QgbWVkaWFUeXBlID0ga2V5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiBtZWRpYVR5cGUgPT09ICcqJyB8fCBtZWRpYVR5cGUgPT09ICcqLyonXG4gICAgICAgICAgPyB7IG1lZGlhVHlwZVByZWZpeDogJycsIHJlZ2V4ZXM6IHZhbHVlIH1cbiAgICAgICAgICA6IHsgbWVkaWFUeXBlUHJlZml4OiBtZWRpYVR5cGUucmVwbGFjZSgvXFwqLywgJycpLCByZWdleGVzOiB2YWx1ZSB9O1xuICAgICAgfSlcbiAgICAgIC8vIGdhdGhlciBhbGwgcmVnZXhwIHBhdHRlcm4gZnJvbSBtYXRjaGVkIG1lZGlhIHR5cGUgcHJlZml4ZXM6XG4gICAgICAuZmlsdGVyKCh7IG1lZGlhVHlwZVByZWZpeCB9KSA9PiBtZWRpYVR5cGUuc3RhcnRzV2l0aChtZWRpYVR5cGVQcmVmaXgpKVxuICAgICAgLmZsYXRNYXAoKHsgcmVnZXhlcyB9KSA9PiByZWdleGVzKVxuICAgICAgLy8gY2hlY2sgaWYgYW55IHBhdHRlcm4gbWF0Y2hlcyB0aGUgdXJsOlxuICAgICAgLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QodXJsKSlcbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBMb2FkQVBJS2V5RXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRBcGlLZXkoe1xuICBhcGlLZXksXG4gIGVudmlyb25tZW50VmFyaWFibGVOYW1lLFxuICBhcGlLZXlQYXJhbWV0ZXJOYW1lID0gJ2FwaUtleScsXG4gIGRlc2NyaXB0aW9uLFxufToge1xuICBhcGlLZXk6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWU6IHN0cmluZztcbiAgYXBpS2V5UGFyYW1ldGVyTmFtZT86IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbn0pOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIGFwaUtleSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gYXBpS2V5O1xuICB9XG5cbiAgaWYgKGFwaUtleSAhPSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IExvYWRBUElLZXlFcnJvcih7XG4gICAgICBtZXNzYWdlOiBgJHtkZXNjcmlwdGlvbn0gQVBJIGtleSBtdXN0IGJlIGEgc3RyaW5nLmAsXG4gICAgfSk7XG4gIH1cblxuICBpZiAodHlwZW9mIHByb2Nlc3MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhyb3cgbmV3IExvYWRBUElLZXlFcnJvcih7XG4gICAgICBtZXNzYWdlOiBgJHtkZXNjcmlwdGlvbn0gQVBJIGtleSBpcyBtaXNzaW5nLiBQYXNzIGl0IHVzaW5nIHRoZSAnJHthcGlLZXlQYXJhbWV0ZXJOYW1lfScgcGFyYW1ldGVyLiBFbnZpcm9ubWVudCB2YXJpYWJsZXMgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGVudmlyb25tZW50LmAsXG4gICAgfSk7XG4gIH1cblxuICBhcGlLZXkgPSBwcm9jZXNzLmVudltlbnZpcm9ubWVudFZhcmlhYmxlTmFtZV07XG5cbiAgaWYgKGFwaUtleSA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IExvYWRBUElLZXlFcnJvcih7XG4gICAgICBtZXNzYWdlOiBgJHtkZXNjcmlwdGlvbn0gQVBJIGtleSBpcyBtaXNzaW5nLiBQYXNzIGl0IHVzaW5nIHRoZSAnJHthcGlLZXlQYXJhbWV0ZXJOYW1lfScgcGFyYW1ldGVyIG9yIHRoZSAke2Vudmlyb25tZW50VmFyaWFibGVOYW1lfSBlbnZpcm9ubWVudCB2YXJpYWJsZS5gLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBhcGlLZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IExvYWRBUElLZXlFcnJvcih7XG4gICAgICBtZXNzYWdlOiBgJHtkZXNjcmlwdGlvbn0gQVBJIGtleSBtdXN0IGJlIGEgc3RyaW5nLiBUaGUgdmFsdWUgb2YgdGhlICR7ZW52aXJvbm1lbnRWYXJpYWJsZU5hbWV9IGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBhIHN0cmluZy5gLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIGFwaUtleTtcbn1cbiIsICIvKipcbiAqIExvYWRzIGFuIG9wdGlvbmFsIGBzdHJpbmdgIHNldHRpbmcgZnJvbSB0aGUgZW52aXJvbm1lbnQgb3IgYSBwYXJhbWV0ZXIuXG4gKlxuICogQHBhcmFtIHNldHRpbmdWYWx1ZSAtIFRoZSBzZXR0aW5nIHZhbHVlLlxuICogQHBhcmFtIGVudmlyb25tZW50VmFyaWFibGVOYW1lIC0gVGhlIGVudmlyb25tZW50IHZhcmlhYmxlIG5hbWUuXG4gKiBAcmV0dXJucyBUaGUgc2V0dGluZyB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRPcHRpb25hbFNldHRpbmcoe1xuICBzZXR0aW5nVmFsdWUsXG4gIGVudmlyb25tZW50VmFyaWFibGVOYW1lLFxufToge1xuICBzZXR0aW5nVmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWU6IHN0cmluZztcbn0pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAodHlwZW9mIHNldHRpbmdWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gc2V0dGluZ1ZhbHVlO1xuICB9XG5cbiAgaWYgKHNldHRpbmdWYWx1ZSAhPSBudWxsIHx8IHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBzZXR0aW5nVmFsdWUgPSBwcm9jZXNzLmVudltlbnZpcm9ubWVudFZhcmlhYmxlTmFtZV07XG5cbiAgaWYgKHNldHRpbmdWYWx1ZSA9PSBudWxsIHx8IHR5cGVvZiBzZXR0aW5nVmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHJldHVybiBzZXR0aW5nVmFsdWU7XG59XG4iLCAiaW1wb3J0IHsgTG9hZFNldHRpbmdFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG4vKipcbiAqIExvYWRzIGEgYHN0cmluZ2Agc2V0dGluZyBmcm9tIHRoZSBlbnZpcm9ubWVudCBvciBhIHBhcmFtZXRlci5cbiAqXG4gKiBAcGFyYW0gc2V0dGluZ1ZhbHVlIC0gVGhlIHNldHRpbmcgdmFsdWUuXG4gKiBAcGFyYW0gZW52aXJvbm1lbnRWYXJpYWJsZU5hbWUgLSBUaGUgZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZS5cbiAqIEBwYXJhbSBzZXR0aW5nTmFtZSAtIFRoZSBzZXR0aW5nIG5hbWUuXG4gKiBAcGFyYW0gZGVzY3JpcHRpb24gLSBUaGUgZGVzY3JpcHRpb24gb2YgdGhlIHNldHRpbmcuXG4gKiBAcmV0dXJucyBUaGUgc2V0dGluZyB2YWx1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRTZXR0aW5nKHtcbiAgc2V0dGluZ1ZhbHVlLFxuICBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZSxcbiAgc2V0dGluZ05hbWUsXG4gIGRlc2NyaXB0aW9uLFxufToge1xuICBzZXR0aW5nVmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWU6IHN0cmluZztcbiAgc2V0dGluZ05hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbn0pOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIHNldHRpbmdWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gc2V0dGluZ1ZhbHVlO1xuICB9XG5cbiAgaWYgKHNldHRpbmdWYWx1ZSAhPSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IExvYWRTZXR0aW5nRXJyb3Ioe1xuICAgICAgbWVzc2FnZTogYCR7ZGVzY3JpcHRpb259IHNldHRpbmcgbXVzdCBiZSBhIHN0cmluZy5gLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJykge1xuICAgIHRocm93IG5ldyBMb2FkU2V0dGluZ0Vycm9yKHtcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgIGAke2Rlc2NyaXB0aW9ufSBzZXR0aW5nIGlzIG1pc3NpbmcuIGAgK1xuICAgICAgICBgUGFzcyBpdCB1c2luZyB0aGUgJyR7c2V0dGluZ05hbWV9JyBwYXJhbWV0ZXIuIGAgK1xuICAgICAgICBgRW52aXJvbm1lbnQgdmFyaWFibGVzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBlbnZpcm9ubWVudC5gLFxuICAgIH0pO1xuICB9XG5cbiAgc2V0dGluZ1ZhbHVlID0gcHJvY2Vzcy5lbnZbZW52aXJvbm1lbnRWYXJpYWJsZU5hbWVdO1xuXG4gIGlmIChzZXR0aW5nVmFsdWUgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBMb2FkU2V0dGluZ0Vycm9yKHtcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgIGAke2Rlc2NyaXB0aW9ufSBzZXR0aW5nIGlzIG1pc3NpbmcuIGAgK1xuICAgICAgICBgUGFzcyBpdCB1c2luZyB0aGUgJyR7c2V0dGluZ05hbWV9JyBwYXJhbWV0ZXIgYCArXG4gICAgICAgIGBvciB0aGUgJHtlbnZpcm9ubWVudFZhcmlhYmxlTmFtZX0gZW52aXJvbm1lbnQgdmFyaWFibGUuYCxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygc2V0dGluZ1ZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBMb2FkU2V0dGluZ0Vycm9yKHtcbiAgICAgIG1lc3NhZ2U6XG4gICAgICAgIGAke2Rlc2NyaXB0aW9ufSBzZXR0aW5nIG11c3QgYmUgYSBzdHJpbmcuIGAgK1xuICAgICAgICBgVGhlIHZhbHVlIG9mIHRoZSAke2Vudmlyb25tZW50VmFyaWFibGVOYW1lfSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyBub3QgYSBzdHJpbmcuYCxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBzZXR0aW5nVmFsdWU7XG59XG4iLCAiaW1wb3J0IHtcbiAgSlNPTlBhcnNlRXJyb3IsXG4gIEpTT05WYWx1ZSxcbiAgVHlwZVZhbGlkYXRpb25FcnJvcixcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IHNlY3VyZUpzb25QYXJzZSB9IGZyb20gJy4vc2VjdXJlLWpzb24tcGFyc2UnO1xuaW1wb3J0IHsgc2FmZVZhbGlkYXRlVHlwZXMsIHZhbGlkYXRlVHlwZXMgfSBmcm9tICcuL3ZhbGlkYXRlLXR5cGVzJztcbmltcG9ydCB7IFZhbGlkYXRvciB9IGZyb20gJy4vdmFsaWRhdG9yJztcblxuLyoqXG4gKiBQYXJzZXMgYSBKU09OIHN0cmluZyBpbnRvIGFuIHVua25vd24gb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB0ZXh0IC0gVGhlIEpTT04gc3RyaW5nIHRvIHBhcnNlLlxuICogQHJldHVybnMge0pTT05WYWx1ZX0gLSBUaGUgcGFyc2VkIEpTT04gb2JqZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VKU09OKG9wdGlvbnM6IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE/OiB1bmRlZmluZWQ7XG59KTogUHJvbWlzZTxKU09OVmFsdWU+O1xuLyoqXG4gKiBQYXJzZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgc3Ryb25nbHktdHlwZWQgb2JqZWN0IHVzaW5nIHRoZSBwcm92aWRlZCBzY2hlbWEuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0IHRvIHBhcnNlIHRoZSBKU09OIGludG8uXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSBKU09OIHN0cmluZyB0byBwYXJzZS5cbiAqIEBwYXJhbSB7VmFsaWRhdG9yPFQ+fSBzY2hlbWEgLSBUaGUgc2NoZW1hIHRvIHVzZSBmb3IgcGFyc2luZyB0aGUgSlNPTi5cbiAqIEByZXR1cm5zIHtQcm9taXNlPFQ+fSAtIFRoZSBwYXJzZWQgb2JqZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VKU09OPFQ+KG9wdGlvbnM6IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE6IHo0LmNvcmUuJFpvZFR5cGU8VD4gfCB6My5TY2hlbWE8VD4gfCBWYWxpZGF0b3I8VD47XG59KTogUHJvbWlzZTxUPjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUpTT048VD4oe1xuICB0ZXh0LFxuICBzY2hlbWEsXG59OiB7XG4gIHRleHQ6IHN0cmluZztcbiAgc2NoZW1hPzogejQuY29yZS4kWm9kVHlwZTxUPiB8IHozLlNjaGVtYTxUPiB8IFZhbGlkYXRvcjxUPjtcbn0pOiBQcm9taXNlPFQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWx1ZSA9IHNlY3VyZUpzb25QYXJzZSh0ZXh0KTtcblxuICAgIGlmIChzY2hlbWEgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiB2YWxpZGF0ZVR5cGVzPFQ+KHsgdmFsdWUsIHNjaGVtYSB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoXG4gICAgICBKU09OUGFyc2VFcnJvci5pc0luc3RhbmNlKGVycm9yKSB8fFxuICAgICAgVHlwZVZhbGlkYXRpb25FcnJvci5pc0luc3RhbmNlKGVycm9yKVxuICAgICkge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEpTT05QYXJzZUVycm9yKHsgdGV4dCwgY2F1c2U6IGVycm9yIH0pO1xuICB9XG59XG5cbmV4cG9ydCB0eXBlIFBhcnNlUmVzdWx0PFQ+ID1cbiAgfCB7IHN1Y2Nlc3M6IHRydWU7IHZhbHVlOiBUOyByYXdWYWx1ZTogdW5rbm93biB9XG4gIHwge1xuICAgICAgc3VjY2VzczogZmFsc2U7XG4gICAgICBlcnJvcjogSlNPTlBhcnNlRXJyb3IgfCBUeXBlVmFsaWRhdGlvbkVycm9yO1xuICAgICAgcmF3VmFsdWU6IHVua25vd247XG4gICAgfTtcblxuLyoqXG4gKiBTYWZlbHkgcGFyc2VzIGEgSlNPTiBzdHJpbmcgYW5kIHJldHVybnMgdGhlIHJlc3VsdCBhcyBhbiBvYmplY3Qgb2YgdHlwZSBgdW5rbm93bmAuXG4gKlxuICogQHBhcmFtIHRleHQgLSBUaGUgSlNPTiBzdHJpbmcgdG8gcGFyc2UuXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxvYmplY3Q+fSBFaXRoZXIgYW4gb2JqZWN0IHdpdGggYHN1Y2Nlc3M6IHRydWVgIGFuZCB0aGUgcGFyc2VkIGRhdGEsIG9yIGFuIG9iamVjdCB3aXRoIGBzdWNjZXNzOiBmYWxzZWAgYW5kIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2FmZVBhcnNlSlNPTihvcHRpb25zOiB7XG4gIHRleHQ6IHN0cmluZztcbiAgc2NoZW1hPzogdW5kZWZpbmVkO1xufSk6IFByb21pc2U8UGFyc2VSZXN1bHQ8SlNPTlZhbHVlPj47XG4vKipcbiAqIFNhZmVseSBwYXJzZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgc3Ryb25nbHktdHlwZWQgb2JqZWN0LCB1c2luZyBhIHByb3ZpZGVkIHNjaGVtYSB0byB2YWxpZGF0ZSB0aGUgb2JqZWN0LlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgdGhlIG9iamVjdCB0byBwYXJzZSB0aGUgSlNPTiBpbnRvLlxuICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBUaGUgSlNPTiBzdHJpbmcgdG8gcGFyc2UuXG4gKiBAcGFyYW0ge1ZhbGlkYXRvcjxUPn0gc2NoZW1hIC0gVGhlIHNjaGVtYSB0byB1c2UgZm9yIHBhcnNpbmcgdGhlIEpTT04uXG4gKiBAcmV0dXJucyBBbiBvYmplY3Qgd2l0aCBlaXRoZXIgYSBgc3VjY2Vzc2AgZmxhZyBhbmQgdGhlIHBhcnNlZCBhbmQgdHlwZWQgZGF0YSwgb3IgYSBgc3VjY2Vzc2AgZmxhZyBhbmQgYW4gZXJyb3Igb2JqZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2FmZVBhcnNlSlNPTjxUPihvcHRpb25zOiB7XG4gIHRleHQ6IHN0cmluZztcbiAgc2NoZW1hOiB6NC5jb3JlLiRab2RUeXBlPFQ+IHwgejMuU2NoZW1hPFQ+IHwgVmFsaWRhdG9yPFQ+O1xufSk6IFByb21pc2U8UGFyc2VSZXN1bHQ8VD4+O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhZmVQYXJzZUpTT048VD4oe1xuICB0ZXh0LFxuICBzY2hlbWEsXG59OiB7XG4gIHRleHQ6IHN0cmluZztcbiAgc2NoZW1hPzogejQuY29yZS4kWm9kVHlwZTxUPiB8IHozLlNjaGVtYTxUPiB8IFZhbGlkYXRvcjxUPjtcbn0pOiBQcm9taXNlPFBhcnNlUmVzdWx0PFQ+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsdWUgPSBzZWN1cmVKc29uUGFyc2UodGV4dCk7XG5cbiAgICBpZiAoc2NoZW1hID09IG51bGwpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiB2YWx1ZSBhcyBULCByYXdWYWx1ZTogdmFsdWUgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgc2FmZVZhbGlkYXRlVHlwZXM8VD4oeyB2YWx1ZSwgc2NoZW1hIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBKU09OUGFyc2VFcnJvci5pc0luc3RhbmNlKGVycm9yKVxuICAgICAgICA/IGVycm9yXG4gICAgICAgIDogbmV3IEpTT05QYXJzZUVycm9yKHsgdGV4dCwgY2F1c2U6IGVycm9yIH0pLFxuICAgICAgcmF3VmFsdWU6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnNhYmxlSnNvbihpbnB1dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHRyeSB7XG4gICAgc2VjdXJlSnNvblBhcnNlKGlucHV0KTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCAiLy8gTGljZW5zZWQgdW5kZXIgQlNELTMtQ2xhdXNlICh0aGlzIGZpbGUgb25seSlcbi8vIENvZGUgYWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9mYXN0aWZ5L3NlY3VyZS1qc29uLXBhcnNlL2Jsb2IvNzgzZmNiMWI1NDM0NzA5NDY2NzU5ODQ3Y2VjOTc0MzgxOTM5NjczYS9pbmRleC5qc1xuLy9cbi8vIENvcHlyaWdodCAoYykgVmVyY2VsLCBJbmMuIChodHRwczovL3ZlcmNlbC5jb20pXG4vLyBDb3B5cmlnaHQgKGMpIDIwMTkgVGhlIEZhc3RpZnkgVGVhbVxuLy8gQ29weXJpZ2h0IChjKSAyMDE5LCBTaWRld2F5IEluYywgYW5kIHByb2plY3QgY29udHJpYnV0b3JzXG4vLyBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy9cbi8vIFRoZSBjb21wbGV0ZSBsaXN0IG9mIGNvbnRyaWJ1dG9ycyBjYW4gYmUgZm91bmQgYXQ6XG4vLyAtIGh0dHBzOi8vZ2l0aHViLmNvbS9oYXBpanMvYm91cm5lL2dyYXBocy9jb250cmlidXRvcnNcbi8vIC0gaHR0cHM6Ly9naXRodWIuY29tL2Zhc3RpZnkvc2VjdXJlLWpzb24tcGFyc2UvZ3JhcGhzL2NvbnRyaWJ1dG9yc1xuLy8gLSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL2FpL2NvbW1pdHMvbWFpbi9wYWNrYWdlcy9wcm92aWRlci11dGlscy9zcmMvc2VjdXJlLXBhcnNlLWpzb24udHNcbi8vXG4vLyBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4vL1xuLy8gMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuLy9cbi8vIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbi8vXG4vLyAzLiBOZWl0aGVyIHRoZSBuYW1lIG9mIHRoZSBjb3B5cmlnaHQgaG9sZGVyIG5vciB0aGUgbmFtZXMgb2YgaXRzIGNvbnRyaWJ1dG9ycyBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4vL1xuLy8gVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuXG5jb25zdCBzdXNwZWN0UHJvdG9SeCA9IC9cIl9fcHJvdG9fX1wiXFxzKjovO1xuY29uc3Qgc3VzcGVjdENvbnN0cnVjdG9yUnggPSAvXCJjb25zdHJ1Y3RvclwiXFxzKjovO1xuXG5mdW5jdGlvbiBfcGFyc2UodGV4dDogc3RyaW5nKSB7XG4gIC8vIFBhcnNlIG5vcm1hbGx5XG4gIGNvbnN0IG9iaiA9IEpTT04ucGFyc2UodGV4dCk7XG5cbiAgLy8gSWdub3JlIG51bGwgYW5kIG5vbi1vYmplY3RzXG4gIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgaWYgKFxuICAgIHN1c3BlY3RQcm90b1J4LnRlc3QodGV4dCkgPT09IGZhbHNlICYmXG4gICAgc3VzcGVjdENvbnN0cnVjdG9yUngudGVzdCh0ZXh0KSA9PT0gZmFsc2VcbiAgKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuXG4gIC8vIFNjYW4gcmVzdWx0IGZvciBwcm90byBrZXlzXG4gIHJldHVybiBmaWx0ZXIob2JqKTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyKG9iajogYW55KSB7XG4gIGxldCBuZXh0ID0gW29ial07XG5cbiAgd2hpbGUgKG5leHQubGVuZ3RoKSB7XG4gICAgY29uc3Qgbm9kZXMgPSBuZXh0O1xuICAgIG5leHQgPSBbXTtcblxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChub2RlLCAnX19wcm90b19fJykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCdPYmplY3QgY29udGFpbnMgZm9yYmlkZGVuIHByb3RvdHlwZSBwcm9wZXJ0eScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChub2RlLCAnY29uc3RydWN0b3InKSAmJlxuICAgICAgICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobm9kZS5jb25zdHJ1Y3RvciwgJ3Byb3RvdHlwZScpXG4gICAgICApIHtcbiAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKCdPYmplY3QgY29udGFpbnMgZm9yYmlkZGVuIHByb3RvdHlwZSBwcm9wZXJ0eScpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBub2RlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gbm9kZVtrZXldO1xuICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIG5leHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlY3VyZUpzb25QYXJzZSh0ZXh0OiBzdHJpbmcpIHtcbiAgLy8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2Zhc3RpZnkvc2VjdXJlLWpzb24tcGFyc2UvcHVsbC85MFxuICBjb25zdCB7IHN0YWNrVHJhY2VMaW1pdCB9ID0gRXJyb3I7XG4gIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9IDA7XG4gIHRyeSB7XG4gICAgcmV0dXJuIF9wYXJzZSh0ZXh0KTtcbiAgfSBmaW5hbGx5IHtcbiAgICBFcnJvci5zdGFja1RyYWNlTGltaXQgPSBzdGFja1RyYWNlTGltaXQ7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBUeXBlVmFsaWRhdGlvbkVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgdHlwZSB7IFN0YW5kYXJkU2NoZW1hVjEgfSBmcm9tICdAc3RhbmRhcmQtc2NoZW1hL3NwZWMnO1xuaW1wb3J0IHsgVmFsaWRhdG9yLCBhc1ZhbGlkYXRvciB9IGZyb20gJy4vdmFsaWRhdG9yJztcblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhlIHR5cGVzIG9mIGFuIHVua25vd24gb2JqZWN0IHVzaW5nIGEgc2NoZW1hIGFuZFxuICogcmV0dXJuIGEgc3Ryb25nbHktdHlwZWQgb2JqZWN0LlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgdGhlIG9iamVjdCB0byB2YWxpZGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnZhbHVlIC0gVGhlIG9iamVjdCB0byB2YWxpZGF0ZS5cbiAqIEBwYXJhbSB7VmFsaWRhdG9yPFQ+fSBvcHRpb25zLnNjaGVtYSAtIFRoZSBzY2hlbWEgdG8gdXNlIGZvciB2YWxpZGF0aW5nIHRoZSBKU09OLlxuICogQHJldHVybnMge1Byb21pc2U8VD59IC0gVGhlIHR5cGVkIG9iamVjdC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlVHlwZXM8T0JKRUNUPih7XG4gIHZhbHVlLFxuICBzY2hlbWEsXG59OiB7XG4gIHZhbHVlOiB1bmtub3duO1xuICBzY2hlbWE6IFN0YW5kYXJkU2NoZW1hVjE8dW5rbm93biwgT0JKRUNUPiB8IFZhbGlkYXRvcjxPQkpFQ1Q+O1xufSk6IFByb21pc2U8T0JKRUNUPiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNhZmVWYWxpZGF0ZVR5cGVzKHsgdmFsdWUsIHNjaGVtYSB9KTtcblxuICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgdGhyb3cgVHlwZVZhbGlkYXRpb25FcnJvci53cmFwKHsgdmFsdWUsIGNhdXNlOiByZXN1bHQuZXJyb3IgfSk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0LnZhbHVlO1xufVxuXG4vKipcbiAqIFNhZmVseSB2YWxpZGF0ZXMgdGhlIHR5cGVzIG9mIGFuIHVua25vd24gb2JqZWN0IHVzaW5nIGEgc2NoZW1hIGFuZFxuICogcmV0dXJuIGEgc3Ryb25nbHktdHlwZWQgb2JqZWN0LlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgdGhlIG9iamVjdCB0byB2YWxpZGF0ZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnZhbHVlIC0gVGhlIEpTT04gb2JqZWN0IHRvIHZhbGlkYXRlLlxuICogQHBhcmFtIHtWYWxpZGF0b3I8VD59IG9wdGlvbnMuc2NoZW1hIC0gVGhlIHNjaGVtYSB0byB1c2UgZm9yIHZhbGlkYXRpbmcgdGhlIEpTT04uXG4gKiBAcmV0dXJucyBBbiBvYmplY3Qgd2l0aCBlaXRoZXIgYSBgc3VjY2Vzc2AgZmxhZyBhbmQgdGhlIHBhcnNlZCBhbmQgdHlwZWQgZGF0YSwgb3IgYSBgc3VjY2Vzc2AgZmxhZyBhbmQgYW4gZXJyb3Igb2JqZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2FmZVZhbGlkYXRlVHlwZXM8T0JKRUNUPih7XG4gIHZhbHVlLFxuICBzY2hlbWEsXG59OiB7XG4gIHZhbHVlOiB1bmtub3duO1xuICBzY2hlbWE6IFN0YW5kYXJkU2NoZW1hVjE8dW5rbm93biwgT0JKRUNUPiB8IFZhbGlkYXRvcjxPQkpFQ1Q+O1xufSk6IFByb21pc2U8XG4gIHwge1xuICAgICAgc3VjY2VzczogdHJ1ZTtcbiAgICAgIHZhbHVlOiBPQkpFQ1Q7XG4gICAgICByYXdWYWx1ZTogdW5rbm93bjtcbiAgICB9XG4gIHwge1xuICAgICAgc3VjY2VzczogZmFsc2U7XG4gICAgICBlcnJvcjogVHlwZVZhbGlkYXRpb25FcnJvcjtcbiAgICAgIHJhd1ZhbHVlOiB1bmtub3duO1xuICAgIH1cbj4ge1xuICBjb25zdCB2YWxpZGF0b3IgPSBhc1ZhbGlkYXRvcihzY2hlbWEpO1xuXG4gIHRyeSB7XG4gICAgaWYgKHZhbGlkYXRvci52YWxpZGF0ZSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogdmFsdWUgYXMgT0JKRUNULCByYXdWYWx1ZTogdmFsdWUgfTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB2YWxpZGF0b3IudmFsaWRhdGUodmFsdWUpO1xuXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogcmVzdWx0LnZhbHVlLCByYXdWYWx1ZTogdmFsdWUgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogVHlwZVZhbGlkYXRpb25FcnJvci53cmFwKHsgdmFsdWUsIGNhdXNlOiByZXN1bHQuZXJyb3IgfSksXG4gICAgICByYXdWYWx1ZTogdmFsdWUsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogVHlwZVZhbGlkYXRpb25FcnJvci53cmFwKHsgdmFsdWUsIGNhdXNlOiBlcnJvciB9KSxcbiAgICAgIHJhd1ZhbHVlOiB2YWx1ZSxcbiAgICB9O1xuICB9XG59XG4iLCAiaW1wb3J0IHsgVHlwZVZhbGlkYXRpb25FcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgU3RhbmRhcmRTY2hlbWFWMSB9IGZyb20gJ0BzdGFuZGFyZC1zY2hlbWEvc3BlYyc7XG5cbi8qKlxuICogVXNlZCB0byBtYXJrIHZhbGlkYXRvciBmdW5jdGlvbnMgc28gd2UgY2FuIHN1cHBvcnQgYm90aCBab2QgYW5kIGN1c3RvbSBzY2hlbWFzLlxuICovXG5leHBvcnQgY29uc3QgdmFsaWRhdG9yU3ltYm9sID0gU3ltYm9sLmZvcigndmVyY2VsLmFpLnZhbGlkYXRvcicpO1xuXG5leHBvcnQgdHlwZSBWYWxpZGF0aW9uUmVzdWx0PE9CSkVDVD4gPVxuICB8IHsgc3VjY2VzczogdHJ1ZTsgdmFsdWU6IE9CSkVDVCB9XG4gIHwgeyBzdWNjZXNzOiBmYWxzZTsgZXJyb3I6IEVycm9yIH07XG5cbmV4cG9ydCB0eXBlIFZhbGlkYXRvcjxPQkpFQ1QgPSB1bmtub3duPiA9IHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gbWFyayB2YWxpZGF0b3IgZnVuY3Rpb25zIHNvIHdlIGNhbiBzdXBwb3J0IGJvdGggWm9kIGFuZCBjdXN0b20gc2NoZW1hcy5cbiAgICovXG4gIFt2YWxpZGF0b3JTeW1ib2xdOiB0cnVlO1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbC4gVmFsaWRhdGVzIHRoYXQgdGhlIHN0cnVjdHVyZSBvZiBhIHZhbHVlIG1hdGNoZXMgdGhpcyBzY2hlbWEsXG4gICAqIGFuZCByZXR1cm5zIGEgdHlwZWQgdmVyc2lvbiBvZiB0aGUgdmFsdWUgaWYgaXQgZG9lcy5cbiAgICovXG4gIHJlYWRvbmx5IHZhbGlkYXRlPzogKFxuICAgIHZhbHVlOiB1bmtub3duLFxuICApID0+IFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPiB8IFByb21pc2VMaWtlPFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPj47XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIHZhbGlkYXRvci5cbiAqXG4gKiBAcGFyYW0gdmFsaWRhdGUgQSB2YWxpZGF0aW9uIGZ1bmN0aW9uIGZvciB0aGUgc2NoZW1hLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdG9yPE9CSkVDVD4oXG4gIHZhbGlkYXRlPzpcbiAgICB8IHVuZGVmaW5lZFxuICAgIHwgKChcbiAgICAgICAgdmFsdWU6IHVua25vd24sXG4gICAgICApID0+IFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPiB8IFByb21pc2VMaWtlPFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPj4pLFxuKTogVmFsaWRhdG9yPE9CSkVDVD4ge1xuICByZXR1cm4geyBbdmFsaWRhdG9yU3ltYm9sXTogdHJ1ZSwgdmFsaWRhdGUgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRhdG9yKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgVmFsaWRhdG9yIHtcbiAgcmV0dXJuIChcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgdmFsdWUgIT09IG51bGwgJiZcbiAgICB2YWxpZGF0b3JTeW1ib2wgaW4gdmFsdWUgJiZcbiAgICB2YWx1ZVt2YWxpZGF0b3JTeW1ib2xdID09PSB0cnVlICYmXG4gICAgJ3ZhbGlkYXRlJyBpbiB2YWx1ZVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNWYWxpZGF0b3I8T0JKRUNUPihcbiAgdmFsdWU6IFZhbGlkYXRvcjxPQkpFQ1Q+IHwgU3RhbmRhcmRTY2hlbWFWMTx1bmtub3duLCBPQkpFQ1Q+LFxuKTogVmFsaWRhdG9yPE9CSkVDVD4ge1xuICByZXR1cm4gaXNWYWxpZGF0b3IodmFsdWUpID8gdmFsdWUgOiBzdGFuZGFyZFNjaGVtYVZhbGlkYXRvcih2YWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFuZGFyZFNjaGVtYVZhbGlkYXRvcjxPQkpFQ1Q+KFxuICBzdGFuZGFyZFNjaGVtYTogU3RhbmRhcmRTY2hlbWFWMTx1bmtub3duLCBPQkpFQ1Q+LFxuKTogVmFsaWRhdG9yPE9CSkVDVD4ge1xuICByZXR1cm4gdmFsaWRhdG9yKGFzeW5jIHZhbHVlID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdGFuZGFyZFNjaGVtYVsnfnN0YW5kYXJkJ10udmFsaWRhdGUodmFsdWUpO1xuXG4gICAgcmV0dXJuIHJlc3VsdC5pc3N1ZXMgPT0gbnVsbFxuICAgICAgPyB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiByZXN1bHQudmFsdWUgfVxuICAgICAgOiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yKHtcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgY2F1c2U6IHJlc3VsdC5pc3N1ZXMsXG4gICAgICAgICAgfSksXG4gICAgICAgIH07XG4gIH0pO1xufVxuIiwgImltcG9ydCB7XG4gIEV2ZW50U291cmNlTWVzc2FnZSxcbiAgRXZlbnRTb3VyY2VQYXJzZXJTdHJlYW0sXG59IGZyb20gJ2V2ZW50c291cmNlLXBhcnNlci9zdHJlYW0nO1xuaW1wb3J0IHsgWm9kVHlwZSB9IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQgeyBQYXJzZVJlc3VsdCwgc2FmZVBhcnNlSlNPTiB9IGZyb20gJy4vcGFyc2UtanNvbic7XG5cbi8qKlxuICogUGFyc2VzIGEgSlNPTiBldmVudCBzdHJlYW0gaW50byBhIHN0cmVhbSBvZiBwYXJzZWQgSlNPTiBvYmplY3RzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uRXZlbnRTdHJlYW08VD4oe1xuICBzdHJlYW0sXG4gIHNjaGVtYSxcbn06IHtcbiAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5PjtcbiAgc2NoZW1hOiBab2RUeXBlPFQ+O1xufSk6IFJlYWRhYmxlU3RyZWFtPFBhcnNlUmVzdWx0PFQ+PiB7XG4gIHJldHVybiBzdHJlYW1cbiAgICAucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKCkpXG4gICAgLnBpcGVUaHJvdWdoKG5ldyBFdmVudFNvdXJjZVBhcnNlclN0cmVhbSgpKVxuICAgIC5waXBlVGhyb3VnaChcbiAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08RXZlbnRTb3VyY2VNZXNzYWdlLCBQYXJzZVJlc3VsdDxUPj4oe1xuICAgICAgICBhc3luYyB0cmFuc2Zvcm0oeyBkYXRhIH0sIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAvLyBpZ25vcmUgdGhlICdET05FJyBldmVudCB0aGF0IGUuZy4gT3BlbkFJIHNlbmRzOlxuICAgICAgICAgIGlmIChkYXRhID09PSAnW0RPTkVdJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShhd2FpdCBzYWZlUGFyc2VKU09OKHsgdGV4dDogZGF0YSwgc2NoZW1hIH0pKTtcbiAgICAgICAgfSxcbiAgICAgIH0pLFxuICAgICk7XG59XG4iLCAiaW1wb3J0IHsgSW52YWxpZEFyZ3VtZW50RXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IHNhZmVWYWxpZGF0ZVR5cGVzIH0gZnJvbSAnLi92YWxpZGF0ZS10eXBlcyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlUHJvdmlkZXJPcHRpb25zPFQ+KHtcbiAgcHJvdmlkZXIsXG4gIHByb3ZpZGVyT3B0aW9ucyxcbiAgc2NoZW1hLFxufToge1xuICBwcm92aWRlcjogc3RyaW5nO1xuICBwcm92aWRlck9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgdW5kZWZpbmVkO1xuICBzY2hlbWE6IHouY29yZS4kWm9kVHlwZTxULCBhbnk+O1xufSk6IFByb21pc2U8VCB8IHVuZGVmaW5lZD4ge1xuICBpZiAocHJvdmlkZXJPcHRpb25zPy5bcHJvdmlkZXJdID09IG51bGwpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3QgcGFyc2VkUHJvdmlkZXJPcHRpb25zID0gYXdhaXQgc2FmZVZhbGlkYXRlVHlwZXM8VCB8IHVuZGVmaW5lZD4oe1xuICAgIHZhbHVlOiBwcm92aWRlck9wdGlvbnNbcHJvdmlkZXJdLFxuICAgIHNjaGVtYSxcbiAgfSk7XG5cbiAgaWYgKCFwYXJzZWRQcm92aWRlck9wdGlvbnMuc3VjY2Vzcykge1xuICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICBhcmd1bWVudDogJ3Byb3ZpZGVyT3B0aW9ucycsXG4gICAgICBtZXNzYWdlOiBgaW52YWxpZCAke3Byb3ZpZGVyfSBwcm92aWRlciBvcHRpb25zYCxcbiAgICAgIGNhdXNlOiBwYXJzZWRQcm92aWRlck9wdGlvbnMuZXJyb3IsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcGFyc2VkUHJvdmlkZXJPcHRpb25zLnZhbHVlO1xufVxuIiwgImltcG9ydCB7IEFQSUNhbGxFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgZXh0cmFjdFJlc3BvbnNlSGVhZGVycyB9IGZyb20gJy4vZXh0cmFjdC1yZXNwb25zZS1oZWFkZXJzJztcbmltcG9ydCB7IEZldGNoRnVuY3Rpb24gfSBmcm9tICcuL2ZldGNoLWZ1bmN0aW9uJztcbmltcG9ydCB7IGhhbmRsZUZldGNoRXJyb3IgfSBmcm9tICcuL2hhbmRsZS1mZXRjaC1lcnJvcic7XG5pbXBvcnQgeyBpc0Fib3J0RXJyb3IgfSBmcm9tICcuL2lzLWFib3J0LWVycm9yJztcbmltcG9ydCB7IHJlbW92ZVVuZGVmaW5lZEVudHJpZXMgfSBmcm9tICcuL3JlbW92ZS11bmRlZmluZWQtZW50cmllcyc7XG5pbXBvcnQgeyBSZXNwb25zZUhhbmRsZXIgfSBmcm9tICcuL3Jlc3BvbnNlLWhhbmRsZXInO1xuXG4vLyB1c2UgZnVuY3Rpb24gdG8gYWxsb3cgZm9yIG1vY2tpbmcgaW4gdGVzdHM6XG5jb25zdCBnZXRPcmlnaW5hbEZldGNoID0gKCkgPT4gZ2xvYmFsVGhpcy5mZXRjaDtcblxuZXhwb3J0IGNvbnN0IHBvc3RKc29uVG9BcGkgPSBhc3luYyA8VD4oe1xuICB1cmwsXG4gIGhlYWRlcnMsXG4gIGJvZHksXG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcixcbiAgYWJvcnRTaWduYWwsXG4gIGZldGNoLFxufToge1xuICB1cmw6IHN0cmluZztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gIGJvZHk6IHVua25vd247XG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPEFQSUNhbGxFcnJvcj47XG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxUPjtcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgZmV0Y2g/OiBGZXRjaEZ1bmN0aW9uO1xufSkgPT5cbiAgcG9zdFRvQXBpKHtcbiAgICB1cmwsXG4gICAgaGVhZGVyczoge1xuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIC4uLmhlYWRlcnMsXG4gICAgfSxcbiAgICBib2R5OiB7XG4gICAgICBjb250ZW50OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgIHZhbHVlczogYm9keSxcbiAgICB9LFxuICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIGZldGNoLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IHBvc3RGb3JtRGF0YVRvQXBpID0gYXN5bmMgPFQ+KHtcbiAgdXJsLFxuICBoZWFkZXJzLFxuICBmb3JtRGF0YSxcbiAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyLFxuICBhYm9ydFNpZ25hbCxcbiAgZmV0Y2gsXG59OiB7XG4gIHVybDogc3RyaW5nO1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPjtcbiAgZm9ybURhdGE6IEZvcm1EYXRhO1xuICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxBUElDYWxsRXJyb3I+O1xuICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBSZXNwb25zZUhhbmRsZXI8VD47XG4gIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWw7XG4gIGZldGNoPzogRmV0Y2hGdW5jdGlvbjtcbn0pID0+XG4gIHBvc3RUb0FwaSh7XG4gICAgdXJsLFxuICAgIGhlYWRlcnMsXG4gICAgYm9keToge1xuICAgICAgY29udGVudDogZm9ybURhdGEsXG4gICAgICB2YWx1ZXM6IE9iamVjdC5mcm9tRW50cmllcygoZm9ybURhdGEgYXMgYW55KS5lbnRyaWVzKCkpLFxuICAgIH0sXG4gICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgZmV0Y2gsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgcG9zdFRvQXBpID0gYXN5bmMgPFQ+KHtcbiAgdXJsLFxuICBoZWFkZXJzID0ge30sXG4gIGJvZHksXG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIsXG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgYWJvcnRTaWduYWwsXG4gIGZldGNoID0gZ2V0T3JpZ2luYWxGZXRjaCgpLFxufToge1xuICB1cmw6IHN0cmluZztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gIGJvZHk6IHtcbiAgICBjb250ZW50OiBzdHJpbmcgfCBGb3JtRGF0YSB8IFVpbnQ4QXJyYXk7XG4gICAgdmFsdWVzOiB1bmtub3duO1xuICB9O1xuICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxFcnJvcj47XG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxUPjtcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgZmV0Y2g/OiBGZXRjaEZ1bmN0aW9uO1xufSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHJlbW92ZVVuZGVmaW5lZEVudHJpZXMoaGVhZGVycyksXG4gICAgICBib2R5OiBib2R5LmNvbnRlbnQsXG4gICAgICBzaWduYWw6IGFib3J0U2lnbmFsLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gZXh0cmFjdFJlc3BvbnNlSGVhZGVycyhyZXNwb25zZSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBsZXQgZXJyb3JJbmZvcm1hdGlvbjoge1xuICAgICAgICB2YWx1ZTogRXJyb3I7XG4gICAgICAgIHJlc3BvbnNlSGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7XG4gICAgICB9O1xuXG4gICAgICB0cnkge1xuICAgICAgICBlcnJvckluZm9ybWF0aW9uID0gYXdhaXQgZmFpbGVkUmVzcG9uc2VIYW5kbGVyKHtcbiAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXM6IGJvZHkudmFsdWVzLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChpc0Fib3J0RXJyb3IoZXJyb3IpIHx8IEFQSUNhbGxFcnJvci5pc0luc3RhbmNlKGVycm9yKSkge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3cgbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBwcm9jZXNzIGVycm9yIHJlc3BvbnNlJyxcbiAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXM6IGJvZHkudmFsdWVzLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgZXJyb3JJbmZvcm1hdGlvbi52YWx1ZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIoe1xuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczogYm9keS52YWx1ZXMsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgaWYgKGlzQWJvcnRFcnJvcihlcnJvcikgfHwgQVBJQ2FsbEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpKSB7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcHJvY2VzcyBzdWNjZXNzZnVsIHJlc3BvbnNlJyxcbiAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczogYm9keS52YWx1ZXMsXG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgaGFuZGxlRmV0Y2hFcnJvcih7IGVycm9yLCB1cmwsIHJlcXVlc3RCb2R5VmFsdWVzOiBib2R5LnZhbHVlcyB9KTtcbiAgfVxufTtcbiIsICJpbXBvcnQgeyBKU09OVmFsdWUsIExhbmd1YWdlTW9kZWxWMlRvb2xSZXN1bHRQYXJ0IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBGbGV4aWJsZVNjaGVtYSB9IGZyb20gJy4uL3NjaGVtYSc7XG5pbXBvcnQgeyBNb2RlbE1lc3NhZ2UgfSBmcm9tICcuL21vZGVsLW1lc3NhZ2UnO1xuaW1wb3J0IHsgUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnLi9wcm92aWRlci1vcHRpb25zJztcblxuLyoqXG4gKiBBZGRpdGlvbmFsIG9wdGlvbnMgdGhhdCBhcmUgc2VudCBpbnRvIGVhY2ggdG9vbCBjYWxsLlxuICovXG4vLyBUT0RPIEFJIFNESyA2OiByZW5hbWUgdG8gVG9vbEV4ZWN1dGlvbk9wdGlvbnNcbmV4cG9ydCBpbnRlcmZhY2UgVG9vbENhbGxPcHRpb25zIHtcbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgdG9vbCBjYWxsLiBZb3UgY2FuIHVzZSBpdCBlLmcuIHdoZW4gc2VuZGluZyB0b29sLWNhbGwgcmVsYXRlZCBpbmZvcm1hdGlvbiB3aXRoIHN0cmVhbSBkYXRhLlxuICAgKi9cbiAgdG9vbENhbGxJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBNZXNzYWdlcyB0aGF0IHdlcmUgc2VudCB0byB0aGUgbGFuZ3VhZ2UgbW9kZWwgdG8gaW5pdGlhdGUgdGhlIHJlc3BvbnNlIHRoYXQgY29udGFpbmVkIHRoZSB0b29sIGNhbGwuXG4gICAqIFRoZSBtZXNzYWdlcyAqKmRvIG5vdCoqIGluY2x1ZGUgdGhlIHN5c3RlbSBwcm9tcHQgbm9yIHRoZSBhc3Npc3RhbnQgcmVzcG9uc2UgdGhhdCBjb250YWluZWQgdGhlIHRvb2wgY2FsbC5cbiAgICovXG4gIG1lc3NhZ2VzOiBNb2RlbE1lc3NhZ2VbXTtcblxuICAvKipcbiAgICogQW4gb3B0aW9uYWwgYWJvcnQgc2lnbmFsIHRoYXQgaW5kaWNhdGVzIHRoYXQgdGhlIG92ZXJhbGwgb3BlcmF0aW9uIHNob3VsZCBiZSBhYm9ydGVkLlxuICAgKi9cbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcblxuICAvKipcbiAgICogQWRkaXRpb25hbCBjb250ZXh0LlxuICAgKlxuICAgKiBFeHBlcmltZW50YWwgKGNhbiBicmVhayBpbiBwYXRjaCByZWxlYXNlcykuXG4gICAqL1xuICBleHBlcmltZW50YWxfY29udGV4dD86IHVua25vd247XG59XG5cbmV4cG9ydCB0eXBlIFRvb2xFeGVjdXRlRnVuY3Rpb248SU5QVVQsIE9VVFBVVD4gPSAoXG4gIGlucHV0OiBJTlBVVCxcbiAgb3B0aW9uczogVG9vbENhbGxPcHRpb25zLFxuKSA9PiBBc3luY0l0ZXJhYmxlPE9VVFBVVD4gfCBQcm9taXNlTGlrZTxPVVRQVVQ+IHwgT1VUUFVUO1xuXG4vLyAwIGV4dGVuZHMgMSAmIE4gY2hlY2tzIGZvciBhbnlcbi8vIFtOXSBleHRlbmRzIFtuZXZlcl0gY2hlY2tzIGZvciBuZXZlclxudHlwZSBOZXZlck9wdGlvbmFsPE4sIFQ+ID0gMCBleHRlbmRzIDEgJiBOXG4gID8gUGFydGlhbDxUPlxuICA6IFtOXSBleHRlbmRzIFtuZXZlcl1cbiAgICA/IFBhcnRpYWw8UmVjb3JkPGtleW9mIFQsIHVuZGVmaW5lZD4+XG4gICAgOiBUO1xuXG4vKipcbkEgdG9vbCBjb250YWlucyB0aGUgZGVzY3JpcHRpb24gYW5kIHRoZSBzY2hlbWEgb2YgdGhlIGlucHV0IHRoYXQgdGhlIHRvb2wgZXhwZWN0cy5cblRoaXMgZW5hYmxlcyB0aGUgbGFuZ3VhZ2UgbW9kZWwgdG8gZ2VuZXJhdGUgdGhlIGlucHV0LlxuXG5UaGUgdG9vbCBjYW4gYWxzbyBjb250YWluIGFuIG9wdGlvbmFsIGV4ZWN1dGUgZnVuY3Rpb24gZm9yIHRoZSBhY3R1YWwgZXhlY3V0aW9uIGZ1bmN0aW9uIG9mIHRoZSB0b29sLlxuICovXG5leHBvcnQgdHlwZSBUb29sPFxuICBJTlBVVCBleHRlbmRzIEpTT05WYWx1ZSB8IHVua25vd24gfCBuZXZlciA9IGFueSxcbiAgT1VUUFVUIGV4dGVuZHMgSlNPTlZhbHVlIHwgdW5rbm93biB8IG5ldmVyID0gYW55LFxuPiA9IHtcbiAgLyoqXG5BbiBvcHRpb25hbCBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSB0b29sIGRvZXMuXG5XaWxsIGJlIHVzZWQgYnkgdGhlIGxhbmd1YWdlIG1vZGVsIHRvIGRlY2lkZSB3aGV0aGVyIHRvIHVzZSB0aGUgdG9vbC5cbk5vdCB1c2VkIGZvciBwcm92aWRlci1kZWZpbmVkIHRvb2xzLlxuICAgKi9cbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG5cbiAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxudG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5mdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gICAqL1xuICBwcm92aWRlck9wdGlvbnM/OiBQcm92aWRlck9wdGlvbnM7XG5cbiAgLyoqXG5UaGUgc2NoZW1hIG9mIHRoZSBpbnB1dCB0aGF0IHRoZSB0b29sIGV4cGVjdHMuIFRoZSBsYW5ndWFnZSBtb2RlbCB3aWxsIHVzZSB0aGlzIHRvIGdlbmVyYXRlIHRoZSBpbnB1dC5cbkl0IGlzIGFsc28gdXNlZCB0byB2YWxpZGF0ZSB0aGUgb3V0cHV0IG9mIHRoZSBsYW5ndWFnZSBtb2RlbC5cblVzZSBkZXNjcmlwdGlvbnMgdG8gbWFrZSB0aGUgaW5wdXQgdW5kZXJzdGFuZGFibGUgZm9yIHRoZSBsYW5ndWFnZSBtb2RlbC5cbiAgICovXG4gIGlucHV0U2NoZW1hOiBGbGV4aWJsZVNjaGVtYTxJTlBVVD47XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlIGFyZ3VtZW50IHN0cmVhbWluZyBzdGFydHMuXG4gICAqIE9ubHkgY2FsbGVkIHdoZW4gdGhlIHRvb2wgaXMgdXNlZCBpbiBhIHN0cmVhbWluZyBjb250ZXh0LlxuICAgKi9cbiAgb25JbnB1dFN0YXJ0PzogKG9wdGlvbnM6IFRvb2xDYWxsT3B0aW9ucykgPT4gdm9pZCB8IFByb21pc2VMaWtlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIGFuIGFyZ3VtZW50IHN0cmVhbWluZyBkZWx0YSBpcyBhdmFpbGFibGUuXG4gICAqIE9ubHkgY2FsbGVkIHdoZW4gdGhlIHRvb2wgaXMgdXNlZCBpbiBhIHN0cmVhbWluZyBjb250ZXh0LlxuICAgKi9cbiAgb25JbnB1dERlbHRhPzogKFxuICAgIG9wdGlvbnM6IHsgaW5wdXRUZXh0RGVsdGE6IHN0cmluZyB9ICYgVG9vbENhbGxPcHRpb25zLFxuICApID0+IHZvaWQgfCBQcm9taXNlTGlrZTx2b2lkPjtcblxuICAvKipcbiAgICogT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIHRvb2wgY2FsbCBjYW4gYmUgc3RhcnRlZCxcbiAgICogZXZlbiBpZiB0aGUgZXhlY3V0ZSBmdW5jdGlvbiBpcyBub3QgcHJvdmlkZWQuXG4gICAqL1xuICBvbklucHV0QXZhaWxhYmxlPzogKFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGlucHV0OiBbSU5QVVRdIGV4dGVuZHMgW25ldmVyXSA/IHVuZGVmaW5lZCA6IElOUFVUO1xuICAgIH0gJiBUb29sQ2FsbE9wdGlvbnMsXG4gICkgPT4gdm9pZCB8IFByb21pc2VMaWtlPHZvaWQ+O1xufSAmIE5ldmVyT3B0aW9uYWw8XG4gIE9VVFBVVCxcbiAge1xuICAgIC8qKlxuT3B0aW9uYWwgY29udmVyc2lvbiBmdW5jdGlvbiB0aGF0IG1hcHMgdGhlIHRvb2wgcmVzdWx0IHRvIGFuIG91dHB1dCB0aGF0IGNhbiBiZSB1c2VkIGJ5IHRoZSBsYW5ndWFnZSBtb2RlbC5cblxuSWYgbm90IHByb3ZpZGVkLCB0aGUgdG9vbCByZXN1bHQgd2lsbCBiZSBzZW50IGFzIGEgSlNPTiBvYmplY3QuXG4gICAgICAqL1xuICAgIHRvTW9kZWxPdXRwdXQ/OiAob3V0cHV0OiBPVVRQVVQpID0+IExhbmd1YWdlTW9kZWxWMlRvb2xSZXN1bHRQYXJ0WydvdXRwdXQnXTtcbiAgfSAmIChcbiAgICB8IHtcbiAgICAgICAgLyoqXG5BbiBhc3luYyBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aXRoIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgdG9vbCBjYWxsIGFuZCBwcm9kdWNlcyBhIHJlc3VsdC5cbklmIG5vdCBwcm92aWRlZCwgdGhlIHRvb2wgd2lsbCBub3QgYmUgZXhlY3V0ZWQgYXV0b21hdGljYWxseS5cblxuQGFyZ3MgaXMgdGhlIGlucHV0IG9mIHRoZSB0b29sIGNhbGwuXG5Ab3B0aW9ucy5hYm9ydFNpZ25hbCBpcyBhIHNpZ25hbCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFib3J0IHRoZSB0b29sIGNhbGwuXG4gICAgICAqL1xuICAgICAgICBleGVjdXRlOiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuXG4gICAgICAgIG91dHB1dFNjaGVtYT86IEZsZXhpYmxlU2NoZW1hPE9VVFBVVD47XG4gICAgICB9XG4gICAgfCB7XG4gICAgICAgIG91dHB1dFNjaGVtYTogRmxleGlibGVTY2hlbWE8T1VUUFVUPjtcblxuICAgICAgICBleGVjdXRlPzogbmV2ZXI7XG4gICAgICB9XG4gIClcbj4gJlxuICAoXG4gICAgfCB7XG4gICAgICAgIC8qKlxuVG9vbCB3aXRoIHVzZXItZGVmaW5lZCBpbnB1dCBhbmQgb3V0cHV0IHNjaGVtYXMuXG4gICAgICovXG4gICAgICAgIHR5cGU/OiB1bmRlZmluZWQgfCAnZnVuY3Rpb24nO1xuICAgICAgfVxuICAgIHwge1xuICAgICAgICAvKipcblRvb2wgdGhhdCBpcyBkZWZpbmVkIGF0IHJ1bnRpbWUgKGUuZy4gYW4gTUNQIHRvb2wpLlxuVGhlIHR5cGVzIG9mIGlucHV0IGFuZCBvdXRwdXQgYXJlIG5vdCBrbm93biBhdCBkZXZlbG9wbWVudCB0aW1lLlxuICAgICAgICovXG4gICAgICAgIHR5cGU6ICdkeW5hbWljJztcbiAgICAgIH1cbiAgICB8IHtcbiAgICAgICAgLyoqXG5Ub29sIHdpdGggcHJvdmlkZXItZGVmaW5lZCBpbnB1dCBhbmQgb3V0cHV0IHNjaGVtYXMuXG4gICAgICovXG4gICAgICAgIHR5cGU6ICdwcm92aWRlci1kZWZpbmVkJztcblxuICAgICAgICAvKipcblRoZSBJRCBvZiB0aGUgdG9vbC4gU2hvdWxkIGZvbGxvdyB0aGUgZm9ybWF0IGA8cHJvdmlkZXItbmFtZT4uPHVuaXF1ZS10b29sLW5hbWU+YC5cbiAgICovXG4gICAgICAgIGlkOiBgJHtzdHJpbmd9LiR7c3RyaW5nfWA7XG5cbiAgICAgICAgLyoqXG5UaGUgbmFtZSBvZiB0aGUgdG9vbCB0aGF0IHRoZSB1c2VyIG11c3QgdXNlIGluIHRoZSB0b29sIHNldC5cbiAqL1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG5cbiAgICAgICAgLyoqXG5UaGUgYXJndW1lbnRzIGZvciBjb25maWd1cmluZyB0aGUgdG9vbC4gTXVzdCBtYXRjaCB0aGUgZXhwZWN0ZWQgYXJndW1lbnRzIGRlZmluZWQgYnkgdGhlIHByb3ZpZGVyIGZvciB0aGlzIHRvb2wuXG4gICAgICovXG4gICAgICAgIGFyZ3M6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgfVxuICApO1xuXG4vKipcbiAqIEluZmVyIHRoZSBpbnB1dCB0eXBlIG9mIGEgdG9vbC5cbiAqL1xuZXhwb3J0IHR5cGUgSW5mZXJUb29sSW5wdXQ8VE9PTCBleHRlbmRzIFRvb2w+ID1cbiAgVE9PTCBleHRlbmRzIFRvb2w8aW5mZXIgSU5QVVQsIGFueT4gPyBJTlBVVCA6IG5ldmVyO1xuXG4vKipcbiAqIEluZmVyIHRoZSBvdXRwdXQgdHlwZSBvZiBhIHRvb2wuXG4gKi9cbmV4cG9ydCB0eXBlIEluZmVyVG9vbE91dHB1dDxUT09MIGV4dGVuZHMgVG9vbD4gPVxuICBUT09MIGV4dGVuZHMgVG9vbDxhbnksIGluZmVyIE9VVFBVVD4gPyBPVVRQVVQgOiBuZXZlcjtcblxuLyoqXG5IZWxwZXIgZnVuY3Rpb24gZm9yIGluZmVycmluZyB0aGUgZXhlY3V0ZSBhcmdzIG9mIGEgdG9vbC5cbiAqL1xuLy8gTm90ZTogb3ZlcmxvYWQgb3JkZXIgaXMgaW1wb3J0YW50IGZvciBhdXRvLWNvbXBsZXRpb25cbmV4cG9ydCBmdW5jdGlvbiB0b29sPElOUFVULCBPVVRQVVQ+KFxuICB0b29sOiBUb29sPElOUFVULCBPVVRQVVQ+LFxuKTogVG9vbDxJTlBVVCwgT1VUUFVUPjtcbmV4cG9ydCBmdW5jdGlvbiB0b29sPElOUFVUPih0b29sOiBUb29sPElOUFVULCBuZXZlcj4pOiBUb29sPElOUFVULCBuZXZlcj47XG5leHBvcnQgZnVuY3Rpb24gdG9vbDxPVVRQVVQ+KHRvb2w6IFRvb2w8bmV2ZXIsIE9VVFBVVD4pOiBUb29sPG5ldmVyLCBPVVRQVVQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHRvb2wodG9vbDogVG9vbDxuZXZlciwgbmV2ZXI+KTogVG9vbDxuZXZlciwgbmV2ZXI+O1xuZXhwb3J0IGZ1bmN0aW9uIHRvb2wodG9vbDogYW55KTogYW55IHtcbiAgcmV0dXJuIHRvb2w7XG59XG5cbi8qKlxuSGVscGVyIGZ1bmN0aW9uIGZvciBkZWZpbmluZyBhIGR5bmFtaWMgdG9vbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGR5bmFtaWNUb29sKHRvb2w6IHtcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcbiAgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPHVua25vd24+O1xuICBleGVjdXRlOiBUb29sRXhlY3V0ZUZ1bmN0aW9uPHVua25vd24sIHVua25vd24+O1xuICB0b01vZGVsT3V0cHV0PzogKG91dHB1dDogdW5rbm93bikgPT4gTGFuZ3VhZ2VNb2RlbFYyVG9vbFJlc3VsdFBhcnRbJ291dHB1dCddO1xufSk6IFRvb2w8dW5rbm93biwgdW5rbm93bj4gJiB7XG4gIHR5cGU6ICdkeW5hbWljJztcbn0ge1xuICByZXR1cm4geyAuLi50b29sLCB0eXBlOiAnZHluYW1pYycgfTtcbn1cbiIsICJpbXBvcnQgeyB0b29sLCBUb29sLCBUb29sRXhlY3V0ZUZ1bmN0aW9uIH0gZnJvbSAnLi90eXBlcy90b29sJztcbmltcG9ydCB7IEZsZXhpYmxlU2NoZW1hIH0gZnJvbSAnLi9zY2hlbWEnO1xuXG5leHBvcnQgdHlwZSBQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeTxJTlBVVCwgQVJHUyBleHRlbmRzIG9iamVjdD4gPSA8T1VUUFVUPihcbiAgb3B0aW9uczogQVJHUyAmIHtcbiAgICBleGVjdXRlPzogVG9vbEV4ZWN1dGVGdW5jdGlvbjxJTlBVVCwgT1VUUFVUPjtcbiAgICB0b01vZGVsT3V0cHV0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsndG9Nb2RlbE91dHB1dCddO1xuICAgIG9uSW5wdXRTdGFydD86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRTdGFydCddO1xuICAgIG9uSW5wdXREZWx0YT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXREZWx0YSddO1xuICAgIG9uSW5wdXRBdmFpbGFibGU/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0QXZhaWxhYmxlJ107XG4gIH0sXG4pID0+IFRvb2w8SU5QVVQsIE9VVFBVVD47XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeTxJTlBVVCwgQVJHUyBleHRlbmRzIG9iamVjdD4oe1xuICBpZCxcbiAgbmFtZSxcbiAgaW5wdXRTY2hlbWEsXG59OiB7XG4gIGlkOiBgJHtzdHJpbmd9LiR7c3RyaW5nfWA7XG4gIG5hbWU6IHN0cmluZztcbiAgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPElOUFVUPjtcbn0pOiBQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeTxJTlBVVCwgQVJHUz4ge1xuICByZXR1cm4gPE9VVFBVVD4oe1xuICAgIGV4ZWN1dGUsXG4gICAgb3V0cHV0U2NoZW1hLFxuICAgIHRvTW9kZWxPdXRwdXQsXG4gICAgb25JbnB1dFN0YXJ0LFxuICAgIG9uSW5wdXREZWx0YSxcbiAgICBvbklucHV0QXZhaWxhYmxlLFxuICAgIC4uLmFyZ3NcbiAgfTogQVJHUyAmIHtcbiAgICBleGVjdXRlPzogVG9vbEV4ZWN1dGVGdW5jdGlvbjxJTlBVVCwgT1VUUFVUPjtcbiAgICBvdXRwdXRTY2hlbWE/OiBGbGV4aWJsZVNjaGVtYTxPVVRQVVQ+O1xuICAgIHRvTW9kZWxPdXRwdXQ/OiBUb29sPElOUFVULCBPVVRQVVQ+Wyd0b01vZGVsT3V0cHV0J107XG4gICAgb25JbnB1dFN0YXJ0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dFN0YXJ0J107XG4gICAgb25JbnB1dERlbHRhPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dERlbHRhJ107XG4gICAgb25JbnB1dEF2YWlsYWJsZT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRBdmFpbGFibGUnXTtcbiAgfSk6IFRvb2w8SU5QVVQsIE9VVFBVVD4gPT5cbiAgICB0b29sKHtcbiAgICAgIHR5cGU6ICdwcm92aWRlci1kZWZpbmVkJyxcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGFyZ3MsXG4gICAgICBpbnB1dFNjaGVtYSxcbiAgICAgIG91dHB1dFNjaGVtYSxcbiAgICAgIGV4ZWN1dGUsXG4gICAgICB0b01vZGVsT3V0cHV0LFxuICAgICAgb25JbnB1dFN0YXJ0LFxuICAgICAgb25JbnB1dERlbHRhLFxuICAgICAgb25JbnB1dEF2YWlsYWJsZSxcbiAgICB9KTtcbn1cblxuZXhwb3J0IHR5cGUgUHJvdmlkZXJEZWZpbmVkVG9vbEZhY3RvcnlXaXRoT3V0cHV0U2NoZW1hPFxuICBJTlBVVCxcbiAgT1VUUFVULFxuICBBUkdTIGV4dGVuZHMgb2JqZWN0LFxuPiA9IChcbiAgb3B0aW9uczogQVJHUyAmIHtcbiAgICBleGVjdXRlPzogVG9vbEV4ZWN1dGVGdW5jdGlvbjxJTlBVVCwgT1VUUFVUPjtcbiAgICB0b01vZGVsT3V0cHV0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsndG9Nb2RlbE91dHB1dCddO1xuICAgIG9uSW5wdXRTdGFydD86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRTdGFydCddO1xuICAgIG9uSW5wdXREZWx0YT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXREZWx0YSddO1xuICAgIG9uSW5wdXRBdmFpbGFibGU/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0QXZhaWxhYmxlJ107XG4gIH0sXG4pID0+IFRvb2w8SU5QVVQsIE9VVFBVVD47XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeVdpdGhPdXRwdXRTY2hlbWE8XG4gIElOUFVULFxuICBPVVRQVVQsXG4gIEFSR1MgZXh0ZW5kcyBvYmplY3QsXG4+KHtcbiAgaWQsXG4gIG5hbWUsXG4gIGlucHV0U2NoZW1hLFxuICBvdXRwdXRTY2hlbWEsXG59OiB7XG4gIGlkOiBgJHtzdHJpbmd9LiR7c3RyaW5nfWA7XG4gIG5hbWU6IHN0cmluZztcbiAgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPElOUFVUPjtcbiAgb3V0cHV0U2NoZW1hOiBGbGV4aWJsZVNjaGVtYTxPVVRQVVQ+O1xufSk6IFByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5V2l0aE91dHB1dFNjaGVtYTxJTlBVVCwgT1VUUFVULCBBUkdTPiB7XG4gIHJldHVybiAoe1xuICAgIGV4ZWN1dGUsXG4gICAgdG9Nb2RlbE91dHB1dCxcbiAgICBvbklucHV0U3RhcnQsXG4gICAgb25JbnB1dERlbHRhLFxuICAgIG9uSW5wdXRBdmFpbGFibGUsXG4gICAgLi4uYXJnc1xuICB9OiBBUkdTICYge1xuICAgIGV4ZWN1dGU/OiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuICAgIHRvTW9kZWxPdXRwdXQ/OiBUb29sPElOUFVULCBPVVRQVVQ+Wyd0b01vZGVsT3V0cHV0J107XG4gICAgb25JbnB1dFN0YXJ0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dFN0YXJ0J107XG4gICAgb25JbnB1dERlbHRhPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dERlbHRhJ107XG4gICAgb25JbnB1dEF2YWlsYWJsZT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRBdmFpbGFibGUnXTtcbiAgfSk6IFRvb2w8SU5QVVQsIE9VVFBVVD4gPT5cbiAgICB0b29sKHtcbiAgICAgIHR5cGU6ICdwcm92aWRlci1kZWZpbmVkJyxcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGFyZ3MsXG4gICAgICBpbnB1dFNjaGVtYSxcbiAgICAgIG91dHB1dFNjaGVtYSxcbiAgICAgIGV4ZWN1dGUsXG4gICAgICB0b01vZGVsT3V0cHV0LFxuICAgICAgb25JbnB1dFN0YXJ0LFxuICAgICAgb25JbnB1dERlbHRhLFxuICAgICAgb25JbnB1dEF2YWlsYWJsZSxcbiAgICB9KTtcbn1cbiIsICJleHBvcnQgdHlwZSBSZXNvbHZhYmxlPFQ+ID1cbiAgfCBUIC8vIFJhdyB2YWx1ZVxuICB8IFByb21pc2U8VD4gLy8gUHJvbWlzZSBvZiB2YWx1ZVxuICB8ICgoKSA9PiBUKSAvLyBGdW5jdGlvbiByZXR1cm5pbmcgdmFsdWVcbiAgfCAoKCkgPT4gUHJvbWlzZTxUPik7IC8vIEZ1bmN0aW9uIHJldHVybmluZyBwcm9taXNlIG9mIHZhbHVlXG5cbi8qKlxuICogUmVzb2x2ZXMgYSB2YWx1ZSB0aGF0IGNvdWxkIGJlIGEgcmF3IHZhbHVlLCBhIFByb21pc2UsIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgdmFsdWUsXG4gKiBvciBhIGZ1bmN0aW9uIHJldHVybmluZyBhIFByb21pc2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXNvbHZlPFQ+KHZhbHVlOiBSZXNvbHZhYmxlPFQ+KTogUHJvbWlzZTxUPiB7XG4gIC8vIElmIGl0J3MgYSBmdW5jdGlvbiwgY2FsbCBpdCB0byBnZXQgdGhlIHZhbHVlL3Byb21pc2VcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhbHVlID0gKHZhbHVlIGFzIEZ1bmN0aW9uKSgpO1xuICB9XG5cbiAgLy8gT3RoZXJ3aXNlIGp1c3QgcmVzb2x2ZSB3aGF0ZXZlciB3ZSBnb3QgKHZhbHVlIG9yIHByb21pc2UpXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUgYXMgVCk7XG59XG4iLCAiaW1wb3J0IHsgQVBJQ2FsbEVycm9yLCBFbXB0eVJlc3BvbnNlQm9keUVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBab2RUeXBlIH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMgfSBmcm9tICcuL2V4dHJhY3QtcmVzcG9uc2UtaGVhZGVycyc7XG5pbXBvcnQgeyBwYXJzZUpTT04sIFBhcnNlUmVzdWx0LCBzYWZlUGFyc2VKU09OIH0gZnJvbSAnLi9wYXJzZS1qc29uJztcbmltcG9ydCB7IHBhcnNlSnNvbkV2ZW50U3RyZWFtIH0gZnJvbSAnLi9wYXJzZS1qc29uLWV2ZW50LXN0cmVhbSc7XG5cbmV4cG9ydCB0eXBlIFJlc3BvbnNlSGFuZGxlcjxSRVRVUk5fVFlQRT4gPSAob3B0aW9uczoge1xuICB1cmw6IHN0cmluZztcbiAgcmVxdWVzdEJvZHlWYWx1ZXM6IHVua25vd247XG4gIHJlc3BvbnNlOiBSZXNwb25zZTtcbn0pID0+IFByb21pc2VMaWtlPHtcbiAgdmFsdWU6IFJFVFVSTl9UWVBFO1xuICByYXdWYWx1ZT86IHVua25vd247XG4gIHJlc3BvbnNlSGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG59PjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlciA9XG4gIDxUPih7XG4gICAgZXJyb3JTY2hlbWEsXG4gICAgZXJyb3JUb01lc3NhZ2UsXG4gICAgaXNSZXRyeWFibGUsXG4gIH06IHtcbiAgICBlcnJvclNjaGVtYTogWm9kVHlwZTxUPjtcbiAgICBlcnJvclRvTWVzc2FnZTogKGVycm9yOiBUKSA9PiBzdHJpbmc7XG4gICAgaXNSZXRyeWFibGU/OiAocmVzcG9uc2U6IFJlc3BvbnNlLCBlcnJvcj86IFQpID0+IGJvb2xlYW47XG4gIH0pOiBSZXNwb25zZUhhbmRsZXI8QVBJQ2FsbEVycm9yPiA9PlxuICBhc3luYyAoeyByZXNwb25zZSwgdXJsLCByZXF1ZXN0Qm9keVZhbHVlcyB9KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2VCb2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuXG4gICAgLy8gU29tZSBwcm92aWRlcnMgcmV0dXJuIGFuIGVtcHR5IHJlc3BvbnNlIGJvZHkgZm9yIHNvbWUgZXJyb3JzOlxuICAgIGlmIChyZXNwb25zZUJvZHkudHJpbSgpID09PSAnJykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICB2YWx1ZTogbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgICByZXNwb25zZUJvZHksXG4gICAgICAgICAgaXNSZXRyeWFibGU6IGlzUmV0cnlhYmxlPy4ocmVzcG9uc2UpLFxuICAgICAgICB9KSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gcmVzaWxpZW50IHBhcnNpbmcgaW4gY2FzZSB0aGUgcmVzcG9uc2UgaXMgbm90IEpTT04gb3IgZG9lcyBub3QgbWF0Y2ggdGhlIHNjaGVtYTpcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkRXJyb3IgPSBhd2FpdCBwYXJzZUpTT04oe1xuICAgICAgICB0ZXh0OiByZXNwb25zZUJvZHksXG4gICAgICAgIHNjaGVtYTogZXJyb3JTY2hlbWEsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICB2YWx1ZTogbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3JUb01lc3NhZ2UocGFyc2VkRXJyb3IpLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICAgIHJlc3BvbnNlQm9keSxcbiAgICAgICAgICBkYXRhOiBwYXJzZWRFcnJvcixcbiAgICAgICAgICBpc1JldHJ5YWJsZTogaXNSZXRyeWFibGU/LihyZXNwb25zZSwgcGFyc2VkRXJyb3IpLFxuICAgICAgICB9KSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICB2YWx1ZTogbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgICByZXNwb25zZUJvZHksXG4gICAgICAgICAgaXNSZXRyeWFibGU6IGlzUmV0cnlhYmxlPy4ocmVzcG9uc2UpLFxuICAgICAgICB9KSxcbiAgICAgIH07XG4gICAgfVxuICB9O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlRXZlbnRTb3VyY2VSZXNwb25zZUhhbmRsZXIgPVxuICA8VD4oXG4gICAgY2h1bmtTY2hlbWE6IFpvZFR5cGU8VD4sXG4gICk6IFJlc3BvbnNlSGFuZGxlcjxSZWFkYWJsZVN0cmVhbTxQYXJzZVJlc3VsdDxUPj4+ID0+XG4gIGFzeW5jICh7IHJlc3BvbnNlIH06IHsgcmVzcG9uc2U6IFJlc3BvbnNlIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmIChyZXNwb25zZS5ib2R5ID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFbXB0eVJlc3BvbnNlQm9keUVycm9yKHt9KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgdmFsdWU6IHBhcnNlSnNvbkV2ZW50U3RyZWFtKHtcbiAgICAgICAgc3RyZWFtOiByZXNwb25zZS5ib2R5LFxuICAgICAgICBzY2hlbWE6IGNodW5rU2NoZW1hLFxuICAgICAgfSksXG4gICAgfTtcbiAgfTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUpzb25TdHJlYW1SZXNwb25zZUhhbmRsZXIgPVxuICA8VD4oXG4gICAgY2h1bmtTY2hlbWE6IFpvZFR5cGU8VD4sXG4gICk6IFJlc3BvbnNlSGFuZGxlcjxSZWFkYWJsZVN0cmVhbTxQYXJzZVJlc3VsdDxUPj4+ID0+XG4gIGFzeW5jICh7IHJlc3BvbnNlIH06IHsgcmVzcG9uc2U6IFJlc3BvbnNlIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmIChyZXNwb25zZS5ib2R5ID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFbXB0eVJlc3BvbnNlQm9keUVycm9yKHt9KTtcbiAgICB9XG5cbiAgICBsZXQgYnVmZmVyID0gJyc7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgdmFsdWU6IHJlc3BvbnNlLmJvZHkucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKCkpLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPHN0cmluZywgUGFyc2VSZXN1bHQ8VD4+KHtcbiAgICAgICAgICBhc3luYyB0cmFuc2Zvcm0oY2h1bmtUZXh0LCBjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAoY2h1bmtUZXh0LmVuZHNXaXRoKCdcXG4nKSkge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoXG4gICAgICAgICAgICAgICAgYXdhaXQgc2FmZVBhcnNlSlNPTih7XG4gICAgICAgICAgICAgICAgICB0ZXh0OiBidWZmZXIgKyBjaHVua1RleHQsXG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IGNodW5rU2NoZW1hLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBidWZmZXIgPSAnJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJ1ZmZlciArPSBjaHVua1RleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICApLFxuICAgIH07XG4gIH07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyID1cbiAgPFQ+KHJlc3BvbnNlU2NoZW1hOiBab2RUeXBlPFQ+KTogUmVzcG9uc2VIYW5kbGVyPFQ+ID0+XG4gIGFzeW5jICh7IHJlc3BvbnNlLCB1cmwsIHJlcXVlc3RCb2R5VmFsdWVzIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZUJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG5cbiAgICBjb25zdCBwYXJzZWRSZXN1bHQgPSBhd2FpdCBzYWZlUGFyc2VKU09OKHtcbiAgICAgIHRleHQ6IHJlc3BvbnNlQm9keSxcbiAgICAgIHNjaGVtYTogcmVzcG9uc2VTY2hlbWEsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmICghcGFyc2VkUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHRocm93IG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBKU09OIHJlc3BvbnNlJyxcbiAgICAgICAgY2F1c2U6IHBhcnNlZFJlc3VsdC5lcnJvcixcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHJlc3BvbnNlQm9keSxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICB2YWx1ZTogcGFyc2VkUmVzdWx0LnZhbHVlLFxuICAgICAgcmF3VmFsdWU6IHBhcnNlZFJlc3VsdC5yYXdWYWx1ZSxcbiAgICB9O1xuICB9O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlQmluYXJ5UmVzcG9uc2VIYW5kbGVyID1cbiAgKCk6IFJlc3BvbnNlSGFuZGxlcjxVaW50OEFycmF5PiA9PlxuICBhc3luYyAoeyByZXNwb25zZSwgdXJsLCByZXF1ZXN0Qm9keVZhbHVlcyB9KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gZXh0cmFjdFJlc3BvbnNlSGVhZGVycyhyZXNwb25zZSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLmJvZHkpIHtcbiAgICAgIHRocm93IG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiAnUmVzcG9uc2UgYm9keSBpcyBlbXB0eScsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICByZXNwb25zZUJvZHk6IHVuZGVmaW5lZCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBidWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICB2YWx1ZTogbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJlYWQgcmVzcG9uc2UgYXMgYXJyYXkgYnVmZmVyJyxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHJlc3BvbnNlQm9keTogdW5kZWZpbmVkLFxuICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVTdGF0dXNDb2RlRXJyb3JSZXNwb25zZUhhbmRsZXIgPVxuICAoKTogUmVzcG9uc2VIYW5kbGVyPEFQSUNhbGxFcnJvcj4gPT5cbiAgYXN5bmMgKHsgcmVzcG9uc2UsIHVybCwgcmVxdWVzdEJvZHlWYWx1ZXMgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcblxuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICB2YWx1ZTogbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXM6IHJlcXVlc3RCb2R5VmFsdWVzIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgcmVzcG9uc2VCb2R5LFxuICAgICAgfSksXG4gICAgfTtcbiAgfTtcbiIsICJpbXBvcnQgeyBKU09OU2NoZW1hNyB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0ICogYXMgejMgZnJvbSAnem9kL3YzJztcbmltcG9ydCAqIGFzIHo0IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQgem9kVG9Kc29uU2NoZW1hIGZyb20gJ3pvZC10by1qc29uLXNjaGVtYSc7XG5pbXBvcnQgeyBqc29uU2NoZW1hLCBTY2hlbWEgfSBmcm9tICcuL3NjaGVtYSc7XG5cbmV4cG9ydCBmdW5jdGlvbiB6b2QzU2NoZW1hPE9CSkVDVD4oXG4gIHpvZFNjaGVtYTogejMuU2NoZW1hPE9CSkVDVCwgejMuWm9kVHlwZURlZiwgYW55PixcbiAgb3B0aW9ucz86IHtcbiAgICAvKipcbiAgICAgKiBFbmFibGVzIHN1cHBvcnQgZm9yIHJlZmVyZW5jZXMgaW4gdGhlIHNjaGVtYS5cbiAgICAgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciByZWN1cnNpdmUgc2NoZW1hcywgZS5nLiB3aXRoIGB6LmxhenlgLlxuICAgICAqIEhvd2V2ZXIsIG5vdCBhbGwgbGFuZ3VhZ2UgbW9kZWxzIGFuZCBwcm92aWRlcnMgc3VwcG9ydCBzdWNoIHJlZmVyZW5jZXMuXG4gICAgICogRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAgICAgKi9cbiAgICB1c2VSZWZlcmVuY2VzPzogYm9vbGVhbjtcbiAgfSxcbik6IFNjaGVtYTxPQkpFQ1Q+IHtcbiAgLy8gZGVmYXVsdCB0byBubyByZWZlcmVuY2VzICh0byBzdXBwb3J0IG9wZW5hcGkgY29udmVyc2lvbiBmb3IgZ29vZ2xlKVxuICBjb25zdCB1c2VSZWZlcmVuY2VzID0gb3B0aW9ucz8udXNlUmVmZXJlbmNlcyA/PyBmYWxzZTtcblxuICByZXR1cm4ganNvblNjaGVtYShcbiAgICB6b2RUb0pzb25TY2hlbWEoem9kU2NoZW1hLCB7XG4gICAgICAkcmVmU3RyYXRlZ3k6IHVzZVJlZmVyZW5jZXMgPyAncm9vdCcgOiAnbm9uZScsXG4gICAgICB0YXJnZXQ6ICdqc29uU2NoZW1hNycsIC8vIG5vdGU6IG9wZW5haSBtb2RlIGJyZWFrcyB2YXJpb3VzIGdlbWluaSBjb252ZXJzaW9uc1xuICAgIH0pIGFzIEpTT05TY2hlbWE3LFxuICAgIHtcbiAgICAgIHZhbGlkYXRlOiBhc3luYyB2YWx1ZSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHpvZFNjaGVtYS5zYWZlUGFyc2VBc3luYyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiByZXN1bHQuc3VjY2Vzc1xuICAgICAgICAgID8geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogcmVzdWx0LmRhdGEgfVxuICAgICAgICAgIDogeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHJlc3VsdC5lcnJvciB9O1xuICAgICAgfSxcbiAgICB9LFxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gem9kNFNjaGVtYTxPQkpFQ1Q+KFxuICB6b2RTY2hlbWE6IHo0LmNvcmUuJFpvZFR5cGU8T0JKRUNULCBhbnk+LFxuICBvcHRpb25zPzoge1xuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgc3VwcG9ydCBmb3IgcmVmZXJlbmNlcyBpbiB0aGUgc2NoZW1hLlxuICAgICAqIFRoaXMgaXMgcmVxdWlyZWQgZm9yIHJlY3Vyc2l2ZSBzY2hlbWFzLCBlLmcuIHdpdGggYHoubGF6eWAuXG4gICAgICogSG93ZXZlciwgbm90IGFsbCBsYW5ndWFnZSBtb2RlbHMgYW5kIHByb3ZpZGVycyBzdXBwb3J0IHN1Y2ggcmVmZXJlbmNlcy5cbiAgICAgKiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgICAqL1xuICAgIHVzZVJlZmVyZW5jZXM/OiBib29sZWFuO1xuICB9LFxuKTogU2NoZW1hPE9CSkVDVD4ge1xuICAvLyBkZWZhdWx0IHRvIG5vIHJlZmVyZW5jZXMgKHRvIHN1cHBvcnQgb3BlbmFwaSBjb252ZXJzaW9uIGZvciBnb29nbGUpXG4gIGNvbnN0IHVzZVJlZmVyZW5jZXMgPSBvcHRpb25zPy51c2VSZWZlcmVuY2VzID8/IGZhbHNlO1xuXG4gIGNvbnN0IHo0SlNPTlNjaGVtYSA9IHo0LnRvSlNPTlNjaGVtYSh6b2RTY2hlbWEsIHtcbiAgICB0YXJnZXQ6ICdkcmFmdC03JyxcbiAgICBpbzogJ291dHB1dCcsXG4gICAgcmV1c2VkOiB1c2VSZWZlcmVuY2VzID8gJ3JlZicgOiAnaW5saW5lJyxcbiAgfSkgYXMgSlNPTlNjaGVtYTc7XG5cbiAgcmV0dXJuIGpzb25TY2hlbWEoejRKU09OU2NoZW1hLCB7XG4gICAgdmFsaWRhdGU6IGFzeW5jIHZhbHVlID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHo0LnNhZmVQYXJzZUFzeW5jKHpvZFNjaGVtYSwgdmFsdWUpO1xuICAgICAgcmV0dXJuIHJlc3VsdC5zdWNjZXNzXG4gICAgICAgID8geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogcmVzdWx0LmRhdGEgfVxuICAgICAgICA6IHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiByZXN1bHQuZXJyb3IgfTtcbiAgICB9LFxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzWm9kNFNjaGVtYShcbiAgem9kU2NoZW1hOiB6NC5jb3JlLiRab2RUeXBlPGFueSwgYW55PiB8IHozLlNjaGVtYTxhbnksIHozLlpvZFR5cGVEZWYsIGFueT4sXG4pOiB6b2RTY2hlbWEgaXMgejQuY29yZS4kWm9kVHlwZTxhbnksIGFueT4ge1xuICAvLyBodHRwczovL3pvZC5kZXYvbGlicmFyeS1hdXRob3JzP2lkPWhvdy10by1zdXBwb3J0LXpvZC0zLWFuZC16b2QtNC1zaW11bHRhbmVvdXNseVxuICByZXR1cm4gJ196b2QnIGluIHpvZFNjaGVtYTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHpvZFNjaGVtYTxPQkpFQ1Q+KFxuICB6b2RTY2hlbWE6XG4gICAgfCB6NC5jb3JlLiRab2RUeXBlPE9CSkVDVCwgYW55PlxuICAgIHwgejMuU2NoZW1hPE9CSkVDVCwgejMuWm9kVHlwZURlZiwgYW55PixcbiAgb3B0aW9ucz86IHtcbiAgICAvKipcbiAgICAgKiBFbmFibGVzIHN1cHBvcnQgZm9yIHJlZmVyZW5jZXMgaW4gdGhlIHNjaGVtYS5cbiAgICAgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciByZWN1cnNpdmUgc2NoZW1hcywgZS5nLiB3aXRoIGB6LmxhenlgLlxuICAgICAqIEhvd2V2ZXIsIG5vdCBhbGwgbGFuZ3VhZ2UgbW9kZWxzIGFuZCBwcm92aWRlcnMgc3VwcG9ydCBzdWNoIHJlZmVyZW5jZXMuXG4gICAgICogRGVmYXVsdHMgdG8gYGZhbHNlYC5cbiAgICAgKi9cbiAgICB1c2VSZWZlcmVuY2VzPzogYm9vbGVhbjtcbiAgfSxcbik6IFNjaGVtYTxPQkpFQ1Q+IHtcbiAgaWYgKGlzWm9kNFNjaGVtYSh6b2RTY2hlbWEpKSB7XG4gICAgcmV0dXJuIHpvZDRTY2hlbWEoem9kU2NoZW1hLCBvcHRpb25zKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gem9kM1NjaGVtYSh6b2RTY2hlbWEsIG9wdGlvbnMpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgVmFsaWRhdG9yLCB2YWxpZGF0b3JTeW1ib2wsIHR5cGUgVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdmFsaWRhdG9yJztcbmltcG9ydCB7IEpTT05TY2hlbWE3IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IHpvZFNjaGVtYSB9IGZyb20gJy4vem9kLXNjaGVtYSc7XG5cbi8qKlxuICogVXNlZCB0byBtYXJrIHNjaGVtYXMgc28gd2UgY2FuIHN1cHBvcnQgYm90aCBab2QgYW5kIGN1c3RvbSBzY2hlbWFzLlxuICovXG5jb25zdCBzY2hlbWFTeW1ib2wgPSBTeW1ib2wuZm9yKCd2ZXJjZWwuYWkuc2NoZW1hJyk7XG5cbmV4cG9ydCB0eXBlIFNjaGVtYTxPQkpFQ1QgPSB1bmtub3duPiA9IFZhbGlkYXRvcjxPQkpFQ1Q+ICYge1xuICAvKipcbiAgICogVXNlZCB0byBtYXJrIHNjaGVtYXMgc28gd2UgY2FuIHN1cHBvcnQgYm90aCBab2QgYW5kIGN1c3RvbSBzY2hlbWFzLlxuICAgKi9cbiAgW3NjaGVtYVN5bWJvbF06IHRydWU7XG5cbiAgLyoqXG4gICAqIFNjaGVtYSB0eXBlIGZvciBpbmZlcmVuY2UuXG4gICAqL1xuICBfdHlwZTogT0JKRUNUO1xuXG4gIC8qKlxuICAgKiBUaGUgSlNPTiBTY2hlbWEgZm9yIHRoZSBzY2hlbWEuIEl0IGlzIHBhc3NlZCB0byB0aGUgcHJvdmlkZXJzLlxuICAgKi9cbiAgcmVhZG9ubHkganNvblNjaGVtYTogSlNPTlNjaGVtYTc7XG59O1xuXG4vLyBOb3RlOiBab2QgdHlwZXMgaGVyZSBleGFjdGx5IG1hdGNoIHRoZSB0eXBlcyBpbiB6b2Qtc2NoZW1hLnRzXG4vLyB0byBwcmV2ZW50IHR5cGUgZXJyb3JzIHdoZW4gdXNpbmcgem9kIHNjaGVtYXMgd2l0aCBmbGV4aWJsZSBzY2hlbWFzLlxuZXhwb3J0IHR5cGUgRmxleGlibGVTY2hlbWE8VD4gPVxuICB8IHo0LmNvcmUuJFpvZFR5cGU8VCwgYW55PlxuICB8IHozLlNjaGVtYTxULCB6My5ab2RUeXBlRGVmLCBhbnk+XG4gIHwgU2NoZW1hPFQ+O1xuXG5leHBvcnQgdHlwZSBJbmZlclNjaGVtYTxTQ0hFTUE+ID0gU0NIRU1BIGV4dGVuZHMgejMuU2NoZW1hXG4gID8gejMuaW5mZXI8U0NIRU1BPlxuICA6IFNDSEVNQSBleHRlbmRzIHo0LmNvcmUuJFpvZFR5cGVcbiAgICA/IHo0LmluZmVyPFNDSEVNQT5cbiAgICA6IFNDSEVNQSBleHRlbmRzIFNjaGVtYTxpbmZlciBUPlxuICAgICAgPyBUXG4gICAgICA6IG5ldmVyO1xuXG4vKipcbiAqIENyZWF0ZSBhIHNjaGVtYSB1c2luZyBhIEpTT04gU2NoZW1hLlxuICpcbiAqIEBwYXJhbSBqc29uU2NoZW1hIFRoZSBKU09OIFNjaGVtYSBmb3IgdGhlIHNjaGVtYS5cbiAqIEBwYXJhbSBvcHRpb25zLnZhbGlkYXRlIE9wdGlvbmFsLiBBIHZhbGlkYXRpb24gZnVuY3Rpb24gZm9yIHRoZSBzY2hlbWEuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBqc29uU2NoZW1hPE9CSkVDVCA9IHVua25vd24+KFxuICBqc29uU2NoZW1hOiBKU09OU2NoZW1hNyxcbiAge1xuICAgIHZhbGlkYXRlLFxuICB9OiB7XG4gICAgdmFsaWRhdGU/OiAoXG4gICAgICB2YWx1ZTogdW5rbm93bixcbiAgICApID0+IFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPiB8IFByb21pc2VMaWtlPFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPj47XG4gIH0gPSB7fSxcbik6IFNjaGVtYTxPQkpFQ1Q+IHtcbiAgcmV0dXJuIHtcbiAgICBbc2NoZW1hU3ltYm9sXTogdHJ1ZSxcbiAgICBfdHlwZTogdW5kZWZpbmVkIGFzIE9CSkVDVCwgLy8gc2hvdWxkIG5ldmVyIGJlIHVzZWQgZGlyZWN0bHlcbiAgICBbdmFsaWRhdG9yU3ltYm9sXTogdHJ1ZSxcbiAgICBqc29uU2NoZW1hLFxuICAgIHZhbGlkYXRlLFxuICB9O1xufVxuXG5mdW5jdGlvbiBpc1NjaGVtYSh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIFNjaGVtYSB7XG4gIHJldHVybiAoXG4gICAgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJlxuICAgIHZhbHVlICE9PSBudWxsICYmXG4gICAgc2NoZW1hU3ltYm9sIGluIHZhbHVlICYmXG4gICAgdmFsdWVbc2NoZW1hU3ltYm9sXSA9PT0gdHJ1ZSAmJlxuICAgICdqc29uU2NoZW1hJyBpbiB2YWx1ZSAmJlxuICAgICd2YWxpZGF0ZScgaW4gdmFsdWVcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzU2NoZW1hPE9CSkVDVD4oXG4gIHNjaGVtYTpcbiAgICB8IHo0LmNvcmUuJFpvZFR5cGU8T0JKRUNULCBhbnk+XG4gICAgfCB6My5TY2hlbWE8T0JKRUNULCB6My5ab2RUeXBlRGVmLCBhbnk+XG4gICAgfCBTY2hlbWE8T0JKRUNUPlxuICAgIHwgdW5kZWZpbmVkLFxuKTogU2NoZW1hPE9CSkVDVD4ge1xuICByZXR1cm4gc2NoZW1hID09IG51bGxcbiAgICA/IGpzb25TY2hlbWEoe1xuICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICAgICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IGZhbHNlLFxuICAgICAgfSlcbiAgICA6IGlzU2NoZW1hKHNjaGVtYSlcbiAgICAgID8gc2NoZW1hXG4gICAgICA6IHpvZFNjaGVtYShzY2hlbWEpO1xufVxuIiwgIi8vIGJ0b2EgYW5kIGF0b2IgbmVlZCB0byBiZSBpbnZva2VkIGFzIGEgZnVuY3Rpb24gY2FsbCwgbm90IGFzIGEgbWV0aG9kIGNhbGwuXG4vLyBPdGhlcndpc2UgQ2xvdWRGbGFyZSB3aWxsIHRocm93IGFcbi8vIFwiVHlwZUVycm9yOiBJbGxlZ2FsIGludm9jYXRpb246IGZ1bmN0aW9uIGNhbGxlZCB3aXRoIGluY29ycmVjdCB0aGlzIHJlZmVyZW5jZVwiXG5jb25zdCB7IGJ0b2EsIGF0b2IgfSA9IGdsb2JhbFRoaXM7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0QmFzZTY0VG9VaW50OEFycmF5KGJhc2U2NFN0cmluZzogc3RyaW5nKSB7XG4gIGNvbnN0IGJhc2U2NFVybCA9IGJhc2U2NFN0cmluZy5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpO1xuICBjb25zdCBsYXRpbjFzdHJpbmcgPSBhdG9iKGJhc2U2NFVybCk7XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20obGF0aW4xc3RyaW5nLCBieXRlID0+IGJ5dGUuY29kZVBvaW50QXQoMCkhKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRVaW50OEFycmF5VG9CYXNlNjQoYXJyYXk6IFVpbnQ4QXJyYXkpOiBzdHJpbmcge1xuICBsZXQgbGF0aW4xc3RyaW5nID0gJyc7XG5cbiAgLy8gTm90ZTogcmVndWxhciBmb3IgbG9vcCB0byBzdXBwb3J0IG9sZGVyIEphdmFTY3JpcHQgdmVyc2lvbnMgdGhhdFxuICAvLyBkbyBub3Qgc3VwcG9ydCBmb3IuLm9mIG9uIFVpbnQ4QXJyYXlcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGxhdGluMXN0cmluZyArPSBTdHJpbmcuZnJvbUNvZGVQb2ludChhcnJheVtpXSk7XG4gIH1cblxuICByZXR1cm4gYnRvYShsYXRpbjFzdHJpbmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFRvQmFzZTY0KHZhbHVlOiBzdHJpbmcgfCBVaW50OEFycmF5KTogc3RyaW5nIHtcbiAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSA/IGNvbnZlcnRVaW50OEFycmF5VG9CYXNlNjQodmFsdWUpIDogdmFsdWU7XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIHdpdGhvdXRUcmFpbGluZ1NsYXNoKHVybDogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gIHJldHVybiB1cmw/LnJlcGxhY2UoL1xcLyQvLCAnJyk7XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGlzQXN5bmNJdGVyYWJsZTxUID0gYW55PihvYmo6IGFueSk6IG9iaiBpcyBBc3luY0l0ZXJhYmxlPFQ+IHtcbiAgcmV0dXJuIG9iaiAhPSBudWxsICYmIHR5cGVvZiBvYmpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID09PSAnZnVuY3Rpb24nO1xufVxuIiwgImltcG9ydCB7IFRvb2wsIFRvb2xDYWxsT3B0aW9ucywgVG9vbEV4ZWN1dGVGdW5jdGlvbiB9IGZyb20gJy4vdG9vbCc7XG5pbXBvcnQgeyBpc0FzeW5jSXRlcmFibGUgfSBmcm9tICcuLi9pcy1hc3luYy1pdGVyYWJsZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiogZXhlY3V0ZVRvb2w8SU5QVVQsIE9VVFBVVD4oe1xuICBleGVjdXRlLFxuICBpbnB1dCxcbiAgb3B0aW9ucyxcbn06IHtcbiAgZXhlY3V0ZTogVG9vbEV4ZWN1dGVGdW5jdGlvbjxJTlBVVCwgT1VUUFVUPjtcbiAgaW5wdXQ6IElOUFVUO1xuICBvcHRpb25zOiBUb29sQ2FsbE9wdGlvbnM7XG59KTogQXN5bmNHZW5lcmF0b3I8XG4gIHsgdHlwZTogJ3ByZWxpbWluYXJ5Jzsgb3V0cHV0OiBPVVRQVVQgfSB8IHsgdHlwZTogJ2ZpbmFsJzsgb3V0cHV0OiBPVVRQVVQgfVxuPiB7XG4gIGNvbnN0IHJlc3VsdCA9IGV4ZWN1dGUoaW5wdXQsIG9wdGlvbnMpO1xuXG4gIGlmIChpc0FzeW5jSXRlcmFibGUocmVzdWx0KSkge1xuICAgIGxldCBsYXN0T3V0cHV0OiBPVVRQVVQgfCB1bmRlZmluZWQ7XG4gICAgZm9yIGF3YWl0IChjb25zdCBvdXRwdXQgb2YgcmVzdWx0KSB7XG4gICAgICBsYXN0T3V0cHV0ID0gb3V0cHV0O1xuICAgICAgeWllbGQgeyB0eXBlOiAncHJlbGltaW5hcnknLCBvdXRwdXQgfTtcbiAgICB9XG4gICAgeWllbGQgeyB0eXBlOiAnZmluYWwnLCBvdXRwdXQ6IGxhc3RPdXRwdXQhIH07XG4gIH0gZWxzZSB7XG4gICAgeWllbGQgeyB0eXBlOiAnZmluYWwnLCBvdXRwdXQ6IGF3YWl0IHJlc3VsdCB9O1xuICB9XG59XG4iLCAiZXhwb3J0ICogZnJvbSAnLi9jb21iaW5lLWhlYWRlcnMnO1xuZXhwb3J0IHsgY29udmVydEFzeW5jSXRlcmF0b3JUb1JlYWRhYmxlU3RyZWFtIH0gZnJvbSAnLi9jb252ZXJ0LWFzeW5jLWl0ZXJhdG9yLXRvLXJlYWRhYmxlLXN0cmVhbSc7XG5leHBvcnQgKiBmcm9tICcuL2RlbGF5JztcbmV4cG9ydCAqIGZyb20gJy4vZXh0cmFjdC1yZXNwb25zZS1oZWFkZXJzJztcbmV4cG9ydCAqIGZyb20gJy4vZmV0Y2gtZnVuY3Rpb24nO1xuZXhwb3J0IHsgY3JlYXRlSWRHZW5lcmF0b3IsIGdlbmVyYXRlSWQsIHR5cGUgSWRHZW5lcmF0b3IgfSBmcm9tICcuL2dlbmVyYXRlLWlkJztcbmV4cG9ydCAqIGZyb20gJy4vZ2V0LWVycm9yLW1lc3NhZ2UnO1xuZXhwb3J0ICogZnJvbSAnLi9nZXQtZnJvbS1hcGknO1xuZXhwb3J0ICogZnJvbSAnLi9pcy1hYm9ydC1lcnJvcic7XG5leHBvcnQgeyBpc1VybFN1cHBvcnRlZCB9IGZyb20gJy4vaXMtdXJsLXN1cHBvcnRlZCc7XG5leHBvcnQgKiBmcm9tICcuL2xvYWQtYXBpLWtleSc7XG5leHBvcnQgeyBsb2FkT3B0aW9uYWxTZXR0aW5nIH0gZnJvbSAnLi9sb2FkLW9wdGlvbmFsLXNldHRpbmcnO1xuZXhwb3J0IHsgbG9hZFNldHRpbmcgfSBmcm9tICcuL2xvYWQtc2V0dGluZyc7XG5leHBvcnQgKiBmcm9tICcuL3BhcnNlLWpzb24nO1xuZXhwb3J0IHsgcGFyc2VKc29uRXZlbnRTdHJlYW0gfSBmcm9tICcuL3BhcnNlLWpzb24tZXZlbnQtc3RyZWFtJztcbmV4cG9ydCB7IHBhcnNlUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnLi9wYXJzZS1wcm92aWRlci1vcHRpb25zJztcbmV4cG9ydCAqIGZyb20gJy4vcG9zdC10by1hcGknO1xuZXhwb3J0IHtcbiAgY3JlYXRlUHJvdmlkZXJEZWZpbmVkVG9vbEZhY3RvcnksXG4gIHR5cGUgUHJvdmlkZXJEZWZpbmVkVG9vbEZhY3RvcnksXG4gIGNyZWF0ZVByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5V2l0aE91dHB1dFNjaGVtYSxcbiAgdHlwZSBQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeVdpdGhPdXRwdXRTY2hlbWEsXG59IGZyb20gJy4vcHJvdmlkZXItZGVmaW5lZC10b29sLWZhY3RvcnknO1xuZXhwb3J0ICogZnJvbSAnLi9yZW1vdmUtdW5kZWZpbmVkLWVudHJpZXMnO1xuZXhwb3J0ICogZnJvbSAnLi9yZXNvbHZlJztcbmV4cG9ydCAqIGZyb20gJy4vcmVzcG9uc2UtaGFuZGxlcic7XG5leHBvcnQge1xuICBhc1NjaGVtYSxcbiAganNvblNjaGVtYSxcbiAgdHlwZSBGbGV4aWJsZVNjaGVtYSxcbiAgdHlwZSBJbmZlclNjaGVtYSxcbiAgdHlwZSBTY2hlbWEsXG59IGZyb20gJy4vc2NoZW1hJztcbmV4cG9ydCAqIGZyb20gJy4vdWludDgtdXRpbHMnO1xuZXhwb3J0ICogZnJvbSAnLi92YWxpZGF0ZS10eXBlcyc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbGlkYXRvcic7XG5leHBvcnQgKiBmcm9tICcuL3dpdGhvdXQtdHJhaWxpbmctc2xhc2gnO1xuZXhwb3J0IHsgem9kU2NoZW1hIH0gZnJvbSAnLi96b2Qtc2NoZW1hJztcblxuLy8gZm9sZGVyIHJlLWV4cG9ydHNcbmV4cG9ydCAqIGZyb20gJy4vdHlwZXMnO1xuXG4vLyBleHRlcm5hbCByZS1leHBvcnRzXG5leHBvcnQgKiBmcm9tICdAc3RhbmRhcmQtc2NoZW1hL3NwZWMnO1xuZXhwb3J0IHtcbiAgRXZlbnRTb3VyY2VQYXJzZXJTdHJlYW0sXG4gIHR5cGUgRXZlbnRTb3VyY2VNZXNzYWdlLFxufSBmcm9tICdldmVudHNvdXJjZS1wYXJzZXIvc3RyZWFtJztcbiIsICJleHBvcnQgY29uc3QgaWdub3JlT3ZlcnJpZGUgPSBTeW1ib2woXCJMZXQgem9kVG9Kc29uU2NoZW1hIGRlY2lkZSBvbiB3aGljaCBwYXJzZXIgdG8gdXNlXCIpO1xuZXhwb3J0IGNvbnN0IGpzb25EZXNjcmlwdGlvbiA9IChqc29uU2NoZW1hLCBkZWYpID0+IHtcbiAgICBpZiAoZGVmLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIC4uLmpzb25TY2hlbWEsXG4gICAgICAgICAgICAgICAgLi4uSlNPTi5wYXJzZShkZWYuZGVzY3JpcHRpb24pLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7IH1cbiAgICB9XG4gICAgcmV0dXJuIGpzb25TY2hlbWE7XG59O1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRPcHRpb25zID0ge1xuICAgIG5hbWU6IHVuZGVmaW5lZCxcbiAgICAkcmVmU3RyYXRlZ3k6IFwicm9vdFwiLFxuICAgIGJhc2VQYXRoOiBbXCIjXCJdLFxuICAgIGVmZmVjdFN0cmF0ZWd5OiBcImlucHV0XCIsXG4gICAgcGlwZVN0cmF0ZWd5OiBcImFsbFwiLFxuICAgIGRhdGVTdHJhdGVneTogXCJmb3JtYXQ6ZGF0ZS10aW1lXCIsXG4gICAgbWFwU3RyYXRlZ3k6IFwiZW50cmllc1wiLFxuICAgIHJlbW92ZUFkZGl0aW9uYWxTdHJhdGVneTogXCJwYXNzdGhyb3VnaFwiLFxuICAgIGFsbG93ZWRBZGRpdGlvbmFsUHJvcGVydGllczogdHJ1ZSxcbiAgICByZWplY3RlZEFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgICBkZWZpbml0aW9uUGF0aDogXCJkZWZpbml0aW9uc1wiLFxuICAgIHRhcmdldDogXCJqc29uU2NoZW1hN1wiLFxuICAgIHN0cmljdFVuaW9uczogZmFsc2UsXG4gICAgZGVmaW5pdGlvbnM6IHt9LFxuICAgIGVycm9yTWVzc2FnZXM6IGZhbHNlLFxuICAgIG1hcmtkb3duRGVzY3JpcHRpb246IGZhbHNlLFxuICAgIHBhdHRlcm5TdHJhdGVneTogXCJlc2NhcGVcIixcbiAgICBhcHBseVJlZ2V4RmxhZ3M6IGZhbHNlLFxuICAgIGVtYWlsU3RyYXRlZ3k6IFwiZm9ybWF0OmVtYWlsXCIsXG4gICAgYmFzZTY0U3RyYXRlZ3k6IFwiY29udGVudEVuY29kaW5nOmJhc2U2NFwiLFxuICAgIG5hbWVTdHJhdGVneTogXCJyZWZcIixcbiAgICBvcGVuQWlBbnlUeXBlTmFtZTogXCJPcGVuQWlBbnlUeXBlXCJcbn07XG5leHBvcnQgY29uc3QgZ2V0RGVmYXVsdE9wdGlvbnMgPSAob3B0aW9ucykgPT4gKHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiXG4gICAgPyB7XG4gICAgICAgIC4uLmRlZmF1bHRPcHRpb25zLFxuICAgICAgICBuYW1lOiBvcHRpb25zLFxuICAgIH1cbiAgICA6IHtcbiAgICAgICAgLi4uZGVmYXVsdE9wdGlvbnMsXG4gICAgICAgIC4uLm9wdGlvbnMsXG4gICAgfSk7XG4iLCAiaW1wb3J0IHsgZ2V0RGVmYXVsdE9wdGlvbnMgfSBmcm9tIFwiLi9PcHRpb25zLmpzXCI7XG5leHBvcnQgY29uc3QgZ2V0UmVmcyA9IChvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgX29wdGlvbnMgPSBnZXREZWZhdWx0T3B0aW9ucyhvcHRpb25zKTtcbiAgICBjb25zdCBjdXJyZW50UGF0aCA9IF9vcHRpb25zLm5hbWUgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IFsuLi5fb3B0aW9ucy5iYXNlUGF0aCwgX29wdGlvbnMuZGVmaW5pdGlvblBhdGgsIF9vcHRpb25zLm5hbWVdXG4gICAgICAgIDogX29wdGlvbnMuYmFzZVBhdGg7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4uX29wdGlvbnMsXG4gICAgICAgIGZsYWdzOiB7IGhhc1JlZmVyZW5jZWRPcGVuQWlBbnlUeXBlOiBmYWxzZSB9LFxuICAgICAgICBjdXJyZW50UGF0aDogY3VycmVudFBhdGgsXG4gICAgICAgIHByb3BlcnR5UGF0aDogdW5kZWZpbmVkLFxuICAgICAgICBzZWVuOiBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKF9vcHRpb25zLmRlZmluaXRpb25zKS5tYXAoKFtuYW1lLCBkZWZdKSA9PiBbXG4gICAgICAgICAgICBkZWYuX2RlZixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkZWY6IGRlZi5fZGVmLFxuICAgICAgICAgICAgICAgIHBhdGg6IFsuLi5fb3B0aW9ucy5iYXNlUGF0aCwgX29wdGlvbnMuZGVmaW5pdGlvblBhdGgsIG5hbWVdLFxuICAgICAgICAgICAgICAgIC8vIFJlc29sdXRpb24gb2YgcmVmZXJlbmNlcyB3aWxsIGJlIGZvcmNlZCBldmVuIHRob3VnaCBzZWVuLCBzbyBpdCdzIG9rIHRoYXQgdGhlIHNjaGVtYSBpcyB1bmRlZmluZWQgaGVyZSBmb3Igbm93LlxuICAgICAgICAgICAgICAgIGpzb25TY2hlbWE6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0pKSxcbiAgICB9O1xufTtcbiIsICJleHBvcnQgZnVuY3Rpb24gYWRkRXJyb3JNZXNzYWdlKHJlcywga2V5LCBlcnJvck1lc3NhZ2UsIHJlZnMpIHtcbiAgICBpZiAoIXJlZnM/LmVycm9yTWVzc2FnZXMpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgIHJlcy5lcnJvck1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAuLi5yZXMuZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgW2tleV06IGVycm9yTWVzc2FnZSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIGtleSwgdmFsdWUsIGVycm9yTWVzc2FnZSwgcmVmcykge1xuICAgIHJlc1trZXldID0gdmFsdWU7XG4gICAgYWRkRXJyb3JNZXNzYWdlKHJlcywga2V5LCBlcnJvck1lc3NhZ2UsIHJlZnMpO1xufVxuIiwgImV4cG9ydCBjb25zdCBnZXRSZWxhdGl2ZVBhdGggPSAocGF0aEEsIHBhdGhCKSA9PiB7XG4gICAgbGV0IGkgPSAwO1xuICAgIGZvciAoOyBpIDwgcGF0aEEubGVuZ3RoICYmIGkgPCBwYXRoQi5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocGF0aEFbaV0gIT09IHBhdGhCW2ldKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBbKHBhdGhBLmxlbmd0aCAtIGkpLnRvU3RyaW5nKCksIC4uLnBhdGhCLnNsaWNlKGkpXS5qb2luKFwiL1wiKTtcbn07XG4iLCAiaW1wb3J0IHsgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kIH0gZnJvbSBcInpvZFwiO1xuaW1wb3J0IHsgcGFyc2VBbnlEZWYgfSBmcm9tIFwiLi9wYXJzZXJzL2FueS5qc1wiO1xuaW1wb3J0IHsgcGFyc2VBcnJheURlZiB9IGZyb20gXCIuL3BhcnNlcnMvYXJyYXkuanNcIjtcbmltcG9ydCB7IHBhcnNlQmlnaW50RGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9iaWdpbnQuanNcIjtcbmltcG9ydCB7IHBhcnNlQm9vbGVhbkRlZiB9IGZyb20gXCIuL3BhcnNlcnMvYm9vbGVhbi5qc1wiO1xuaW1wb3J0IHsgcGFyc2VCcmFuZGVkRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9icmFuZGVkLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUNhdGNoRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9jYXRjaC5qc1wiO1xuaW1wb3J0IHsgcGFyc2VEYXRlRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9kYXRlLmpzXCI7XG5pbXBvcnQgeyBwYXJzZURlZmF1bHREZWYgfSBmcm9tIFwiLi9wYXJzZXJzL2RlZmF1bHQuanNcIjtcbmltcG9ydCB7IHBhcnNlRWZmZWN0c0RlZiB9IGZyb20gXCIuL3BhcnNlcnMvZWZmZWN0cy5qc1wiO1xuaW1wb3J0IHsgcGFyc2VFbnVtRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9lbnVtLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUludGVyc2VjdGlvbkRlZiB9IGZyb20gXCIuL3BhcnNlcnMvaW50ZXJzZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUxpdGVyYWxEZWYgfSBmcm9tIFwiLi9wYXJzZXJzL2xpdGVyYWwuanNcIjtcbmltcG9ydCB7IHBhcnNlTWFwRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9tYXAuanNcIjtcbmltcG9ydCB7IHBhcnNlTmF0aXZlRW51bURlZiB9IGZyb20gXCIuL3BhcnNlcnMvbmF0aXZlRW51bS5qc1wiO1xuaW1wb3J0IHsgcGFyc2VOZXZlckRlZiB9IGZyb20gXCIuL3BhcnNlcnMvbmV2ZXIuanNcIjtcbmltcG9ydCB7IHBhcnNlTnVsbERlZiB9IGZyb20gXCIuL3BhcnNlcnMvbnVsbC5qc1wiO1xuaW1wb3J0IHsgcGFyc2VOdWxsYWJsZURlZiB9IGZyb20gXCIuL3BhcnNlcnMvbnVsbGFibGUuanNcIjtcbmltcG9ydCB7IHBhcnNlTnVtYmVyRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9udW1iZXIuanNcIjtcbmltcG9ydCB7IHBhcnNlT2JqZWN0RGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9vYmplY3QuanNcIjtcbmltcG9ydCB7IHBhcnNlT3B0aW9uYWxEZWYgfSBmcm9tIFwiLi9wYXJzZXJzL29wdGlvbmFsLmpzXCI7XG5pbXBvcnQgeyBwYXJzZVBpcGVsaW5lRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9waXBlbGluZS5qc1wiO1xuaW1wb3J0IHsgcGFyc2VQcm9taXNlRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy9wcm9taXNlLmpzXCI7XG5pbXBvcnQgeyBwYXJzZVJlY29yZERlZiB9IGZyb20gXCIuL3BhcnNlcnMvcmVjb3JkLmpzXCI7XG5pbXBvcnQgeyBwYXJzZVNldERlZiB9IGZyb20gXCIuL3BhcnNlcnMvc2V0LmpzXCI7XG5pbXBvcnQgeyBwYXJzZVN0cmluZ0RlZiB9IGZyb20gXCIuL3BhcnNlcnMvc3RyaW5nLmpzXCI7XG5pbXBvcnQgeyBwYXJzZVR1cGxlRGVmIH0gZnJvbSBcIi4vcGFyc2Vycy90dXBsZS5qc1wiO1xuaW1wb3J0IHsgcGFyc2VVbmRlZmluZWREZWYgfSBmcm9tIFwiLi9wYXJzZXJzL3VuZGVmaW5lZC5qc1wiO1xuaW1wb3J0IHsgcGFyc2VVbmlvbkRlZiB9IGZyb20gXCIuL3BhcnNlcnMvdW5pb24uanNcIjtcbmltcG9ydCB7IHBhcnNlVW5rbm93bkRlZiB9IGZyb20gXCIuL3BhcnNlcnMvdW5rbm93bi5qc1wiO1xuaW1wb3J0IHsgcGFyc2VSZWFkb25seURlZiB9IGZyb20gXCIuL3BhcnNlcnMvcmVhZG9ubHkuanNcIjtcbmV4cG9ydCBjb25zdCBzZWxlY3RQYXJzZXIgPSAoZGVmLCB0eXBlTmFtZSwgcmVmcykgPT4ge1xuICAgIHN3aXRjaCAodHlwZU5hbWUpIHtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kU3RyaW5nOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlU3RyaW5nRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZE51bWJlcjpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZU51bWJlckRlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RPYmplY3Q6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VPYmplY3REZWYoZGVmLCByZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kQmlnSW50OlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlQmlnaW50RGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEJvb2xlYW46XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VCb29sZWFuRGVmKCk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZERhdGU6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VEYXRlRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFVuZGVmaW5lZDpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVVuZGVmaW5lZERlZihyZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kTnVsbDpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZU51bGxEZWYocmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEFycmF5OlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlQXJyYXlEZWYoZGVmLCByZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kVW5pb246XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZERpc2NyaW1pbmF0ZWRVbmlvbjpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVVuaW9uRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEludGVyc2VjdGlvbjpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludGVyc2VjdGlvbkRlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RUdXBsZTpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVR1cGxlRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFJlY29yZDpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVJlY29yZERlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RMaXRlcmFsOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlTGl0ZXJhbERlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RFbnVtOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRW51bURlZihkZWYpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2ROYXRpdmVFbnVtOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlTmF0aXZlRW51bURlZihkZWYpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2ROdWxsYWJsZTpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZU51bGxhYmxlRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZE9wdGlvbmFsOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlT3B0aW9uYWxEZWYoZGVmLCByZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kTWFwOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlTWFwRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFNldDpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVNldERlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RMYXp5OlxuICAgICAgICAgICAgcmV0dXJuICgpID0+IGRlZi5nZXR0ZXIoKS5fZGVmO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RQcm9taXNlOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlUHJvbWlzZURlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2ROYU46XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZE5ldmVyOlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlTmV2ZXJEZWYocmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEVmZmVjdHM6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VFZmZlY3RzRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEFueTpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUFueURlZihyZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kVW5rbm93bjpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVVua25vd25EZWYocmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZERlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VEZWZhdWx0RGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEJyYW5kZWQ6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VCcmFuZGVkRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFJlYWRvbmx5OlxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlUmVhZG9ubHlEZWYoZGVmLCByZWZzKTtcbiAgICAgICAgY2FzZSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kQ2F0Y2g6XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VDYXRjaERlZihkZWYsIHJlZnMpO1xuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RQaXBlbGluZTpcbiAgICAgICAgICAgIHJldHVybiBwYXJzZVBpcGVsaW5lRGVmKGRlZiwgcmVmcyk7XG4gICAgICAgIGNhc2UgWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEZ1bmN0aW9uOlxuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RWb2lkOlxuICAgICAgICBjYXNlIFpvZEZpcnN0UGFydHlUeXBlS2luZC5ab2RTeW1ib2w6XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgLyogYzggaWdub3JlIG5leHQgKi9cbiAgICAgICAgICAgIHJldHVybiAoKF8pID0+IHVuZGVmaW5lZCkodHlwZU5hbWUpO1xuICAgIH1cbn07XG4iLCAiaW1wb3J0IHsgZ2V0UmVsYXRpdmVQYXRoIH0gZnJvbSBcIi4uL2dldFJlbGF0aXZlUGF0aC5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQW55RGVmKHJlZnMpIHtcbiAgICBpZiAocmVmcy50YXJnZXQgIT09IFwib3BlbkFpXCIpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBjb25zdCBhbnlEZWZpbml0aW9uUGF0aCA9IFtcbiAgICAgICAgLi4ucmVmcy5iYXNlUGF0aCxcbiAgICAgICAgcmVmcy5kZWZpbml0aW9uUGF0aCxcbiAgICAgICAgcmVmcy5vcGVuQWlBbnlUeXBlTmFtZSxcbiAgICBdO1xuICAgIHJlZnMuZmxhZ3MuaGFzUmVmZXJlbmNlZE9wZW5BaUFueVR5cGUgPSB0cnVlO1xuICAgIHJldHVybiB7XG4gICAgICAgICRyZWY6IHJlZnMuJHJlZlN0cmF0ZWd5ID09PSBcInJlbGF0aXZlXCJcbiAgICAgICAgICAgID8gZ2V0UmVsYXRpdmVQYXRoKGFueURlZmluaXRpb25QYXRoLCByZWZzLmN1cnJlbnRQYXRoKVxuICAgICAgICAgICAgOiBhbnlEZWZpbml0aW9uUGF0aC5qb2luKFwiL1wiKSxcbiAgICB9O1xufVxuIiwgImltcG9ydCB7IFpvZEZpcnN0UGFydHlUeXBlS2luZCB9IGZyb20gXCJ6b2RcIjtcbmltcG9ydCB7IHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMgfSBmcm9tIFwiLi4vZXJyb3JNZXNzYWdlcy5qc1wiO1xuaW1wb3J0IHsgcGFyc2VEZWYgfSBmcm9tIFwiLi4vcGFyc2VEZWYuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUFycmF5RGVmKGRlZiwgcmVmcykge1xuICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgIH07XG4gICAgaWYgKGRlZi50eXBlPy5fZGVmICYmXG4gICAgICAgIGRlZi50eXBlPy5fZGVmPy50eXBlTmFtZSAhPT0gWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEFueSkge1xuICAgICAgICByZXMuaXRlbXMgPSBwYXJzZURlZihkZWYudHlwZS5fZGVmLCB7XG4gICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcIml0ZW1zXCJdLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGRlZi5taW5MZW5ndGgpIHtcbiAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWluSXRlbXNcIiwgZGVmLm1pbkxlbmd0aC52YWx1ZSwgZGVmLm1pbkxlbmd0aC5tZXNzYWdlLCByZWZzKTtcbiAgICB9XG4gICAgaWYgKGRlZi5tYXhMZW5ndGgpIHtcbiAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWF4SXRlbXNcIiwgZGVmLm1heExlbmd0aC52YWx1ZSwgZGVmLm1heExlbmd0aC5tZXNzYWdlLCByZWZzKTtcbiAgICB9XG4gICAgaWYgKGRlZi5leGFjdExlbmd0aCkge1xuICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtaW5JdGVtc1wiLCBkZWYuZXhhY3RMZW5ndGgudmFsdWUsIGRlZi5leGFjdExlbmd0aC5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWF4SXRlbXNcIiwgZGVmLmV4YWN0TGVuZ3RoLnZhbHVlLCBkZWYuZXhhY3RMZW5ndGgubWVzc2FnZSwgcmVmcyk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4iLCAiaW1wb3J0IHsgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyB9IGZyb20gXCIuLi9lcnJvck1lc3NhZ2VzLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VCaWdpbnREZWYoZGVmLCByZWZzKSB7XG4gICAgY29uc3QgcmVzID0ge1xuICAgICAgICB0eXBlOiBcImludGVnZXJcIixcbiAgICAgICAgZm9ybWF0OiBcImludDY0XCIsXG4gICAgfTtcbiAgICBpZiAoIWRlZi5jaGVja3MpXG4gICAgICAgIHJldHVybiByZXM7XG4gICAgZm9yIChjb25zdCBjaGVjayBvZiBkZWYuY2hlY2tzKSB7XG4gICAgICAgIHN3aXRjaCAoY2hlY2sua2luZCkge1xuICAgICAgICAgICAgY2FzZSBcIm1pblwiOlxuICAgICAgICAgICAgICAgIGlmIChyZWZzLnRhcmdldCA9PT0gXCJqc29uU2NoZW1hN1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVjay5pbmNsdXNpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm1pbmltdW1cIiwgY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwiZXhjbHVzaXZlTWluaW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2suaW5jbHVzaXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZXhjbHVzaXZlTWluaW11bSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWluaW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm1heFwiOlxuICAgICAgICAgICAgICAgIGlmIChyZWZzLnRhcmdldCA9PT0gXCJqc29uU2NoZW1hN1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVjay5pbmNsdXNpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm1heGltdW1cIiwgY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwiZXhjbHVzaXZlTWF4aW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2suaW5jbHVzaXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZXhjbHVzaXZlTWF4aW11bSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWF4aW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm11bHRpcGxlT2ZcIjpcbiAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtdWx0aXBsZU9mXCIsIGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBwYXJzZUJvb2xlYW5EZWYoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgfTtcbn1cbiIsICJpbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQnJhbmRlZERlZihfZGVmLCByZWZzKSB7XG4gICAgcmV0dXJuIHBhcnNlRGVmKF9kZWYudHlwZS5fZGVmLCByZWZzKTtcbn1cbiIsICJpbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGNvbnN0IHBhcnNlQ2F0Y2hEZWYgPSAoZGVmLCByZWZzKSA9PiB7XG4gICAgcmV0dXJuIHBhcnNlRGVmKGRlZi5pbm5lclR5cGUuX2RlZiwgcmVmcyk7XG59O1xuIiwgImltcG9ydCB7IHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMgfSBmcm9tIFwiLi4vZXJyb3JNZXNzYWdlcy5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRGF0ZURlZihkZWYsIHJlZnMsIG92ZXJyaWRlRGF0ZVN0cmF0ZWd5KSB7XG4gICAgY29uc3Qgc3RyYXRlZ3kgPSBvdmVycmlkZURhdGVTdHJhdGVneSA/PyByZWZzLmRhdGVTdHJhdGVneTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdHJhdGVneSkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFueU9mOiBzdHJhdGVneS5tYXAoKGl0ZW0sIGkpID0+IHBhcnNlRGF0ZURlZihkZWYsIHJlZnMsIGl0ZW0pKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3dpdGNoIChzdHJhdGVneSkge1xuICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgIGNhc2UgXCJmb3JtYXQ6ZGF0ZS10aW1lXCI6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSBcImZvcm1hdDpkYXRlXCI6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGVcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgXCJpbnRlZ2VyXCI6XG4gICAgICAgICAgICByZXR1cm4gaW50ZWdlckRhdGVQYXJzZXIoZGVmLCByZWZzKTtcbiAgICB9XG59XG5jb25zdCBpbnRlZ2VyRGF0ZVBhcnNlciA9IChkZWYsIHJlZnMpID0+IHtcbiAgICBjb25zdCByZXMgPSB7XG4gICAgICAgIHR5cGU6IFwiaW50ZWdlclwiLFxuICAgICAgICBmb3JtYXQ6IFwidW5peC10aW1lXCIsXG4gICAgfTtcbiAgICBpZiAocmVmcy50YXJnZXQgPT09IFwib3BlbkFwaTNcIikge1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGNoZWNrIG9mIGRlZi5jaGVja3MpIHtcbiAgICAgICAgc3dpdGNoIChjaGVjay5raW5kKSB7XG4gICAgICAgICAgICBjYXNlIFwibWluXCI6XG4gICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWluaW11bVwiLCBjaGVjay52YWx1ZSwgLy8gVGhpcyBpcyBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgICAgICAgICBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJtYXhcIjpcbiAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtYXhpbXVtXCIsIGNoZWNrLnZhbHVlLCAvLyBUaGlzIGlzIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICAgICAgICAgIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59O1xuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4uL3BhcnNlRGVmLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VEZWZhdWx0RGVmKF9kZWYsIHJlZnMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5wYXJzZURlZihfZGVmLmlubmVyVHlwZS5fZGVmLCByZWZzKSxcbiAgICAgICAgZGVmYXVsdDogX2RlZi5kZWZhdWx0VmFsdWUoKSxcbiAgICB9O1xufVxuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4uL3BhcnNlRGVmLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUFueURlZiB9IGZyb20gXCIuL2FueS5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRWZmZWN0c0RlZihfZGVmLCByZWZzKSB7XG4gICAgcmV0dXJuIHJlZnMuZWZmZWN0U3RyYXRlZ3kgPT09IFwiaW5wdXRcIlxuICAgICAgICA/IHBhcnNlRGVmKF9kZWYuc2NoZW1hLl9kZWYsIHJlZnMpXG4gICAgICAgIDogcGFyc2VBbnlEZWYocmVmcyk7XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRW51bURlZihkZWYpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICBlbnVtOiBBcnJheS5mcm9tKGRlZi52YWx1ZXMpLFxuICAgIH07XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VEZWYgfSBmcm9tIFwiLi4vcGFyc2VEZWYuanNcIjtcbmNvbnN0IGlzSnNvblNjaGVtYTdBbGxPZlR5cGUgPSAodHlwZSkgPT4ge1xuICAgIGlmIChcInR5cGVcIiBpbiB0eXBlICYmIHR5cGUudHlwZSA9PT0gXCJzdHJpbmdcIilcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiBcImFsbE9mXCIgaW4gdHlwZTtcbn07XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VJbnRlcnNlY3Rpb25EZWYoZGVmLCByZWZzKSB7XG4gICAgY29uc3QgYWxsT2YgPSBbXG4gICAgICAgIHBhcnNlRGVmKGRlZi5sZWZ0Ll9kZWYsIHtcbiAgICAgICAgICAgIC4uLnJlZnMsXG4gICAgICAgICAgICBjdXJyZW50UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwiYWxsT2ZcIiwgXCIwXCJdLFxuICAgICAgICB9KSxcbiAgICAgICAgcGFyc2VEZWYoZGVmLnJpZ2h0Ll9kZWYsIHtcbiAgICAgICAgICAgIC4uLnJlZnMsXG4gICAgICAgICAgICBjdXJyZW50UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwiYWxsT2ZcIiwgXCIxXCJdLFxuICAgICAgICB9KSxcbiAgICBdLmZpbHRlcigoeCkgPT4gISF4KTtcbiAgICBsZXQgdW5ldmFsdWF0ZWRQcm9wZXJ0aWVzID0gcmVmcy50YXJnZXQgPT09IFwianNvblNjaGVtYTIwMTktMDlcIlxuICAgICAgICA/IHsgdW5ldmFsdWF0ZWRQcm9wZXJ0aWVzOiBmYWxzZSB9XG4gICAgICAgIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IG1lcmdlZEFsbE9mID0gW107XG4gICAgLy8gSWYgZWl0aGVyIG9mIHRoZSBzY2hlbWFzIGlzIGFuIGFsbE9mLCBtZXJnZSB0aGVtIGludG8gYSBzaW5nbGUgYWxsT2ZcbiAgICBhbGxPZi5mb3JFYWNoKChzY2hlbWEpID0+IHtcbiAgICAgICAgaWYgKGlzSnNvblNjaGVtYTdBbGxPZlR5cGUoc2NoZW1hKSkge1xuICAgICAgICAgICAgbWVyZ2VkQWxsT2YucHVzaCguLi5zY2hlbWEuYWxsT2YpO1xuICAgICAgICAgICAgaWYgKHNjaGVtYS51bmV2YWx1YXRlZFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIElmIG9uZSBvZiB0aGUgc2NoZW1hcyBoYXMgbm8gdW5ldmFsdWF0ZWRQcm9wZXJ0aWVzIHNldCxcbiAgICAgICAgICAgICAgICAvLyB0aGUgbWVyZ2VkIHNjaGVtYSBzaG91bGQgYWxzbyBoYXZlIG5vIHVuZXZhbHVhdGVkUHJvcGVydGllcyBzZXRcbiAgICAgICAgICAgICAgICB1bmV2YWx1YXRlZFByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmVzdGVkU2NoZW1hID0gc2NoZW1hO1xuICAgICAgICAgICAgaWYgKFwiYWRkaXRpb25hbFByb3BlcnRpZXNcIiBpbiBzY2hlbWEgJiZcbiAgICAgICAgICAgICAgICBzY2hlbWEuYWRkaXRpb25hbFByb3BlcnRpZXMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBhZGRpdGlvbmFsUHJvcGVydGllcywgLi4ucmVzdCB9ID0gc2NoZW1hO1xuICAgICAgICAgICAgICAgIG5lc3RlZFNjaGVtYSA9IHJlc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBBcyBzb29uIGFzIG9uZSBvZiB0aGUgc2NoZW1hcyBoYXMgYWRkaXRpb25hbFByb3BlcnRpZXMgc2V0IG5vdCB0byBmYWxzZSwgd2UgYWxsb3cgdW5ldmFsdWF0ZWRQcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgdW5ldmFsdWF0ZWRQcm9wZXJ0aWVzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWVyZ2VkQWxsT2YucHVzaChuZXN0ZWRTY2hlbWEpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG1lcmdlZEFsbE9mLmxlbmd0aFxuICAgICAgICA/IHtcbiAgICAgICAgICAgIGFsbE9mOiBtZXJnZWRBbGxPZixcbiAgICAgICAgICAgIC4uLnVuZXZhbHVhdGVkUHJvcGVydGllcyxcbiAgICAgICAgfVxuICAgICAgICA6IHVuZGVmaW5lZDtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gcGFyc2VMaXRlcmFsRGVmKGRlZiwgcmVmcykge1xuICAgIGNvbnN0IHBhcnNlZFR5cGUgPSB0eXBlb2YgZGVmLnZhbHVlO1xuICAgIGlmIChwYXJzZWRUeXBlICE9PSBcImJpZ2ludFwiICYmXG4gICAgICAgIHBhcnNlZFR5cGUgIT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgcGFyc2VkVHlwZSAhPT0gXCJib29sZWFuXCIgJiZcbiAgICAgICAgcGFyc2VkVHlwZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogQXJyYXkuaXNBcnJheShkZWYudmFsdWUpID8gXCJhcnJheVwiIDogXCJvYmplY3RcIixcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHJlZnMudGFyZ2V0ID09PSBcIm9wZW5BcGkzXCIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IHBhcnNlZFR5cGUgPT09IFwiYmlnaW50XCIgPyBcImludGVnZXJcIiA6IHBhcnNlZFR5cGUsXG4gICAgICAgICAgICBlbnVtOiBbZGVmLnZhbHVlXSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogcGFyc2VkVHlwZSA9PT0gXCJiaWdpbnRcIiA/IFwiaW50ZWdlclwiIDogcGFyc2VkVHlwZSxcbiAgICAgICAgY29uc3Q6IGRlZi52YWx1ZSxcbiAgICB9O1xufVxuIiwgImltcG9ydCB7IFpvZEZpcnN0UGFydHlUeXBlS2luZCwgfSBmcm9tIFwiem9kXCI7XG5pbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuaW1wb3J0IHsgcGFyc2VTdHJpbmdEZWYgfSBmcm9tIFwiLi9zdHJpbmcuanNcIjtcbmltcG9ydCB7IHBhcnNlQnJhbmRlZERlZiB9IGZyb20gXCIuL2JyYW5kZWQuanNcIjtcbmltcG9ydCB7IHBhcnNlQW55RGVmIH0gZnJvbSBcIi4vYW55LmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VSZWNvcmREZWYoZGVmLCByZWZzKSB7XG4gICAgaWYgKHJlZnMudGFyZ2V0ID09PSBcIm9wZW5BaVwiKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIldhcm5pbmc6IE9wZW5BSSBtYXkgbm90IHN1cHBvcnQgcmVjb3JkcyBpbiBzY2hlbWFzISBUcnkgYW4gYXJyYXkgb2Yga2V5LXZhbHVlIHBhaXJzIGluc3RlYWQuXCIpO1xuICAgIH1cbiAgICBpZiAocmVmcy50YXJnZXQgPT09IFwib3BlbkFwaTNcIiAmJlxuICAgICAgICBkZWYua2V5VHlwZT8uX2RlZi50eXBlTmFtZSA9PT0gWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEVudW0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICByZXF1aXJlZDogZGVmLmtleVR5cGUuX2RlZi52YWx1ZXMsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiBkZWYua2V5VHlwZS5fZGVmLnZhbHVlcy5yZWR1Y2UoKGFjYywga2V5KSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICAgICAgICBba2V5XTogcGFyc2VEZWYoZGVmLnZhbHVlVHlwZS5fZGVmLCB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnJlZnMsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJwcm9wZXJ0aWVzXCIsIGtleV0sXG4gICAgICAgICAgICAgICAgfSkgPz8gcGFyc2VBbnlEZWYocmVmcyksXG4gICAgICAgICAgICB9KSwge30pLFxuICAgICAgICAgICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IHJlZnMucmVqZWN0ZWRBZGRpdGlvbmFsUHJvcGVydGllcyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3Qgc2NoZW1hID0ge1xuICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogcGFyc2VEZWYoZGVmLnZhbHVlVHlwZS5fZGVmLCB7XG4gICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcImFkZGl0aW9uYWxQcm9wZXJ0aWVzXCJdLFxuICAgICAgICB9KSA/PyByZWZzLmFsbG93ZWRBZGRpdGlvbmFsUHJvcGVydGllcyxcbiAgICB9O1xuICAgIGlmIChyZWZzLnRhcmdldCA9PT0gXCJvcGVuQXBpM1wiKSB7XG4gICAgICAgIHJldHVybiBzY2hlbWE7XG4gICAgfVxuICAgIGlmIChkZWYua2V5VHlwZT8uX2RlZi50eXBlTmFtZSA9PT0gWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFN0cmluZyAmJlxuICAgICAgICBkZWYua2V5VHlwZS5fZGVmLmNoZWNrcz8ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IHsgdHlwZSwgLi4ua2V5VHlwZSB9ID0gcGFyc2VTdHJpbmdEZWYoZGVmLmtleVR5cGUuX2RlZiwgcmVmcyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zY2hlbWEsXG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWVzOiBrZXlUeXBlLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIGlmIChkZWYua2V5VHlwZT8uX2RlZi50eXBlTmFtZSA9PT0gWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZEVudW0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnNjaGVtYSxcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZXM6IHtcbiAgICAgICAgICAgICAgICBlbnVtOiBkZWYua2V5VHlwZS5fZGVmLnZhbHVlcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2UgaWYgKGRlZi5rZXlUeXBlPy5fZGVmLnR5cGVOYW1lID09PSBab2RGaXJzdFBhcnR5VHlwZUtpbmQuWm9kQnJhbmRlZCAmJlxuICAgICAgICBkZWYua2V5VHlwZS5fZGVmLnR5cGUuX2RlZi50eXBlTmFtZSA9PT0gWm9kRmlyc3RQYXJ0eVR5cGVLaW5kLlpvZFN0cmluZyAmJlxuICAgICAgICBkZWYua2V5VHlwZS5fZGVmLnR5cGUuX2RlZi5jaGVja3M/Lmxlbmd0aCkge1xuICAgICAgICBjb25zdCB7IHR5cGUsIC4uLmtleVR5cGUgfSA9IHBhcnNlQnJhbmRlZERlZihkZWYua2V5VHlwZS5fZGVmLCByZWZzKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLnNjaGVtYSxcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZXM6IGtleVR5cGUsXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBzY2hlbWE7XG59XG4iLCAiaW1wb3J0IHsgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyB9IGZyb20gXCIuLi9lcnJvck1lc3NhZ2VzLmpzXCI7XG5sZXQgZW1vamlSZWdleCA9IHVuZGVmaW5lZDtcbi8qKlxuICogR2VuZXJhdGVkIGZyb20gdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbnMgZm91bmQgaGVyZSBhcyBvZiAyMDI0LTA1LTIyOlxuICogaHR0cHM6Ly9naXRodWIuY29tL2NvbGluaGFja3Mvem9kL2Jsb2IvbWFzdGVyL3NyYy90eXBlcy50cy5cbiAqXG4gKiBFeHByZXNzaW9ucyB3aXRoIC9pIGZsYWcgaGF2ZSBiZWVuIGNoYW5nZWQgYWNjb3JkaW5nbHkuXG4gKi9cbmV4cG9ydCBjb25zdCB6b2RQYXR0ZXJucyA9IHtcbiAgICAvKipcbiAgICAgKiBgY2Agd2FzIGNoYW5nZWQgdG8gYFtjQ11gIHRvIHJlcGxpY2F0ZSAvaSBmbGFnXG4gICAgICovXG4gICAgY3VpZDogL15bY0NdW15cXHMtXXs4LH0kLyxcbiAgICBjdWlkMjogL15bMC05YS16XSskLyxcbiAgICB1bGlkOiAvXlswLTlBLUhKS01OUC1UVi1aXXsyNn0kLyxcbiAgICAvKipcbiAgICAgKiBgYS16YCB3YXMgYWRkZWQgdG8gcmVwbGljYXRlIC9pIGZsYWdcbiAgICAgKi9cbiAgICBlbWFpbDogL14oPyFcXC4pKD8hLipcXC5cXC4pKFthLXpBLVowLTlfJytcXC1cXC5dKilbYS16QS1aMC05XystXUAoW2EtekEtWjAtOV1bYS16QS1aMC05XFwtXSpcXC4pK1thLXpBLVpdezIsfSQvLFxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdGVkIGEgdmFsaWQgVW5pY29kZSBSZWdFeHBcbiAgICAgKlxuICAgICAqIExhemlseSBpbnN0YW50aWF0ZSBzaW5jZSB0aGlzIHR5cGUgb2YgcmVnZXggaXNuJ3Qgc3VwcG9ydGVkXG4gICAgICogaW4gYWxsIGVudnMgKGUuZy4gUmVhY3QgTmF0aXZlKS5cbiAgICAgKlxuICAgICAqIFNlZTpcbiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vY29saW5oYWNrcy96b2QvaXNzdWVzLzI0MzNcbiAgICAgKiBGaXggaW4gWm9kOlxuICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9jb2xpbmhhY2tzL3pvZC9jb21taXQvOTM0MGZkNTFlNDg1NzZhNzVhZGM5MTliZmY2NWRiYzRhNWQ0Yzk5YlxuICAgICAqL1xuICAgIGVtb2ppOiAoKSA9PiB7XG4gICAgICAgIGlmIChlbW9qaVJlZ2V4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGVtb2ppUmVnZXggPSBSZWdFeHAoXCJeKFxcXFxwe0V4dGVuZGVkX1BpY3RvZ3JhcGhpY318XFxcXHB7RW1vamlfQ29tcG9uZW50fSkrJFwiLCBcInVcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVtb2ppUmVnZXg7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBVbnVzZWRcbiAgICAgKi9cbiAgICB1dWlkOiAvXlswLTlhLWZBLUZdezh9XFxiLVswLTlhLWZBLUZdezR9XFxiLVswLTlhLWZBLUZdezR9XFxiLVswLTlhLWZBLUZdezR9XFxiLVswLTlhLWZBLUZdezEyfSQvLFxuICAgIC8qKlxuICAgICAqIFVudXNlZFxuICAgICAqL1xuICAgIGlwdjQ6IC9eKD86KD86MjVbMC01XXwyWzAtNF1bMC05XXwxWzAtOV1bMC05XXxbMS05XVswLTldfFswLTldKVxcLil7M30oPzoyNVswLTVdfDJbMC00XVswLTldfDFbMC05XVswLTldfFsxLTldWzAtOV18WzAtOV0pJC8sXG4gICAgaXB2NENpZHI6IC9eKD86KD86MjVbMC01XXwyWzAtNF1bMC05XXwxWzAtOV1bMC05XXxbMS05XVswLTldfFswLTldKVxcLil7M30oPzoyNVswLTVdfDJbMC00XVswLTldfDFbMC05XVswLTldfFsxLTldWzAtOV18WzAtOV0pXFwvKDNbMC0yXXxbMTJdP1swLTldKSQvLFxuICAgIC8qKlxuICAgICAqIFVudXNlZFxuICAgICAqL1xuICAgIGlwdjY6IC9eKChbYS1mMC05XXsxLDR9Oil7N318OjooW2EtZjAtOV17MSw0fTopezAsNn18KFthLWYwLTldezEsNH06KXsxfTooW2EtZjAtOV17MSw0fTopezAsNX18KFthLWYwLTldezEsNH06KXsyfTooW2EtZjAtOV17MSw0fTopezAsNH18KFthLWYwLTldezEsNH06KXszfTooW2EtZjAtOV17MSw0fTopezAsM318KFthLWYwLTldezEsNH06KXs0fTooW2EtZjAtOV17MSw0fTopezAsMn18KFthLWYwLTldezEsNH06KXs1fTooW2EtZjAtOV17MSw0fTopezAsMX0pKFthLWYwLTldezEsNH18KCgoMjVbMC01XSl8KDJbMC00XVswLTldKXwoMVswLTldezJ9KXwoWzAtOV17MSwyfSkpXFwuKXszfSgoMjVbMC01XSl8KDJbMC00XVswLTldKXwoMVswLTldezJ9KXwoWzAtOV17MSwyfSkpKSQvLFxuICAgIGlwdjZDaWRyOiAvXigoWzAtOWEtZkEtRl17MSw0fTopezcsN31bMC05YS1mQS1GXXsxLDR9fChbMC05YS1mQS1GXXsxLDR9Oil7MSw3fTp8KFswLTlhLWZBLUZdezEsNH06KXsxLDZ9OlswLTlhLWZBLUZdezEsNH18KFswLTlhLWZBLUZdezEsNH06KXsxLDV9KDpbMC05YS1mQS1GXXsxLDR9KXsxLDJ9fChbMC05YS1mQS1GXXsxLDR9Oil7MSw0fSg6WzAtOWEtZkEtRl17MSw0fSl7MSwzfXwoWzAtOWEtZkEtRl17MSw0fTopezEsM30oOlswLTlhLWZBLUZdezEsNH0pezEsNH18KFswLTlhLWZBLUZdezEsNH06KXsxLDJ9KDpbMC05YS1mQS1GXXsxLDR9KXsxLDV9fFswLTlhLWZBLUZdezEsNH06KCg6WzAtOWEtZkEtRl17MSw0fSl7MSw2fSl8OigoOlswLTlhLWZBLUZdezEsNH0pezEsN318Oil8ZmU4MDooOlswLTlhLWZBLUZdezAsNH0pezAsNH0lWzAtOWEtekEtWl17MSx9fDo6KGZmZmYoOjB7MSw0fSl7MCwxfTopezAsMX0oKDI1WzAtNV18KDJbMC00XXwxezAsMX1bMC05XSl7MCwxfVswLTldKVxcLil7MywzfSgyNVswLTVdfCgyWzAtNF18MXswLDF9WzAtOV0pezAsMX1bMC05XSl8KFswLTlhLWZBLUZdezEsNH06KXsxLDR9OigoMjVbMC01XXwoMlswLTRdfDF7MCwxfVswLTldKXswLDF9WzAtOV0pXFwuKXszLDN9KDI1WzAtNV18KDJbMC00XXwxezAsMX1bMC05XSl7MCwxfVswLTldKSlcXC8oMTJbMC04XXwxWzAxXVswLTldfFsxLTldP1swLTldKSQvLFxuICAgIGJhc2U2NDogL14oWzAtOWEtekEtWisvXXs0fSkqKChbMC05YS16QS1aKy9dezJ9PT0pfChbMC05YS16QS1aKy9dezN9PSkpPyQvLFxuICAgIGJhc2U2NHVybDogL14oWzAtOWEtekEtWi1fXXs0fSkqKChbMC05YS16QS1aLV9dezJ9KD09KT8pfChbMC05YS16QS1aLV9dezN9KD0pPykpPyQvLFxuICAgIG5hbm9pZDogL15bYS16QS1aMC05Xy1dezIxfSQvLFxuICAgIGp3dDogL15bQS1aYS16MC05LV9dK1xcLltBLVphLXowLTktX10rXFwuW0EtWmEtejAtOS1fXSokLyxcbn07XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTdHJpbmdEZWYoZGVmLCByZWZzKSB7XG4gICAgY29uc3QgcmVzID0ge1xuICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgIH07XG4gICAgaWYgKGRlZi5jaGVja3MpIHtcbiAgICAgICAgZm9yIChjb25zdCBjaGVjayBvZiBkZWYuY2hlY2tzKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNoZWNrLmtpbmQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwibWluXCI6XG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm1pbkxlbmd0aFwiLCB0eXBlb2YgcmVzLm1pbkxlbmd0aCA9PT0gXCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPyBNYXRoLm1heChyZXMubWluTGVuZ3RoLCBjaGVjay52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibWF4XCI6XG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm1heExlbmd0aFwiLCB0eXBlb2YgcmVzLm1heExlbmd0aCA9PT0gXCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPyBNYXRoLm1pbihyZXMubWF4TGVuZ3RoLCBjaGVjay52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW1haWxcIjpcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChyZWZzLmVtYWlsU3RyYXRlZ3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJmb3JtYXQ6ZW1haWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImVtYWlsXCIsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImZvcm1hdDppZG4tZW1haWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImlkbi1lbWFpbFwiLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwYXR0ZXJuOnpvZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFBhdHRlcm4ocmVzLCB6b2RQYXR0ZXJucy5lbWFpbCwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInVybFwiOlxuICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcInVyaVwiLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInV1aWRcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkRm9ybWF0KHJlcywgXCJ1dWlkXCIsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicmVnZXhcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIGNoZWNrLnJlZ2V4LCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImN1aWRcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmN1aWQsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiY3VpZDJcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmN1aWQyLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0YXJ0c1dpdGhcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIFJlZ0V4cChgXiR7ZXNjYXBlTGl0ZXJhbENoZWNrVmFsdWUoY2hlY2sudmFsdWUsIHJlZnMpfWApLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImVuZHNXaXRoXCI6XG4gICAgICAgICAgICAgICAgICAgIGFkZFBhdHRlcm4ocmVzLCBSZWdFeHAoYCR7ZXNjYXBlTGl0ZXJhbENoZWNrVmFsdWUoY2hlY2sudmFsdWUsIHJlZnMpfSRgKSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJkYXRldGltZVwiOlxuICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImRhdGUtdGltZVwiLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImRhdGVcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkRm9ybWF0KHJlcywgXCJkYXRlXCIsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidGltZVwiOlxuICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcInRpbWVcIiwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJkdXJhdGlvblwiOlxuICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImR1cmF0aW9uXCIsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibGVuZ3RoXCI6XG4gICAgICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm1pbkxlbmd0aFwiLCB0eXBlb2YgcmVzLm1pbkxlbmd0aCA9PT0gXCJudW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPyBNYXRoLm1heChyZXMubWluTGVuZ3RoLCBjaGVjay52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtYXhMZW5ndGhcIiwgdHlwZW9mIHJlcy5tYXhMZW5ndGggPT09IFwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gTWF0aC5taW4ocmVzLm1heExlbmd0aCwgY2hlY2sudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImluY2x1ZGVzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIFJlZ0V4cChlc2NhcGVMaXRlcmFsQ2hlY2tWYWx1ZShjaGVjay52YWx1ZSwgcmVmcykpLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJpcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVjay52ZXJzaW9uICE9PSBcInY2XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvcm1hdChyZXMsIFwiaXB2NFwiLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2sudmVyc2lvbiAhPT0gXCJ2NFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImlwdjZcIiwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJiYXNlNjR1cmxcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmJhc2U2NHVybCwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJqd3RcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmp3dCwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJjaWRyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrLnZlcnNpb24gIT09IFwidjZcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmlwdjRDaWRyLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2sudmVyc2lvbiAhPT0gXCJ2NFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRQYXR0ZXJuKHJlcywgem9kUGF0dGVybnMuaXB2NkNpZHIsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFwiZW1vamlcIjpcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLmVtb2ppKCksIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidWxpZFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIGFkZFBhdHRlcm4ocmVzLCB6b2RQYXR0ZXJucy51bGlkLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJiYXNlNjRcIjoge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHJlZnMuYmFzZTY0U3RyYXRlZ3kpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJmb3JtYXQ6YmluYXJ5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRGb3JtYXQocmVzLCBcImJpbmFyeVwiLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjb250ZW50RW5jb2Rpbmc6YmFzZTY0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJjb250ZW50RW5jb2RpbmdcIiwgXCJiYXNlNjRcIiwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGF0dGVybjp6b2RcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZFBhdHRlcm4ocmVzLCB6b2RQYXR0ZXJucy5iYXNlNjQsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFwibmFub2lkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgYWRkUGF0dGVybihyZXMsIHpvZFBhdHRlcm5zLm5hbm9pZCwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0b0xvd2VyQ2FzZVwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0b1VwcGVyQ2FzZVwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmltXCI6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIC8qIGM4IGlnbm9yZSBuZXh0ICovXG4gICAgICAgICAgICAgICAgICAgICgoXykgPT4geyB9KShjaGVjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbmZ1bmN0aW9uIGVzY2FwZUxpdGVyYWxDaGVja1ZhbHVlKGxpdGVyYWwsIHJlZnMpIHtcbiAgICByZXR1cm4gcmVmcy5wYXR0ZXJuU3RyYXRlZ3kgPT09IFwiZXNjYXBlXCJcbiAgICAgICAgPyBlc2NhcGVOb25BbHBoYU51bWVyaWMobGl0ZXJhbClcbiAgICAgICAgOiBsaXRlcmFsO1xufVxuY29uc3QgQUxQSEFfTlVNRVJJQyA9IG5ldyBTZXQoXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnh5ejAxMjM0NTY3ODlcIik7XG5mdW5jdGlvbiBlc2NhcGVOb25BbHBoYU51bWVyaWMoc291cmNlKSB7XG4gICAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKCFBTFBIQV9OVU1FUklDLmhhcyhzb3VyY2VbaV0pKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJcXFxcXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ICs9IHNvdXJjZVtpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbi8vIEFkZHMgYSBcImZvcm1hdFwiIGtleXdvcmQgdG8gdGhlIHNjaGVtYS4gSWYgYSBmb3JtYXQgZXhpc3RzLCBib3RoIGZvcm1hdHMgd2lsbCBiZSBqb2luZWQgaW4gYW4gYWxsT2Ytbm9kZSwgYWxvbmcgd2l0aCBzdWJzZXF1ZW50IG9uZXMuXG5mdW5jdGlvbiBhZGRGb3JtYXQoc2NoZW1hLCB2YWx1ZSwgbWVzc2FnZSwgcmVmcykge1xuICAgIGlmIChzY2hlbWEuZm9ybWF0IHx8IHNjaGVtYS5hbnlPZj8uc29tZSgoeCkgPT4geC5mb3JtYXQpKSB7XG4gICAgICAgIGlmICghc2NoZW1hLmFueU9mKSB7XG4gICAgICAgICAgICBzY2hlbWEuYW55T2YgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NoZW1hLmZvcm1hdCkge1xuICAgICAgICAgICAgc2NoZW1hLmFueU9mLnB1c2goe1xuICAgICAgICAgICAgICAgIGZvcm1hdDogc2NoZW1hLmZvcm1hdCxcbiAgICAgICAgICAgICAgICAuLi4oc2NoZW1hLmVycm9yTWVzc2FnZSAmJlxuICAgICAgICAgICAgICAgICAgICByZWZzLmVycm9yTWVzc2FnZXMgJiYge1xuICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6IHsgZm9ybWF0OiBzY2hlbWEuZXJyb3JNZXNzYWdlLmZvcm1hdCB9LFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkZWxldGUgc2NoZW1hLmZvcm1hdDtcbiAgICAgICAgICAgIGlmIChzY2hlbWEuZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNjaGVtYS5lcnJvck1lc3NhZ2UuZm9ybWF0O1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhzY2hlbWEuZXJyb3JNZXNzYWdlKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHNjaGVtYS5lcnJvck1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNjaGVtYS5hbnlPZi5wdXNoKHtcbiAgICAgICAgICAgIGZvcm1hdDogdmFsdWUsXG4gICAgICAgICAgICAuLi4obWVzc2FnZSAmJlxuICAgICAgICAgICAgICAgIHJlZnMuZXJyb3JNZXNzYWdlcyAmJiB7IGVycm9yTWVzc2FnZTogeyBmb3JtYXQ6IG1lc3NhZ2UgfSB9KSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHNjaGVtYSwgXCJmb3JtYXRcIiwgdmFsdWUsIG1lc3NhZ2UsIHJlZnMpO1xuICAgIH1cbn1cbi8vIEFkZHMgYSBcInBhdHRlcm5cIiBrZXl3b3JkIHRvIHRoZSBzY2hlbWEuIElmIGEgcGF0dGVybiBleGlzdHMsIGJvdGggcGF0dGVybnMgd2lsbCBiZSBqb2luZWQgaW4gYW4gYWxsT2Ytbm9kZSwgYWxvbmcgd2l0aCBzdWJzZXF1ZW50IG9uZXMuXG5mdW5jdGlvbiBhZGRQYXR0ZXJuKHNjaGVtYSwgcmVnZXgsIG1lc3NhZ2UsIHJlZnMpIHtcbiAgICBpZiAoc2NoZW1hLnBhdHRlcm4gfHwgc2NoZW1hLmFsbE9mPy5zb21lKCh4KSA9PiB4LnBhdHRlcm4pKSB7XG4gICAgICAgIGlmICghc2NoZW1hLmFsbE9mKSB7XG4gICAgICAgICAgICBzY2hlbWEuYWxsT2YgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NoZW1hLnBhdHRlcm4pIHtcbiAgICAgICAgICAgIHNjaGVtYS5hbGxPZi5wdXNoKHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiBzY2hlbWEucGF0dGVybixcbiAgICAgICAgICAgICAgICAuLi4oc2NoZW1hLmVycm9yTWVzc2FnZSAmJlxuICAgICAgICAgICAgICAgICAgICByZWZzLmVycm9yTWVzc2FnZXMgJiYge1xuICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2U6IHsgcGF0dGVybjogc2NoZW1hLmVycm9yTWVzc2FnZS5wYXR0ZXJuIH0sXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlbGV0ZSBzY2hlbWEucGF0dGVybjtcbiAgICAgICAgICAgIGlmIChzY2hlbWEuZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNjaGVtYS5lcnJvck1lc3NhZ2UucGF0dGVybjtcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoc2NoZW1hLmVycm9yTWVzc2FnZSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzY2hlbWEuZXJyb3JNZXNzYWdlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzY2hlbWEuYWxsT2YucHVzaCh7XG4gICAgICAgICAgICBwYXR0ZXJuOiBzdHJpbmdpZnlSZWdFeHBXaXRoRmxhZ3MocmVnZXgsIHJlZnMpLFxuICAgICAgICAgICAgLi4uKG1lc3NhZ2UgJiZcbiAgICAgICAgICAgICAgICByZWZzLmVycm9yTWVzc2FnZXMgJiYgeyBlcnJvck1lc3NhZ2U6IHsgcGF0dGVybjogbWVzc2FnZSB9IH0pLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMoc2NoZW1hLCBcInBhdHRlcm5cIiwgc3RyaW5naWZ5UmVnRXhwV2l0aEZsYWdzKHJlZ2V4LCByZWZzKSwgbWVzc2FnZSwgcmVmcyk7XG4gICAgfVxufVxuLy8gTXV0YXRlIHouc3RyaW5nLnJlZ2V4KCkgaW4gYSBiZXN0IGF0dGVtcHQgdG8gYWNjb21tb2RhdGUgZm9yIHJlZ2V4IGZsYWdzIHdoZW4gYXBwbHlSZWdleEZsYWdzIGlzIHRydWVcbmZ1bmN0aW9uIHN0cmluZ2lmeVJlZ0V4cFdpdGhGbGFncyhyZWdleCwgcmVmcykge1xuICAgIGlmICghcmVmcy5hcHBseVJlZ2V4RmxhZ3MgfHwgIXJlZ2V4LmZsYWdzKSB7XG4gICAgICAgIHJldHVybiByZWdleC5zb3VyY2U7XG4gICAgfVxuICAgIC8vIEN1cnJlbnRseSBoYW5kbGVkIGZsYWdzXG4gICAgY29uc3QgZmxhZ3MgPSB7XG4gICAgICAgIGk6IHJlZ2V4LmZsYWdzLmluY2x1ZGVzKFwiaVwiKSxcbiAgICAgICAgbTogcmVnZXguZmxhZ3MuaW5jbHVkZXMoXCJtXCIpLFxuICAgICAgICBzOiByZWdleC5mbGFncy5pbmNsdWRlcyhcInNcIiksIC8vIGAuYCBtYXRjaGVzIG5ld2xpbmVzXG4gICAgfTtcbiAgICAvLyBUaGUgZ2VuZXJhbCBwcmluY2lwbGUgaGVyZSBpcyB0byBzdGVwIHRocm91Z2ggZWFjaCBjaGFyYWN0ZXIsIG9uZSBhdCBhIHRpbWUsIGFwcGx5aW5nIG11dGF0aW9ucyBhcyBmbGFncyByZXF1aXJlLiBXZSBrZWVwIHRyYWNrIHdoZW4gdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGlzIGVzY2FwZWQsIGFuZCB3aGVuIGl0J3MgaW5zaWRlIGEgZ3JvdXAgL2xpa2UgW3RoaXNdLyBvciAoYWxzbykgYSByYW5nZSBsaWtlIC9bYS16XS8uIFRoZSBmb2xsb3dpbmcgaXMgZmFpcmx5IGJyaXR0bGUgaW1wZXJhdGl2ZSBjb2RlOyBlZGl0IGF0IHlvdXIgcGVyaWwhXG4gICAgY29uc3Qgc291cmNlID0gZmxhZ3MuaSA/IHJlZ2V4LnNvdXJjZS50b0xvd2VyQ2FzZSgpIDogcmVnZXguc291cmNlO1xuICAgIGxldCBwYXR0ZXJuID0gXCJcIjtcbiAgICBsZXQgaXNFc2NhcGVkID0gZmFsc2U7XG4gICAgbGV0IGluQ2hhckdyb3VwID0gZmFsc2U7XG4gICAgbGV0IGluQ2hhclJhbmdlID0gZmFsc2U7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGlzRXNjYXBlZCkge1xuICAgICAgICAgICAgcGF0dGVybiArPSBzb3VyY2VbaV07XG4gICAgICAgICAgICBpc0VzY2FwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmbGFncy5pKSB7XG4gICAgICAgICAgICBpZiAoaW5DaGFyR3JvdXApIHtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlW2ldLm1hdGNoKC9bYS16XS8pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbkNoYXJSYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiArPSBzb3VyY2VbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuICs9IGAke3NvdXJjZVtpIC0gMl19LSR7c291cmNlW2ldfWAudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluQ2hhclJhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc291cmNlW2kgKyAxXSA9PT0gXCItXCIgJiYgc291cmNlW2kgKyAyXT8ubWF0Y2goL1thLXpdLykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gKz0gc291cmNlW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5DaGFyUmFuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiArPSBgJHtzb3VyY2VbaV19JHtzb3VyY2VbaV0udG9VcHBlckNhc2UoKX1gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNvdXJjZVtpXS5tYXRjaCgvW2Etel0vKSkge1xuICAgICAgICAgICAgICAgIHBhdHRlcm4gKz0gYFske3NvdXJjZVtpXX0ke3NvdXJjZVtpXS50b1VwcGVyQ2FzZSgpfV1gO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChmbGFncy5tKSB7XG4gICAgICAgICAgICBpZiAoc291cmNlW2ldID09PSBcIl5cIikge1xuICAgICAgICAgICAgICAgIHBhdHRlcm4gKz0gYChefCg/PD1bXFxyXFxuXSkpYDtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNvdXJjZVtpXSA9PT0gXCIkXCIpIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuICs9IGAoJHwoPz1bXFxyXFxuXSkpYDtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZmxhZ3MucyAmJiBzb3VyY2VbaV0gPT09IFwiLlwiKSB7XG4gICAgICAgICAgICBwYXR0ZXJuICs9IGluQ2hhckdyb3VwID8gYCR7c291cmNlW2ldfVxcclxcbmAgOiBgWyR7c291cmNlW2ldfVxcclxcbl1gO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcGF0dGVybiArPSBzb3VyY2VbaV07XG4gICAgICAgIGlmIChzb3VyY2VbaV0gPT09IFwiXFxcXFwiKSB7XG4gICAgICAgICAgICBpc0VzY2FwZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluQ2hhckdyb3VwICYmIHNvdXJjZVtpXSA9PT0gXCJdXCIpIHtcbiAgICAgICAgICAgIGluQ2hhckdyb3VwID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWluQ2hhckdyb3VwICYmIHNvdXJjZVtpXSA9PT0gXCJbXCIpIHtcbiAgICAgICAgICAgIGluQ2hhckdyb3VwID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBuZXcgUmVnRXhwKHBhdHRlcm4pO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IGNvbnZlcnQgcmVnZXggcGF0dGVybiBhdCAke3JlZnMuY3VycmVudFBhdGguam9pbihcIi9cIil9IHRvIGEgZmxhZy1pbmRlcGVuZGVudCBmb3JtISBGYWxsaW5nIGJhY2sgdG8gdGhlIGZsYWctaWdub3JhbnQgc291cmNlYCk7XG4gICAgICAgIHJldHVybiByZWdleC5zb3VyY2U7XG4gICAgfVxuICAgIHJldHVybiBwYXR0ZXJuO1xufVxuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4uL3BhcnNlRGVmLmpzXCI7XG5pbXBvcnQgeyBwYXJzZVJlY29yZERlZiB9IGZyb20gXCIuL3JlY29yZC5qc1wiO1xuaW1wb3J0IHsgcGFyc2VBbnlEZWYgfSBmcm9tIFwiLi9hbnkuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZU1hcERlZihkZWYsIHJlZnMpIHtcbiAgICBpZiAocmVmcy5tYXBTdHJhdGVneSA9PT0gXCJyZWNvcmRcIikge1xuICAgICAgICByZXR1cm4gcGFyc2VSZWNvcmREZWYoZGVmLCByZWZzKTtcbiAgICB9XG4gICAgY29uc3Qga2V5cyA9IHBhcnNlRGVmKGRlZi5rZXlUeXBlLl9kZWYsIHtcbiAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcIml0ZW1zXCIsIFwiaXRlbXNcIiwgXCIwXCJdLFxuICAgIH0pIHx8IHBhcnNlQW55RGVmKHJlZnMpO1xuICAgIGNvbnN0IHZhbHVlcyA9IHBhcnNlRGVmKGRlZi52YWx1ZVR5cGUuX2RlZiwge1xuICAgICAgICAuLi5yZWZzLFxuICAgICAgICBjdXJyZW50UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwiaXRlbXNcIiwgXCJpdGVtc1wiLCBcIjFcIl0sXG4gICAgfSkgfHwgcGFyc2VBbnlEZWYocmVmcyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICBtYXhJdGVtczogMTI1LFxuICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgaXRlbXM6IFtrZXlzLCB2YWx1ZXNdLFxuICAgICAgICAgICAgbWluSXRlbXM6IDIsXG4gICAgICAgICAgICBtYXhJdGVtczogMixcbiAgICAgICAgfSxcbiAgICB9O1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBwYXJzZU5hdGl2ZUVudW1EZWYoZGVmKSB7XG4gICAgY29uc3Qgb2JqZWN0ID0gZGVmLnZhbHVlcztcbiAgICBjb25zdCBhY3R1YWxLZXlzID0gT2JqZWN0LmtleXMoZGVmLnZhbHVlcykuZmlsdGVyKChrZXkpID0+IHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmplY3Rbb2JqZWN0W2tleV1dICE9PSBcIm51bWJlclwiO1xuICAgIH0pO1xuICAgIGNvbnN0IGFjdHVhbFZhbHVlcyA9IGFjdHVhbEtleXMubWFwKChrZXkpID0+IG9iamVjdFtrZXldKTtcbiAgICBjb25zdCBwYXJzZWRUeXBlcyA9IEFycmF5LmZyb20obmV3IFNldChhY3R1YWxWYWx1ZXMubWFwKCh2YWx1ZXMpID0+IHR5cGVvZiB2YWx1ZXMpKSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogcGFyc2VkVHlwZXMubGVuZ3RoID09PSAxXG4gICAgICAgICAgICA/IHBhcnNlZFR5cGVzWzBdID09PSBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgPyBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgOiBcIm51bWJlclwiXG4gICAgICAgICAgICA6IFtcInN0cmluZ1wiLCBcIm51bWJlclwiXSxcbiAgICAgICAgZW51bTogYWN0dWFsVmFsdWVzLFxuICAgIH07XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VBbnlEZWYgfSBmcm9tIFwiLi9hbnkuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZU5ldmVyRGVmKHJlZnMpIHtcbiAgICByZXR1cm4gcmVmcy50YXJnZXQgPT09IFwib3BlbkFpXCJcbiAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgOiB7XG4gICAgICAgICAgICBub3Q6IHBhcnNlQW55RGVmKHtcbiAgICAgICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJub3RcIl0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gcGFyc2VOdWxsRGVmKHJlZnMpIHtcbiAgICByZXR1cm4gcmVmcy50YXJnZXQgPT09IFwib3BlbkFwaTNcIlxuICAgICAgICA/IHtcbiAgICAgICAgICAgIGVudW06IFtcIm51bGxcIl0sXG4gICAgICAgICAgICBudWxsYWJsZTogdHJ1ZSxcbiAgICAgICAgfVxuICAgICAgICA6IHtcbiAgICAgICAgICAgIHR5cGU6IFwibnVsbFwiLFxuICAgICAgICB9O1xufVxuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4uL3BhcnNlRGVmLmpzXCI7XG5leHBvcnQgY29uc3QgcHJpbWl0aXZlTWFwcGluZ3MgPSB7XG4gICAgWm9kU3RyaW5nOiBcInN0cmluZ1wiLFxuICAgIFpvZE51bWJlcjogXCJudW1iZXJcIixcbiAgICBab2RCaWdJbnQ6IFwiaW50ZWdlclwiLFxuICAgIFpvZEJvb2xlYW46IFwiYm9vbGVhblwiLFxuICAgIFpvZE51bGw6IFwibnVsbFwiLFxufTtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVuaW9uRGVmKGRlZiwgcmVmcykge1xuICAgIGlmIChyZWZzLnRhcmdldCA9PT0gXCJvcGVuQXBpM1wiKVxuICAgICAgICByZXR1cm4gYXNBbnlPZihkZWYsIHJlZnMpO1xuICAgIGNvbnN0IG9wdGlvbnMgPSBkZWYub3B0aW9ucyBpbnN0YW5jZW9mIE1hcCA/IEFycmF5LmZyb20oZGVmLm9wdGlvbnMudmFsdWVzKCkpIDogZGVmLm9wdGlvbnM7XG4gICAgLy8gVGhpcyBibG9ja3MgdHJpZXMgdG8gbG9vayBhaGVhZCBhIGJpdCB0byBwcm9kdWNlIG5pY2VyIGxvb2tpbmcgc2NoZW1hcyB3aXRoIHR5cGUgYXJyYXkgaW5zdGVhZCBvZiBhbnlPZi5cbiAgICBpZiAob3B0aW9ucy5ldmVyeSgoeCkgPT4geC5fZGVmLnR5cGVOYW1lIGluIHByaW1pdGl2ZU1hcHBpbmdzICYmXG4gICAgICAgICgheC5fZGVmLmNoZWNrcyB8fCAheC5fZGVmLmNoZWNrcy5sZW5ndGgpKSkge1xuICAgICAgICAvLyBhbGwgdHlwZXMgaW4gdW5pb24gYXJlIHByaW1pdGl2ZSBhbmQgbGFjayBjaGVja3MsIHNvIG1pZ2h0IGFzIHdlbGwgc3F1YXNoIGludG8ge3R5cGU6IFsuLi5dfVxuICAgICAgICBjb25zdCB0eXBlcyA9IG9wdGlvbnMucmVkdWNlKCh0eXBlcywgeCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHByaW1pdGl2ZU1hcHBpbmdzW3guX2RlZi50eXBlTmFtZV07IC8vQ2FuIGJlIHNhZmVseSBjYXN0ZWQgZHVlIHRvIHJvdyA0M1xuICAgICAgICAgICAgcmV0dXJuIHR5cGUgJiYgIXR5cGVzLmluY2x1ZGVzKHR5cGUpID8gWy4uLnR5cGVzLCB0eXBlXSA6IHR5cGVzO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiB0eXBlcy5sZW5ndGggPiAxID8gdHlwZXMgOiB0eXBlc1swXSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSBpZiAob3B0aW9ucy5ldmVyeSgoeCkgPT4geC5fZGVmLnR5cGVOYW1lID09PSBcIlpvZExpdGVyYWxcIiAmJiAheC5kZXNjcmlwdGlvbikpIHtcbiAgICAgICAgLy8gYWxsIG9wdGlvbnMgbGl0ZXJhbHNcbiAgICAgICAgY29uc3QgdHlwZXMgPSBvcHRpb25zLnJlZHVjZSgoYWNjLCB4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0eXBlID0gdHlwZW9mIHguX2RlZi52YWx1ZTtcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcImJvb2xlYW5cIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsuLi5hY2MsIHR5cGVdO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJiaWdpbnRcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsuLi5hY2MsIFwiaW50ZWdlclwiXTtcbiAgICAgICAgICAgICAgICBjYXNlIFwib2JqZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh4Ll9kZWYudmFsdWUgPT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWy4uLmFjYywgXCJudWxsXCJdO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzeW1ib2xcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwidW5kZWZpbmVkXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcImZ1bmN0aW9uXCI6XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgW10pO1xuICAgICAgICBpZiAodHlwZXMubGVuZ3RoID09PSBvcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gYWxsIHRoZSBsaXRlcmFscyBhcmUgcHJpbWl0aXZlLCBhcyBmYXIgYXMgbnVsbCBjYW4gYmUgY29uc2lkZXJlZCBwcmltaXRpdmVcbiAgICAgICAgICAgIGNvbnN0IHVuaXF1ZVR5cGVzID0gdHlwZXMuZmlsdGVyKCh4LCBpLCBhKSA9PiBhLmluZGV4T2YoeCkgPT09IGkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiB1bmlxdWVUeXBlcy5sZW5ndGggPiAxID8gdW5pcXVlVHlwZXMgOiB1bmlxdWVUeXBlc1swXSxcbiAgICAgICAgICAgICAgICBlbnVtOiBvcHRpb25zLnJlZHVjZSgoYWNjLCB4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY2MuaW5jbHVkZXMoeC5fZGVmLnZhbHVlKSA/IGFjYyA6IFsuLi5hY2MsIHguX2RlZi52YWx1ZV07XG4gICAgICAgICAgICAgICAgfSwgW10pLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChvcHRpb25zLmV2ZXJ5KCh4KSA9PiB4Ll9kZWYudHlwZU5hbWUgPT09IFwiWm9kRW51bVwiKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgIGVudW06IG9wdGlvbnMucmVkdWNlKChhY2MsIHgpID0+IFtcbiAgICAgICAgICAgICAgICAuLi5hY2MsXG4gICAgICAgICAgICAgICAgLi4ueC5fZGVmLnZhbHVlcy5maWx0ZXIoKHgpID0+ICFhY2MuaW5jbHVkZXMoeCkpLFxuICAgICAgICAgICAgXSwgW10pLFxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gYXNBbnlPZihkZWYsIHJlZnMpO1xufVxuY29uc3QgYXNBbnlPZiA9IChkZWYsIHJlZnMpID0+IHtcbiAgICBjb25zdCBhbnlPZiA9IChkZWYub3B0aW9ucyBpbnN0YW5jZW9mIE1hcFxuICAgICAgICA/IEFycmF5LmZyb20oZGVmLm9wdGlvbnMudmFsdWVzKCkpXG4gICAgICAgIDogZGVmLm9wdGlvbnMpXG4gICAgICAgIC5tYXAoKHgsIGkpID0+IHBhcnNlRGVmKHguX2RlZiwge1xuICAgICAgICAuLi5yZWZzLFxuICAgICAgICBjdXJyZW50UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwiYW55T2ZcIiwgYCR7aX1gXSxcbiAgICB9KSlcbiAgICAgICAgLmZpbHRlcigoeCkgPT4gISF4ICYmXG4gICAgICAgICghcmVmcy5zdHJpY3RVbmlvbnMgfHxcbiAgICAgICAgICAgICh0eXBlb2YgeCA9PT0gXCJvYmplY3RcIiAmJiBPYmplY3Qua2V5cyh4KS5sZW5ndGggPiAwKSkpO1xuICAgIHJldHVybiBhbnlPZi5sZW5ndGggPyB7IGFueU9mIH0gOiB1bmRlZmluZWQ7XG59O1xuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4uL3BhcnNlRGVmLmpzXCI7XG5pbXBvcnQgeyBwcmltaXRpdmVNYXBwaW5ncyB9IGZyb20gXCIuL3VuaW9uLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VOdWxsYWJsZURlZihkZWYsIHJlZnMpIHtcbiAgICBpZiAoW1wiWm9kU3RyaW5nXCIsIFwiWm9kTnVtYmVyXCIsIFwiWm9kQmlnSW50XCIsIFwiWm9kQm9vbGVhblwiLCBcIlpvZE51bGxcIl0uaW5jbHVkZXMoZGVmLmlubmVyVHlwZS5fZGVmLnR5cGVOYW1lKSAmJlxuICAgICAgICAoIWRlZi5pbm5lclR5cGUuX2RlZi5jaGVja3MgfHwgIWRlZi5pbm5lclR5cGUuX2RlZi5jaGVja3MubGVuZ3RoKSkge1xuICAgICAgICBpZiAocmVmcy50YXJnZXQgPT09IFwib3BlbkFwaTNcIikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBwcmltaXRpdmVNYXBwaW5nc1tkZWYuaW5uZXJUeXBlLl9kZWYudHlwZU5hbWVdLFxuICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogW1xuICAgICAgICAgICAgICAgIHByaW1pdGl2ZU1hcHBpbmdzW2RlZi5pbm5lclR5cGUuX2RlZi50eXBlTmFtZV0sXG4gICAgICAgICAgICAgICAgXCJudWxsXCIsXG4gICAgICAgICAgICBdLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBpZiAocmVmcy50YXJnZXQgPT09IFwib3BlbkFwaTNcIikge1xuICAgICAgICBjb25zdCBiYXNlID0gcGFyc2VEZWYoZGVmLmlubmVyVHlwZS5fZGVmLCB7XG4gICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoXSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChiYXNlICYmIFwiJHJlZlwiIGluIGJhc2UpXG4gICAgICAgICAgICByZXR1cm4geyBhbGxPZjogW2Jhc2VdLCBudWxsYWJsZTogdHJ1ZSB9O1xuICAgICAgICByZXR1cm4gYmFzZSAmJiB7IC4uLmJhc2UsIG51bGxhYmxlOiB0cnVlIH07XG4gICAgfVxuICAgIGNvbnN0IGJhc2UgPSBwYXJzZURlZihkZWYuaW5uZXJUeXBlLl9kZWYsIHtcbiAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcImFueU9mXCIsIFwiMFwiXSxcbiAgICB9KTtcbiAgICByZXR1cm4gYmFzZSAmJiB7IGFueU9mOiBbYmFzZSwgeyB0eXBlOiBcIm51bGxcIiB9XSB9O1xufVxuIiwgImltcG9ydCB7IGFkZEVycm9yTWVzc2FnZSwgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycywgfSBmcm9tIFwiLi4vZXJyb3JNZXNzYWdlcy5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTnVtYmVyRGVmKGRlZiwgcmVmcykge1xuICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICB9O1xuICAgIGlmICghZGVmLmNoZWNrcylcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICBmb3IgKGNvbnN0IGNoZWNrIG9mIGRlZi5jaGVja3MpIHtcbiAgICAgICAgc3dpdGNoIChjaGVjay5raW5kKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW50XCI6XG4gICAgICAgICAgICAgICAgcmVzLnR5cGUgPSBcImludGVnZXJcIjtcbiAgICAgICAgICAgICAgICBhZGRFcnJvck1lc3NhZ2UocmVzLCBcInR5cGVcIiwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWluXCI6XG4gICAgICAgICAgICAgICAgaWYgKHJlZnMudGFyZ2V0ID09PSBcImpzb25TY2hlbWE3XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrLmluY2x1c2l2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWluaW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJleGNsdXNpdmVNaW5pbXVtXCIsIGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVjay5pbmNsdXNpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5leGNsdXNpdmVNaW5pbXVtID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtaW5pbXVtXCIsIGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWF4XCI6XG4gICAgICAgICAgICAgICAgaWYgKHJlZnMudGFyZ2V0ID09PSBcImpzb25TY2hlbWE3XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrLmluY2x1c2l2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyhyZXMsIFwibWF4aW11bVwiLCBjaGVjay52YWx1ZSwgY2hlY2subWVzc2FnZSwgcmVmcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJleGNsdXNpdmVNYXhpbXVtXCIsIGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVjay5pbmNsdXNpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5leGNsdXNpdmVNYXhpbXVtID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZXRSZXNwb25zZVZhbHVlQW5kRXJyb3JzKHJlcywgXCJtYXhpbXVtXCIsIGNoZWNrLnZhbHVlLCBjaGVjay5tZXNzYWdlLCByZWZzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibXVsdGlwbGVPZlwiOlxuICAgICAgICAgICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMocmVzLCBcIm11bHRpcGxlT2ZcIiwgY2hlY2sudmFsdWUsIGNoZWNrLm1lc3NhZ2UsIHJlZnMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VEZWYgfSBmcm9tIFwiLi4vcGFyc2VEZWYuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZU9iamVjdERlZihkZWYsIHJlZnMpIHtcbiAgICBjb25zdCBmb3JjZU9wdGlvbmFsSW50b051bGxhYmxlID0gcmVmcy50YXJnZXQgPT09IFwib3BlbkFpXCI7XG4gICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICB9O1xuICAgIGNvbnN0IHJlcXVpcmVkID0gW107XG4gICAgY29uc3Qgc2hhcGUgPSBkZWYuc2hhcGUoKTtcbiAgICBmb3IgKGNvbnN0IHByb3BOYW1lIGluIHNoYXBlKSB7XG4gICAgICAgIGxldCBwcm9wRGVmID0gc2hhcGVbcHJvcE5hbWVdO1xuICAgICAgICBpZiAocHJvcERlZiA9PT0gdW5kZWZpbmVkIHx8IHByb3BEZWYuX2RlZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcHJvcE9wdGlvbmFsID0gc2FmZUlzT3B0aW9uYWwocHJvcERlZik7XG4gICAgICAgIGlmIChwcm9wT3B0aW9uYWwgJiYgZm9yY2VPcHRpb25hbEludG9OdWxsYWJsZSkge1xuICAgICAgICAgICAgaWYgKHByb3BEZWYuX2RlZi50eXBlTmFtZSA9PT0gXCJab2RPcHRpb25hbFwiKSB7XG4gICAgICAgICAgICAgICAgcHJvcERlZiA9IHByb3BEZWYuX2RlZi5pbm5lclR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXByb3BEZWYuaXNOdWxsYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcHJvcERlZiA9IHByb3BEZWYubnVsbGFibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByb3BPcHRpb25hbCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBhcnNlZERlZiA9IHBhcnNlRGVmKHByb3BEZWYuX2RlZiwge1xuICAgICAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJwcm9wZXJ0aWVzXCIsIHByb3BOYW1lXSxcbiAgICAgICAgICAgIHByb3BlcnR5UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwicHJvcGVydGllc1wiLCBwcm9wTmFtZV0sXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocGFyc2VkRGVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5wcm9wZXJ0aWVzW3Byb3BOYW1lXSA9IHBhcnNlZERlZjtcbiAgICAgICAgaWYgKCFwcm9wT3B0aW9uYWwpIHtcbiAgICAgICAgICAgIHJlcXVpcmVkLnB1c2gocHJvcE5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChyZXF1aXJlZC5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0LnJlcXVpcmVkID0gcmVxdWlyZWQ7XG4gICAgfVxuICAgIGNvbnN0IGFkZGl0aW9uYWxQcm9wZXJ0aWVzID0gZGVjaWRlQWRkaXRpb25hbFByb3BlcnRpZXMoZGVmLCByZWZzKTtcbiAgICBpZiAoYWRkaXRpb25hbFByb3BlcnRpZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXN1bHQuYWRkaXRpb25hbFByb3BlcnRpZXMgPSBhZGRpdGlvbmFsUHJvcGVydGllcztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGRlY2lkZUFkZGl0aW9uYWxQcm9wZXJ0aWVzKGRlZiwgcmVmcykge1xuICAgIGlmIChkZWYuY2F0Y2hhbGwuX2RlZi50eXBlTmFtZSAhPT0gXCJab2ROZXZlclwiKSB7XG4gICAgICAgIHJldHVybiBwYXJzZURlZihkZWYuY2F0Y2hhbGwuX2RlZiwge1xuICAgICAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJhZGRpdGlvbmFsUHJvcGVydGllc1wiXSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN3aXRjaCAoZGVmLnVua25vd25LZXlzKSB7XG4gICAgICAgIGNhc2UgXCJwYXNzdGhyb3VnaFwiOlxuICAgICAgICAgICAgcmV0dXJuIHJlZnMuYWxsb3dlZEFkZGl0aW9uYWxQcm9wZXJ0aWVzO1xuICAgICAgICBjYXNlIFwic3RyaWN0XCI6XG4gICAgICAgICAgICByZXR1cm4gcmVmcy5yZWplY3RlZEFkZGl0aW9uYWxQcm9wZXJ0aWVzO1xuICAgICAgICBjYXNlIFwic3RyaXBcIjpcbiAgICAgICAgICAgIHJldHVybiByZWZzLnJlbW92ZUFkZGl0aW9uYWxTdHJhdGVneSA9PT0gXCJzdHJpY3RcIlxuICAgICAgICAgICAgICAgID8gcmVmcy5hbGxvd2VkQWRkaXRpb25hbFByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICA6IHJlZnMucmVqZWN0ZWRBZGRpdGlvbmFsUHJvcGVydGllcztcbiAgICB9XG59XG5mdW5jdGlvbiBzYWZlSXNPcHRpb25hbChzY2hlbWEpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gc2NoZW1hLmlzT3B0aW9uYWwoKTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VEZWYgfSBmcm9tIFwiLi4vcGFyc2VEZWYuanNcIjtcbmltcG9ydCB7IHBhcnNlQW55RGVmIH0gZnJvbSBcIi4vYW55LmpzXCI7XG5leHBvcnQgY29uc3QgcGFyc2VPcHRpb25hbERlZiA9IChkZWYsIHJlZnMpID0+IHtcbiAgICBpZiAocmVmcy5jdXJyZW50UGF0aC50b1N0cmluZygpID09PSByZWZzLnByb3BlcnR5UGF0aD8udG9TdHJpbmcoKSkge1xuICAgICAgICByZXR1cm4gcGFyc2VEZWYoZGVmLmlubmVyVHlwZS5fZGVmLCByZWZzKTtcbiAgICB9XG4gICAgY29uc3QgaW5uZXJTY2hlbWEgPSBwYXJzZURlZihkZWYuaW5uZXJUeXBlLl9kZWYsIHtcbiAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcImFueU9mXCIsIFwiMVwiXSxcbiAgICB9KTtcbiAgICByZXR1cm4gaW5uZXJTY2hlbWFcbiAgICAgICAgPyB7XG4gICAgICAgICAgICBhbnlPZjogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbm90OiBwYXJzZUFueURlZihyZWZzKSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGlubmVyU2NoZW1hLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfVxuICAgICAgICA6IHBhcnNlQW55RGVmKHJlZnMpO1xufTtcbiIsICJpbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGNvbnN0IHBhcnNlUGlwZWxpbmVEZWYgPSAoZGVmLCByZWZzKSA9PiB7XG4gICAgaWYgKHJlZnMucGlwZVN0cmF0ZWd5ID09PSBcImlucHV0XCIpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRGVmKGRlZi5pbi5fZGVmLCByZWZzKTtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVmcy5waXBlU3RyYXRlZ3kgPT09IFwib3V0cHV0XCIpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRGVmKGRlZi5vdXQuX2RlZiwgcmVmcyk7XG4gICAgfVxuICAgIGNvbnN0IGEgPSBwYXJzZURlZihkZWYuaW4uX2RlZiwge1xuICAgICAgICAuLi5yZWZzLFxuICAgICAgICBjdXJyZW50UGF0aDogWy4uLnJlZnMuY3VycmVudFBhdGgsIFwiYWxsT2ZcIiwgXCIwXCJdLFxuICAgIH0pO1xuICAgIGNvbnN0IGIgPSBwYXJzZURlZihkZWYub3V0Ll9kZWYsIHtcbiAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcImFsbE9mXCIsIGEgPyBcIjFcIiA6IFwiMFwiXSxcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhbGxPZjogW2EsIGJdLmZpbHRlcigoeCkgPT4geCAhPT0gdW5kZWZpbmVkKSxcbiAgICB9O1xufTtcbiIsICJpbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUHJvbWlzZURlZihkZWYsIHJlZnMpIHtcbiAgICByZXR1cm4gcGFyc2VEZWYoZGVmLnR5cGUuX2RlZiwgcmVmcyk7XG59XG4iLCAiaW1wb3J0IHsgc2V0UmVzcG9uc2VWYWx1ZUFuZEVycm9ycyB9IGZyb20gXCIuLi9lcnJvck1lc3NhZ2VzLmpzXCI7XG5pbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlU2V0RGVmKGRlZiwgcmVmcykge1xuICAgIGNvbnN0IGl0ZW1zID0gcGFyc2VEZWYoZGVmLnZhbHVlVHlwZS5fZGVmLCB7XG4gICAgICAgIC4uLnJlZnMsXG4gICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJpdGVtc1wiXSxcbiAgICB9KTtcbiAgICBjb25zdCBzY2hlbWEgPSB7XG4gICAgICAgIHR5cGU6IFwiYXJyYXlcIixcbiAgICAgICAgdW5pcXVlSXRlbXM6IHRydWUsXG4gICAgICAgIGl0ZW1zLFxuICAgIH07XG4gICAgaWYgKGRlZi5taW5TaXplKSB7XG4gICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMoc2NoZW1hLCBcIm1pbkl0ZW1zXCIsIGRlZi5taW5TaXplLnZhbHVlLCBkZWYubWluU2l6ZS5tZXNzYWdlLCByZWZzKTtcbiAgICB9XG4gICAgaWYgKGRlZi5tYXhTaXplKSB7XG4gICAgICAgIHNldFJlc3BvbnNlVmFsdWVBbmRFcnJvcnMoc2NoZW1hLCBcIm1heEl0ZW1zXCIsIGRlZi5tYXhTaXplLnZhbHVlLCBkZWYubWF4U2l6ZS5tZXNzYWdlLCByZWZzKTtcbiAgICB9XG4gICAgcmV0dXJuIHNjaGVtYTtcbn1cbiIsICJpbXBvcnQgeyBwYXJzZURlZiB9IGZyb20gXCIuLi9wYXJzZURlZi5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVHVwbGVEZWYoZGVmLCByZWZzKSB7XG4gICAgaWYgKGRlZi5yZXN0KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICBtaW5JdGVtczogZGVmLml0ZW1zLmxlbmd0aCxcbiAgICAgICAgICAgIGl0ZW1zOiBkZWYuaXRlbXNcbiAgICAgICAgICAgICAgICAubWFwKCh4LCBpKSA9PiBwYXJzZURlZih4Ll9kZWYsIHtcbiAgICAgICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJpdGVtc1wiLCBgJHtpfWBdLFxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoYWNjLCB4KSA9PiAoeCA9PT0gdW5kZWZpbmVkID8gYWNjIDogWy4uLmFjYywgeF0pLCBbXSksXG4gICAgICAgICAgICBhZGRpdGlvbmFsSXRlbXM6IHBhcnNlRGVmKGRlZi5yZXN0Ll9kZWYsIHtcbiAgICAgICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5jdXJyZW50UGF0aCwgXCJhZGRpdGlvbmFsSXRlbXNcIl0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICBtaW5JdGVtczogZGVmLml0ZW1zLmxlbmd0aCxcbiAgICAgICAgICAgIG1heEl0ZW1zOiBkZWYuaXRlbXMubGVuZ3RoLFxuICAgICAgICAgICAgaXRlbXM6IGRlZi5pdGVtc1xuICAgICAgICAgICAgICAgIC5tYXAoKHgsIGkpID0+IHBhcnNlRGVmKHguX2RlZiwge1xuICAgICAgICAgICAgICAgIC4uLnJlZnMsXG4gICAgICAgICAgICAgICAgY3VycmVudFBhdGg6IFsuLi5yZWZzLmN1cnJlbnRQYXRoLCBcIml0ZW1zXCIsIGAke2l9YF0sXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAucmVkdWNlKChhY2MsIHgpID0+ICh4ID09PSB1bmRlZmluZWQgPyBhY2MgOiBbLi4uYWNjLCB4XSksIFtdKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VBbnlEZWYgfSBmcm9tIFwiLi9hbnkuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVuZGVmaW5lZERlZihyZWZzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbm90OiBwYXJzZUFueURlZihyZWZzKSxcbiAgICB9O1xufVxuIiwgImltcG9ydCB7IHBhcnNlQW55RGVmIH0gZnJvbSBcIi4vYW55LmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVbmtub3duRGVmKHJlZnMpIHtcbiAgICByZXR1cm4gcGFyc2VBbnlEZWYocmVmcyk7XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VEZWYgfSBmcm9tIFwiLi4vcGFyc2VEZWYuanNcIjtcbmV4cG9ydCBjb25zdCBwYXJzZVJlYWRvbmx5RGVmID0gKGRlZiwgcmVmcykgPT4ge1xuICAgIHJldHVybiBwYXJzZURlZihkZWYuaW5uZXJUeXBlLl9kZWYsIHJlZnMpO1xufTtcbiIsICJpbXBvcnQgeyBpZ25vcmVPdmVycmlkZSB9IGZyb20gXCIuL09wdGlvbnMuanNcIjtcbmltcG9ydCB7IHNlbGVjdFBhcnNlciB9IGZyb20gXCIuL3NlbGVjdFBhcnNlci5qc1wiO1xuaW1wb3J0IHsgZ2V0UmVsYXRpdmVQYXRoIH0gZnJvbSBcIi4vZ2V0UmVsYXRpdmVQYXRoLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUFueURlZiB9IGZyb20gXCIuL3BhcnNlcnMvYW55LmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VEZWYoZGVmLCByZWZzLCBmb3JjZVJlc29sdXRpb24gPSBmYWxzZSkge1xuICAgIGNvbnN0IHNlZW5JdGVtID0gcmVmcy5zZWVuLmdldChkZWYpO1xuICAgIGlmIChyZWZzLm92ZXJyaWRlKSB7XG4gICAgICAgIGNvbnN0IG92ZXJyaWRlUmVzdWx0ID0gcmVmcy5vdmVycmlkZT8uKGRlZiwgcmVmcywgc2Vlbkl0ZW0sIGZvcmNlUmVzb2x1dGlvbik7XG4gICAgICAgIGlmIChvdmVycmlkZVJlc3VsdCAhPT0gaWdub3JlT3ZlcnJpZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBvdmVycmlkZVJlc3VsdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoc2Vlbkl0ZW0gJiYgIWZvcmNlUmVzb2x1dGlvbikge1xuICAgICAgICBjb25zdCBzZWVuU2NoZW1hID0gZ2V0JHJlZihzZWVuSXRlbSwgcmVmcyk7XG4gICAgICAgIGlmIChzZWVuU2NoZW1hICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWVuU2NoZW1hO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld0l0ZW0gPSB7IGRlZiwgcGF0aDogcmVmcy5jdXJyZW50UGF0aCwganNvblNjaGVtYTogdW5kZWZpbmVkIH07XG4gICAgcmVmcy5zZWVuLnNldChkZWYsIG5ld0l0ZW0pO1xuICAgIGNvbnN0IGpzb25TY2hlbWFPckdldHRlciA9IHNlbGVjdFBhcnNlcihkZWYsIGRlZi50eXBlTmFtZSwgcmVmcyk7XG4gICAgLy8gSWYgdGhlIHJldHVybiB3YXMgYSBmdW5jdGlvbiwgdGhlbiB0aGUgaW5uZXIgZGVmaW5pdGlvbiBuZWVkcyB0byBiZSBleHRyYWN0ZWQgYmVmb3JlIGEgY2FsbCB0byBwYXJzZURlZiAocmVjdXJzaXZlKVxuICAgIGNvbnN0IGpzb25TY2hlbWEgPSB0eXBlb2YganNvblNjaGVtYU9yR2V0dGVyID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBwYXJzZURlZihqc29uU2NoZW1hT3JHZXR0ZXIoKSwgcmVmcylcbiAgICAgICAgOiBqc29uU2NoZW1hT3JHZXR0ZXI7XG4gICAgaWYgKGpzb25TY2hlbWEpIHtcbiAgICAgICAgYWRkTWV0YShkZWYsIHJlZnMsIGpzb25TY2hlbWEpO1xuICAgIH1cbiAgICBpZiAocmVmcy5wb3N0UHJvY2Vzcykge1xuICAgICAgICBjb25zdCBwb3N0UHJvY2Vzc1Jlc3VsdCA9IHJlZnMucG9zdFByb2Nlc3MoanNvblNjaGVtYSwgZGVmLCByZWZzKTtcbiAgICAgICAgbmV3SXRlbS5qc29uU2NoZW1hID0ganNvblNjaGVtYTtcbiAgICAgICAgcmV0dXJuIHBvc3RQcm9jZXNzUmVzdWx0O1xuICAgIH1cbiAgICBuZXdJdGVtLmpzb25TY2hlbWEgPSBqc29uU2NoZW1hO1xuICAgIHJldHVybiBqc29uU2NoZW1hO1xufVxuY29uc3QgZ2V0JHJlZiA9IChpdGVtLCByZWZzKSA9PiB7XG4gICAgc3dpdGNoIChyZWZzLiRyZWZTdHJhdGVneSkge1xuICAgICAgICBjYXNlIFwicm9vdFwiOlxuICAgICAgICAgICAgcmV0dXJuIHsgJHJlZjogaXRlbS5wYXRoLmpvaW4oXCIvXCIpIH07XG4gICAgICAgIGNhc2UgXCJyZWxhdGl2ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIHsgJHJlZjogZ2V0UmVsYXRpdmVQYXRoKHJlZnMuY3VycmVudFBhdGgsIGl0ZW0ucGF0aCkgfTtcbiAgICAgICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgICAgY2FzZSBcInNlZW5cIjoge1xuICAgICAgICAgICAgaWYgKGl0ZW0ucGF0aC5sZW5ndGggPCByZWZzLmN1cnJlbnRQYXRoLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgIGl0ZW0ucGF0aC5ldmVyeSgodmFsdWUsIGluZGV4KSA9PiByZWZzLmN1cnJlbnRQYXRoW2luZGV4XSA9PT0gdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSZWN1cnNpdmUgcmVmZXJlbmNlIGRldGVjdGVkIGF0ICR7cmVmcy5jdXJyZW50UGF0aC5qb2luKFwiL1wiKX0hIERlZmF1bHRpbmcgdG8gYW55YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlQW55RGVmKHJlZnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlZnMuJHJlZlN0cmF0ZWd5ID09PSBcInNlZW5cIiA/IHBhcnNlQW55RGVmKHJlZnMpIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxufTtcbmNvbnN0IGFkZE1ldGEgPSAoZGVmLCByZWZzLCBqc29uU2NoZW1hKSA9PiB7XG4gICAgaWYgKGRlZi5kZXNjcmlwdGlvbikge1xuICAgICAgICBqc29uU2NoZW1hLmRlc2NyaXB0aW9uID0gZGVmLmRlc2NyaXB0aW9uO1xuICAgICAgICBpZiAocmVmcy5tYXJrZG93bkRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBqc29uU2NoZW1hLm1hcmtkb3duRGVzY3JpcHRpb24gPSBkZWYuZGVzY3JpcHRpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGpzb25TY2hlbWE7XG59O1xuIiwgImltcG9ydCB7IHBhcnNlRGVmIH0gZnJvbSBcIi4vcGFyc2VEZWYuanNcIjtcbmltcG9ydCB7IGdldFJlZnMgfSBmcm9tIFwiLi9SZWZzLmpzXCI7XG5pbXBvcnQgeyBwYXJzZUFueURlZiB9IGZyb20gXCIuL3BhcnNlcnMvYW55LmpzXCI7XG5jb25zdCB6b2RUb0pzb25TY2hlbWEgPSAoc2NoZW1hLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgcmVmcyA9IGdldFJlZnMob3B0aW9ucyk7XG4gICAgbGV0IGRlZmluaXRpb25zID0gdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucy5kZWZpbml0aW9uc1xuICAgICAgICA/IE9iamVjdC5lbnRyaWVzKG9wdGlvbnMuZGVmaW5pdGlvbnMpLnJlZHVjZSgoYWNjLCBbbmFtZSwgc2NoZW1hXSkgPT4gKHtcbiAgICAgICAgICAgIC4uLmFjYyxcbiAgICAgICAgICAgIFtuYW1lXTogcGFyc2VEZWYoc2NoZW1hLl9kZWYsIHtcbiAgICAgICAgICAgICAgICAuLi5yZWZzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5iYXNlUGF0aCwgcmVmcy5kZWZpbml0aW9uUGF0aCwgbmFtZV0sXG4gICAgICAgICAgICB9LCB0cnVlKSA/PyBwYXJzZUFueURlZihyZWZzKSxcbiAgICAgICAgfSksIHt9KVxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICBjb25zdCBuYW1lID0gdHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCJcbiAgICAgICAgPyBvcHRpb25zXG4gICAgICAgIDogb3B0aW9ucz8ubmFtZVN0cmF0ZWd5ID09PSBcInRpdGxlXCJcbiAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICA6IG9wdGlvbnM/Lm5hbWU7XG4gICAgY29uc3QgbWFpbiA9IHBhcnNlRGVmKHNjaGVtYS5fZGVmLCBuYW1lID09PSB1bmRlZmluZWRcbiAgICAgICAgPyByZWZzXG4gICAgICAgIDoge1xuICAgICAgICAgICAgLi4ucmVmcyxcbiAgICAgICAgICAgIGN1cnJlbnRQYXRoOiBbLi4ucmVmcy5iYXNlUGF0aCwgcmVmcy5kZWZpbml0aW9uUGF0aCwgbmFtZV0sXG4gICAgICAgIH0sIGZhbHNlKSA/PyBwYXJzZUFueURlZihyZWZzKTtcbiAgICBjb25zdCB0aXRsZSA9IHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgIG9wdGlvbnMubmFtZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIG9wdGlvbnMubmFtZVN0cmF0ZWd5ID09PSBcInRpdGxlXCJcbiAgICAgICAgPyBvcHRpb25zLm5hbWVcbiAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgaWYgKHRpdGxlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbWFpbi50aXRsZSA9IHRpdGxlO1xuICAgIH1cbiAgICBpZiAocmVmcy5mbGFncy5oYXNSZWZlcmVuY2VkT3BlbkFpQW55VHlwZSkge1xuICAgICAgICBpZiAoIWRlZmluaXRpb25zKSB7XG4gICAgICAgICAgICBkZWZpbml0aW9ucyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVmaW5pdGlvbnNbcmVmcy5vcGVuQWlBbnlUeXBlTmFtZV0pIHtcbiAgICAgICAgICAgIGRlZmluaXRpb25zW3JlZnMub3BlbkFpQW55VHlwZU5hbWVdID0ge1xuICAgICAgICAgICAgICAgIC8vIFNraXBwaW5nIFwib2JqZWN0XCIgYXMgbm8gcHJvcGVydGllcyBjYW4gYmUgZGVmaW5lZCBhbmQgYWRkaXRpb25hbFByb3BlcnRpZXMgbXVzdCBiZSBcImZhbHNlXCJcbiAgICAgICAgICAgICAgICB0eXBlOiBbXCJzdHJpbmdcIiwgXCJudW1iZXJcIiwgXCJpbnRlZ2VyXCIsIFwiYm9vbGVhblwiLCBcImFycmF5XCIsIFwibnVsbFwiXSxcbiAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICAkcmVmOiByZWZzLiRyZWZTdHJhdGVneSA9PT0gXCJyZWxhdGl2ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiMVwiXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5yZWZzLmJhc2VQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMuZGVmaW5pdGlvblBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmcy5vcGVuQWlBbnlUeXBlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIi9cIiksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29tYmluZWQgPSBuYW1lID09PSB1bmRlZmluZWRcbiAgICAgICAgPyBkZWZpbml0aW9uc1xuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgLi4ubWFpbixcbiAgICAgICAgICAgICAgICBbcmVmcy5kZWZpbml0aW9uUGF0aF06IGRlZmluaXRpb25zLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiBtYWluXG4gICAgICAgIDoge1xuICAgICAgICAgICAgJHJlZjogW1xuICAgICAgICAgICAgICAgIC4uLihyZWZzLiRyZWZTdHJhdGVneSA9PT0gXCJyZWxhdGl2ZVwiID8gW10gOiByZWZzLmJhc2VQYXRoKSxcbiAgICAgICAgICAgICAgICByZWZzLmRlZmluaXRpb25QYXRoLFxuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBdLmpvaW4oXCIvXCIpLFxuICAgICAgICAgICAgW3JlZnMuZGVmaW5pdGlvblBhdGhdOiB7XG4gICAgICAgICAgICAgICAgLi4uZGVmaW5pdGlvbnMsXG4gICAgICAgICAgICAgICAgW25hbWVdOiBtYWluLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICBpZiAocmVmcy50YXJnZXQgPT09IFwianNvblNjaGVtYTdcIikge1xuICAgICAgICBjb21iaW5lZC4kc2NoZW1hID0gXCJodHRwOi8vanNvbi1zY2hlbWEub3JnL2RyYWZ0LTA3L3NjaGVtYSNcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVmcy50YXJnZXQgPT09IFwianNvblNjaGVtYTIwMTktMDlcIiB8fCByZWZzLnRhcmdldCA9PT0gXCJvcGVuQWlcIikge1xuICAgICAgICBjb21iaW5lZC4kc2NoZW1hID0gXCJodHRwczovL2pzb24tc2NoZW1hLm9yZy9kcmFmdC8yMDE5LTA5L3NjaGVtYSNcIjtcbiAgICB9XG4gICAgaWYgKHJlZnMudGFyZ2V0ID09PSBcIm9wZW5BaVwiICYmXG4gICAgICAgIChcImFueU9mXCIgaW4gY29tYmluZWQgfHxcbiAgICAgICAgICAgIFwib25lT2ZcIiBpbiBjb21iaW5lZCB8fFxuICAgICAgICAgICAgXCJhbGxPZlwiIGluIGNvbWJpbmVkIHx8XG4gICAgICAgICAgICAoXCJ0eXBlXCIgaW4gY29tYmluZWQgJiYgQXJyYXkuaXNBcnJheShjb21iaW5lZC50eXBlKSkpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIldhcm5pbmc6IE9wZW5BSSBtYXkgbm90IHN1cHBvcnQgc2NoZW1hcyB3aXRoIHVuaW9ucyBhcyByb290cyEgVHJ5IHdyYXBwaW5nIGl0IGluIGFuIG9iamVjdCBwcm9wZXJ0eS5cIik7XG4gICAgfVxuICAgIHJldHVybiBjb21iaW5lZDtcbn07XG5leHBvcnQgeyB6b2RUb0pzb25TY2hlbWEgfTtcbiIsICJleHBvcnQgKiBmcm9tIFwiLi9PcHRpb25zLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9SZWZzLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9lcnJvck1lc3NhZ2VzLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9nZXRSZWxhdGl2ZVBhdGguanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlRGVmLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZVR5cGVzLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL2FueS5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9hcnJheS5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9iaWdpbnQuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvYm9vbGVhbi5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9icmFuZGVkLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL2NhdGNoLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL2RhdGUuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvZGVmYXVsdC5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9lZmZlY3RzLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL2VudW0uanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvaW50ZXJzZWN0aW9uLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL2xpdGVyYWwuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvbWFwLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL25hdGl2ZUVudW0uanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvbmV2ZXIuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvbnVsbC5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9udWxsYWJsZS5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9udW1iZXIuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvb2JqZWN0LmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL29wdGlvbmFsLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL3BpcGVsaW5lLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL3Byb21pc2UuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvcmVhZG9ubHkuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvcmVjb3JkLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL3NldC5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGFyc2Vycy9zdHJpbmcuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvdHVwbGUuanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3BhcnNlcnMvdW5kZWZpbmVkLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL3VuaW9uLmpzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9wYXJzZXJzL3Vua25vd24uanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL3NlbGVjdFBhcnNlci5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vem9kVG9Kc29uU2NoZW1hLmpzXCI7XG5pbXBvcnQgeyB6b2RUb0pzb25TY2hlbWEgfSBmcm9tIFwiLi96b2RUb0pzb25TY2hlbWEuanNcIjtcbmV4cG9ydCBkZWZhdWx0IHpvZFRvSnNvblNjaGVtYTtcbiIsICJpbXBvcnQgeyBOb1N1Y2hNb2RlbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBsb2FkT3B0aW9uYWxTZXR0aW5nLFxuICB3aXRob3V0VHJhaWxpbmdTbGFzaCxcbiAgdHlwZSBGZXRjaEZ1bmN0aW9uLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IGFzR2F0ZXdheUVycm9yLCBHYXRld2F5QXV0aGVudGljYXRpb25FcnJvciB9IGZyb20gJy4vZXJyb3JzJztcbmltcG9ydCB7XG4gIEdBVEVXQVlfQVVUSF9NRVRIT0RfSEVBREVSLFxuICBwYXJzZUF1dGhNZXRob2QsXG59IGZyb20gJy4vZXJyb3JzL3BhcnNlLWF1dGgtbWV0aG9kJztcbmltcG9ydCB7XG4gIEdhdGV3YXlGZXRjaE1ldGFkYXRhLFxuICB0eXBlIEdhdGV3YXlGZXRjaE1ldGFkYXRhUmVzcG9uc2UsXG59IGZyb20gJy4vZ2F0ZXdheS1mZXRjaC1tZXRhZGF0YSc7XG5pbXBvcnQgeyBHYXRld2F5TGFuZ3VhZ2VNb2RlbCB9IGZyb20gJy4vZ2F0ZXdheS1sYW5ndWFnZS1tb2RlbCc7XG5pbXBvcnQgeyBHYXRld2F5RW1iZWRkaW5nTW9kZWwgfSBmcm9tICcuL2dhdGV3YXktZW1iZWRkaW5nLW1vZGVsJztcbmltcG9ydCB0eXBlIHsgR2F0ZXdheUVtYmVkZGluZ01vZGVsSWQgfSBmcm9tICcuL2dhdGV3YXktZW1iZWRkaW5nLW1vZGVsLXNldHRpbmdzJztcbmltcG9ydCB7IGdldFZlcmNlbE9pZGNUb2tlbiwgZ2V0VmVyY2VsUmVxdWVzdElkIH0gZnJvbSAnLi92ZXJjZWwtZW52aXJvbm1lbnQnO1xuaW1wb3J0IHR5cGUgeyBHYXRld2F5TW9kZWxJZCB9IGZyb20gJy4vZ2F0ZXdheS1sYW5ndWFnZS1tb2RlbC1zZXR0aW5ncyc7XG5pbXBvcnQgdHlwZSB7XG4gIExhbmd1YWdlTW9kZWxWMixcbiAgRW1iZWRkaW5nTW9kZWxWMixcbiAgUHJvdmlkZXJWMixcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2F0ZXdheVByb3ZpZGVyIGV4dGVuZHMgUHJvdmlkZXJWMiB7XG4gIChtb2RlbElkOiBHYXRld2F5TW9kZWxJZCk6IExhbmd1YWdlTW9kZWxWMjtcblxuICAvKipcbkNyZWF0ZXMgYSBtb2RlbCBmb3IgdGV4dCBnZW5lcmF0aW9uLlxuKi9cbiAgbGFuZ3VhZ2VNb2RlbChtb2RlbElkOiBHYXRld2F5TW9kZWxJZCk6IExhbmd1YWdlTW9kZWxWMjtcblxuICAvKipcblJldHVybnMgYXZhaWxhYmxlIHByb3ZpZGVycyBhbmQgbW9kZWxzIGZvciB1c2Ugd2l0aCB0aGUgcmVtb3RlIHByb3ZpZGVyLlxuICovXG4gIGdldEF2YWlsYWJsZU1vZGVscygpOiBQcm9taXNlPEdhdGV3YXlGZXRjaE1ldGFkYXRhUmVzcG9uc2U+O1xuXG4gIC8qKlxuQ3JlYXRlcyBhIG1vZGVsIGZvciBnZW5lcmF0aW5nIHRleHQgZW1iZWRkaW5ncy5cbiovXG4gIHRleHRFbWJlZGRpbmdNb2RlbChcbiAgICBtb2RlbElkOiBHYXRld2F5RW1iZWRkaW5nTW9kZWxJZCxcbiAgKTogRW1iZWRkaW5nTW9kZWxWMjxzdHJpbmc+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdhdGV3YXlQcm92aWRlclNldHRpbmdzIHtcbiAgLyoqXG5UaGUgYmFzZSBVUkwgcHJlZml4IGZvciBBUEkgY2FsbHMuIERlZmF1bHRzIHRvIGBodHRwczovL2FpLWdhdGV3YXkudmVyY2VsLnNoL3YxL2FpYC5cbiAgICovXG4gIGJhc2VVUkw/OiBzdHJpbmc7XG5cbiAgLyoqXG5BUEkga2V5IHRoYXQgaXMgYmVpbmcgc2VudCB1c2luZyB0aGUgYEF1dGhvcml6YXRpb25gIGhlYWRlci5cbiAgICovXG4gIGFwaUtleT86IHN0cmluZztcblxuICAvKipcbkN1c3RvbSBoZWFkZXJzIHRvIGluY2x1ZGUgaW4gdGhlIHJlcXVlc3RzLlxuICAgICAqL1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICAvKipcbkN1c3RvbSBmZXRjaCBpbXBsZW1lbnRhdGlvbi4gWW91IGNhbiB1c2UgaXQgYXMgYSBtaWRkbGV3YXJlIHRvIGludGVyY2VwdCByZXF1ZXN0cyxcbm9yIHRvIHByb3ZpZGUgYSBjdXN0b20gZmV0Y2ggaW1wbGVtZW50YXRpb24gZm9yIGUuZy4gdGVzdGluZy5cbiAgICAqL1xuICBmZXRjaD86IEZldGNoRnVuY3Rpb247XG5cbiAgLyoqXG5Ib3cgZnJlcXVlbnRseSB0byByZWZyZXNoIHRoZSBtZXRhZGF0YSBjYWNoZSBpbiBtaWxsaXNlY29uZHMuXG4gICAqL1xuICBtZXRhZGF0YUNhY2hlUmVmcmVzaE1pbGxpcz86IG51bWJlcjtcblxuICAvKipcbiAgICogQGludGVybmFsIEZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHlcbiAgICovXG4gIF9pbnRlcm5hbD86IHtcbiAgICBjdXJyZW50RGF0ZT86ICgpID0+IERhdGU7XG4gIH07XG59XG5cbmNvbnN0IEFJX0dBVEVXQVlfUFJPVE9DT0xfVkVSU0lPTiA9ICcwLjAuMSc7XG5cbi8qKlxuQ3JlYXRlIGEgcmVtb3RlIHByb3ZpZGVyIGluc3RhbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlR2F0ZXdheVByb3ZpZGVyKFxuICBvcHRpb25zOiBHYXRld2F5UHJvdmlkZXJTZXR0aW5ncyA9IHt9LFxuKTogR2F0ZXdheVByb3ZpZGVyIHtcbiAgbGV0IHBlbmRpbmdNZXRhZGF0YTogUHJvbWlzZTxHYXRld2F5RmV0Y2hNZXRhZGF0YVJlc3BvbnNlPiB8IG51bGwgPSBudWxsO1xuICBsZXQgbWV0YWRhdGFDYWNoZTogR2F0ZXdheUZldGNoTWV0YWRhdGFSZXNwb25zZSB8IG51bGwgPSBudWxsO1xuICBjb25zdCBjYWNoZVJlZnJlc2hNaWxsaXMgPVxuICAgIG9wdGlvbnMubWV0YWRhdGFDYWNoZVJlZnJlc2hNaWxsaXMgPz8gMTAwMCAqIDYwICogNTtcbiAgbGV0IGxhc3RGZXRjaFRpbWUgPSAwO1xuXG4gIGNvbnN0IGJhc2VVUkwgPVxuICAgIHdpdGhvdXRUcmFpbGluZ1NsYXNoKG9wdGlvbnMuYmFzZVVSTCkgPz9cbiAgICAnaHR0cHM6Ly9haS1nYXRld2F5LnZlcmNlbC5zaC92MS9haSc7XG5cbiAgY29uc3QgZ2V0SGVhZGVycyA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBhdXRoID0gYXdhaXQgZ2V0R2F0ZXdheUF1dGhUb2tlbihvcHRpb25zKTtcbiAgICBpZiAoYXV0aCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2F1dGgudG9rZW59YCxcbiAgICAgICAgJ2FpLWdhdGV3YXktcHJvdG9jb2wtdmVyc2lvbic6IEFJX0dBVEVXQVlfUFJPVE9DT0xfVkVSU0lPTixcbiAgICAgICAgW0dBVEVXQVlfQVVUSF9NRVRIT0RfSEVBREVSXTogYXV0aC5hdXRoTWV0aG9kLFxuICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRocm93IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yLmNyZWF0ZUNvbnRleHR1YWxFcnJvcih7XG4gICAgICBhcGlLZXlQcm92aWRlZDogZmFsc2UsXG4gICAgICBvaWRjVG9rZW5Qcm92aWRlZDogZmFsc2UsXG4gICAgICBzdGF0dXNDb2RlOiA0MDEsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlTzExeUhlYWRlcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGVwbG95bWVudElkID0gbG9hZE9wdGlvbmFsU2V0dGluZyh7XG4gICAgICBzZXR0aW5nVmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiAnVkVSQ0VMX0RFUExPWU1FTlRfSUQnLFxuICAgIH0pO1xuICAgIGNvbnN0IGVudmlyb25tZW50ID0gbG9hZE9wdGlvbmFsU2V0dGluZyh7XG4gICAgICBzZXR0aW5nVmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiAnVkVSQ0VMX0VOVicsXG4gICAgfSk7XG4gICAgY29uc3QgcmVnaW9uID0gbG9hZE9wdGlvbmFsU2V0dGluZyh7XG4gICAgICBzZXR0aW5nVmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiAnVkVSQ0VMX1JFR0lPTicsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdElkID0gYXdhaXQgZ2V0VmVyY2VsUmVxdWVzdElkKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi4oZGVwbG95bWVudElkICYmIHsgJ2FpLW8xMXktZGVwbG95bWVudC1pZCc6IGRlcGxveW1lbnRJZCB9KSxcbiAgICAgICAgLi4uKGVudmlyb25tZW50ICYmIHsgJ2FpLW8xMXktZW52aXJvbm1lbnQnOiBlbnZpcm9ubWVudCB9KSxcbiAgICAgICAgLi4uKHJlZ2lvbiAmJiB7ICdhaS1vMTF5LXJlZ2lvbic6IHJlZ2lvbiB9KSxcbiAgICAgICAgLi4uKHJlcXVlc3RJZCAmJiB7ICdhaS1vMTF5LXJlcXVlc3QtaWQnOiByZXF1ZXN0SWQgfSksXG4gICAgICB9O1xuICAgIH07XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlTGFuZ3VhZ2VNb2RlbCA9IChtb2RlbElkOiBHYXRld2F5TW9kZWxJZCkgPT4ge1xuICAgIHJldHVybiBuZXcgR2F0ZXdheUxhbmd1YWdlTW9kZWwobW9kZWxJZCwge1xuICAgICAgcHJvdmlkZXI6ICdnYXRld2F5JyxcbiAgICAgIGJhc2VVUkwsXG4gICAgICBoZWFkZXJzOiBnZXRIZWFkZXJzLFxuICAgICAgZmV0Y2g6IG9wdGlvbnMuZmV0Y2gsXG4gICAgICBvMTF5SGVhZGVyczogY3JlYXRlTzExeUhlYWRlcnMoKSxcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBnZXRBdmFpbGFibGVNb2RlbHMgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgbm93ID0gb3B0aW9ucy5faW50ZXJuYWw/LmN1cnJlbnREYXRlPy4oKS5nZXRUaW1lKCkgPz8gRGF0ZS5ub3coKTtcbiAgICBpZiAoIXBlbmRpbmdNZXRhZGF0YSB8fCBub3cgLSBsYXN0RmV0Y2hUaW1lID4gY2FjaGVSZWZyZXNoTWlsbGlzKSB7XG4gICAgICBsYXN0RmV0Y2hUaW1lID0gbm93O1xuXG4gICAgICBwZW5kaW5nTWV0YWRhdGEgPSBuZXcgR2F0ZXdheUZldGNoTWV0YWRhdGEoe1xuICAgICAgICBiYXNlVVJMLFxuICAgICAgICBoZWFkZXJzOiBnZXRIZWFkZXJzLFxuICAgICAgICBmZXRjaDogb3B0aW9ucy5mZXRjaCxcbiAgICAgIH0pXG4gICAgICAgIC5nZXRBdmFpbGFibGVNb2RlbHMoKVxuICAgICAgICAudGhlbihtZXRhZGF0YSA9PiB7XG4gICAgICAgICAgbWV0YWRhdGFDYWNoZSA9IG1ldGFkYXRhO1xuICAgICAgICAgIHJldHVybiBtZXRhZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGFzeW5jIChlcnJvcjogdW5rbm93bikgPT4ge1xuICAgICAgICAgIHRocm93IGFzR2F0ZXdheUVycm9yKGVycm9yLCBwYXJzZUF1dGhNZXRob2QoYXdhaXQgZ2V0SGVhZGVycygpKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBtZXRhZGF0YUNhY2hlID8gUHJvbWlzZS5yZXNvbHZlKG1ldGFkYXRhQ2FjaGUpIDogcGVuZGluZ01ldGFkYXRhO1xuICB9O1xuXG4gIGNvbnN0IHByb3ZpZGVyID0gZnVuY3Rpb24gKG1vZGVsSWQ6IEdhdGV3YXlNb2RlbElkKSB7XG4gICAgaWYgKG5ldy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ1RoZSBHYXRld2F5IFByb3ZpZGVyIG1vZGVsIGZ1bmN0aW9uIGNhbm5vdCBiZSBjYWxsZWQgd2l0aCB0aGUgbmV3IGtleXdvcmQuJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZUxhbmd1YWdlTW9kZWwobW9kZWxJZCk7XG4gIH07XG5cbiAgcHJvdmlkZXIuZ2V0QXZhaWxhYmxlTW9kZWxzID0gZ2V0QXZhaWxhYmxlTW9kZWxzO1xuICBwcm92aWRlci5pbWFnZU1vZGVsID0gKG1vZGVsSWQ6IHN0cmluZykgPT4ge1xuICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHsgbW9kZWxJZCwgbW9kZWxUeXBlOiAnaW1hZ2VNb2RlbCcgfSk7XG4gIH07XG4gIHByb3ZpZGVyLmxhbmd1YWdlTW9kZWwgPSBjcmVhdGVMYW5ndWFnZU1vZGVsO1xuICBwcm92aWRlci50ZXh0RW1iZWRkaW5nTW9kZWwgPSAobW9kZWxJZDogR2F0ZXdheUVtYmVkZGluZ01vZGVsSWQpID0+IHtcbiAgICByZXR1cm4gbmV3IEdhdGV3YXlFbWJlZGRpbmdNb2RlbChtb2RlbElkLCB7XG4gICAgICBwcm92aWRlcjogJ2dhdGV3YXknLFxuICAgICAgYmFzZVVSTCxcbiAgICAgIGhlYWRlcnM6IGdldEhlYWRlcnMsXG4gICAgICBmZXRjaDogb3B0aW9ucy5mZXRjaCxcbiAgICAgIG8xMXlIZWFkZXJzOiBjcmVhdGVPMTF5SGVhZGVycygpLFxuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBwcm92aWRlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGdhdGV3YXkgPSBjcmVhdGVHYXRld2F5UHJvdmlkZXIoKTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEdhdGV3YXlBdXRoVG9rZW4oXG4gIG9wdGlvbnM6IEdhdGV3YXlQcm92aWRlclNldHRpbmdzLFxuKTogUHJvbWlzZTx7XG4gIHRva2VuOiBzdHJpbmc7XG4gIGF1dGhNZXRob2Q6ICdhcGkta2V5JyB8ICdvaWRjJztcbn0gfCBudWxsPiB7XG4gIGNvbnN0IGFwaUtleSA9IGxvYWRPcHRpb25hbFNldHRpbmcoe1xuICAgIHNldHRpbmdWYWx1ZTogb3B0aW9ucy5hcGlLZXksXG4gICAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWU6ICdBSV9HQVRFV0FZX0FQSV9LRVknLFxuICB9KTtcblxuICBpZiAoYXBpS2V5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRva2VuOiBhcGlLZXksXG4gICAgICBhdXRoTWV0aG9kOiAnYXBpLWtleScsXG4gICAgfTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3Qgb2lkY1Rva2VuID0gYXdhaXQgZ2V0VmVyY2VsT2lkY1Rva2VuKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRva2VuOiBvaWRjVG9rZW4sXG4gICAgICBhdXRoTWV0aG9kOiAnb2lkYycsXG4gICAgfTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBUElDYWxsRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IGV4dHJhY3RBcGlDYWxsUmVzcG9uc2UsIEdhdGV3YXlFcnJvciB9IGZyb20gJy4nO1xuaW1wb3J0IHsgY3JlYXRlR2F0ZXdheUVycm9yRnJvbVJlc3BvbnNlIH0gZnJvbSAnLi9jcmVhdGUtZ2F0ZXdheS1lcnJvcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBhc0dhdGV3YXlFcnJvcihcbiAgZXJyb3I6IHVua25vd24sXG4gIGF1dGhNZXRob2Q/OiAnYXBpLWtleScgfCAnb2lkYycsXG4pIHtcbiAgaWYgKEdhdGV3YXlFcnJvci5pc0luc3RhbmNlKGVycm9yKSkge1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGlmIChBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICByZXR1cm4gY3JlYXRlR2F0ZXdheUVycm9yRnJvbVJlc3BvbnNlKHtcbiAgICAgIHJlc3BvbnNlOiBleHRyYWN0QXBpQ2FsbFJlc3BvbnNlKGVycm9yKSxcbiAgICAgIHN0YXR1c0NvZGU6IGVycm9yLnN0YXR1c0NvZGUgPz8gNTAwLFxuICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdHYXRld2F5IHJlcXVlc3QgZmFpbGVkJyxcbiAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgIGF1dGhNZXRob2QsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlR2F0ZXdheUVycm9yRnJvbVJlc3BvbnNlKHtcbiAgICByZXNwb25zZToge30sXG4gICAgc3RhdHVzQ29kZTogNTAwLFxuICAgIGRlZmF1bHRNZXNzYWdlOlxuICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvclxuICAgICAgICA/IGBHYXRld2F5IHJlcXVlc3QgZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YFxuICAgICAgICA6ICdVbmtub3duIEdhdGV3YXkgZXJyb3InLFxuICAgIGNhdXNlOiBlcnJvcixcbiAgICBhdXRoTWV0aG9kLFxuICB9KTtcbn1cbiIsICJpbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB0eXBlIHsgR2F0ZXdheUVycm9yIH0gZnJvbSAnLi9nYXRld2F5LWVycm9yJztcbmltcG9ydCB7IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yIH0gZnJvbSAnLi9nYXRld2F5LWF1dGhlbnRpY2F0aW9uLWVycm9yJztcbmltcG9ydCB7IEdhdGV3YXlJbnZhbGlkUmVxdWVzdEVycm9yIH0gZnJvbSAnLi9nYXRld2F5LWludmFsaWQtcmVxdWVzdC1lcnJvcic7XG5pbXBvcnQgeyBHYXRld2F5UmF0ZUxpbWl0RXJyb3IgfSBmcm9tICcuL2dhdGV3YXktcmF0ZS1saW1pdC1lcnJvcic7XG5pbXBvcnQge1xuICBHYXRld2F5TW9kZWxOb3RGb3VuZEVycm9yLFxuICBtb2RlbE5vdEZvdW5kUGFyYW1TY2hlbWEsXG59IGZyb20gJy4vZ2F0ZXdheS1tb2RlbC1ub3QtZm91bmQtZXJyb3InO1xuaW1wb3J0IHsgR2F0ZXdheUludGVybmFsU2VydmVyRXJyb3IgfSBmcm9tICcuL2dhdGV3YXktaW50ZXJuYWwtc2VydmVyLWVycm9yJztcbmltcG9ydCB7IEdhdGV3YXlSZXNwb25zZUVycm9yIH0gZnJvbSAnLi9nYXRld2F5LXJlc3BvbnNlLWVycm9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUdhdGV3YXlFcnJvckZyb21SZXNwb25zZSh7XG4gIHJlc3BvbnNlLFxuICBzdGF0dXNDb2RlLFxuICBkZWZhdWx0TWVzc2FnZSA9ICdHYXRld2F5IHJlcXVlc3QgZmFpbGVkJyxcbiAgY2F1c2UsXG4gIGF1dGhNZXRob2QsXG59OiB7XG4gIHJlc3BvbnNlOiB1bmtub3duO1xuICBzdGF0dXNDb2RlOiBudW1iZXI7XG4gIGRlZmF1bHRNZXNzYWdlPzogc3RyaW5nO1xuICBjYXVzZT86IHVua25vd247XG4gIGF1dGhNZXRob2Q/OiAnYXBpLWtleScgfCAnb2lkYyc7XG59KTogR2F0ZXdheUVycm9yIHtcbiAgY29uc3QgcGFyc2VSZXN1bHQgPSBnYXRld2F5RXJyb3JSZXNwb25zZVNjaGVtYS5zYWZlUGFyc2UocmVzcG9uc2UpO1xuICBpZiAoIXBhcnNlUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gbmV3IEdhdGV3YXlSZXNwb25zZUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGBJbnZhbGlkIGVycm9yIHJlc3BvbnNlIGZvcm1hdDogJHtkZWZhdWx0TWVzc2FnZX1gLFxuICAgICAgc3RhdHVzQ29kZSxcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgdmFsaWRhdGlvbkVycm9yOiBwYXJzZVJlc3VsdC5lcnJvcixcbiAgICAgIGNhdXNlLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgdmFsaWRhdGVkUmVzcG9uc2U6IEdhdGV3YXlFcnJvclJlc3BvbnNlID0gcGFyc2VSZXN1bHQuZGF0YTtcbiAgY29uc3QgZXJyb3JUeXBlID0gdmFsaWRhdGVkUmVzcG9uc2UuZXJyb3IudHlwZTtcbiAgY29uc3QgbWVzc2FnZSA9IHZhbGlkYXRlZFJlc3BvbnNlLmVycm9yLm1lc3NhZ2U7XG5cbiAgc3dpdGNoIChlcnJvclR5cGUpIHtcbiAgICBjYXNlICdhdXRoZW50aWNhdGlvbl9lcnJvcic6XG4gICAgICByZXR1cm4gR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3IuY3JlYXRlQ29udGV4dHVhbEVycm9yKHtcbiAgICAgICAgYXBpS2V5UHJvdmlkZWQ6IGF1dGhNZXRob2QgPT09ICdhcGkta2V5JyxcbiAgICAgICAgb2lkY1Rva2VuUHJvdmlkZWQ6IGF1dGhNZXRob2QgPT09ICdvaWRjJyxcbiAgICAgICAgc3RhdHVzQ29kZSxcbiAgICAgICAgY2F1c2UsXG4gICAgICB9KTtcbiAgICBjYXNlICdpbnZhbGlkX3JlcXVlc3RfZXJyb3InOlxuICAgICAgcmV0dXJuIG5ldyBHYXRld2F5SW52YWxpZFJlcXVlc3RFcnJvcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIGNhc2UgJ3JhdGVfbGltaXRfZXhjZWVkZWQnOlxuICAgICAgcmV0dXJuIG5ldyBHYXRld2F5UmF0ZUxpbWl0RXJyb3IoeyBtZXNzYWdlLCBzdGF0dXNDb2RlLCBjYXVzZSB9KTtcbiAgICBjYXNlICdtb2RlbF9ub3RfZm91bmQnOiB7XG4gICAgICBjb25zdCBtb2RlbFJlc3VsdCA9IG1vZGVsTm90Rm91bmRQYXJhbVNjaGVtYS5zYWZlUGFyc2UoXG4gICAgICAgIHZhbGlkYXRlZFJlc3BvbnNlLmVycm9yLnBhcmFtLFxuICAgICAgKTtcbiAgICAgIHJldHVybiBuZXcgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvcih7XG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIHN0YXR1c0NvZGUsXG4gICAgICAgIG1vZGVsSWQ6IG1vZGVsUmVzdWx0LnN1Y2Nlc3MgPyBtb2RlbFJlc3VsdC5kYXRhLm1vZGVsSWQgOiB1bmRlZmluZWQsXG4gICAgICAgIGNhdXNlLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNhc2UgJ2ludGVybmFsX3NlcnZlcl9lcnJvcic6XG4gICAgICByZXR1cm4gbmV3IEdhdGV3YXlJbnRlcm5hbFNlcnZlckVycm9yKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBuZXcgR2F0ZXdheUludGVybmFsU2VydmVyRXJyb3IoeyBtZXNzYWdlLCBzdGF0dXNDb2RlLCBjYXVzZSB9KTtcbiAgfVxufVxuXG5jb25zdCBnYXRld2F5RXJyb3JSZXNwb25zZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZXJyb3I6IHoub2JqZWN0KHtcbiAgICBtZXNzYWdlOiB6LnN0cmluZygpLFxuICAgIHR5cGU6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICAgIHBhcmFtOiB6LnVua25vd24oKS5udWxsaXNoKCksXG4gICAgY29kZTogei51bmlvbihbei5zdHJpbmcoKSwgei5udW1iZXIoKV0pLm51bGxpc2goKSxcbiAgfSksXG59KTtcblxuZXhwb3J0IHR5cGUgR2F0ZXdheUVycm9yUmVzcG9uc2UgPSB6LmluZmVyPHR5cGVvZiBnYXRld2F5RXJyb3JSZXNwb25zZVNjaGVtYT47XG4iLCAiY29uc3QgbWFya2VyID0gJ3ZlcmNlbC5haS5nYXRld2F5LmVycm9yJztcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEdhdGV3YXlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIGFic3RyYWN0IHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAgYWJzdHJhY3QgcmVhZG9ubHkgdHlwZTogc3RyaW5nO1xuICByZWFkb25seSBzdGF0dXNDb2RlOiBudW1iZXI7XG4gIHJlYWRvbmx5IGNhdXNlPzogdW5rbm93bjtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSxcbiAgICBzdGF0dXNDb2RlID0gNTAwLFxuICAgIGNhdXNlLFxuICB9OiB7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICB0aGlzLmNhdXNlID0gY2F1c2U7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBlcnJvciBpcyBhIEdhdGV3YXkgRXJyb3IuXG4gICAqIEBwYXJhbSB7dW5rbm93bn0gZXJyb3IgLSBUaGUgZXJyb3IgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBlcnJvciBpcyBhIEdhdGV3YXkgRXJyb3IsIGZhbHNlIG90aGVyd2lzZS5cbiAgICovXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgR2F0ZXdheUVycm9yIHtcbiAgICByZXR1cm4gR2F0ZXdheUVycm9yLmhhc01hcmtlcihlcnJvcik7XG4gIH1cblxuICBzdGF0aWMgaGFzTWFya2VyKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgR2F0ZXdheUVycm9yIHtcbiAgICByZXR1cm4gKFxuICAgICAgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJlxuICAgICAgZXJyb3IgIT09IG51bGwgJiZcbiAgICAgIHN5bWJvbCBpbiBlcnJvciAmJlxuICAgICAgKGVycm9yIGFzIGFueSlbc3ltYm9sXSA9PT0gdHJ1ZVxuICAgICk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBHYXRld2F5RXJyb3IgfSBmcm9tICcuL2dhdGV3YXktZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0dhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZ2F0ZXdheS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG4gKiBBdXRoZW50aWNhdGlvbiBmYWlsZWQgLSBpbnZhbGlkIEFQSSBrZXkgb3IgT0lEQyB0b2tlblxuICovXG5leHBvcnQgY2xhc3MgR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBHYXRld2F5RXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgbmFtZSA9IG5hbWU7XG4gIHJlYWRvbmx5IHR5cGUgPSAnYXV0aGVudGljYXRpb25fZXJyb3InO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcsXG4gICAgc3RhdHVzQ29kZSA9IDQwMSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gICAgc3RhdHVzQ29kZT86IG51bWJlcjtcbiAgICBjYXVzZT86IHVua25vd247XG4gIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yIHtcbiAgICByZXR1cm4gR2F0ZXdheUVycm9yLmhhc01hcmtlcihlcnJvcikgJiYgc3ltYm9sIGluIGVycm9yO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBjb250ZXh0dWFsIGVycm9yIG1lc3NhZ2Ugd2hlbiBhdXRoZW50aWNhdGlvbiBmYWlsc1xuICAgKi9cbiAgc3RhdGljIGNyZWF0ZUNvbnRleHR1YWxFcnJvcih7XG4gICAgYXBpS2V5UHJvdmlkZWQsXG4gICAgb2lkY1Rva2VuUHJvdmlkZWQsXG4gICAgbWVzc2FnZSA9ICdBdXRoZW50aWNhdGlvbiBmYWlsZWQnLFxuICAgIHN0YXR1c0NvZGUgPSA0MDEsXG4gICAgY2F1c2UsXG4gIH06IHtcbiAgICBhcGlLZXlQcm92aWRlZDogYm9vbGVhbjtcbiAgICBvaWRjVG9rZW5Qcm92aWRlZDogYm9vbGVhbjtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KTogR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3Ige1xuICAgIGxldCBjb250ZXh0dWFsTWVzc2FnZTogc3RyaW5nO1xuXG4gICAgaWYgKGFwaUtleVByb3ZpZGVkKSB7XG4gICAgICBjb250ZXh0dWFsTWVzc2FnZSA9IGBBSSBHYXRld2F5IGF1dGhlbnRpY2F0aW9uIGZhaWxlZDogSW52YWxpZCBBUEkga2V5IHByb3ZpZGVkLlxuXG5UaGUgdG9rZW4gaXMgZXhwZWN0ZWQgdG8gYmUgcHJvdmlkZWQgdmlhIHRoZSAnYXBpS2V5JyBvcHRpb24gb3IgJ0FJX0dBVEVXQVlfQVBJX0tFWScgZW52aXJvbm1lbnQgdmFyaWFibGUuYDtcbiAgICB9IGVsc2UgaWYgKG9pZGNUb2tlblByb3ZpZGVkKSB7XG4gICAgICBjb250ZXh0dWFsTWVzc2FnZSA9IGBBSSBHYXRld2F5IGF1dGhlbnRpY2F0aW9uIGZhaWxlZDogSW52YWxpZCBPSURDIHRva2VuIHByb3ZpZGVkLlxuXG5UaGUgdG9rZW4gaXMgZXhwZWN0ZWQgdG8gYmUgcHJvdmlkZWQgdmlhIHRoZSAnVkVSQ0VMX09JRENfVE9LRU4nIGVudmlyb25tZW50IHZhcmlhYmxlLiBJdCBleHBpcmVzIGV2ZXJ5IDEyIGhvdXJzLlxuLSBtYWtlIHN1cmUgeW91ciBWZXJjZWwgcHJvamVjdCBzZXR0aW5ncyBoYXZlIE9JREMgZW5hYmxlZFxuLSBpZiBydW5uaW5nIGxvY2FsbHkgd2l0aCAndmVyY2VsIGRldicsIHRoZSB0b2tlbiBpcyBhdXRvbWF0aWNhbGx5IG9idGFpbmVkIGFuZCByZWZyZXNoZWRcbi0gaWYgcnVubmluZyBsb2NhbGx5IHdpdGggeW91ciBvd24gZGV2IHNlcnZlciwgcnVuICd2ZXJjZWwgZW52IHB1bGwnIHRvIGZldGNoIHRoZSB0b2tlblxuLSBpbiBwcm9kdWN0aW9uL3ByZXZpZXcsIHRoZSB0b2tlbiBpcyBhdXRvbWF0aWNhbGx5IG9idGFpbmVkIGFuZCByZWZyZXNoZWRcblxuQWx0ZXJuYXRpdmU6IFByb3ZpZGUgYW4gQVBJIGtleSB2aWEgJ2FwaUtleScgb3B0aW9uIG9yICdBSV9HQVRFV0FZX0FQSV9LRVknIGVudmlyb25tZW50IHZhcmlhYmxlLmA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRleHR1YWxNZXNzYWdlID0gYEFJIEdhdGV3YXkgYXV0aGVudGljYXRpb24gZmFpbGVkOiBObyBhdXRoZW50aWNhdGlvbiBwcm92aWRlZC5cblxuUHJvdmlkZSBlaXRoZXIgYW4gQVBJIGtleSBvciBPSURDIHRva2VuLlxuXG5BUEkga2V5IGluc3RydWN0aW9uczpcblxuVGhlIHRva2VuIGlzIGV4cGVjdGVkIHRvIGJlIHByb3ZpZGVkIHZpYSB0aGUgJ2FwaUtleScgb3B0aW9uIG9yICdBSV9HQVRFV0FZX0FQSV9LRVknIGVudmlyb25tZW50IHZhcmlhYmxlLlxuXG5PSURDIHRva2VuIGluc3RydWN0aW9uczpcblxuVGhlIHRva2VuIGlzIGV4cGVjdGVkIHRvIGJlIHByb3ZpZGVkIHZpYSB0aGUgJ1ZFUkNFTF9PSURDX1RPS0VOJyBlbnZpcm9ubWVudCB2YXJpYWJsZS4gSXQgZXhwaXJlcyBldmVyeSAxMiBob3Vycy5cbi0gbWFrZSBzdXJlIHlvdXIgVmVyY2VsIHByb2plY3Qgc2V0dGluZ3MgaGF2ZSBPSURDIGVuYWJsZWRcbi0gaWYgcnVubmluZyBsb2NhbGx5IHdpdGggJ3ZlcmNlbCBkZXYnLCB0aGUgdG9rZW4gaXMgYXV0b21hdGljYWxseSBvYnRhaW5lZCBhbmQgcmVmcmVzaGVkXG4tIGlmIHJ1bm5pbmcgbG9jYWxseSB3aXRoIHlvdXIgb3duIGRldiBzZXJ2ZXIsIHJ1biAndmVyY2VsIGVudiBwdWxsJyB0byBmZXRjaCB0aGUgdG9rZW5cbi0gaW4gcHJvZHVjdGlvbi9wcmV2aWV3LCB0aGUgdG9rZW4gaXMgYXV0b21hdGljYWxseSBvYnRhaW5lZCBhbmQgcmVmcmVzaGVkYDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGNvbnRleHR1YWxNZXNzYWdlLFxuICAgICAgc3RhdHVzQ29kZSxcbiAgICAgIGNhdXNlLFxuICAgIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgR2F0ZXdheUVycm9yIH0gZnJvbSAnLi9nYXRld2F5LWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdHYXRld2F5SW52YWxpZFJlcXVlc3RFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogSW52YWxpZCByZXF1ZXN0IC0gbWlzc2luZyBoZWFkZXJzLCBtYWxmb3JtZWQgZGF0YSwgZXRjLlxuICovXG5leHBvcnQgY2xhc3MgR2F0ZXdheUludmFsaWRSZXF1ZXN0RXJyb3IgZXh0ZW5kcyBHYXRld2F5RXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgbmFtZSA9IG5hbWU7XG4gIHJlYWRvbmx5IHR5cGUgPSAnaW52YWxpZF9yZXF1ZXN0X2Vycm9yJztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdJbnZhbGlkIHJlcXVlc3QnLFxuICAgIHN0YXR1c0NvZGUgPSA0MDAsXG4gICAgY2F1c2UsXG4gIH06IHtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBHYXRld2F5SW52YWxpZFJlcXVlc3RFcnJvciB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbCBpbiBlcnJvcjtcbiAgfVxufVxuIiwgImltcG9ydCB7IEdhdGV3YXlFcnJvciB9IGZyb20gJy4vZ2F0ZXdheS1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnR2F0ZXdheVJhdGVMaW1pdEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZ2F0ZXdheS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG4gKiBSYXRlIGxpbWl0IGV4Y2VlZGVkLlxuICovXG5leHBvcnQgY2xhc3MgR2F0ZXdheVJhdGVMaW1pdEVycm9yIGV4dGVuZHMgR2F0ZXdheUVycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIHJlYWRvbmx5IG5hbWUgPSBuYW1lO1xuICByZWFkb25seSB0eXBlID0gJ3JhdGVfbGltaXRfZXhjZWVkZWQnO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxuICAgIHN0YXR1c0NvZGUgPSA0MjksXG4gICAgY2F1c2UsXG4gIH06IHtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBHYXRld2F5UmF0ZUxpbWl0RXJyb3Ige1xuICAgIHJldHVybiBHYXRld2F5RXJyb3IuaGFzTWFya2VyKGVycm9yKSAmJiBzeW1ib2wgaW4gZXJyb3I7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IEdhdGV3YXlFcnJvciB9IGZyb20gJy4vZ2F0ZXdheS1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjb25zdCBtb2RlbE5vdEZvdW5kUGFyYW1TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIG1vZGVsSWQ6IHouc3RyaW5nKCksXG59KTtcblxuLyoqXG4gKiBNb2RlbCBub3QgZm91bmQgb3Igbm90IGF2YWlsYWJsZVxuICovXG5leHBvcnQgY2xhc3MgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvciBleHRlbmRzIEdhdGV3YXlFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBuYW1lID0gbmFtZTtcbiAgcmVhZG9ubHkgdHlwZSA9ICdtb2RlbF9ub3RfZm91bmQnO1xuICByZWFkb25seSBtb2RlbElkPzogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gJ01vZGVsIG5vdCBmb3VuZCcsXG4gICAgc3RhdHVzQ29kZSA9IDQwNCxcbiAgICBtb2RlbElkLFxuICAgIGNhdXNlLFxuICB9OiB7XG4gICAgbWVzc2FnZT86IHN0cmluZztcbiAgICBzdGF0dXNDb2RlPzogbnVtYmVyO1xuICAgIG1vZGVsSWQ/OiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEdhdGV3YXlNb2RlbE5vdEZvdW5kRXJyb3Ige1xuICAgIHJldHVybiBHYXRld2F5RXJyb3IuaGFzTWFya2VyKGVycm9yKSAmJiBzeW1ib2wgaW4gZXJyb3I7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBHYXRld2F5RXJyb3IgfSBmcm9tICcuL2dhdGV3YXktZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0dhdGV3YXlJbnRlcm5hbFNlcnZlckVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZ2F0ZXdheS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG4gKiBJbnRlcm5hbCBzZXJ2ZXIgZXJyb3IgZnJvbSB0aGUgR2F0ZXdheVxuICovXG5leHBvcnQgY2xhc3MgR2F0ZXdheUludGVybmFsU2VydmVyRXJyb3IgZXh0ZW5kcyBHYXRld2F5RXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgbmFtZSA9IG5hbWU7XG4gIHJlYWRvbmx5IHR5cGUgPSAnaW50ZXJuYWxfc2VydmVyX2Vycm9yJztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgIHN0YXR1c0NvZGUgPSA1MDAsXG4gICAgY2F1c2UsXG4gIH06IHtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBHYXRld2F5SW50ZXJuYWxTZXJ2ZXJFcnJvciB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbCBpbiBlcnJvcjtcbiAgfVxufVxuIiwgImltcG9ydCB7IEdhdGV3YXlFcnJvciB9IGZyb20gJy4vZ2F0ZXdheS1lcnJvcic7XG5pbXBvcnQgdHlwZSB7IFpvZEVycm9yIH0gZnJvbSAnem9kL3Y0JztcblxuY29uc3QgbmFtZSA9ICdHYXRld2F5UmVzcG9uc2VFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogR2F0ZXdheSByZXNwb25zZSBwYXJzaW5nIGVycm9yXG4gKi9cbmV4cG9ydCBjbGFzcyBHYXRld2F5UmVzcG9uc2VFcnJvciBleHRlbmRzIEdhdGV3YXlFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBuYW1lID0gbmFtZTtcbiAgcmVhZG9ubHkgdHlwZSA9ICdyZXNwb25zZV9lcnJvcic7XG4gIHJlYWRvbmx5IHJlc3BvbnNlPzogdW5rbm93bjtcbiAgcmVhZG9ubHkgdmFsaWRhdGlvbkVycm9yPzogWm9kRXJyb3I7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lc3NhZ2UgPSAnSW52YWxpZCByZXNwb25zZSBmcm9tIEdhdGV3YXknLFxuICAgIHN0YXR1c0NvZGUgPSA1MDIsXG4gICAgcmVzcG9uc2UsXG4gICAgdmFsaWRhdGlvbkVycm9yLFxuICAgIGNhdXNlLFxuICB9OiB7XG4gICAgbWVzc2FnZT86IHN0cmluZztcbiAgICBzdGF0dXNDb2RlPzogbnVtYmVyO1xuICAgIHJlc3BvbnNlPzogdW5rbm93bjtcbiAgICB2YWxpZGF0aW9uRXJyb3I/OiBab2RFcnJvcjtcbiAgICBjYXVzZT86IHVua25vd247XG4gIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMudmFsaWRhdGlvbkVycm9yID0gdmFsaWRhdGlvbkVycm9yO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBHYXRld2F5UmVzcG9uc2VFcnJvciB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbCBpbiBlcnJvcjtcbiAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgQVBJQ2FsbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0QXBpQ2FsbFJlc3BvbnNlKGVycm9yOiBBUElDYWxsRXJyb3IpOiB1bmtub3duIHtcbiAgaWYgKGVycm9yLmRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBlcnJvci5kYXRhO1xuICB9XG4gIGlmIChlcnJvci5yZXNwb25zZUJvZHkgIT0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShlcnJvci5yZXNwb25zZUJvZHkpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGVycm9yLnJlc3BvbnNlQm9keTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHt9O1xufVxuIiwgImltcG9ydCB7IHogfSBmcm9tICd6b2QvdjQnO1xuXG5leHBvcnQgY29uc3QgR0FURVdBWV9BVVRIX01FVEhPRF9IRUFERVIgPSAnYWktZ2F0ZXdheS1hdXRoLW1ldGhvZCcgYXMgY29uc3Q7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUF1dGhNZXRob2QoaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPikge1xuICBjb25zdCByZXN1bHQgPSBnYXRld2F5QXV0aE1ldGhvZFNjaGVtYS5zYWZlUGFyc2UoXG4gICAgaGVhZGVyc1tHQVRFV0FZX0FVVEhfTUVUSE9EX0hFQURFUl0sXG4gICk7XG4gIHJldHVybiByZXN1bHQuc3VjY2VzcyA/IHJlc3VsdC5kYXRhIDogdW5kZWZpbmVkO1xufVxuXG5jb25zdCBnYXRld2F5QXV0aE1ldGhvZFNjaGVtYSA9IHoudW5pb24oW1xuICB6LmxpdGVyYWwoJ2FwaS1rZXknKSxcbiAgei5saXRlcmFsKCdvaWRjJyksXG5dKTtcbiIsICJpbXBvcnQge1xuICBjcmVhdGVKc29uRXJyb3JSZXNwb25zZUhhbmRsZXIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIsXG4gIGdldEZyb21BcGksXG4gIHJlc29sdmUsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgYXNHYXRld2F5RXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgdHlwZSB7IEdhdGV3YXlDb25maWcgfSBmcm9tICcuL2dhdGV3YXktY29uZmlnJztcbmltcG9ydCB0eXBlIHsgR2F0ZXdheUxhbmd1YWdlTW9kZWxFbnRyeSB9IGZyb20gJy4vZ2F0ZXdheS1tb2RlbC1lbnRyeSc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcblxudHlwZSBHYXRld2F5RmV0Y2hNZXRhZGF0YUNvbmZpZyA9IEdhdGV3YXlDb25maWc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2F0ZXdheUZldGNoTWV0YWRhdGFSZXNwb25zZSB7XG4gIG1vZGVsczogR2F0ZXdheUxhbmd1YWdlTW9kZWxFbnRyeVtdO1xufVxuXG5leHBvcnQgY2xhc3MgR2F0ZXdheUZldGNoTWV0YWRhdGEge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGNvbmZpZzogR2F0ZXdheUZldGNoTWV0YWRhdGFDb25maWcpIHt9XG5cbiAgYXN5bmMgZ2V0QXZhaWxhYmxlTW9kZWxzKCk6IFByb21pc2U8R2F0ZXdheUZldGNoTWV0YWRhdGFSZXNwb25zZT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHZhbHVlIH0gPSBhd2FpdCBnZXRGcm9tQXBpKHtcbiAgICAgICAgdXJsOiBgJHt0aGlzLmNvbmZpZy5iYXNlVVJMfS9jb25maWdgLFxuICAgICAgICBoZWFkZXJzOiBhd2FpdCByZXNvbHZlKHRoaXMuY29uZmlnLmhlYWRlcnMoKSksXG4gICAgICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIoXG4gICAgICAgICAgZ2F0ZXdheUZldGNoTWV0YWRhdGFTY2hlbWEsXG4gICAgICAgICksXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyKHtcbiAgICAgICAgICBlcnJvclNjaGVtYTogei5hbnkoKSxcbiAgICAgICAgICBlcnJvclRvTWVzc2FnZTogZGF0YSA9PiBkYXRhLFxuICAgICAgICB9KSxcbiAgICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxufVxuXG5jb25zdCBnYXRld2F5TGFuZ3VhZ2VNb2RlbFNwZWNpZmljYXRpb25TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHNwZWNpZmljYXRpb25WZXJzaW9uOiB6LmxpdGVyYWwoJ3YyJyksXG4gIHByb3ZpZGVyOiB6LnN0cmluZygpLFxuICBtb2RlbElkOiB6LnN0cmluZygpLFxufSk7XG5cbmNvbnN0IGdhdGV3YXlMYW5ndWFnZU1vZGVsUHJpY2luZ1NjaGVtYSA9IHoub2JqZWN0KHtcbiAgaW5wdXQ6IHouc3RyaW5nKCksXG4gIG91dHB1dDogei5zdHJpbmcoKSxcbn0pO1xuXG5jb25zdCBnYXRld2F5TGFuZ3VhZ2VNb2RlbEVudHJ5U2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgZGVzY3JpcHRpb246IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBwcmljaW5nOiBnYXRld2F5TGFuZ3VhZ2VNb2RlbFByaWNpbmdTY2hlbWEubnVsbGlzaCgpLFxuICBzcGVjaWZpY2F0aW9uOiBnYXRld2F5TGFuZ3VhZ2VNb2RlbFNwZWNpZmljYXRpb25TY2hlbWEsXG59KTtcblxuY29uc3QgZ2F0ZXdheUZldGNoTWV0YWRhdGFTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIG1vZGVsczogei5hcnJheShnYXRld2F5TGFuZ3VhZ2VNb2RlbEVudHJ5U2NoZW1hKSxcbn0pO1xuIiwgImltcG9ydCB0eXBlIHtcbiAgTGFuZ3VhZ2VNb2RlbFYyLFxuICBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9ucyxcbiAgTGFuZ3VhZ2VNb2RlbFYyQ2FsbFdhcm5pbmcsXG4gIExhbmd1YWdlTW9kZWxWMkZpbGVQYXJ0LFxuICBMYW5ndWFnZU1vZGVsVjJTdHJlYW1QYXJ0LFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzLFxuICBjcmVhdGVFdmVudFNvdXJjZVJlc3BvbnNlSGFuZGxlcixcbiAgY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyLFxuICBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyLFxuICBwb3N0SnNvblRvQXBpLFxuICByZXNvbHZlLFxuICB0eXBlIFBhcnNlUmVzdWx0LFxuICB0eXBlIFJlc29sdmFibGUsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQgdHlwZSB7IEdhdGV3YXlDb25maWcgfSBmcm9tICcuL2dhdGV3YXktY29uZmlnJztcbmltcG9ydCB0eXBlIHsgR2F0ZXdheU1vZGVsSWQgfSBmcm9tICcuL2dhdGV3YXktbGFuZ3VhZ2UtbW9kZWwtc2V0dGluZ3MnO1xuaW1wb3J0IHsgYXNHYXRld2F5RXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBwYXJzZUF1dGhNZXRob2QgfSBmcm9tICcuL2Vycm9ycy9wYXJzZS1hdXRoLW1ldGhvZCc7XG5cbnR5cGUgR2F0ZXdheUNoYXRDb25maWcgPSBHYXRld2F5Q29uZmlnICYge1xuICBwcm92aWRlcjogc3RyaW5nO1xuICBvMTF5SGVhZGVyczogUmVzb2x2YWJsZTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+Pjtcbn07XG5cbmV4cG9ydCBjbGFzcyBHYXRld2F5TGFuZ3VhZ2VNb2RlbCBpbXBsZW1lbnRzIExhbmd1YWdlTW9kZWxWMiB7XG4gIHJlYWRvbmx5IHNwZWNpZmljYXRpb25WZXJzaW9uID0gJ3YyJztcbiAgcmVhZG9ubHkgc3VwcG9ydGVkVXJscyA9IHsgJyovKic6IFsvLiovXSB9O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHJlYWRvbmx5IG1vZGVsSWQ6IEdhdGV3YXlNb2RlbElkLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgY29uZmlnOiBHYXRld2F5Q2hhdENvbmZpZyxcbiAgKSB7fVxuXG4gIGdldCBwcm92aWRlcigpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZy5wcm92aWRlcjtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0QXJncyhvcHRpb25zOiBQYXJhbWV0ZXJzPExhbmd1YWdlTW9kZWxWMlsnZG9HZW5lcmF0ZSddPlswXSkge1xuICAgIGNvbnN0IHsgYWJvcnRTaWduYWw6IF9hYm9ydFNpZ25hbCwgLi4ub3B0aW9uc1dpdGhvdXRTaWduYWwgfSA9IG9wdGlvbnM7XG5cbiAgICByZXR1cm4ge1xuICAgICAgYXJnczogdGhpcy5tYXliZUVuY29kZUZpbGVQYXJ0cyhvcHRpb25zV2l0aG91dFNpZ25hbCksXG4gICAgICB3YXJuaW5nczogW10sXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGRvR2VuZXJhdGUoXG4gICAgb3B0aW9uczogUGFyYW1ldGVyczxMYW5ndWFnZU1vZGVsVjJbJ2RvR2VuZXJhdGUnXT5bMF0sXG4gICk6IFByb21pc2U8QXdhaXRlZDxSZXR1cm5UeXBlPExhbmd1YWdlTW9kZWxWMlsnZG9HZW5lcmF0ZSddPj4+IHtcbiAgICBjb25zdCB7IGFyZ3MsIHdhcm5pbmdzIH0gPSBhd2FpdCB0aGlzLmdldEFyZ3Mob3B0aW9ucyk7XG4gICAgY29uc3QgeyBhYm9ydFNpZ25hbCB9ID0gb3B0aW9ucztcblxuICAgIGNvbnN0IHJlc29sdmVkSGVhZGVycyA9IGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycygpKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgdmFsdWU6IHJlc3BvbnNlQm9keSxcbiAgICAgICAgcmF3VmFsdWU6IHJhd1Jlc3BvbnNlLFxuICAgICAgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkoe1xuICAgICAgICB1cmw6IHRoaXMuZ2V0VXJsKCksXG4gICAgICAgIGhlYWRlcnM6IGNvbWJpbmVIZWFkZXJzKFxuICAgICAgICAgIHJlc29sdmVkSGVhZGVycyxcbiAgICAgICAgICBvcHRpb25zLmhlYWRlcnMsXG4gICAgICAgICAgdGhpcy5nZXRNb2RlbENvbmZpZ0hlYWRlcnModGhpcy5tb2RlbElkLCBmYWxzZSksXG4gICAgICAgICAgYXdhaXQgcmVzb2x2ZSh0aGlzLmNvbmZpZy5vMTF5SGVhZGVycyksXG4gICAgICAgICksXG4gICAgICAgIGJvZHk6IGFyZ3MsXG4gICAgICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIoei5hbnkoKSksXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyKHtcbiAgICAgICAgICBlcnJvclNjaGVtYTogei5hbnkoKSxcbiAgICAgICAgICBlcnJvclRvTWVzc2FnZTogZGF0YSA9PiBkYXRhLFxuICAgICAgICB9KSxcbiAgICAgICAgLi4uKGFib3J0U2lnbmFsICYmIHsgYWJvcnRTaWduYWwgfSksXG4gICAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5yZXNwb25zZUJvZHksXG4gICAgICAgIHJlcXVlc3Q6IHsgYm9keTogYXJncyB9LFxuICAgICAgICByZXNwb25zZTogeyBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnMsIGJvZHk6IHJhd1Jlc3BvbnNlIH0sXG4gICAgICAgIHdhcm5pbmdzLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IsIHBhcnNlQXV0aE1ldGhvZChyZXNvbHZlZEhlYWRlcnMpKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkb1N0cmVhbShcbiAgICBvcHRpb25zOiBQYXJhbWV0ZXJzPExhbmd1YWdlTW9kZWxWMlsnZG9TdHJlYW0nXT5bMF0sXG4gICk6IFByb21pc2U8QXdhaXRlZDxSZXR1cm5UeXBlPExhbmd1YWdlTW9kZWxWMlsnZG9TdHJlYW0nXT4+PiB7XG4gICAgY29uc3QgeyBhcmdzLCB3YXJuaW5ncyB9ID0gYXdhaXQgdGhpcy5nZXRBcmdzKG9wdGlvbnMpO1xuICAgIGNvbnN0IHsgYWJvcnRTaWduYWwgfSA9IG9wdGlvbnM7XG5cbiAgICBjb25zdCByZXNvbHZlZEhlYWRlcnMgPSBhd2FpdCByZXNvbHZlKHRoaXMuY29uZmlnLmhlYWRlcnMoKSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB2YWx1ZTogcmVzcG9uc2UsIHJlc3BvbnNlSGVhZGVycyB9ID0gYXdhaXQgcG9zdEpzb25Ub0FwaSh7XG4gICAgICAgIHVybDogdGhpcy5nZXRVcmwoKSxcbiAgICAgICAgaGVhZGVyczogY29tYmluZUhlYWRlcnMoXG4gICAgICAgICAgcmVzb2x2ZWRIZWFkZXJzLFxuICAgICAgICAgIG9wdGlvbnMuaGVhZGVycyxcbiAgICAgICAgICB0aGlzLmdldE1vZGVsQ29uZmlnSGVhZGVycyh0aGlzLm1vZGVsSWQsIHRydWUpLFxuICAgICAgICAgIGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcubzExeUhlYWRlcnMpLFxuICAgICAgICApLFxuICAgICAgICBib2R5OiBhcmdzLFxuICAgICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVFdmVudFNvdXJjZVJlc3BvbnNlSGFuZGxlcih6LmFueSgpKSxcbiAgICAgICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uRXJyb3JSZXNwb25zZUhhbmRsZXIoe1xuICAgICAgICAgIGVycm9yU2NoZW1hOiB6LmFueSgpLFxuICAgICAgICAgIGVycm9yVG9NZXNzYWdlOiBkYXRhID0+IGRhdGEsXG4gICAgICAgIH0pLFxuICAgICAgICAuLi4oYWJvcnRTaWduYWwgJiYgeyBhYm9ydFNpZ25hbCB9KSxcbiAgICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0cmVhbTogcmVzcG9uc2UucGlwZVRocm91Z2goXG4gICAgICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxcbiAgICAgICAgICAgIFBhcnNlUmVzdWx0PExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQ+LFxuICAgICAgICAgICAgTGFuZ3VhZ2VNb2RlbFYyU3RyZWFtUGFydFxuICAgICAgICAgID4oe1xuICAgICAgICAgICAgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICBpZiAod2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICdzdHJlYW0tc3RhcnQnLCB3YXJuaW5ncyB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgICBpZiAoY2h1bmsuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbVBhcnQgPSBjaHVuay52YWx1ZTtcblxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSByYXcgY2h1bmtzOiBpZiB0aGlzIGlzIGEgcmF3IGNodW5rIGZyb20gdGhlIGdhdGV3YXkgQVBJLFxuICAgICAgICAgICAgICAgIC8vIG9ubHkgZW1pdCBpdCBpZiBpbmNsdWRlUmF3Q2h1bmtzIGlzIHRydWVcbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtUGFydC50eXBlID09PSAncmF3JyAmJiAhb3B0aW9ucy5pbmNsdWRlUmF3Q2h1bmtzKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47IC8vIFNraXAgcmF3IGNodW5rcyBpZiBub3QgcmVxdWVzdGVkXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgc3RyZWFtUGFydC50eXBlID09PSAncmVzcG9uc2UtbWV0YWRhdGEnICYmXG4gICAgICAgICAgICAgICAgICBzdHJlYW1QYXJ0LnRpbWVzdGFtcCAmJlxuICAgICAgICAgICAgICAgICAgdHlwZW9mIHN0cmVhbVBhcnQudGltZXN0YW1wID09PSAnc3RyaW5nJ1xuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgc3RyZWFtUGFydC50aW1lc3RhbXAgPSBuZXcgRGF0ZShzdHJlYW1QYXJ0LnRpbWVzdGFtcCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHN0cmVhbVBhcnQpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgICAoY2h1bmsgYXMgeyBzdWNjZXNzOiBmYWxzZTsgZXJyb3I6IHVua25vd24gfSkuZXJyb3IsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKSxcbiAgICAgICAgcmVxdWVzdDogeyBib2R5OiBhcmdzIH0sXG4gICAgICAgIHJlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IsIHBhcnNlQXV0aE1ldGhvZChyZXNvbHZlZEhlYWRlcnMpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGlzRmlsZVBhcnQocGFydDogdW5rbm93bikge1xuICAgIHJldHVybiAoXG4gICAgICBwYXJ0ICYmIHR5cGVvZiBwYXJ0ID09PSAnb2JqZWN0JyAmJiAndHlwZScgaW4gcGFydCAmJiBwYXJ0LnR5cGUgPT09ICdmaWxlJ1xuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogRW5jb2RlcyBmaWxlIHBhcnRzIGluIHRoZSBwcm9tcHQgdG8gYmFzZTY0LiBNdXRhdGVzIHRoZSBwYXNzZWQgb3B0aW9uc1xuICAgKiBpbnN0YW5jZSBkaXJlY3RseSB0byBhdm9pZCBjb3B5aW5nIHRoZSBmaWxlIGRhdGEuXG4gICAqIEBwYXJhbSBvcHRpb25zIC0gVGhlIG9wdGlvbnMgdG8gZW5jb2RlLlxuICAgKiBAcmV0dXJucyBUaGUgb3B0aW9ucyB3aXRoIHRoZSBmaWxlIHBhcnRzIGVuY29kZWQuXG4gICAqL1xuICBwcml2YXRlIG1heWJlRW5jb2RlRmlsZVBhcnRzKG9wdGlvbnM6IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zKSB7XG4gICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIG9wdGlvbnMucHJvbXB0KSB7XG4gICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgbWVzc2FnZS5jb250ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzRmlsZVBhcnQocGFydCkpIHtcbiAgICAgICAgICBjb25zdCBmaWxlUGFydCA9IHBhcnQgYXMgTGFuZ3VhZ2VNb2RlbFYyRmlsZVBhcnQ7XG4gICAgICAgICAgLy8gSWYgdGhlIGZpbGUgcGFydCBpcyBhIFVSTCBpdCB3aWxsIGdldCBjbGVhbmx5IGNvbnZlcnRlZCB0byBhIHN0cmluZy5cbiAgICAgICAgICAvLyBJZiBpdCdzIGEgYmluYXJ5IGZpbGUgYXR0YWNobWVudCB3ZSBjb252ZXJ0IGl0IHRvIGEgZGF0YSB1cmwuXG4gICAgICAgICAgLy8gSW4gZWl0aGVyIGNhc2UsIHNlcnZlci1zaWRlIHdlIHNob3VsZCBvbmx5IGV2ZXIgc2VlIFVSTHMgYXMgc3RyaW5ncy5cbiAgICAgICAgICBpZiAoZmlsZVBhcnQuZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IFVpbnQ4QXJyYXkuZnJvbShmaWxlUGFydC5kYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBCdWZmZXIuZnJvbShidWZmZXIpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgICAgICAgICAgIGZpbGVQYXJ0LmRhdGEgPSBuZXcgVVJMKFxuICAgICAgICAgICAgICBgZGF0YToke2ZpbGVQYXJ0Lm1lZGlhVHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ307YmFzZTY0LCR7YmFzZTY0RGF0YX1gLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGdldFVybCgpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5jb25maWcuYmFzZVVSTH0vbGFuZ3VhZ2UtbW9kZWxgO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRNb2RlbENvbmZpZ0hlYWRlcnMobW9kZWxJZDogc3RyaW5nLCBzdHJlYW1pbmc6IGJvb2xlYW4pIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ2FpLWxhbmd1YWdlLW1vZGVsLXNwZWNpZmljYXRpb24tdmVyc2lvbic6ICcyJyxcbiAgICAgICdhaS1sYW5ndWFnZS1tb2RlbC1pZCc6IG1vZGVsSWQsXG4gICAgICAnYWktbGFuZ3VhZ2UtbW9kZWwtc3RyZWFtaW5nJzogU3RyaW5nKHN0cmVhbWluZyksXG4gICAgfTtcbiAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgRW1iZWRkaW5nTW9kZWxWMiB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgY29tYmluZUhlYWRlcnMsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIsXG4gIGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcixcbiAgcG9zdEpzb25Ub0FwaSxcbiAgcmVzb2x2ZSxcbiAgdHlwZSBSZXNvbHZhYmxlLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHR5cGUgeyBHYXRld2F5Q29uZmlnIH0gZnJvbSAnLi9nYXRld2F5LWNvbmZpZyc7XG5pbXBvcnQgeyBhc0dhdGV3YXlFcnJvciB9IGZyb20gJy4vZXJyb3JzJztcbmltcG9ydCB7IHBhcnNlQXV0aE1ldGhvZCB9IGZyb20gJy4vZXJyb3JzL3BhcnNlLWF1dGgtbWV0aG9kJztcbmltcG9ydCB0eXBlIHsgU2hhcmVkVjJQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmV4cG9ydCBjbGFzcyBHYXRld2F5RW1iZWRkaW5nTW9kZWwgaW1wbGVtZW50cyBFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz4ge1xuICByZWFkb25seSBzcGVjaWZpY2F0aW9uVmVyc2lvbiA9ICd2Mic7XG4gIHJlYWRvbmx5IG1heEVtYmVkZGluZ3NQZXJDYWxsID0gMjA0ODtcbiAgcmVhZG9ubHkgc3VwcG9ydHNQYXJhbGxlbENhbGxzID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICByZWFkb25seSBtb2RlbElkOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSByZWFkb25seSBjb25maWc6IEdhdGV3YXlDb25maWcgJiB7XG4gICAgICBwcm92aWRlcjogc3RyaW5nO1xuICAgICAgbzExeUhlYWRlcnM6IFJlc29sdmFibGU8UmVjb3JkPHN0cmluZywgc3RyaW5nPj47XG4gICAgfSxcbiAgKSB7fVxuXG4gIGdldCBwcm92aWRlcigpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZy5wcm92aWRlcjtcbiAgfVxuXG4gIGFzeW5jIGRvRW1iZWQoe1xuICAgIHZhbHVlcyxcbiAgICBoZWFkZXJzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgfTogUGFyYW1ldGVyczxFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz5bJ2RvRW1iZWQnXT5bMF0pOiBQcm9taXNlPFxuICAgIEF3YWl0ZWQ8UmV0dXJuVHlwZTxFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz5bJ2RvRW1iZWQnXT4+XG4gID4ge1xuICAgIGNvbnN0IHJlc29sdmVkSGVhZGVycyA9IGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycygpKTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qge1xuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHZhbHVlOiByZXNwb25zZUJvZHksXG4gICAgICAgIHJhd1ZhbHVlLFxuICAgICAgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkoe1xuICAgICAgICB1cmw6IHRoaXMuZ2V0VXJsKCksXG4gICAgICAgIGhlYWRlcnM6IGNvbWJpbmVIZWFkZXJzKFxuICAgICAgICAgIHJlc29sdmVkSGVhZGVycyxcbiAgICAgICAgICBoZWFkZXJzID8/IHt9LFxuICAgICAgICAgIHRoaXMuZ2V0TW9kZWxDb25maWdIZWFkZXJzKCksXG4gICAgICAgICAgYXdhaXQgcmVzb2x2ZSh0aGlzLmNvbmZpZy5vMTF5SGVhZGVycyksXG4gICAgICAgICksXG4gICAgICAgIGJvZHk6IHtcbiAgICAgICAgICBpbnB1dDogdmFsdWVzLmxlbmd0aCA9PT0gMSA/IHZhbHVlc1swXSA6IHZhbHVlcyxcbiAgICAgICAgICAuLi4ocHJvdmlkZXJPcHRpb25zID8/IHt9KSxcbiAgICAgICAgfSxcbiAgICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcihcbiAgICAgICAgICBnYXRld2F5RW1iZWRkaW5nUmVzcG9uc2VTY2hlbWEsXG4gICAgICAgICksXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyKHtcbiAgICAgICAgICBlcnJvclNjaGVtYTogei5hbnkoKSxcbiAgICAgICAgICBlcnJvclRvTWVzc2FnZTogZGF0YSA9PiBkYXRhLFxuICAgICAgICB9KSxcbiAgICAgICAgLi4uKGFib3J0U2lnbmFsICYmIHsgYWJvcnRTaWduYWwgfSksXG4gICAgICAgIGZldGNoOiB0aGlzLmNvbmZpZy5mZXRjaCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbWJlZGRpbmdzOiByZXNwb25zZUJvZHkuZW1iZWRkaW5ncyxcbiAgICAgICAgdXNhZ2U6IHJlc3BvbnNlQm9keS51c2FnZSA/PyB1bmRlZmluZWQsXG4gICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6XG4gICAgICAgICAgcmVzcG9uc2VCb2R5LnByb3ZpZGVyTWV0YWRhdGEgYXMgdW5rbm93biBhcyBTaGFyZWRWMlByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgIHJlc3BvbnNlOiB7IGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycywgYm9keTogcmF3VmFsdWUgfSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGFzR2F0ZXdheUVycm9yKGVycm9yLCBwYXJzZUF1dGhNZXRob2QocmVzb2x2ZWRIZWFkZXJzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRVcmwoKSB7XG4gICAgcmV0dXJuIGAke3RoaXMuY29uZmlnLmJhc2VVUkx9L2VtYmVkZGluZy1tb2RlbGA7XG4gIH1cblxuICBwcml2YXRlIGdldE1vZGVsQ29uZmlnSGVhZGVycygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ2FpLWVtYmVkZGluZy1tb2RlbC1zcGVjaWZpY2F0aW9uLXZlcnNpb24nOiAnMicsXG4gICAgICAnYWktbW9kZWwtaWQnOiB0aGlzLm1vZGVsSWQsXG4gICAgfTtcbiAgfVxufVxuXG5jb25zdCBnYXRld2F5RW1iZWRkaW5nUmVzcG9uc2VTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGVtYmVkZGluZ3M6IHouYXJyYXkoei5hcnJheSh6Lm51bWJlcigpKSksXG4gIHVzYWdlOiB6Lm9iamVjdCh7IHRva2Vuczogei5udW1iZXIoKSB9KS5udWxsaXNoKCksXG4gIHByb3ZpZGVyTWV0YWRhdGE6IHpcbiAgICAucmVjb3JkKHouc3RyaW5nKCksIHoucmVjb3JkKHouc3RyaW5nKCksIHoudW5rbm93bigpKSlcbiAgICAub3B0aW9uYWwoKSxcbn0pO1xuIiwgImltcG9ydCB7IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yIH0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VmVyY2VsT2lkY1Rva2VuKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHRva2VuID1cbiAgICBnZXRDb250ZXh0KCkuaGVhZGVycz8uWyd4LXZlcmNlbC1vaWRjLXRva2VuJ10gPz9cbiAgICBwcm9jZXNzLmVudi5WRVJDRUxfT0lEQ19UT0tFTjtcblxuICBpZiAoIXRva2VuKSB7XG4gICAgdGhyb3cgbmV3IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yKHtcbiAgICAgIG1lc3NhZ2U6ICdPSURDIHRva2VuIG5vdCBhdmFpbGFibGUnLFxuICAgICAgc3RhdHVzQ29kZTogNDAxLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHRva2VuO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VmVyY2VsUmVxdWVzdElkKCk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPiB7XG4gIHJldHVybiBnZXRDb250ZXh0KCkuaGVhZGVycz8uWyd4LXZlcmNlbC1pZCddO1xufVxuXG50eXBlIENvbnRleHQgPSB7XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufTtcblxuY29uc3QgU1lNQk9MX0ZPUl9SRVFfQ09OVEVYVCA9IFN5bWJvbC5mb3IoJ0B2ZXJjZWwvcmVxdWVzdC1jb250ZXh0Jyk7XG5cbmZ1bmN0aW9uIGdldENvbnRleHQoKTogQ29udGV4dCB7XG4gIGNvbnN0IGZyb21TeW1ib2w6IHR5cGVvZiBnbG9iYWxUaGlzICYge1xuICAgIFtTWU1CT0xfRk9SX1JFUV9DT05URVhUXT86IHsgZ2V0PzogKCkgPT4gQ29udGV4dCB9O1xuICB9ID0gZ2xvYmFsVGhpcztcbiAgcmV0dXJuIGZyb21TeW1ib2xbU1lNQk9MX0ZPUl9SRVFfQ09OVEVYVF0/LmdldD8uKCkgPz8ge307XG59XG4iLCAiLyoqXG4gKiBTeW1ib2wgdXNlZCBmb3IgaWRlbnRpZnlpbmcgQUkgU0RLIEVycm9yIGluc3RhbmNlcy5cbiAqIEVuYWJsZXMgY2hlY2tpbmcgaWYgYW4gZXJyb3IgaXMgYW4gaW5zdGFuY2Ugb2YgQUlTREtFcnJvciBhY3Jvc3MgcGFja2FnZSB2ZXJzaW9ucy5cbiAqL1xuY29uc3QgbWFya2VyID0gJ3ZlcmNlbC5haS5lcnJvcic7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogQ3VzdG9tIGVycm9yIGNsYXNzIGZvciBBSSBTREsgcmVsYXRlZCBlcnJvcnMuXG4gKiBAZXh0ZW5kcyBFcnJvclxuICovXG5leHBvcnQgY2xhc3MgQUlTREtFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIC8qKlxuICAgKiBUaGUgdW5kZXJseWluZyBjYXVzZSBvZiB0aGUgZXJyb3IsIGlmIGFueS5cbiAgICovXG4gIHJlYWRvbmx5IGNhdXNlPzogdW5rbm93bjtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBBSSBTREsgRXJyb3IuXG4gICAqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgLSBUaGUgcGFyYW1ldGVycyBmb3IgY3JlYXRpbmcgdGhlIGVycm9yLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zLm5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgZXJyb3IuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwYXJhbXMubWVzc2FnZSAtIFRoZSBlcnJvciBtZXNzYWdlLlxuICAgKiBAcGFyYW0ge3Vua25vd259IFtwYXJhbXMuY2F1c2VdIC0gVGhlIHVuZGVybHlpbmcgY2F1c2Ugb2YgdGhlIGVycm9yLlxuICAgKi9cbiAgY29uc3RydWN0b3Ioe1xuICAgIG5hbWUsXG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVycm9yIGlzIGFuIEFJIFNESyBFcnJvci5cbiAgICogQHBhcmFtIHt1bmtub3dufSBlcnJvciAtIFRoZSBlcnJvciB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVycm9yIGlzIGFuIEFJIFNESyBFcnJvciwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBBSVNES0Vycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cblxuICBwcm90ZWN0ZWQgc3RhdGljIGhhc01hcmtlcihlcnJvcjogdW5rbm93biwgbWFya2VyOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBtYXJrZXJTeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG4gICAgcmV0dXJuIChcbiAgICAgIGVycm9yICE9IG51bGwgJiZcbiAgICAgIHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiZcbiAgICAgIG1hcmtlclN5bWJvbCBpbiBlcnJvciAmJlxuICAgICAgdHlwZW9mIGVycm9yW21hcmtlclN5bWJvbF0gPT09ICdib29sZWFuJyAmJlxuICAgICAgZXJyb3JbbWFya2VyU3ltYm9sXSA9PT0gdHJ1ZVxuICAgICk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0FJX0FQSUNhbGxFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgQVBJQ2FsbEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSB1cmw6IHN0cmluZztcbiAgcmVhZG9ubHkgcmVxdWVzdEJvZHlWYWx1ZXM6IHVua25vd247XG4gIHJlYWRvbmx5IHN0YXR1c0NvZGU/OiBudW1iZXI7XG5cbiAgcmVhZG9ubHkgcmVzcG9uc2VIZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgcmVhZG9ubHkgcmVzcG9uc2VCb2R5Pzogc3RyaW5nO1xuXG4gIHJlYWRvbmx5IGlzUmV0cnlhYmxlOiBib29sZWFuO1xuICByZWFkb25seSBkYXRhPzogdW5rbm93bjtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSxcbiAgICB1cmwsXG4gICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgc3RhdHVzQ29kZSxcbiAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgcmVzcG9uc2VCb2R5LFxuICAgIGNhdXNlLFxuICAgIGlzUmV0cnlhYmxlID0gc3RhdHVzQ29kZSAhPSBudWxsICYmXG4gICAgICAoc3RhdHVzQ29kZSA9PT0gNDA4IHx8IC8vIHJlcXVlc3QgdGltZW91dFxuICAgICAgICBzdGF0dXNDb2RlID09PSA0MDkgfHwgLy8gY29uZmxpY3RcbiAgICAgICAgc3RhdHVzQ29kZSA9PT0gNDI5IHx8IC8vIHRvbyBtYW55IHJlcXVlc3RzXG4gICAgICAgIHN0YXR1c0NvZGUgPj0gNTAwKSwgLy8gc2VydmVyIGVycm9yXG4gICAgZGF0YSxcbiAgfToge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgICByZXF1ZXN0Qm9keVZhbHVlczogdW5rbm93bjtcbiAgICBzdGF0dXNDb2RlPzogbnVtYmVyO1xuICAgIHJlc3BvbnNlSGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgcmVzcG9uc2VCb2R5Pzogc3RyaW5nO1xuICAgIGNhdXNlPzogdW5rbm93bjtcbiAgICBpc1JldHJ5YWJsZT86IGJvb2xlYW47XG4gICAgZGF0YT86IHVua25vd247XG4gIH0pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UsIGNhdXNlIH0pO1xuXG4gICAgdGhpcy51cmwgPSB1cmw7XG4gICAgdGhpcy5yZXF1ZXN0Qm9keVZhbHVlcyA9IHJlcXVlc3RCb2R5VmFsdWVzO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgdGhpcy5yZXNwb25zZUhlYWRlcnMgPSByZXNwb25zZUhlYWRlcnM7XG4gICAgdGhpcy5yZXNwb25zZUJvZHkgPSByZXNwb25zZUJvZHk7XG4gICAgdGhpcy5pc1JldHJ5YWJsZSA9IGlzUmV0cnlhYmxlO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEFQSUNhbGxFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9FbXB0eVJlc3BvbnNlQm9keUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBFbXB0eVJlc3BvbnNlQm9keUVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgPSAnRW1wdHkgcmVzcG9uc2UgYm9keScgfTogeyBtZXNzYWdlPzogc3RyaW5nIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgRW1wdHlSZXNwb25zZUJvZHlFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZShlcnJvcjogdW5rbm93biB8IHVuZGVmaW5lZCkge1xuICBpZiAoZXJyb3IgPT0gbnVsbCkge1xuICAgIHJldHVybiAndW5rbm93biBlcnJvcic7XG4gIH1cblxuICBpZiAodHlwZW9mIGVycm9yID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBlcnJvcjtcbiAgfVxuXG4gIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgcmV0dXJuIGVycm9yLm1lc3NhZ2U7XG4gIH1cblxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZXJyb3IpO1xufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZEFyZ3VtZW50RXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIGFyZ3VtZW50IGlzIGludmFsaWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnZhbGlkQXJndW1lbnRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgYXJndW1lbnQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgICBhcmd1bWVudCxcbiAgfToge1xuICAgIGFyZ3VtZW50OiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIGNhdXNlPzogdW5rbm93bjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLmFyZ3VtZW50ID0gYXJndW1lbnQ7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEludmFsaWRBcmd1bWVudEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuXG5jb25zdCBuYW1lID0gJ0FJX0ludmFsaWRQcm9tcHRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG4vKipcbiAqIEEgcHJvbXB0IGlzIGludmFsaWQuIFRoaXMgZXJyb3Igc2hvdWxkIGJlIHRocm93biBieSBwcm92aWRlcnMgd2hlbiB0aGV5IGNhbm5vdFxuICogcHJvY2VzcyBhIHByb21wdC5cbiAqL1xuZXhwb3J0IGNsYXNzIEludmFsaWRQcm9tcHRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcHJvbXB0OiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBwcm9tcHQsXG4gICAgbWVzc2FnZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIHByb21wdDogdW5rbm93bjtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlOiBgSW52YWxpZCBwcm9tcHQ6ICR7bWVzc2FnZX1gLCBjYXVzZSB9KTtcblxuICAgIHRoaXMucHJvbXB0ID0gcHJvbXB0O1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBJbnZhbGlkUHJvbXB0RXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogU2VydmVyIHJldHVybmVkIGEgcmVzcG9uc2Ugd2l0aCBpbnZhbGlkIGRhdGEgY29udGVudC5cbiAqIFRoaXMgc2hvdWxkIGJlIHRocm93biBieSBwcm92aWRlcnMgd2hlbiB0aGV5IGNhbm5vdCBwYXJzZSB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgQVBJLlxuICovXG5leHBvcnQgY2xhc3MgSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBkYXRhOiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBkYXRhLFxuICAgIG1lc3NhZ2UgPSBgSW52YWxpZCByZXNwb25zZSBkYXRhOiAke0pTT04uc3RyaW5naWZ5KGRhdGEpfS5gLFxuICB9OiB7XG4gICAgZGF0YTogdW5rbm93bjtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuXG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgSW52YWxpZFJlc3BvbnNlRGF0YUVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuaW1wb3J0IHsgZ2V0RXJyb3JNZXNzYWdlIH0gZnJvbSAnLi9nZXQtZXJyb3ItbWVzc2FnZSc7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSlNPTlBhcnNlRXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLy8gVE9ETyB2NTogcmVuYW1lIHRvIFBhcnNlRXJyb3JcbmV4cG9ydCBjbGFzcyBKU09OUGFyc2VFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdGV4dDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHsgdGV4dCwgY2F1c2UgfTogeyB0ZXh0OiBzdHJpbmc7IGNhdXNlOiB1bmtub3duIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lLFxuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYEpTT04gcGFyc2luZyBmYWlsZWQ6IGAgK1xuICAgICAgICBgVGV4dDogJHt0ZXh0fS5cXG5gICtcbiAgICAgICAgYEVycm9yIG1lc3NhZ2U6ICR7Z2V0RXJyb3JNZXNzYWdlKGNhdXNlKX1gLFxuICAgICAgY2F1c2UsXG4gICAgfSk7XG5cbiAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBKU09OUGFyc2VFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Mb2FkQVBJS2V5RXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGNsYXNzIExvYWRBUElLZXlFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgY29uc3RydWN0b3IoeyBtZXNzYWdlIH06IHsgbWVzc2FnZTogc3RyaW5nIH0pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UgfSk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIExvYWRBUElLZXlFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Mb2FkU2V0dGluZ0Vycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBMb2FkU2V0dGluZ0Vycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgfTogeyBtZXNzYWdlOiBzdHJpbmcgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgTG9hZFNldHRpbmdFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob0NvbnRlbnRHZW5lcmF0ZWRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG4vKipcblRocm93biB3aGVuIHRoZSBBSSBwcm92aWRlciBmYWlscyB0byBnZW5lcmF0ZSBhbnkgY29udGVudC5cbiAqL1xuZXhwb3J0IGNsYXNzIE5vQ29udGVudEdlbmVyYXRlZEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdObyBjb250ZW50IGdlbmVyYXRlZC4nLFxuICB9OiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSA9IHt9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBOb0NvbnRlbnRHZW5lcmF0ZWRFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob1N1Y2hNb2RlbEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBOb1N1Y2hNb2RlbEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBtb2RlbElkOiBzdHJpbmc7XG4gIHJlYWRvbmx5IG1vZGVsVHlwZTpcbiAgICB8ICdsYW5ndWFnZU1vZGVsJ1xuICAgIHwgJ3RleHRFbWJlZGRpbmdNb2RlbCdcbiAgICB8ICdpbWFnZU1vZGVsJ1xuICAgIHwgJ3RyYW5zY3JpcHRpb25Nb2RlbCdcbiAgICB8ICdzcGVlY2hNb2RlbCc7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIGVycm9yTmFtZSA9IG5hbWUsXG4gICAgbW9kZWxJZCxcbiAgICBtb2RlbFR5cGUsXG4gICAgbWVzc2FnZSA9IGBObyBzdWNoICR7bW9kZWxUeXBlfTogJHttb2RlbElkfWAsXG4gIH06IHtcbiAgICBlcnJvck5hbWU/OiBzdHJpbmc7XG4gICAgbW9kZWxJZDogc3RyaW5nO1xuICAgIG1vZGVsVHlwZTpcbiAgICAgIHwgJ2xhbmd1YWdlTW9kZWwnXG4gICAgICB8ICd0ZXh0RW1iZWRkaW5nTW9kZWwnXG4gICAgICB8ICdpbWFnZU1vZGVsJ1xuICAgICAgfCAndHJhbnNjcmlwdGlvbk1vZGVsJ1xuICAgICAgfCAnc3BlZWNoTW9kZWwnO1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gIH0pIHtcbiAgICBzdXBlcih7IG5hbWU6IGVycm9yTmFtZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5tb2RlbFR5cGUgPSBtb2RlbFR5cGU7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vU3VjaE1vZGVsRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICcuL2FpLXNkay1lcnJvcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVG9vTWFueUVtYmVkZGluZ1ZhbHVlc0ZvckNhbGxFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcHJvdmlkZXI6IHN0cmluZztcbiAgcmVhZG9ubHkgbW9kZWxJZDogc3RyaW5nO1xuICByZWFkb25seSBtYXhFbWJlZGRpbmdzUGVyQ2FsbDogbnVtYmVyO1xuICByZWFkb25seSB2YWx1ZXM6IEFycmF5PHVua25vd24+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHtcbiAgICBwcm92aWRlcjogc3RyaW5nO1xuICAgIG1vZGVsSWQ6IHN0cmluZztcbiAgICBtYXhFbWJlZGRpbmdzUGVyQ2FsbDogbnVtYmVyO1xuICAgIHZhbHVlczogQXJyYXk8dW5rbm93bj47XG4gIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lLFxuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYFRvbyBtYW55IHZhbHVlcyBmb3IgYSBzaW5nbGUgZW1iZWRkaW5nIGNhbGwuIGAgK1xuICAgICAgICBgVGhlICR7b3B0aW9ucy5wcm92aWRlcn0gbW9kZWwgXCIke29wdGlvbnMubW9kZWxJZH1cIiBjYW4gb25seSBlbWJlZCB1cCB0byBgICtcbiAgICAgICAgYCR7b3B0aW9ucy5tYXhFbWJlZGRpbmdzUGVyQ2FsbH0gdmFsdWVzIHBlciBjYWxsLCBidXQgJHtvcHRpb25zLnZhbHVlcy5sZW5ndGh9IHZhbHVlcyB3ZXJlIHByb3ZpZGVkLmAsXG4gICAgfSk7XG5cbiAgICB0aGlzLnByb3ZpZGVyID0gb3B0aW9ucy5wcm92aWRlcjtcbiAgICB0aGlzLm1vZGVsSWQgPSBvcHRpb25zLm1vZGVsSWQ7XG4gICAgdGhpcy5tYXhFbWJlZGRpbmdzUGVyQ2FsbCA9IG9wdGlvbnMubWF4RW1iZWRkaW5nc1BlckNhbGw7XG4gICAgdGhpcy52YWx1ZXMgPSBvcHRpb25zLnZhbHVlcztcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKFxuICAgIGVycm9yOiB1bmtub3duLFxuICApOiBlcnJvciBpcyBUb29NYW55RW1iZWRkaW5nVmFsdWVzRm9yQ2FsbEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnLi9haS1zZGstZXJyb3InO1xuaW1wb3J0IHsgZ2V0RXJyb3JNZXNzYWdlIH0gZnJvbSAnLi9nZXQtZXJyb3ItbWVzc2FnZSc7XG5cbmNvbnN0IG5hbWUgPSAnQUlfVHlwZVZhbGlkYXRpb25FcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVHlwZVZhbGlkYXRpb25FcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdmFsdWU6IHVua25vd247XG5cbiAgY29uc3RydWN0b3IoeyB2YWx1ZSwgY2F1c2UgfTogeyB2YWx1ZTogdW5rbm93bjsgY2F1c2U6IHVua25vd24gfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG5hbWUsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICBgVHlwZSB2YWxpZGF0aW9uIGZhaWxlZDogYCArXG4gICAgICAgIGBWYWx1ZTogJHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9LlxcbmAgK1xuICAgICAgICBgRXJyb3IgbWVzc2FnZTogJHtnZXRFcnJvck1lc3NhZ2UoY2F1c2UpfWAsXG4gICAgICBjYXVzZSxcbiAgICB9KTtcblxuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgVHlwZVZhbGlkYXRpb25FcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdyYXBzIGFuIGVycm9yIGludG8gYSBUeXBlVmFsaWRhdGlvbkVycm9yLlxuICAgKiBJZiB0aGUgY2F1c2UgaXMgYWxyZWFkeSBhIFR5cGVWYWxpZGF0aW9uRXJyb3Igd2l0aCB0aGUgc2FtZSB2YWx1ZSwgaXQgcmV0dXJucyB0aGUgY2F1c2UuXG4gICAqIE90aGVyd2lzZSwgaXQgY3JlYXRlcyBhIG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yLlxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gVGhlIHBhcmFtZXRlcnMgZm9yIHdyYXBwaW5nIHRoZSBlcnJvci5cbiAgICogQHBhcmFtIHt1bmtub3dufSBwYXJhbXMudmFsdWUgLSBUaGUgdmFsdWUgdGhhdCBmYWlsZWQgdmFsaWRhdGlvbi5cbiAgICogQHBhcmFtIHt1bmtub3dufSBwYXJhbXMuY2F1c2UgLSBUaGUgb3JpZ2luYWwgZXJyb3Igb3IgY2F1c2Ugb2YgdGhlIHZhbGlkYXRpb24gZmFpbHVyZS5cbiAgICogQHJldHVybnMge1R5cGVWYWxpZGF0aW9uRXJyb3J9IEEgVHlwZVZhbGlkYXRpb25FcnJvciBpbnN0YW5jZS5cbiAgICovXG4gIHN0YXRpYyB3cmFwKHtcbiAgICB2YWx1ZSxcbiAgICBjYXVzZSxcbiAgfToge1xuICAgIHZhbHVlOiB1bmtub3duO1xuICAgIGNhdXNlOiB1bmtub3duO1xuICB9KTogVHlwZVZhbGlkYXRpb25FcnJvciB7XG4gICAgcmV0dXJuIFR5cGVWYWxpZGF0aW9uRXJyb3IuaXNJbnN0YW5jZShjYXVzZSkgJiYgY2F1c2UudmFsdWUgPT09IHZhbHVlXG4gICAgICA/IGNhdXNlXG4gICAgICA6IG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yKHsgdmFsdWUsIGNhdXNlIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJy4vYWktc2RrLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9VbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgVW5zdXBwb3J0ZWRGdW5jdGlvbmFsaXR5RXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIHJlYWRvbmx5IGZ1bmN0aW9uYWxpdHk6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgZnVuY3Rpb25hbGl0eSxcbiAgICBtZXNzYWdlID0gYCcke2Z1bmN0aW9uYWxpdHl9JyBmdW5jdGlvbmFsaXR5IG5vdCBzdXBwb3J0ZWQuYCxcbiAgfToge1xuICAgIGZ1bmN0aW9uYWxpdHk6IHN0cmluZztcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuICAgIHRoaXMuZnVuY3Rpb25hbGl0eSA9IGZ1bmN0aW9uYWxpdHk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBKU09OQXJyYXksIEpTT05PYmplY3QsIEpTT05WYWx1ZSB9IGZyb20gJy4vanNvbi12YWx1ZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0pTT05WYWx1ZSh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEpTT05WYWx1ZSB7XG4gIGlmIChcbiAgICB2YWx1ZSA9PT0gbnVsbCB8fFxuICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHxcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8XG4gICAgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbidcbiAgKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWUuZXZlcnkoaXNKU09OVmFsdWUpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXModmFsdWUpLmV2ZXJ5KFxuICAgICAgKFtrZXksIHZhbF0pID0+IHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGlzSlNPTlZhbHVlKHZhbCksXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSlNPTkFycmF5KHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgSlNPTkFycmF5IHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmV2ZXJ5KGlzSlNPTlZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSlNPTk9iamVjdCh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEpTT05PYmplY3Qge1xuICByZXR1cm4gKFxuICAgIHZhbHVlICE9IG51bGwgJiZcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgT2JqZWN0LmVudHJpZXModmFsdWUpLmV2ZXJ5KFxuICAgICAgKFtrZXksIHZhbF0pID0+IHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGlzSlNPTlZhbHVlKHZhbCksXG4gICAgKVxuICApO1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBjb21iaW5lSGVhZGVycyhcbiAgLi4uaGVhZGVyczogQXJyYXk8UmVjb3JkPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPiB8IHVuZGVmaW5lZD5cbik6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD4ge1xuICByZXR1cm4gaGVhZGVycy5yZWR1Y2UoXG4gICAgKGNvbWJpbmVkSGVhZGVycywgY3VycmVudEhlYWRlcnMpID0+ICh7XG4gICAgICAuLi5jb21iaW5lZEhlYWRlcnMsXG4gICAgICAuLi4oY3VycmVudEhlYWRlcnMgPz8ge30pLFxuICAgIH0pLFxuICAgIHt9LFxuICApIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG59XG4iLCAiLyoqXG4gKiBDb252ZXJ0cyBhbiBBc3luY0l0ZXJhdG9yIHRvIGEgUmVhZGFibGVTdHJlYW0uXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiBlbGVtZW50cyBwcm9kdWNlZCBieSB0aGUgQXN5bmNJdGVyYXRvci5cbiAqIEBwYXJhbSB7IDxUPn0gaXRlcmF0b3IgLSBUaGUgQXN5bmNJdGVyYXRvciB0byBjb252ZXJ0LlxuICogQHJldHVybnMge1JlYWRhYmxlU3RyZWFtPFQ+fSAtIEEgUmVhZGFibGVTdHJlYW0gdGhhdCBwcm92aWRlcyB0aGUgc2FtZSBkYXRhIGFzIHRoZSBBc3luY0l0ZXJhdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29udmVydEFzeW5jSXRlcmF0b3JUb1JlYWRhYmxlU3RyZWFtPFQ+KFxuICBpdGVyYXRvcjogQXN5bmNJdGVyYXRvcjxUPixcbik6IFJlYWRhYmxlU3RyZWFtPFQ+IHtcbiAgcmV0dXJuIG5ldyBSZWFkYWJsZVN0cmVhbTxUPih7XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIGNvbnN1bWVyIHdhbnRzIHRvIHB1bGwgbW9yZSBkYXRhIGZyb20gdGhlIHN0cmVhbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcjxUPn0gY29udHJvbGxlciAtIFRoZSBjb250cm9sbGVyIHRvIGVucXVldWUgZGF0YSBpbnRvIHRoZSBzdHJlYW0uXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gICAgICovXG4gICAgYXN5bmMgcHVsbChjb250cm9sbGVyKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSBhd2FpdCBpdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gdGhlIGNvbnN1bWVyIGNhbmNlbHMgdGhlIHN0cmVhbS5cbiAgICAgKi9cbiAgICBjYW5jZWwoKSB7fSxcbiAgfSk7XG59XG4iLCAiLyoqXG4gKiBDcmVhdGVzIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGEgc3BlY2lmaWVkIGRlbGF5XG4gKiBAcGFyYW0gZGVsYXlJbk1zIC0gVGhlIGRlbGF5IGR1cmF0aW9uIGluIG1pbGxpc2Vjb25kcy4gSWYgbnVsbCBvciB1bmRlZmluZWQsIHJlc29sdmVzIGltbWVkaWF0ZWx5LlxuICogQHBhcmFtIHNpZ25hbCAtIE9wdGlvbmFsIEFib3J0U2lnbmFsIHRvIGNhbmNlbCB0aGUgZGVsYXlcbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIHRoZSBzcGVjaWZpZWQgZGVsYXlcbiAqIEB0aHJvd3Mge0RPTUV4Y2VwdGlvbn0gV2hlbiB0aGUgc2lnbmFsIGlzIGFib3J0ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGF5KFxuICBkZWxheUluTXM/OiBudW1iZXIgfCBudWxsLFxuICBvcHRpb25zPzoge1xuICAgIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWw7XG4gIH0sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKGRlbGF5SW5NcyA9PSBudWxsKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG5cbiAgY29uc3Qgc2lnbmFsID0gb3B0aW9ucz8uYWJvcnRTaWduYWw7XG5cbiAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpZiAoc2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICByZWplY3QoY3JlYXRlQWJvcnRFcnJvcigpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNsZWFudXAoKTtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9LCBkZWxheUluTXMpO1xuXG4gICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgc2lnbmFsPy5yZW1vdmVFdmVudExpc3RlbmVyKCdhYm9ydCcsIG9uQWJvcnQpO1xuICAgIH07XG5cbiAgICBjb25zdCBvbkFib3J0ID0gKCkgPT4ge1xuICAgICAgY2xlYW51cCgpO1xuICAgICAgcmVqZWN0KGNyZWF0ZUFib3J0RXJyb3IoKSk7XG4gICAgfTtcblxuICAgIHNpZ25hbD8uYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBvbkFib3J0KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUFib3J0RXJyb3IoKTogRE9NRXhjZXB0aW9uIHtcbiAgcmV0dXJuIG5ldyBET01FeGNlcHRpb24oJ0RlbGF5IHdhcyBhYm9ydGVkJywgJ0Fib3J0RXJyb3InKTtcbn1cbiIsICIvKipcbkV4dHJhY3RzIHRoZSBoZWFkZXJzIGZyb20gYSByZXNwb25zZSBvYmplY3QgYW5kIHJldHVybnMgdGhlbSBhcyBhIGtleS12YWx1ZSBvYmplY3QuXG5cbkBwYXJhbSByZXNwb25zZSAtIFRoZSByZXNwb25zZSBvYmplY3QgdG8gZXh0cmFjdCBoZWFkZXJzIGZyb20uXG5AcmV0dXJucyBUaGUgaGVhZGVycyBhcyBhIGtleS12YWx1ZSBvYmplY3QuXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2U6IFJlc3BvbnNlKSB7XG4gIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXM8c3RyaW5nPihbLi4ucmVzcG9uc2UuaGVhZGVyc10pO1xufVxuIiwgImltcG9ydCB7IEludmFsaWRBcmd1bWVudEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbi8qKlxuQ3JlYXRlcyBhbiBJRCBnZW5lcmF0b3IuXG5UaGUgdG90YWwgbGVuZ3RoIG9mIHRoZSBJRCBpcyB0aGUgc3VtIG9mIHRoZSBwcmVmaXgsIHNlcGFyYXRvciwgYW5kIHJhbmRvbSBwYXJ0IGxlbmd0aC5cbk5vdCBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUuXG5cbkBwYXJhbSBhbHBoYWJldCAtIFRoZSBhbHBoYWJldCB0byB1c2UgZm9yIHRoZSBJRC4gRGVmYXVsdDogJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Jy5cbkBwYXJhbSBwcmVmaXggLSBUaGUgcHJlZml4IG9mIHRoZSBJRCB0byBnZW5lcmF0ZS4gT3B0aW9uYWwuXG5AcGFyYW0gc2VwYXJhdG9yIC0gVGhlIHNlcGFyYXRvciBiZXR3ZWVuIHRoZSBwcmVmaXggYW5kIHRoZSByYW5kb20gcGFydCBvZiB0aGUgSUQuIERlZmF1bHQ6ICctJy5cbkBwYXJhbSBzaXplIC0gVGhlIHNpemUgb2YgdGhlIHJhbmRvbSBwYXJ0IG9mIHRoZSBJRCB0byBnZW5lcmF0ZS4gRGVmYXVsdDogMTYuXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVJZEdlbmVyYXRvciA9ICh7XG4gIHByZWZpeCxcbiAgc2l6ZSA9IDE2LFxuICBhbHBoYWJldCA9ICcwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsXG4gIHNlcGFyYXRvciA9ICctJyxcbn06IHtcbiAgcHJlZml4Pzogc3RyaW5nO1xuICBzZXBhcmF0b3I/OiBzdHJpbmc7XG4gIHNpemU/OiBudW1iZXI7XG4gIGFscGhhYmV0Pzogc3RyaW5nO1xufSA9IHt9KTogSWRHZW5lcmF0b3IgPT4ge1xuICBjb25zdCBnZW5lcmF0b3IgPSAoKSA9PiB7XG4gICAgY29uc3QgYWxwaGFiZXRMZW5ndGggPSBhbHBoYWJldC5sZW5ndGg7XG4gICAgY29uc3QgY2hhcnMgPSBuZXcgQXJyYXkoc2l6ZSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIGNoYXJzW2ldID0gYWxwaGFiZXRbKE1hdGgucmFuZG9tKCkgKiBhbHBoYWJldExlbmd0aCkgfCAwXTtcbiAgICB9XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICB9O1xuXG4gIGlmIChwcmVmaXggPT0gbnVsbCkge1xuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cblxuICAvLyBjaGVjayB0aGF0IHRoZSBwcmVmaXggaXMgbm90IHBhcnQgb2YgdGhlIGFscGhhYmV0IChvdGhlcndpc2UgcHJlZml4IGNoZWNraW5nIGNhbiBmYWlsIHJhbmRvbWx5KVxuICBpZiAoYWxwaGFiZXQuaW5jbHVkZXMoc2VwYXJhdG9yKSkge1xuICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICBhcmd1bWVudDogJ3NlcGFyYXRvcicsXG4gICAgICBtZXNzYWdlOiBgVGhlIHNlcGFyYXRvciBcIiR7c2VwYXJhdG9yfVwiIG11c3Qgbm90IGJlIHBhcnQgb2YgdGhlIGFscGhhYmV0IFwiJHthbHBoYWJldH1cIi5gLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuICgpID0+IGAke3ByZWZpeH0ke3NlcGFyYXRvcn0ke2dlbmVyYXRvcigpfWA7XG59O1xuXG4vKipcbkEgZnVuY3Rpb24gdGhhdCBnZW5lcmF0ZXMgYW4gSUQuXG4gKi9cbmV4cG9ydCB0eXBlIElkR2VuZXJhdG9yID0gKCkgPT4gc3RyaW5nO1xuXG4vKipcbkdlbmVyYXRlcyBhIDE2LWNoYXJhY3RlciByYW5kb20gc3RyaW5nIHRvIHVzZSBmb3IgSURzLlxuTm90IGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZS5cbiAqL1xuZXhwb3J0IGNvbnN0IGdlbmVyYXRlSWQgPSBjcmVhdGVJZEdlbmVyYXRvcigpO1xuIiwgImV4cG9ydCBmdW5jdGlvbiBnZXRFcnJvck1lc3NhZ2UoZXJyb3I6IHVua25vd24gfCB1bmRlZmluZWQpIHtcbiAgaWYgKGVycm9yID09IG51bGwpIHtcbiAgICByZXR1cm4gJ3Vua25vd24gZXJyb3InO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cblxuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiBlcnJvci5tZXNzYWdlO1xuICB9XG5cbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGVycm9yKTtcbn1cbiIsICJpbXBvcnQgeyBBUElDYWxsRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMgfSBmcm9tICcuL2V4dHJhY3QtcmVzcG9uc2UtaGVhZGVycyc7XG5pbXBvcnQgeyBGZXRjaEZ1bmN0aW9uIH0gZnJvbSAnLi9mZXRjaC1mdW5jdGlvbic7XG5pbXBvcnQgeyBoYW5kbGVGZXRjaEVycm9yIH0gZnJvbSAnLi9oYW5kbGUtZmV0Y2gtZXJyb3InO1xuaW1wb3J0IHsgaXNBYm9ydEVycm9yIH0gZnJvbSAnLi9pcy1hYm9ydC1lcnJvcic7XG5pbXBvcnQgeyByZW1vdmVVbmRlZmluZWRFbnRyaWVzIH0gZnJvbSAnLi9yZW1vdmUtdW5kZWZpbmVkLWVudHJpZXMnO1xuaW1wb3J0IHsgUmVzcG9uc2VIYW5kbGVyIH0gZnJvbSAnLi9yZXNwb25zZS1oYW5kbGVyJztcblxuLy8gdXNlIGZ1bmN0aW9uIHRvIGFsbG93IGZvciBtb2NraW5nIGluIHRlc3RzOlxuY29uc3QgZ2V0T3JpZ2luYWxGZXRjaCA9ICgpID0+IGdsb2JhbFRoaXMuZmV0Y2g7XG5cbmV4cG9ydCBjb25zdCBnZXRGcm9tQXBpID0gYXN5bmMgPFQ+KHtcbiAgdXJsLFxuICBoZWFkZXJzID0ge30sXG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIsXG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcixcbiAgYWJvcnRTaWduYWwsXG4gIGZldGNoID0gZ2V0T3JpZ2luYWxGZXRjaCgpLFxufToge1xuICB1cmw6IHN0cmluZztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPEVycm9yPjtcbiAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPFQ+O1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuICBmZXRjaD86IEZldGNoRnVuY3Rpb247XG59KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiByZW1vdmVVbmRlZmluZWRFbnRyaWVzKGhlYWRlcnMpLFxuICAgICAgc2lnbmFsOiBhYm9ydFNpZ25hbCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgbGV0IGVycm9ySW5mb3JtYXRpb246IHtcbiAgICAgICAgdmFsdWU6IEVycm9yO1xuICAgICAgICByZXNwb25zZUhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkO1xuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgZXJyb3JJbmZvcm1hdGlvbiA9IGF3YWl0IGZhaWxlZFJlc3BvbnNlSGFuZGxlcih7XG4gICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiB7fSxcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAoaXNBYm9ydEVycm9yKGVycm9yKSB8fCBBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRocm93IG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcHJvY2VzcyBlcnJvciByZXNwb25zZScsXG4gICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiB7fSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IGVycm9ySW5mb3JtYXRpb24udmFsdWU7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyKHtcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXM6IHt9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIGlmIChpc0Fib3J0RXJyb3IoZXJyb3IpIHx8IEFQSUNhbGxFcnJvci5pc0luc3RhbmNlKGVycm9yKSkge1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHByb2Nlc3Mgc3VjY2Vzc2Z1bCByZXNwb25zZScsXG4gICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXM6IHt9LFxuICAgICAgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IGhhbmRsZUZldGNoRXJyb3IoeyBlcnJvciwgdXJsLCByZXF1ZXN0Qm9keVZhbHVlczoge30gfSk7XG4gIH1cbn07XG4iLCAiaW1wb3J0IHsgQVBJQ2FsbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBpc0Fib3J0RXJyb3IgfSBmcm9tICcuL2lzLWFib3J0LWVycm9yJztcblxuY29uc3QgRkVUQ0hfRkFJTEVEX0VSUk9SX01FU1NBR0VTID0gWydmZXRjaCBmYWlsZWQnLCAnZmFpbGVkIHRvIGZldGNoJ107XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVGZXRjaEVycm9yKHtcbiAgZXJyb3IsXG4gIHVybCxcbiAgcmVxdWVzdEJvZHlWYWx1ZXMsXG59OiB7XG4gIGVycm9yOiB1bmtub3duO1xuICB1cmw6IHN0cmluZztcbiAgcmVxdWVzdEJvZHlWYWx1ZXM6IHVua25vd247XG59KSB7XG4gIGlmIChpc0Fib3J0RXJyb3IoZXJyb3IpKSB7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgLy8gdW53cmFwIG9yaWdpbmFsIGVycm9yIHdoZW4gZmV0Y2ggZmFpbGVkIChmb3IgZWFzaWVyIGRlYnVnZ2luZyk6XG4gIGlmIChcbiAgICBlcnJvciBpbnN0YW5jZW9mIFR5cGVFcnJvciAmJlxuICAgIEZFVENIX0ZBSUxFRF9FUlJPUl9NRVNTQUdFUy5pbmNsdWRlcyhlcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkpXG4gICkge1xuICAgIGNvbnN0IGNhdXNlID0gKGVycm9yIGFzIGFueSkuY2F1c2U7XG5cbiAgICBpZiAoY2F1c2UgIT0gbnVsbCkge1xuICAgICAgLy8gRmFpbGVkIHRvIGNvbm5lY3QgdG8gc2VydmVyOlxuICAgICAgcmV0dXJuIG5ldyBBUElDYWxsRXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiBgQ2Fubm90IGNvbm5lY3QgdG8gQVBJOiAke2NhdXNlLm1lc3NhZ2V9YCxcbiAgICAgICAgY2F1c2UsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVxdWVzdEJvZHlWYWx1ZXMsXG4gICAgICAgIGlzUmV0cnlhYmxlOiB0cnVlLCAvLyByZXRyeSB3aGVuIG5ldHdvcmsgZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBlcnJvcjtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gaXNBYm9ydEVycm9yKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgRXJyb3Ige1xuICByZXR1cm4gKFxuICAgIChlcnJvciBpbnN0YW5jZW9mIEVycm9yIHx8IGVycm9yIGluc3RhbmNlb2YgRE9NRXhjZXB0aW9uKSAmJlxuICAgIChlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicgfHxcbiAgICAgIGVycm9yLm5hbWUgPT09ICdSZXNwb25zZUFib3J0ZWQnIHx8IC8vIE5leHQuanNcbiAgICAgIGVycm9yLm5hbWUgPT09ICdUaW1lb3V0RXJyb3InKVxuICApO1xufVxuIiwgIi8qKlxuICogUmVtb3ZlcyBlbnRyaWVzIGZyb20gYSByZWNvcmQgd2hlcmUgdGhlIHZhbHVlIGlzIG51bGwgb3IgdW5kZWZpbmVkLlxuICogQHBhcmFtIHJlY29yZCAtIFRoZSBpbnB1dCBvYmplY3Qgd2hvc2UgZW50cmllcyBtYXkgYmUgbnVsbCBvciB1bmRlZmluZWQuXG4gKiBAcmV0dXJucyBBIG5ldyBvYmplY3QgY29udGFpbmluZyBvbmx5IGVudHJpZXMgd2l0aCBub24tbnVsbCBhbmQgbm9uLXVuZGVmaW5lZCB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVVbmRlZmluZWRFbnRyaWVzPFQ+KFxuICByZWNvcmQ6IFJlY29yZDxzdHJpbmcsIFQgfCB1bmRlZmluZWQ+LFxuKTogUmVjb3JkPHN0cmluZywgVD4ge1xuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIE9iamVjdC5lbnRyaWVzKHJlY29yZCkuZmlsdGVyKChbX2tleSwgdmFsdWVdKSA9PiB2YWx1ZSAhPSBudWxsKSxcbiAgKSBhcyBSZWNvcmQ8c3RyaW5nLCBUPjtcbn1cbiIsICIvKipcbiAqIENoZWNrcyBpZiB0aGUgZ2l2ZW4gVVJMIGlzIHN1cHBvcnRlZCBuYXRpdmVseSBieSB0aGUgbW9kZWwuXG4gKlxuICogQHBhcmFtIG1lZGlhVHlwZSAtIFRoZSBtZWRpYSB0eXBlIG9mIHRoZSBVUkwuIENhc2Utc2Vuc2l0aXZlLlxuICogQHBhcmFtIHVybCAtIFRoZSBVUkwgdG8gY2hlY2suXG4gKiBAcGFyYW0gc3VwcG9ydGVkVXJscyAtIEEgcmVjb3JkIHdoZXJlIGtleXMgYXJlIGNhc2Utc2Vuc2l0aXZlIG1lZGlhIHR5cGVzIChvciAnKicpXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCB2YWx1ZXMgYXJlIGFycmF5cyBvZiBSZWdFeHAgcGF0dGVybnMgZm9yIFVSTHMuXG4gKlxuICogQHJldHVybnMgYHRydWVgIGlmIHRoZSBVUkwgbWF0Y2hlcyBhIHBhdHRlcm4gdW5kZXIgdGhlIHNwZWNpZmljIG1lZGlhIHR5cGVcbiAqICAgICAgICAgIG9yIHRoZSB3aWxkY2FyZCAnKicsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNVcmxTdXBwb3J0ZWQoe1xuICBtZWRpYVR5cGUsXG4gIHVybCxcbiAgc3VwcG9ydGVkVXJscyxcbn06IHtcbiAgbWVkaWFUeXBlOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBzdXBwb3J0ZWRVcmxzOiBSZWNvcmQ8c3RyaW5nLCBSZWdFeHBbXT47XG59KTogYm9vbGVhbiB7XG4gIC8vIHN0YW5kYXJkaXplIG1lZGlhIHR5cGUgYW5kIHVybCB0byBsb3dlciBjYXNlXG4gIHVybCA9IHVybC50b0xvd2VyQ2FzZSgpO1xuICBtZWRpYVR5cGUgPSBtZWRpYVR5cGUudG9Mb3dlckNhc2UoKTtcblxuICByZXR1cm4gKFxuICAgIE9iamVjdC5lbnRyaWVzKHN1cHBvcnRlZFVybHMpXG4gICAgICAvLyBzdGFuZGFyZGl6ZSBzdXBwb3J0ZWQgdXJsIG1hcCBpbnRvIGxvd2VyY2FzZSBwcmVmaXhlczpcbiAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjb25zdCBtZWRpYVR5cGUgPSBrZXkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIG1lZGlhVHlwZSA9PT0gJyonIHx8IG1lZGlhVHlwZSA9PT0gJyovKidcbiAgICAgICAgICA/IHsgbWVkaWFUeXBlUHJlZml4OiAnJywgcmVnZXhlczogdmFsdWUgfVxuICAgICAgICAgIDogeyBtZWRpYVR5cGVQcmVmaXg6IG1lZGlhVHlwZS5yZXBsYWNlKC9cXCovLCAnJyksIHJlZ2V4ZXM6IHZhbHVlIH07XG4gICAgICB9KVxuICAgICAgLy8gZ2F0aGVyIGFsbCByZWdleHAgcGF0dGVybiBmcm9tIG1hdGNoZWQgbWVkaWEgdHlwZSBwcmVmaXhlczpcbiAgICAgIC5maWx0ZXIoKHsgbWVkaWFUeXBlUHJlZml4IH0pID0+IG1lZGlhVHlwZS5zdGFydHNXaXRoKG1lZGlhVHlwZVByZWZpeCkpXG4gICAgICAuZmxhdE1hcCgoeyByZWdleGVzIH0pID0+IHJlZ2V4ZXMpXG4gICAgICAvLyBjaGVjayBpZiBhbnkgcGF0dGVybiBtYXRjaGVzIHRoZSB1cmw6XG4gICAgICAuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdCh1cmwpKVxuICApO1xufVxuIiwgImltcG9ydCB7IExvYWRBUElLZXlFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gbG9hZEFwaUtleSh7XG4gIGFwaUtleSxcbiAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWUsXG4gIGFwaUtleVBhcmFtZXRlck5hbWUgPSAnYXBpS2V5JyxcbiAgZGVzY3JpcHRpb24sXG59OiB7XG4gIGFwaUtleTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZTogc3RyaW5nO1xuICBhcGlLZXlQYXJhbWV0ZXJOYW1lPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufSk6IHN0cmluZyB7XG4gIGlmICh0eXBlb2YgYXBpS2V5ID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBhcGlLZXk7XG4gIH1cblxuICBpZiAoYXBpS2V5ICE9IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgTG9hZEFQSUtleUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGAke2Rlc2NyaXB0aW9ufSBBUEkga2V5IG11c3QgYmUgYSBzdHJpbmcuYCxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0aHJvdyBuZXcgTG9hZEFQSUtleUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGAke2Rlc2NyaXB0aW9ufSBBUEkga2V5IGlzIG1pc3NpbmcuIFBhc3MgaXQgdXNpbmcgdGhlICcke2FwaUtleVBhcmFtZXRlck5hbWV9JyBwYXJhbWV0ZXIuIEVudmlyb25tZW50IHZhcmlhYmxlcyBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgZW52aXJvbm1lbnQuYCxcbiAgICB9KTtcbiAgfVxuXG4gIGFwaUtleSA9IHByb2Nlc3MuZW52W2Vudmlyb25tZW50VmFyaWFibGVOYW1lXTtcblxuICBpZiAoYXBpS2V5ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgTG9hZEFQSUtleUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGAke2Rlc2NyaXB0aW9ufSBBUEkga2V5IGlzIG1pc3NpbmcuIFBhc3MgaXQgdXNpbmcgdGhlICcke2FwaUtleVBhcmFtZXRlck5hbWV9JyBwYXJhbWV0ZXIgb3IgdGhlICR7ZW52aXJvbm1lbnRWYXJpYWJsZU5hbWV9IGVudmlyb25tZW50IHZhcmlhYmxlLmAsXG4gICAgfSk7XG4gIH1cblxuICBpZiAodHlwZW9mIGFwaUtleSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgTG9hZEFQSUtleUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGAke2Rlc2NyaXB0aW9ufSBBUEkga2V5IG11c3QgYmUgYSBzdHJpbmcuIFRoZSB2YWx1ZSBvZiB0aGUgJHtlbnZpcm9ubWVudFZhcmlhYmxlTmFtZX0gZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IGEgc3RyaW5nLmAsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYXBpS2V5O1xufVxuIiwgIi8qKlxuICogTG9hZHMgYW4gb3B0aW9uYWwgYHN0cmluZ2Agc2V0dGluZyBmcm9tIHRoZSBlbnZpcm9ubWVudCBvciBhIHBhcmFtZXRlci5cbiAqXG4gKiBAcGFyYW0gc2V0dGluZ1ZhbHVlIC0gVGhlIHNldHRpbmcgdmFsdWUuXG4gKiBAcGFyYW0gZW52aXJvbm1lbnRWYXJpYWJsZU5hbWUgLSBUaGUgZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZS5cbiAqIEByZXR1cm5zIFRoZSBzZXR0aW5nIHZhbHVlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZE9wdGlvbmFsU2V0dGluZyh7XG4gIHNldHRpbmdWYWx1ZSxcbiAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWUsXG59OiB7XG4gIHNldHRpbmdWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZTogc3RyaW5nO1xufSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIGlmICh0eXBlb2Ygc2V0dGluZ1ZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzZXR0aW5nVmFsdWU7XG4gIH1cblxuICBpZiAoc2V0dGluZ1ZhbHVlICE9IG51bGwgfHwgdHlwZW9mIHByb2Nlc3MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHNldHRpbmdWYWx1ZSA9IHByb2Nlc3MuZW52W2Vudmlyb25tZW50VmFyaWFibGVOYW1lXTtcblxuICBpZiAoc2V0dGluZ1ZhbHVlID09IG51bGwgfHwgdHlwZW9mIHNldHRpbmdWYWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgcmV0dXJuIHNldHRpbmdWYWx1ZTtcbn1cbiIsICJpbXBvcnQgeyBMb2FkU2V0dGluZ0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbi8qKlxuICogTG9hZHMgYSBgc3RyaW5nYCBzZXR0aW5nIGZyb20gdGhlIGVudmlyb25tZW50IG9yIGEgcGFyYW1ldGVyLlxuICpcbiAqIEBwYXJhbSBzZXR0aW5nVmFsdWUgLSBUaGUgc2V0dGluZyB2YWx1ZS5cbiAqIEBwYXJhbSBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZSAtIFRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZSBuYW1lLlxuICogQHBhcmFtIHNldHRpbmdOYW1lIC0gVGhlIHNldHRpbmcgbmFtZS5cbiAqIEBwYXJhbSBkZXNjcmlwdGlvbiAtIFRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgc2V0dGluZy5cbiAqIEByZXR1cm5zIFRoZSBzZXR0aW5nIHZhbHVlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZFNldHRpbmcoe1xuICBzZXR0aW5nVmFsdWUsXG4gIGVudmlyb25tZW50VmFyaWFibGVOYW1lLFxuICBzZXR0aW5nTmFtZSxcbiAgZGVzY3JpcHRpb24sXG59OiB7XG4gIHNldHRpbmdWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZTogc3RyaW5nO1xuICBzZXR0aW5nTmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xufSk6IHN0cmluZyB7XG4gIGlmICh0eXBlb2Ygc2V0dGluZ1ZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBzZXR0aW5nVmFsdWU7XG4gIH1cblxuICBpZiAoc2V0dGluZ1ZhbHVlICE9IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgTG9hZFNldHRpbmdFcnJvcih7XG4gICAgICBtZXNzYWdlOiBgJHtkZXNjcmlwdGlvbn0gc2V0dGluZyBtdXN0IGJlIGEgc3RyaW5nLmAsXG4gICAgfSk7XG4gIH1cblxuICBpZiAodHlwZW9mIHByb2Nlc3MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhyb3cgbmV3IExvYWRTZXR0aW5nRXJyb3Ioe1xuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYCR7ZGVzY3JpcHRpb259IHNldHRpbmcgaXMgbWlzc2luZy4gYCArXG4gICAgICAgIGBQYXNzIGl0IHVzaW5nIHRoZSAnJHtzZXR0aW5nTmFtZX0nIHBhcmFtZXRlci4gYCArXG4gICAgICAgIGBFbnZpcm9ubWVudCB2YXJpYWJsZXMgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGVudmlyb25tZW50LmAsXG4gICAgfSk7XG4gIH1cblxuICBzZXR0aW5nVmFsdWUgPSBwcm9jZXNzLmVudltlbnZpcm9ubWVudFZhcmlhYmxlTmFtZV07XG5cbiAgaWYgKHNldHRpbmdWYWx1ZSA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IExvYWRTZXR0aW5nRXJyb3Ioe1xuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYCR7ZGVzY3JpcHRpb259IHNldHRpbmcgaXMgbWlzc2luZy4gYCArXG4gICAgICAgIGBQYXNzIGl0IHVzaW5nIHRoZSAnJHtzZXR0aW5nTmFtZX0nIHBhcmFtZXRlciBgICtcbiAgICAgICAgYG9yIHRoZSAke2Vudmlyb25tZW50VmFyaWFibGVOYW1lfSBlbnZpcm9ubWVudCB2YXJpYWJsZS5gLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBzZXR0aW5nVmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IExvYWRTZXR0aW5nRXJyb3Ioe1xuICAgICAgbWVzc2FnZTpcbiAgICAgICAgYCR7ZGVzY3JpcHRpb259IHNldHRpbmcgbXVzdCBiZSBhIHN0cmluZy4gYCArXG4gICAgICAgIGBUaGUgdmFsdWUgb2YgdGhlICR7ZW52aXJvbm1lbnRWYXJpYWJsZU5hbWV9IGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBhIHN0cmluZy5gLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHNldHRpbmdWYWx1ZTtcbn1cbiIsICJpbXBvcnQge1xuICBKU09OUGFyc2VFcnJvcixcbiAgSlNPTlZhbHVlLFxuICBUeXBlVmFsaWRhdGlvbkVycm9yLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCAqIGFzIHozIGZyb20gJ3pvZC92Myc7XG5pbXBvcnQgKiBhcyB6NCBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgc2VjdXJlSnNvblBhcnNlIH0gZnJvbSAnLi9zZWN1cmUtanNvbi1wYXJzZSc7XG5pbXBvcnQgeyBzYWZlVmFsaWRhdGVUeXBlcywgdmFsaWRhdGVUeXBlcyB9IGZyb20gJy4vdmFsaWRhdGUtdHlwZXMnO1xuaW1wb3J0IHsgVmFsaWRhdG9yIH0gZnJvbSAnLi92YWxpZGF0b3InO1xuXG4vKipcbiAqIFBhcnNlcyBhIEpTT04gc3RyaW5nIGludG8gYW4gdW5rbm93biBvYmplY3QuXG4gKlxuICogQHBhcmFtIHRleHQgLSBUaGUgSlNPTiBzdHJpbmcgdG8gcGFyc2UuXG4gKiBAcmV0dXJucyB7SlNPTlZhbHVlfSAtIFRoZSBwYXJzZWQgSlNPTiBvYmplY3QuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUpTT04ob3B0aW9uczoge1xuICB0ZXh0OiBzdHJpbmc7XG4gIHNjaGVtYT86IHVuZGVmaW5lZDtcbn0pOiBQcm9taXNlPEpTT05WYWx1ZT47XG4vKipcbiAqIFBhcnNlcyBhIEpTT04gc3RyaW5nIGludG8gYSBzdHJvbmdseS10eXBlZCBvYmplY3QgdXNpbmcgdGhlIHByb3ZpZGVkIHNjaGVtYS5cbiAqXG4gKiBAdGVtcGxhdGUgVCAtIFRoZSB0eXBlIG9mIHRoZSBvYmplY3QgdG8gcGFyc2UgdGhlIEpTT04gaW50by5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gVGhlIEpTT04gc3RyaW5nIHRvIHBhcnNlLlxuICogQHBhcmFtIHtWYWxpZGF0b3I8VD59IHNjaGVtYSAtIFRoZSBzY2hlbWEgdG8gdXNlIGZvciBwYXJzaW5nIHRoZSBKU09OLlxuICogQHJldHVybnMge1Byb21pc2U8VD59IC0gVGhlIHBhcnNlZCBvYmplY3QuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUpTT048VD4ob3B0aW9uczoge1xuICB0ZXh0OiBzdHJpbmc7XG4gIHNjaGVtYTogejQuY29yZS4kWm9kVHlwZTxUPiB8IHozLlNjaGVtYTxUPiB8IFZhbGlkYXRvcjxUPjtcbn0pOiBQcm9taXNlPFQ+O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlSlNPTjxUPih7XG4gIHRleHQsXG4gIHNjaGVtYSxcbn06IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE/OiB6NC5jb3JlLiRab2RUeXBlPFQ+IHwgejMuU2NoZW1hPFQ+IHwgVmFsaWRhdG9yPFQ+O1xufSk6IFByb21pc2U8VD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbHVlID0gc2VjdXJlSnNvblBhcnNlKHRleHQpO1xuXG4gICAgaWYgKHNjaGVtYSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbGlkYXRlVHlwZXM8VD4oeyB2YWx1ZSwgc2NoZW1hIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChcbiAgICAgIEpTT05QYXJzZUVycm9yLmlzSW5zdGFuY2UoZXJyb3IpIHx8XG4gICAgICBUeXBlVmFsaWRhdGlvbkVycm9yLmlzSW5zdGFuY2UoZXJyb3IpXG4gICAgKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgSlNPTlBhcnNlRXJyb3IoeyB0ZXh0LCBjYXVzZTogZXJyb3IgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgUGFyc2VSZXN1bHQ8VD4gPVxuICB8IHsgc3VjY2VzczogdHJ1ZTsgdmFsdWU6IFQ7IHJhd1ZhbHVlOiB1bmtub3duIH1cbiAgfCB7XG4gICAgICBzdWNjZXNzOiBmYWxzZTtcbiAgICAgIGVycm9yOiBKU09OUGFyc2VFcnJvciB8IFR5cGVWYWxpZGF0aW9uRXJyb3I7XG4gICAgICByYXdWYWx1ZTogdW5rbm93bjtcbiAgICB9O1xuXG4vKipcbiAqIFNhZmVseSBwYXJzZXMgYSBKU09OIHN0cmluZyBhbmQgcmV0dXJucyB0aGUgcmVzdWx0IGFzIGFuIG9iamVjdCBvZiB0eXBlIGB1bmtub3duYC5cbiAqXG4gKiBAcGFyYW0gdGV4dCAtIFRoZSBKU09OIHN0cmluZyB0byBwYXJzZS5cbiAqIEByZXR1cm5zIHtQcm9taXNlPG9iamVjdD59IEVpdGhlciBhbiBvYmplY3Qgd2l0aCBgc3VjY2VzczogdHJ1ZWAgYW5kIHRoZSBwYXJzZWQgZGF0YSwgb3IgYW4gb2JqZWN0IHdpdGggYHN1Y2Nlc3M6IGZhbHNlYCBhbmQgdGhlIGVycm9yIHRoYXQgb2NjdXJyZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYWZlUGFyc2VKU09OKG9wdGlvbnM6IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE/OiB1bmRlZmluZWQ7XG59KTogUHJvbWlzZTxQYXJzZVJlc3VsdDxKU09OVmFsdWU+Pjtcbi8qKlxuICogU2FmZWx5IHBhcnNlcyBhIEpTT04gc3RyaW5nIGludG8gYSBzdHJvbmdseS10eXBlZCBvYmplY3QsIHVzaW5nIGEgcHJvdmlkZWQgc2NoZW1hIHRvIHZhbGlkYXRlIHRoZSBvYmplY3QuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0IHRvIHBhcnNlIHRoZSBKU09OIGludG8uXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSBKU09OIHN0cmluZyB0byBwYXJzZS5cbiAqIEBwYXJhbSB7VmFsaWRhdG9yPFQ+fSBzY2hlbWEgLSBUaGUgc2NoZW1hIHRvIHVzZSBmb3IgcGFyc2luZyB0aGUgSlNPTi5cbiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIGVpdGhlciBhIGBzdWNjZXNzYCBmbGFnIGFuZCB0aGUgcGFyc2VkIGFuZCB0eXBlZCBkYXRhLCBvciBhIGBzdWNjZXNzYCBmbGFnIGFuZCBhbiBlcnJvciBvYmplY3QuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYWZlUGFyc2VKU09OPFQ+KG9wdGlvbnM6IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE6IHo0LmNvcmUuJFpvZFR5cGU8VD4gfCB6My5TY2hlbWE8VD4gfCBWYWxpZGF0b3I8VD47XG59KTogUHJvbWlzZTxQYXJzZVJlc3VsdDxUPj47XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2FmZVBhcnNlSlNPTjxUPih7XG4gIHRleHQsXG4gIHNjaGVtYSxcbn06IHtcbiAgdGV4dDogc3RyaW5nO1xuICBzY2hlbWE/OiB6NC5jb3JlLiRab2RUeXBlPFQ+IHwgejMuU2NoZW1hPFQ+IHwgVmFsaWRhdG9yPFQ+O1xufSk6IFByb21pc2U8UGFyc2VSZXN1bHQ8VD4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWx1ZSA9IHNlY3VyZUpzb25QYXJzZSh0ZXh0KTtcblxuICAgIGlmIChzY2hlbWEgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsdWU6IHZhbHVlIGFzIFQsIHJhd1ZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCBzYWZlVmFsaWRhdGVUeXBlczxUPih7IHZhbHVlLCBzY2hlbWEgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IEpTT05QYXJzZUVycm9yLmlzSW5zdGFuY2UoZXJyb3IpXG4gICAgICAgID8gZXJyb3JcbiAgICAgICAgOiBuZXcgSlNPTlBhcnNlRXJyb3IoeyB0ZXh0LCBjYXVzZTogZXJyb3IgfSksXG4gICAgICByYXdWYWx1ZTogdW5kZWZpbmVkLFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUGFyc2FibGVKc29uKGlucHV0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICBzZWN1cmVKc29uUGFyc2UoaW5wdXQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsICIvLyBMaWNlbnNlZCB1bmRlciBCU0QtMy1DbGF1c2UgKHRoaXMgZmlsZSBvbmx5KVxuLy8gQ29kZSBhZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2Zhc3RpZnkvc2VjdXJlLWpzb24tcGFyc2UvYmxvYi83ODNmY2IxYjU0MzQ3MDk0NjY3NTk4NDdjZWM5NzQzODE5Mzk2NzNhL2luZGV4LmpzXG4vL1xuLy8gQ29weXJpZ2h0IChjKSBWZXJjZWwsIEluYy4gKGh0dHBzOi8vdmVyY2VsLmNvbSlcbi8vIENvcHlyaWdodCAoYykgMjAxOSBUaGUgRmFzdGlmeSBUZWFtXG4vLyBDb3B5cmlnaHQgKGMpIDIwMTksIFNpZGV3YXkgSW5jLCBhbmQgcHJvamVjdCBjb250cmlidXRvcnNcbi8vIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vL1xuLy8gVGhlIGNvbXBsZXRlIGxpc3Qgb2YgY29udHJpYnV0b3JzIGNhbiBiZSBmb3VuZCBhdDpcbi8vIC0gaHR0cHM6Ly9naXRodWIuY29tL2hhcGlqcy9ib3VybmUvZ3JhcGhzL2NvbnRyaWJ1dG9yc1xuLy8gLSBodHRwczovL2dpdGh1Yi5jb20vZmFzdGlmeS9zZWN1cmUtanNvbi1wYXJzZS9ncmFwaHMvY29udHJpYnV0b3JzXG4vLyAtIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvYWkvY29tbWl0cy9tYWluL3BhY2thZ2VzL3Byb3ZpZGVyLXV0aWxzL3NyYy9zZWN1cmUtcGFyc2UtanNvbi50c1xuLy9cbi8vIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dCBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbi8vXG4vLyAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4vL1xuLy8gMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuLy9cbi8vIDMuIE5laXRoZXIgdGhlIG5hbWUgb2YgdGhlIGNvcHlyaWdodCBob2xkZXIgbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbi8vXG4vLyBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIEhPTERFUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG5cbmNvbnN0IHN1c3BlY3RQcm90b1J4ID0gL1wiX19wcm90b19fXCJcXHMqOi87XG5jb25zdCBzdXNwZWN0Q29uc3RydWN0b3JSeCA9IC9cImNvbnN0cnVjdG9yXCJcXHMqOi87XG5cbmZ1bmN0aW9uIF9wYXJzZSh0ZXh0OiBzdHJpbmcpIHtcbiAgLy8gUGFyc2Ugbm9ybWFsbHlcbiAgY29uc3Qgb2JqID0gSlNPTi5wYXJzZSh0ZXh0KTtcblxuICAvLyBJZ25vcmUgbnVsbCBhbmQgbm9uLW9iamVjdHNcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICBpZiAoXG4gICAgc3VzcGVjdFByb3RvUngudGVzdCh0ZXh0KSA9PT0gZmFsc2UgJiZcbiAgICBzdXNwZWN0Q29uc3RydWN0b3JSeC50ZXN0KHRleHQpID09PSBmYWxzZVxuICApIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgLy8gU2NhbiByZXN1bHQgZm9yIHByb3RvIGtleXNcbiAgcmV0dXJuIGZpbHRlcihvYmopO1xufVxuXG5mdW5jdGlvbiBmaWx0ZXIob2JqOiBhbnkpIHtcbiAgbGV0IG5leHQgPSBbb2JqXTtcblxuICB3aGlsZSAobmV4dC5sZW5ndGgpIHtcbiAgICBjb25zdCBub2RlcyA9IG5leHQ7XG4gICAgbmV4dCA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBub2RlIG9mIG5vZGVzKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5vZGUsICdfX3Byb3RvX18nKSkge1xuICAgICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoJ09iamVjdCBjb250YWlucyBmb3JiaWRkZW4gcHJvdG90eXBlIHByb3BlcnR5Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5vZGUsICdjb25zdHJ1Y3RvcicpICYmXG4gICAgICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChub2RlLmNvbnN0cnVjdG9yLCAncHJvdG90eXBlJylcbiAgICAgICkge1xuICAgICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoJ09iamVjdCBjb250YWlucyBmb3JiaWRkZW4gcHJvdG90eXBlIHByb3BlcnR5Jyk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoY29uc3Qga2V5IGluIG5vZGUpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBub2RlW2tleV07XG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgbmV4dC5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VjdXJlSnNvblBhcnNlKHRleHQ6IHN0cmluZykge1xuICAvLyBQZXJmb3JtYW5jZSBvcHRpbWl6YXRpb24sIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFzdGlmeS9zZWN1cmUtanNvbi1wYXJzZS9wdWxsLzkwXG4gIGNvbnN0IHsgc3RhY2tUcmFjZUxpbWl0IH0gPSBFcnJvcjtcbiAgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gMDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gX3BhcnNlKHRleHQpO1xuICB9IGZpbmFsbHkge1xuICAgIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9IHN0YWNrVHJhY2VMaW1pdDtcbiAgfVxufVxuIiwgImltcG9ydCB7IFR5cGVWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB0eXBlIHsgU3RhbmRhcmRTY2hlbWFWMSB9IGZyb20gJ0BzdGFuZGFyZC1zY2hlbWEvc3BlYyc7XG5pbXBvcnQgeyBWYWxpZGF0b3IsIGFzVmFsaWRhdG9yIH0gZnJvbSAnLi92YWxpZGF0b3InO1xuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGUgdHlwZXMgb2YgYW4gdW5rbm93biBvYmplY3QgdXNpbmcgYSBzY2hlbWEgYW5kXG4gKiByZXR1cm4gYSBzdHJvbmdseS10eXBlZCBvYmplY3QuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0IHRvIHZhbGlkYXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMudmFsdWUgLSBUaGUgb2JqZWN0IHRvIHZhbGlkYXRlLlxuICogQHBhcmFtIHtWYWxpZGF0b3I8VD59IG9wdGlvbnMuc2NoZW1hIC0gVGhlIHNjaGVtYSB0byB1c2UgZm9yIHZhbGlkYXRpbmcgdGhlIEpTT04uXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxUPn0gLSBUaGUgdHlwZWQgb2JqZWN0LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVUeXBlczxPQkpFQ1Q+KHtcbiAgdmFsdWUsXG4gIHNjaGVtYSxcbn06IHtcbiAgdmFsdWU6IHVua25vd247XG4gIHNjaGVtYTogU3RhbmRhcmRTY2hlbWFWMTx1bmtub3duLCBPQkpFQ1Q+IHwgVmFsaWRhdG9yPE9CSkVDVD47XG59KTogUHJvbWlzZTxPQkpFQ1Q+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2FmZVZhbGlkYXRlVHlwZXMoeyB2YWx1ZSwgc2NoZW1hIH0pO1xuXG4gIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICB0aHJvdyBUeXBlVmFsaWRhdGlvbkVycm9yLndyYXAoeyB2YWx1ZSwgY2F1c2U6IHJlc3VsdC5lcnJvciB9KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59XG5cbi8qKlxuICogU2FmZWx5IHZhbGlkYXRlcyB0aGUgdHlwZXMgb2YgYW4gdW5rbm93biBvYmplY3QgdXNpbmcgYSBzY2hlbWEgYW5kXG4gKiByZXR1cm4gYSBzdHJvbmdseS10eXBlZCBvYmplY3QuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB0aGUgb2JqZWN0IHRvIHZhbGlkYXRlLlxuICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMudmFsdWUgLSBUaGUgSlNPTiBvYmplY3QgdG8gdmFsaWRhdGUuXG4gKiBAcGFyYW0ge1ZhbGlkYXRvcjxUPn0gb3B0aW9ucy5zY2hlbWEgLSBUaGUgc2NoZW1hIHRvIHVzZSBmb3IgdmFsaWRhdGluZyB0aGUgSlNPTi5cbiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIGVpdGhlciBhIGBzdWNjZXNzYCBmbGFnIGFuZCB0aGUgcGFyc2VkIGFuZCB0eXBlZCBkYXRhLCBvciBhIGBzdWNjZXNzYCBmbGFnIGFuZCBhbiBlcnJvciBvYmplY3QuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYWZlVmFsaWRhdGVUeXBlczxPQkpFQ1Q+KHtcbiAgdmFsdWUsXG4gIHNjaGVtYSxcbn06IHtcbiAgdmFsdWU6IHVua25vd247XG4gIHNjaGVtYTogU3RhbmRhcmRTY2hlbWFWMTx1bmtub3duLCBPQkpFQ1Q+IHwgVmFsaWRhdG9yPE9CSkVDVD47XG59KTogUHJvbWlzZTxcbiAgfCB7XG4gICAgICBzdWNjZXNzOiB0cnVlO1xuICAgICAgdmFsdWU6IE9CSkVDVDtcbiAgICAgIHJhd1ZhbHVlOiB1bmtub3duO1xuICAgIH1cbiAgfCB7XG4gICAgICBzdWNjZXNzOiBmYWxzZTtcbiAgICAgIGVycm9yOiBUeXBlVmFsaWRhdGlvbkVycm9yO1xuICAgICAgcmF3VmFsdWU6IHVua25vd247XG4gICAgfVxuPiB7XG4gIGNvbnN0IHZhbGlkYXRvciA9IGFzVmFsaWRhdG9yKHNjaGVtYSk7XG5cbiAgdHJ5IHtcbiAgICBpZiAodmFsaWRhdG9yLnZhbGlkYXRlID09IG51bGwpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiB2YWx1ZSBhcyBPQkpFQ1QsIHJhd1ZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZhbGlkYXRvci52YWxpZGF0ZSh2YWx1ZSk7XG5cbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiByZXN1bHQudmFsdWUsIHJhd1ZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBUeXBlVmFsaWRhdGlvbkVycm9yLndyYXAoeyB2YWx1ZSwgY2F1c2U6IHJlc3VsdC5lcnJvciB9KSxcbiAgICAgIHJhd1ZhbHVlOiB2YWx1ZSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBUeXBlVmFsaWRhdGlvbkVycm9yLndyYXAoeyB2YWx1ZSwgY2F1c2U6IGVycm9yIH0pLFxuICAgICAgcmF3VmFsdWU6IHZhbHVlLFxuICAgIH07XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBUeXBlVmFsaWRhdGlvbkVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBTdGFuZGFyZFNjaGVtYVYxIH0gZnJvbSAnQHN0YW5kYXJkLXNjaGVtYS9zcGVjJztcblxuLyoqXG4gKiBVc2VkIHRvIG1hcmsgdmFsaWRhdG9yIGZ1bmN0aW9ucyBzbyB3ZSBjYW4gc3VwcG9ydCBib3RoIFpvZCBhbmQgY3VzdG9tIHNjaGVtYXMuXG4gKi9cbmV4cG9ydCBjb25zdCB2YWxpZGF0b3JTeW1ib2wgPSBTeW1ib2wuZm9yKCd2ZXJjZWwuYWkudmFsaWRhdG9yJyk7XG5cbmV4cG9ydCB0eXBlIFZhbGlkYXRpb25SZXN1bHQ8T0JKRUNUPiA9XG4gIHwgeyBzdWNjZXNzOiB0cnVlOyB2YWx1ZTogT0JKRUNUIH1cbiAgfCB7IHN1Y2Nlc3M6IGZhbHNlOyBlcnJvcjogRXJyb3IgfTtcblxuZXhwb3J0IHR5cGUgVmFsaWRhdG9yPE9CSkVDVCA9IHVua25vd24+ID0ge1xuICAvKipcbiAgICogVXNlZCB0byBtYXJrIHZhbGlkYXRvciBmdW5jdGlvbnMgc28gd2UgY2FuIHN1cHBvcnQgYm90aCBab2QgYW5kIGN1c3RvbSBzY2hlbWFzLlxuICAgKi9cbiAgW3ZhbGlkYXRvclN5bWJvbF06IHRydWU7XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsLiBWYWxpZGF0ZXMgdGhhdCB0aGUgc3RydWN0dXJlIG9mIGEgdmFsdWUgbWF0Y2hlcyB0aGlzIHNjaGVtYSxcbiAgICogYW5kIHJldHVybnMgYSB0eXBlZCB2ZXJzaW9uIG9mIHRoZSB2YWx1ZSBpZiBpdCBkb2VzLlxuICAgKi9cbiAgcmVhZG9ubHkgdmFsaWRhdGU/OiAoXG4gICAgdmFsdWU6IHVua25vd24sXG4gICkgPT4gVmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+IHwgUHJvbWlzZUxpa2U8VmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+Pjtcbn07XG5cbi8qKlxuICogQ3JlYXRlIGEgdmFsaWRhdG9yLlxuICpcbiAqIEBwYXJhbSB2YWxpZGF0ZSBBIHZhbGlkYXRpb24gZnVuY3Rpb24gZm9yIHRoZSBzY2hlbWEuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0b3I8T0JKRUNUPihcbiAgdmFsaWRhdGU/OlxuICAgIHwgdW5kZWZpbmVkXG4gICAgfCAoKFxuICAgICAgICB2YWx1ZTogdW5rbm93bixcbiAgICAgICkgPT4gVmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+IHwgUHJvbWlzZUxpa2U8VmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+PiksXG4pOiBWYWxpZGF0b3I8T0JKRUNUPiB7XG4gIHJldHVybiB7IFt2YWxpZGF0b3JTeW1ib2xdOiB0cnVlLCB2YWxpZGF0ZSB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZGF0b3IodmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBWYWxpZGF0b3Ige1xuICByZXR1cm4gKFxuICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICB2YWx1ZSAhPT0gbnVsbCAmJlxuICAgIHZhbGlkYXRvclN5bWJvbCBpbiB2YWx1ZSAmJlxuICAgIHZhbHVlW3ZhbGlkYXRvclN5bWJvbF0gPT09IHRydWUgJiZcbiAgICAndmFsaWRhdGUnIGluIHZhbHVlXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc1ZhbGlkYXRvcjxPQkpFQ1Q+KFxuICB2YWx1ZTogVmFsaWRhdG9yPE9CSkVDVD4gfCBTdGFuZGFyZFNjaGVtYVYxPHVua25vd24sIE9CSkVDVD4sXG4pOiBWYWxpZGF0b3I8T0JKRUNUPiB7XG4gIHJldHVybiBpc1ZhbGlkYXRvcih2YWx1ZSkgPyB2YWx1ZSA6IHN0YW5kYXJkU2NoZW1hVmFsaWRhdG9yKHZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0YW5kYXJkU2NoZW1hVmFsaWRhdG9yPE9CSkVDVD4oXG4gIHN0YW5kYXJkU2NoZW1hOiBTdGFuZGFyZFNjaGVtYVYxPHVua25vd24sIE9CSkVDVD4sXG4pOiBWYWxpZGF0b3I8T0JKRUNUPiB7XG4gIHJldHVybiB2YWxpZGF0b3IoYXN5bmMgdmFsdWUgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHN0YW5kYXJkU2NoZW1hWyd+c3RhbmRhcmQnXS52YWxpZGF0ZSh2YWx1ZSk7XG5cbiAgICByZXR1cm4gcmVzdWx0Lmlzc3VlcyA9PSBudWxsXG4gICAgICA/IHsgc3VjY2VzczogdHJ1ZSwgdmFsdWU6IHJlc3VsdC52YWx1ZSB9XG4gICAgICA6IHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogbmV3IFR5cGVWYWxpZGF0aW9uRXJyb3Ioe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBjYXVzZTogcmVzdWx0Lmlzc3VlcyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfTtcbiAgfSk7XG59XG4iLCAiaW1wb3J0IHtcbiAgRXZlbnRTb3VyY2VNZXNzYWdlLFxuICBFdmVudFNvdXJjZVBhcnNlclN0cmVhbSxcbn0gZnJvbSAnZXZlbnRzb3VyY2UtcGFyc2VyL3N0cmVhbSc7XG5pbXBvcnQgeyBab2RUeXBlIH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IFBhcnNlUmVzdWx0LCBzYWZlUGFyc2VKU09OIH0gZnJvbSAnLi9wYXJzZS1qc29uJztcblxuLyoqXG4gKiBQYXJzZXMgYSBKU09OIGV2ZW50IHN0cmVhbSBpbnRvIGEgc3RyZWFtIG9mIHBhcnNlZCBKU09OIG9iamVjdHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25FdmVudFN0cmVhbTxUPih7XG4gIHN0cmVhbSxcbiAgc2NoZW1hLFxufToge1xuICBzdHJlYW06IFJlYWRhYmxlU3RyZWFtPFVpbnQ4QXJyYXk+O1xuICBzY2hlbWE6IFpvZFR5cGU8VD47XG59KTogUmVhZGFibGVTdHJlYW08UGFyc2VSZXN1bHQ8VD4+IHtcbiAgcmV0dXJuIHN0cmVhbVxuICAgIC5waXBlVGhyb3VnaChuZXcgVGV4dERlY29kZXJTdHJlYW0oKSlcbiAgICAucGlwZVRocm91Z2gobmV3IEV2ZW50U291cmNlUGFyc2VyU3RyZWFtKCkpXG4gICAgLnBpcGVUaHJvdWdoKFxuICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxFdmVudFNvdXJjZU1lc3NhZ2UsIFBhcnNlUmVzdWx0PFQ+Pih7XG4gICAgICAgIGFzeW5jIHRyYW5zZm9ybSh7IGRhdGEgfSwgY29udHJvbGxlcikge1xuICAgICAgICAgIC8vIGlnbm9yZSB0aGUgJ0RPTkUnIGV2ZW50IHRoYXQgZS5nLiBPcGVuQUkgc2VuZHM6XG4gICAgICAgICAgaWYgKGRhdGEgPT09ICdbRE9ORV0nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGF3YWl0IHNhZmVQYXJzZUpTT04oeyB0ZXh0OiBkYXRhLCBzY2hlbWEgfSkpO1xuICAgICAgICB9LFxuICAgICAgfSksXG4gICAgKTtcbn1cbiIsICJpbXBvcnQgeyBJbnZhbGlkQXJndW1lbnRFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgc2FmZVZhbGlkYXRlVHlwZXMgfSBmcm9tICcuL3ZhbGlkYXRlLXR5cGVzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QvdjQnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VQcm92aWRlck9wdGlvbnM8VD4oe1xuICBwcm92aWRlcixcbiAgcHJvdmlkZXJPcHRpb25zLFxuICBzY2hlbWEsXG59OiB7XG4gIHByb3ZpZGVyOiBzdHJpbmc7XG4gIHByb3ZpZGVyT3B0aW9uczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gfCB1bmRlZmluZWQ7XG4gIHNjaGVtYTogei5jb3JlLiRab2RUeXBlPFQsIGFueT47XG59KTogUHJvbWlzZTxUIHwgdW5kZWZpbmVkPiB7XG4gIGlmIChwcm92aWRlck9wdGlvbnM/Lltwcm92aWRlcl0gPT0gbnVsbCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb25zdCBwYXJzZWRQcm92aWRlck9wdGlvbnMgPSBhd2FpdCBzYWZlVmFsaWRhdGVUeXBlczxUIHwgdW5kZWZpbmVkPih7XG4gICAgdmFsdWU6IHByb3ZpZGVyT3B0aW9uc1twcm92aWRlcl0sXG4gICAgc2NoZW1hLFxuICB9KTtcblxuICBpZiAoIXBhcnNlZFByb3ZpZGVyT3B0aW9ucy5zdWNjZXNzKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgIGFyZ3VtZW50OiAncHJvdmlkZXJPcHRpb25zJyxcbiAgICAgIG1lc3NhZ2U6IGBpbnZhbGlkICR7cHJvdmlkZXJ9IHByb3ZpZGVyIG9wdGlvbnNgLFxuICAgICAgY2F1c2U6IHBhcnNlZFByb3ZpZGVyT3B0aW9ucy5lcnJvcixcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBwYXJzZWRQcm92aWRlck9wdGlvbnMudmFsdWU7XG59XG4iLCAiaW1wb3J0IHsgQVBJQ2FsbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBleHRyYWN0UmVzcG9uc2VIZWFkZXJzIH0gZnJvbSAnLi9leHRyYWN0LXJlc3BvbnNlLWhlYWRlcnMnO1xuaW1wb3J0IHsgRmV0Y2hGdW5jdGlvbiB9IGZyb20gJy4vZmV0Y2gtZnVuY3Rpb24nO1xuaW1wb3J0IHsgaGFuZGxlRmV0Y2hFcnJvciB9IGZyb20gJy4vaGFuZGxlLWZldGNoLWVycm9yJztcbmltcG9ydCB7IGlzQWJvcnRFcnJvciB9IGZyb20gJy4vaXMtYWJvcnQtZXJyb3InO1xuaW1wb3J0IHsgcmVtb3ZlVW5kZWZpbmVkRW50cmllcyB9IGZyb20gJy4vcmVtb3ZlLXVuZGVmaW5lZC1lbnRyaWVzJztcbmltcG9ydCB7IFJlc3BvbnNlSGFuZGxlciB9IGZyb20gJy4vcmVzcG9uc2UtaGFuZGxlcic7XG5cbi8vIHVzZSBmdW5jdGlvbiB0byBhbGxvdyBmb3IgbW9ja2luZyBpbiB0ZXN0czpcbmNvbnN0IGdldE9yaWdpbmFsRmV0Y2ggPSAoKSA9PiBnbG9iYWxUaGlzLmZldGNoO1xuXG5leHBvcnQgY29uc3QgcG9zdEpzb25Ub0FwaSA9IGFzeW5jIDxUPih7XG4gIHVybCxcbiAgaGVhZGVycyxcbiAgYm9keSxcbiAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyLFxuICBhYm9ydFNpZ25hbCxcbiAgZmV0Y2gsXG59OiB7XG4gIHVybDogc3RyaW5nO1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPjtcbiAgYm9keTogdW5rbm93bjtcbiAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyOiBSZXNwb25zZUhhbmRsZXI8QVBJQ2FsbEVycm9yPjtcbiAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPFQ+O1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuICBmZXRjaD86IEZldGNoRnVuY3Rpb247XG59KSA9PlxuICBwb3N0VG9BcGkoe1xuICAgIHVybCxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgLi4uaGVhZGVycyxcbiAgICB9LFxuICAgIGJvZHk6IHtcbiAgICAgIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgdmFsdWVzOiBib2R5LFxuICAgIH0sXG4gICAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICAgIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgZmV0Y2gsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgcG9zdEZvcm1EYXRhVG9BcGkgPSBhc3luYyA8VD4oe1xuICB1cmwsXG4gIGhlYWRlcnMsXG4gIGZvcm1EYXRhLFxuICBmYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXIsXG4gIGFib3J0U2lnbmFsLFxuICBmZXRjaCxcbn06IHtcbiAgdXJsOiBzdHJpbmc7XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+O1xuICBmb3JtRGF0YTogRm9ybURhdGE7XG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPEFQSUNhbGxFcnJvcj47XG4gIHN1Y2Nlc3NmdWxSZXNwb25zZUhhbmRsZXI6IFJlc3BvbnNlSGFuZGxlcjxUPjtcbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgZmV0Y2g/OiBGZXRjaEZ1bmN0aW9uO1xufSkgPT5cbiAgcG9zdFRvQXBpKHtcbiAgICB1cmwsXG4gICAgaGVhZGVycyxcbiAgICBib2R5OiB7XG4gICAgICBjb250ZW50OiBmb3JtRGF0YSxcbiAgICAgIHZhbHVlczogT2JqZWN0LmZyb21FbnRyaWVzKChmb3JtRGF0YSBhcyBhbnkpLmVudHJpZXMoKSksXG4gICAgfSxcbiAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXIsXG4gICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcixcbiAgICBhYm9ydFNpZ25hbCxcbiAgICBmZXRjaCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBwb3N0VG9BcGkgPSBhc3luYyA8VD4oe1xuICB1cmwsXG4gIGhlYWRlcnMgPSB7fSxcbiAgYm9keSxcbiAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcixcbiAgZmFpbGVkUmVzcG9uc2VIYW5kbGVyLFxuICBhYm9ydFNpZ25hbCxcbiAgZmV0Y2ggPSBnZXRPcmlnaW5hbEZldGNoKCksXG59OiB7XG4gIHVybDogc3RyaW5nO1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPjtcbiAgYm9keToge1xuICAgIGNvbnRlbnQ6IHN0cmluZyB8IEZvcm1EYXRhIHwgVWludDhBcnJheTtcbiAgICB2YWx1ZXM6IHVua25vd247XG4gIH07XG4gIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPEVycm9yPjtcbiAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogUmVzcG9uc2VIYW5kbGVyPFQ+O1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuICBmZXRjaD86IEZldGNoRnVuY3Rpb247XG59KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogcmVtb3ZlVW5kZWZpbmVkRW50cmllcyhoZWFkZXJzKSxcbiAgICAgIGJvZHk6IGJvZHkuY29udGVudCxcbiAgICAgIHNpZ25hbDogYWJvcnRTaWduYWwsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGxldCBlcnJvckluZm9ybWF0aW9uOiB7XG4gICAgICAgIHZhbHVlOiBFcnJvcjtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDtcbiAgICAgIH07XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGVycm9ySW5mb3JtYXRpb24gPSBhd2FpdCBmYWlsZWRSZXNwb25zZUhhbmRsZXIoe1xuICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczogYm9keS52YWx1ZXMsXG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKGlzQWJvcnRFcnJvcihlcnJvcikgfHwgQVBJQ2FsbEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpKSB7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHByb2Nlc3MgZXJyb3IgcmVzcG9uc2UnLFxuICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczogYm9keS52YWx1ZXMsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBlcnJvckluZm9ybWF0aW9uLnZhbHVlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcih7XG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiBib2R5LnZhbHVlcyxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBpZiAoaXNBYm9ydEVycm9yKGVycm9yKSB8fCBBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBwcm9jZXNzIHN1Y2Nlc3NmdWwgcmVzcG9uc2UnLFxuICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzOiBib2R5LnZhbHVlcyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBoYW5kbGVGZXRjaEVycm9yKHsgZXJyb3IsIHVybCwgcmVxdWVzdEJvZHlWYWx1ZXM6IGJvZHkudmFsdWVzIH0pO1xuICB9XG59O1xuIiwgImltcG9ydCB7IEpTT05WYWx1ZSwgTGFuZ3VhZ2VNb2RlbFYyVG9vbFJlc3VsdFBhcnQgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IEZsZXhpYmxlU2NoZW1hIH0gZnJvbSAnLi4vc2NoZW1hJztcbmltcG9ydCB7IE1vZGVsTWVzc2FnZSB9IGZyb20gJy4vbW9kZWwtbWVzc2FnZSc7XG5pbXBvcnQgeyBQcm92aWRlck9wdGlvbnMgfSBmcm9tICcuL3Byb3ZpZGVyLW9wdGlvbnMnO1xuXG4vKipcbiAqIEFkZGl0aW9uYWwgb3B0aW9ucyB0aGF0IGFyZSBzZW50IGludG8gZWFjaCB0b29sIGNhbGwuXG4gKi9cbi8vIFRPRE8gQUkgU0RLIDY6IHJlbmFtZSB0byBUb29sRXhlY3V0aW9uT3B0aW9uc1xuZXhwb3J0IGludGVyZmFjZSBUb29sQ2FsbE9wdGlvbnMge1xuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSB0b29sIGNhbGwuIFlvdSBjYW4gdXNlIGl0IGUuZy4gd2hlbiBzZW5kaW5nIHRvb2wtY2FsbCByZWxhdGVkIGluZm9ybWF0aW9uIHdpdGggc3RyZWFtIGRhdGEuXG4gICAqL1xuICB0b29sQ2FsbElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIE1lc3NhZ2VzIHRoYXQgd2VyZSBzZW50IHRvIHRoZSBsYW5ndWFnZSBtb2RlbCB0byBpbml0aWF0ZSB0aGUgcmVzcG9uc2UgdGhhdCBjb250YWluZWQgdGhlIHRvb2wgY2FsbC5cbiAgICogVGhlIG1lc3NhZ2VzICoqZG8gbm90KiogaW5jbHVkZSB0aGUgc3lzdGVtIHByb21wdCBub3IgdGhlIGFzc2lzdGFudCByZXNwb25zZSB0aGF0IGNvbnRhaW5lZCB0aGUgdG9vbCBjYWxsLlxuICAgKi9cbiAgbWVzc2FnZXM6IE1vZGVsTWVzc2FnZVtdO1xuXG4gIC8qKlxuICAgKiBBbiBvcHRpb25hbCBhYm9ydCBzaWduYWwgdGhhdCBpbmRpY2F0ZXMgdGhhdCB0aGUgb3ZlcmFsbCBvcGVyYXRpb24gc2hvdWxkIGJlIGFib3J0ZWQuXG4gICAqL1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuXG4gIC8qKlxuICAgKiBBZGRpdGlvbmFsIGNvbnRleHQuXG4gICAqXG4gICAqIEV4cGVyaW1lbnRhbCAoY2FuIGJyZWFrIGluIHBhdGNoIHJlbGVhc2VzKS5cbiAgICovXG4gIGV4cGVyaW1lbnRhbF9jb250ZXh0PzogdW5rbm93bjtcbn1cblxuZXhwb3J0IHR5cGUgVG9vbEV4ZWN1dGVGdW5jdGlvbjxJTlBVVCwgT1VUUFVUPiA9IChcbiAgaW5wdXQ6IElOUFVULFxuICBvcHRpb25zOiBUb29sQ2FsbE9wdGlvbnMsXG4pID0+IEFzeW5jSXRlcmFibGU8T1VUUFVUPiB8IFByb21pc2VMaWtlPE9VVFBVVD4gfCBPVVRQVVQ7XG5cbi8vIDAgZXh0ZW5kcyAxICYgTiBjaGVja3MgZm9yIGFueVxuLy8gW05dIGV4dGVuZHMgW25ldmVyXSBjaGVja3MgZm9yIG5ldmVyXG50eXBlIE5ldmVyT3B0aW9uYWw8TiwgVD4gPSAwIGV4dGVuZHMgMSAmIE5cbiAgPyBQYXJ0aWFsPFQ+XG4gIDogW05dIGV4dGVuZHMgW25ldmVyXVxuICAgID8gUGFydGlhbDxSZWNvcmQ8a2V5b2YgVCwgdW5kZWZpbmVkPj5cbiAgICA6IFQ7XG5cbi8qKlxuQSB0b29sIGNvbnRhaW5zIHRoZSBkZXNjcmlwdGlvbiBhbmQgdGhlIHNjaGVtYSBvZiB0aGUgaW5wdXQgdGhhdCB0aGUgdG9vbCBleHBlY3RzLlxuVGhpcyBlbmFibGVzIHRoZSBsYW5ndWFnZSBtb2RlbCB0byBnZW5lcmF0ZSB0aGUgaW5wdXQuXG5cblRoZSB0b29sIGNhbiBhbHNvIGNvbnRhaW4gYW4gb3B0aW9uYWwgZXhlY3V0ZSBmdW5jdGlvbiBmb3IgdGhlIGFjdHVhbCBleGVjdXRpb24gZnVuY3Rpb24gb2YgdGhlIHRvb2wuXG4gKi9cbmV4cG9ydCB0eXBlIFRvb2w8XG4gIElOUFVUIGV4dGVuZHMgSlNPTlZhbHVlIHwgdW5rbm93biB8IG5ldmVyID0gYW55LFxuICBPVVRQVVQgZXh0ZW5kcyBKU09OVmFsdWUgfCB1bmtub3duIHwgbmV2ZXIgPSBhbnksXG4+ID0ge1xuICAvKipcbkFuIG9wdGlvbmFsIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIHRvb2wgZG9lcy5cbldpbGwgYmUgdXNlZCBieSB0aGUgbGFuZ3VhZ2UgbW9kZWwgdG8gZGVjaWRlIHdoZXRoZXIgdG8gdXNlIHRoZSB0b29sLlxuTm90IHVzZWQgZm9yIHByb3ZpZGVyLWRlZmluZWQgdG9vbHMuXG4gICAqL1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcblxuICAvKipcbkFkZGl0aW9uYWwgcHJvdmlkZXItc3BlY2lmaWMgbWV0YWRhdGEuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG50byB0aGUgcHJvdmlkZXIgZnJvbSB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbmZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cbiAgICovXG4gIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcblxuICAvKipcblRoZSBzY2hlbWEgb2YgdGhlIGlucHV0IHRoYXQgdGhlIHRvb2wgZXhwZWN0cy4gVGhlIGxhbmd1YWdlIG1vZGVsIHdpbGwgdXNlIHRoaXMgdG8gZ2VuZXJhdGUgdGhlIGlucHV0LlxuSXQgaXMgYWxzbyB1c2VkIHRvIHZhbGlkYXRlIHRoZSBvdXRwdXQgb2YgdGhlIGxhbmd1YWdlIG1vZGVsLlxuVXNlIGRlc2NyaXB0aW9ucyB0byBtYWtlIHRoZSBpbnB1dCB1bmRlcnN0YW5kYWJsZSBmb3IgdGhlIGxhbmd1YWdlIG1vZGVsLlxuICAgKi9cbiAgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPElOUFVUPjtcblxuICAvKipcbiAgICogT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgYXJndW1lbnQgc3RyZWFtaW5nIHN0YXJ0cy5cbiAgICogT25seSBjYWxsZWQgd2hlbiB0aGUgdG9vbCBpcyB1c2VkIGluIGEgc3RyZWFtaW5nIGNvbnRleHQuXG4gICAqL1xuICBvbklucHV0U3RhcnQ/OiAob3B0aW9uczogVG9vbENhbGxPcHRpb25zKSA9PiB2b2lkIHwgUHJvbWlzZUxpa2U8dm9pZD47XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gYW4gYXJndW1lbnQgc3RyZWFtaW5nIGRlbHRhIGlzIGF2YWlsYWJsZS5cbiAgICogT25seSBjYWxsZWQgd2hlbiB0aGUgdG9vbCBpcyB1c2VkIGluIGEgc3RyZWFtaW5nIGNvbnRleHQuXG4gICAqL1xuICBvbklucHV0RGVsdGE/OiAoXG4gICAgb3B0aW9uczogeyBpbnB1dFRleHREZWx0YTogc3RyaW5nIH0gJiBUb29sQ2FsbE9wdGlvbnMsXG4gICkgPT4gdm9pZCB8IFByb21pc2VMaWtlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIGEgdG9vbCBjYWxsIGNhbiBiZSBzdGFydGVkLFxuICAgKiBldmVuIGlmIHRoZSBleGVjdXRlIGZ1bmN0aW9uIGlzIG5vdCBwcm92aWRlZC5cbiAgICovXG4gIG9uSW5wdXRBdmFpbGFibGU/OiAoXG4gICAgb3B0aW9uczoge1xuICAgICAgaW5wdXQ6IFtJTlBVVF0gZXh0ZW5kcyBbbmV2ZXJdID8gdW5kZWZpbmVkIDogSU5QVVQ7XG4gICAgfSAmIFRvb2xDYWxsT3B0aW9ucyxcbiAgKSA9PiB2b2lkIHwgUHJvbWlzZUxpa2U8dm9pZD47XG59ICYgTmV2ZXJPcHRpb25hbDxcbiAgT1VUUFVULFxuICB7XG4gICAgLyoqXG5PcHRpb25hbCBjb252ZXJzaW9uIGZ1bmN0aW9uIHRoYXQgbWFwcyB0aGUgdG9vbCByZXN1bHQgdG8gYW4gb3V0cHV0IHRoYXQgY2FuIGJlIHVzZWQgYnkgdGhlIGxhbmd1YWdlIG1vZGVsLlxuXG5JZiBub3QgcHJvdmlkZWQsIHRoZSB0b29sIHJlc3VsdCB3aWxsIGJlIHNlbnQgYXMgYSBKU09OIG9iamVjdC5cbiAgICAgICovXG4gICAgdG9Nb2RlbE91dHB1dD86IChvdXRwdXQ6IE9VVFBVVCkgPT4gTGFuZ3VhZ2VNb2RlbFYyVG9vbFJlc3VsdFBhcnRbJ291dHB1dCddO1xuICB9ICYgKFxuICAgIHwge1xuICAgICAgICAvKipcbkFuIGFzeW5jIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdpdGggdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSB0b29sIGNhbGwgYW5kIHByb2R1Y2VzIGEgcmVzdWx0LlxuSWYgbm90IHByb3ZpZGVkLCB0aGUgdG9vbCB3aWxsIG5vdCBiZSBleGVjdXRlZCBhdXRvbWF0aWNhbGx5LlxuXG5AYXJncyBpcyB0aGUgaW5wdXQgb2YgdGhlIHRvb2wgY2FsbC5cbkBvcHRpb25zLmFib3J0U2lnbmFsIGlzIGEgc2lnbmFsIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWJvcnQgdGhlIHRvb2wgY2FsbC5cbiAgICAgICovXG4gICAgICAgIGV4ZWN1dGU6IFRvb2xFeGVjdXRlRnVuY3Rpb248SU5QVVQsIE9VVFBVVD47XG5cbiAgICAgICAgb3V0cHV0U2NoZW1hPzogRmxleGlibGVTY2hlbWE8T1VUUFVUPjtcbiAgICAgIH1cbiAgICB8IHtcbiAgICAgICAgb3V0cHV0U2NoZW1hOiBGbGV4aWJsZVNjaGVtYTxPVVRQVVQ+O1xuXG4gICAgICAgIGV4ZWN1dGU/OiBuZXZlcjtcbiAgICAgIH1cbiAgKVxuPiAmXG4gIChcbiAgICB8IHtcbiAgICAgICAgLyoqXG5Ub29sIHdpdGggdXNlci1kZWZpbmVkIGlucHV0IGFuZCBvdXRwdXQgc2NoZW1hcy5cbiAgICAgKi9cbiAgICAgICAgdHlwZT86IHVuZGVmaW5lZCB8ICdmdW5jdGlvbic7XG4gICAgICB9XG4gICAgfCB7XG4gICAgICAgIC8qKlxuVG9vbCB0aGF0IGlzIGRlZmluZWQgYXQgcnVudGltZSAoZS5nLiBhbiBNQ1AgdG9vbCkuXG5UaGUgdHlwZXMgb2YgaW5wdXQgYW5kIG91dHB1dCBhcmUgbm90IGtub3duIGF0IGRldmVsb3BtZW50IHRpbWUuXG4gICAgICAgKi9cbiAgICAgICAgdHlwZTogJ2R5bmFtaWMnO1xuICAgICAgfVxuICAgIHwge1xuICAgICAgICAvKipcblRvb2wgd2l0aCBwcm92aWRlci1kZWZpbmVkIGlucHV0IGFuZCBvdXRwdXQgc2NoZW1hcy5cbiAgICAgKi9cbiAgICAgICAgdHlwZTogJ3Byb3ZpZGVyLWRlZmluZWQnO1xuXG4gICAgICAgIC8qKlxuVGhlIElEIG9mIHRoZSB0b29sLiBTaG91bGQgZm9sbG93IHRoZSBmb3JtYXQgYDxwcm92aWRlci1uYW1lPi48dW5pcXVlLXRvb2wtbmFtZT5gLlxuICAgKi9cbiAgICAgICAgaWQ6IGAke3N0cmluZ30uJHtzdHJpbmd9YDtcblxuICAgICAgICAvKipcblRoZSBuYW1lIG9mIHRoZSB0b29sIHRoYXQgdGhlIHVzZXIgbXVzdCB1c2UgaW4gdGhlIHRvb2wgc2V0LlxuICovXG4gICAgICAgIG5hbWU6IHN0cmluZztcblxuICAgICAgICAvKipcblRoZSBhcmd1bWVudHMgZm9yIGNvbmZpZ3VyaW5nIHRoZSB0b29sLiBNdXN0IG1hdGNoIHRoZSBleHBlY3RlZCBhcmd1bWVudHMgZGVmaW5lZCBieSB0aGUgcHJvdmlkZXIgZm9yIHRoaXMgdG9vbC5cbiAgICAgKi9cbiAgICAgICAgYXJnczogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICB9XG4gICk7XG5cbi8qKlxuICogSW5mZXIgdGhlIGlucHV0IHR5cGUgb2YgYSB0b29sLlxuICovXG5leHBvcnQgdHlwZSBJbmZlclRvb2xJbnB1dDxUT09MIGV4dGVuZHMgVG9vbD4gPVxuICBUT09MIGV4dGVuZHMgVG9vbDxpbmZlciBJTlBVVCwgYW55PiA/IElOUFVUIDogbmV2ZXI7XG5cbi8qKlxuICogSW5mZXIgdGhlIG91dHB1dCB0eXBlIG9mIGEgdG9vbC5cbiAqL1xuZXhwb3J0IHR5cGUgSW5mZXJUb29sT3V0cHV0PFRPT0wgZXh0ZW5kcyBUb29sPiA9XG4gIFRPT0wgZXh0ZW5kcyBUb29sPGFueSwgaW5mZXIgT1VUUFVUPiA/IE9VVFBVVCA6IG5ldmVyO1xuXG4vKipcbkhlbHBlciBmdW5jdGlvbiBmb3IgaW5mZXJyaW5nIHRoZSBleGVjdXRlIGFyZ3Mgb2YgYSB0b29sLlxuICovXG4vLyBOb3RlOiBvdmVybG9hZCBvcmRlciBpcyBpbXBvcnRhbnQgZm9yIGF1dG8tY29tcGxldGlvblxuZXhwb3J0IGZ1bmN0aW9uIHRvb2w8SU5QVVQsIE9VVFBVVD4oXG4gIHRvb2w6IFRvb2w8SU5QVVQsIE9VVFBVVD4sXG4pOiBUb29sPElOUFVULCBPVVRQVVQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHRvb2w8SU5QVVQ+KHRvb2w6IFRvb2w8SU5QVVQsIG5ldmVyPik6IFRvb2w8SU5QVVQsIG5ldmVyPjtcbmV4cG9ydCBmdW5jdGlvbiB0b29sPE9VVFBVVD4odG9vbDogVG9vbDxuZXZlciwgT1VUUFVUPik6IFRvb2w8bmV2ZXIsIE9VVFBVVD47XG5leHBvcnQgZnVuY3Rpb24gdG9vbCh0b29sOiBUb29sPG5ldmVyLCBuZXZlcj4pOiBUb29sPG5ldmVyLCBuZXZlcj47XG5leHBvcnQgZnVuY3Rpb24gdG9vbCh0b29sOiBhbnkpOiBhbnkge1xuICByZXR1cm4gdG9vbDtcbn1cblxuLyoqXG5IZWxwZXIgZnVuY3Rpb24gZm9yIGRlZmluaW5nIGEgZHluYW1pYyB0b29sLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZHluYW1pY1Rvb2wodG9vbDoge1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuICBpbnB1dFNjaGVtYTogRmxleGlibGVTY2hlbWE8dW5rbm93bj47XG4gIGV4ZWN1dGU6IFRvb2xFeGVjdXRlRnVuY3Rpb248dW5rbm93biwgdW5rbm93bj47XG4gIHRvTW9kZWxPdXRwdXQ/OiAob3V0cHV0OiB1bmtub3duKSA9PiBMYW5ndWFnZU1vZGVsVjJUb29sUmVzdWx0UGFydFsnb3V0cHV0J107XG59KTogVG9vbDx1bmtub3duLCB1bmtub3duPiAmIHtcbiAgdHlwZTogJ2R5bmFtaWMnO1xufSB7XG4gIHJldHVybiB7IC4uLnRvb2wsIHR5cGU6ICdkeW5hbWljJyB9O1xufVxuIiwgImltcG9ydCB7IHRvb2wsIFRvb2wsIFRvb2xFeGVjdXRlRnVuY3Rpb24gfSBmcm9tICcuL3R5cGVzL3Rvb2wnO1xuaW1wb3J0IHsgRmxleGlibGVTY2hlbWEgfSBmcm9tICcuL3NjaGVtYSc7XG5cbmV4cG9ydCB0eXBlIFByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5PElOUFVULCBBUkdTIGV4dGVuZHMgb2JqZWN0PiA9IDxPVVRQVVQ+KFxuICBvcHRpb25zOiBBUkdTICYge1xuICAgIGV4ZWN1dGU/OiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuICAgIHRvTW9kZWxPdXRwdXQ/OiBUb29sPElOUFVULCBPVVRQVVQ+Wyd0b01vZGVsT3V0cHV0J107XG4gICAgb25JbnB1dFN0YXJ0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dFN0YXJ0J107XG4gICAgb25JbnB1dERlbHRhPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dERlbHRhJ107XG4gICAgb25JbnB1dEF2YWlsYWJsZT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRBdmFpbGFibGUnXTtcbiAgfSxcbikgPT4gVG9vbDxJTlBVVCwgT1VUUFVUPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5PElOUFVULCBBUkdTIGV4dGVuZHMgb2JqZWN0Pih7XG4gIGlkLFxuICBuYW1lLFxuICBpbnB1dFNjaGVtYSxcbn06IHtcbiAgaWQ6IGAke3N0cmluZ30uJHtzdHJpbmd9YDtcbiAgbmFtZTogc3RyaW5nO1xuICBpbnB1dFNjaGVtYTogRmxleGlibGVTY2hlbWE8SU5QVVQ+O1xufSk6IFByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5PElOUFVULCBBUkdTPiB7XG4gIHJldHVybiA8T1VUUFVUPih7XG4gICAgZXhlY3V0ZSxcbiAgICBvdXRwdXRTY2hlbWEsXG4gICAgdG9Nb2RlbE91dHB1dCxcbiAgICBvbklucHV0U3RhcnQsXG4gICAgb25JbnB1dERlbHRhLFxuICAgIG9uSW5wdXRBdmFpbGFibGUsXG4gICAgLi4uYXJnc1xuICB9OiBBUkdTICYge1xuICAgIGV4ZWN1dGU/OiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuICAgIG91dHB1dFNjaGVtYT86IEZsZXhpYmxlU2NoZW1hPE9VVFBVVD47XG4gICAgdG9Nb2RlbE91dHB1dD86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ3RvTW9kZWxPdXRwdXQnXTtcbiAgICBvbklucHV0U3RhcnQ/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0U3RhcnQnXTtcbiAgICBvbklucHV0RGVsdGE/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0RGVsdGEnXTtcbiAgICBvbklucHV0QXZhaWxhYmxlPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dEF2YWlsYWJsZSddO1xuICB9KTogVG9vbDxJTlBVVCwgT1VUUFVUPiA9PlxuICAgIHRvb2woe1xuICAgICAgdHlwZTogJ3Byb3ZpZGVyLWRlZmluZWQnLFxuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgYXJncyxcbiAgICAgIGlucHV0U2NoZW1hLFxuICAgICAgb3V0cHV0U2NoZW1hLFxuICAgICAgZXhlY3V0ZSxcbiAgICAgIHRvTW9kZWxPdXRwdXQsXG4gICAgICBvbklucHV0U3RhcnQsXG4gICAgICBvbklucHV0RGVsdGEsXG4gICAgICBvbklucHV0QXZhaWxhYmxlLFxuICAgIH0pO1xufVxuXG5leHBvcnQgdHlwZSBQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeVdpdGhPdXRwdXRTY2hlbWE8XG4gIElOUFVULFxuICBPVVRQVVQsXG4gIEFSR1MgZXh0ZW5kcyBvYmplY3QsXG4+ID0gKFxuICBvcHRpb25zOiBBUkdTICYge1xuICAgIGV4ZWN1dGU/OiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuICAgIHRvTW9kZWxPdXRwdXQ/OiBUb29sPElOUFVULCBPVVRQVVQ+Wyd0b01vZGVsT3V0cHV0J107XG4gICAgb25JbnB1dFN0YXJ0PzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dFN0YXJ0J107XG4gICAgb25JbnB1dERlbHRhPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dERlbHRhJ107XG4gICAgb25JbnB1dEF2YWlsYWJsZT86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ29uSW5wdXRBdmFpbGFibGUnXTtcbiAgfSxcbikgPT4gVG9vbDxJTlBVVCwgT1VUUFVUPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5V2l0aE91dHB1dFNjaGVtYTxcbiAgSU5QVVQsXG4gIE9VVFBVVCxcbiAgQVJHUyBleHRlbmRzIG9iamVjdCxcbj4oe1xuICBpZCxcbiAgbmFtZSxcbiAgaW5wdXRTY2hlbWEsXG4gIG91dHB1dFNjaGVtYSxcbn06IHtcbiAgaWQ6IGAke3N0cmluZ30uJHtzdHJpbmd9YDtcbiAgbmFtZTogc3RyaW5nO1xuICBpbnB1dFNjaGVtYTogRmxleGlibGVTY2hlbWE8SU5QVVQ+O1xuICBvdXRwdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPE9VVFBVVD47XG59KTogUHJvdmlkZXJEZWZpbmVkVG9vbEZhY3RvcnlXaXRoT3V0cHV0U2NoZW1hPElOUFVULCBPVVRQVVQsIEFSR1M+IHtcbiAgcmV0dXJuICh7XG4gICAgZXhlY3V0ZSxcbiAgICB0b01vZGVsT3V0cHV0LFxuICAgIG9uSW5wdXRTdGFydCxcbiAgICBvbklucHV0RGVsdGEsXG4gICAgb25JbnB1dEF2YWlsYWJsZSxcbiAgICAuLi5hcmdzXG4gIH06IEFSR1MgJiB7XG4gICAgZXhlY3V0ZT86IFRvb2xFeGVjdXRlRnVuY3Rpb248SU5QVVQsIE9VVFBVVD47XG4gICAgdG9Nb2RlbE91dHB1dD86IFRvb2w8SU5QVVQsIE9VVFBVVD5bJ3RvTW9kZWxPdXRwdXQnXTtcbiAgICBvbklucHV0U3RhcnQ/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0U3RhcnQnXTtcbiAgICBvbklucHV0RGVsdGE/OiBUb29sPElOUFVULCBPVVRQVVQ+WydvbklucHV0RGVsdGEnXTtcbiAgICBvbklucHV0QXZhaWxhYmxlPzogVG9vbDxJTlBVVCwgT1VUUFVUPlsnb25JbnB1dEF2YWlsYWJsZSddO1xuICB9KTogVG9vbDxJTlBVVCwgT1VUUFVUPiA9PlxuICAgIHRvb2woe1xuICAgICAgdHlwZTogJ3Byb3ZpZGVyLWRlZmluZWQnLFxuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgYXJncyxcbiAgICAgIGlucHV0U2NoZW1hLFxuICAgICAgb3V0cHV0U2NoZW1hLFxuICAgICAgZXhlY3V0ZSxcbiAgICAgIHRvTW9kZWxPdXRwdXQsXG4gICAgICBvbklucHV0U3RhcnQsXG4gICAgICBvbklucHV0RGVsdGEsXG4gICAgICBvbklucHV0QXZhaWxhYmxlLFxuICAgIH0pO1xufVxuIiwgImV4cG9ydCB0eXBlIFJlc29sdmFibGU8VD4gPVxuICB8IFQgLy8gUmF3IHZhbHVlXG4gIHwgUHJvbWlzZTxUPiAvLyBQcm9taXNlIG9mIHZhbHVlXG4gIHwgKCgpID0+IFQpIC8vIEZ1bmN0aW9uIHJldHVybmluZyB2YWx1ZVxuICB8ICgoKSA9PiBQcm9taXNlPFQ+KTsgLy8gRnVuY3Rpb24gcmV0dXJuaW5nIHByb21pc2Ugb2YgdmFsdWVcblxuLyoqXG4gKiBSZXNvbHZlcyBhIHZhbHVlIHRoYXQgY291bGQgYmUgYSByYXcgdmFsdWUsIGEgUHJvbWlzZSwgYSBmdW5jdGlvbiByZXR1cm5pbmcgYSB2YWx1ZSxcbiAqIG9yIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgUHJvbWlzZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc29sdmU8VD4odmFsdWU6IFJlc29sdmFibGU8VD4pOiBQcm9taXNlPFQ+IHtcbiAgLy8gSWYgaXQncyBhIGZ1bmN0aW9uLCBjYWxsIGl0IHRvIGdldCB0aGUgdmFsdWUvcHJvbWlzZVxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFsdWUgPSAodmFsdWUgYXMgRnVuY3Rpb24pKCk7XG4gIH1cblxuICAvLyBPdGhlcndpc2UganVzdCByZXNvbHZlIHdoYXRldmVyIHdlIGdvdCAodmFsdWUgb3IgcHJvbWlzZSlcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZSBhcyBUKTtcbn1cbiIsICJpbXBvcnQgeyBBUElDYWxsRXJyb3IsIEVtcHR5UmVzcG9uc2VCb2R5RXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IFpvZFR5cGUgfSBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgZXh0cmFjdFJlc3BvbnNlSGVhZGVycyB9IGZyb20gJy4vZXh0cmFjdC1yZXNwb25zZS1oZWFkZXJzJztcbmltcG9ydCB7IHBhcnNlSlNPTiwgUGFyc2VSZXN1bHQsIHNhZmVQYXJzZUpTT04gfSBmcm9tICcuL3BhcnNlLWpzb24nO1xuaW1wb3J0IHsgcGFyc2VKc29uRXZlbnRTdHJlYW0gfSBmcm9tICcuL3BhcnNlLWpzb24tZXZlbnQtc3RyZWFtJztcblxuZXhwb3J0IHR5cGUgUmVzcG9uc2VIYW5kbGVyPFJFVFVSTl9UWVBFPiA9IChvcHRpb25zOiB7XG4gIHVybDogc3RyaW5nO1xuICByZXF1ZXN0Qm9keVZhbHVlczogdW5rbm93bjtcbiAgcmVzcG9uc2U6IFJlc3BvbnNlO1xufSkgPT4gUHJvbWlzZUxpa2U8e1xuICB2YWx1ZTogUkVUVVJOX1RZUEU7XG4gIHJhd1ZhbHVlPzogdW5rbm93bjtcbiAgcmVzcG9uc2VIZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbn0+O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyID1cbiAgPFQ+KHtcbiAgICBlcnJvclNjaGVtYSxcbiAgICBlcnJvclRvTWVzc2FnZSxcbiAgICBpc1JldHJ5YWJsZSxcbiAgfToge1xuICAgIGVycm9yU2NoZW1hOiBab2RUeXBlPFQ+O1xuICAgIGVycm9yVG9NZXNzYWdlOiAoZXJyb3I6IFQpID0+IHN0cmluZztcbiAgICBpc1JldHJ5YWJsZT86IChyZXNwb25zZTogUmVzcG9uc2UsIGVycm9yPzogVCkgPT4gYm9vbGVhbjtcbiAgfSk6IFJlc3BvbnNlSGFuZGxlcjxBUElDYWxsRXJyb3I+ID0+XG4gIGFzeW5jICh7IHJlc3BvbnNlLCB1cmwsIHJlcXVlc3RCb2R5VmFsdWVzIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZUJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gZXh0cmFjdFJlc3BvbnNlSGVhZGVycyhyZXNwb25zZSk7XG5cbiAgICAvLyBTb21lIHByb3ZpZGVycyByZXR1cm4gYW4gZW1wdHkgcmVzcG9uc2UgYm9keSBmb3Igc29tZSBlcnJvcnM6XG4gICAgaWYgKHJlc3BvbnNlQm9keS50cmltKCkgPT09ICcnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHZhbHVlOiBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICAgIHJlc3BvbnNlQm9keSxcbiAgICAgICAgICBpc1JldHJ5YWJsZTogaXNSZXRyeWFibGU/LihyZXNwb25zZSksXG4gICAgICAgIH0pLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyByZXNpbGllbnQgcGFyc2luZyBpbiBjYXNlIHRoZSByZXNwb25zZSBpcyBub3QgSlNPTiBvciBkb2VzIG5vdCBtYXRjaCB0aGUgc2NoZW1hOlxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXJzZWRFcnJvciA9IGF3YWl0IHBhcnNlSlNPTih7XG4gICAgICAgIHRleHQ6IHJlc3BvbnNlQm9keSxcbiAgICAgICAgc2NoZW1hOiBlcnJvclNjaGVtYSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHZhbHVlOiBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvclRvTWVzc2FnZShwYXJzZWRFcnJvciksXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgICAgcmVzcG9uc2VCb2R5LFxuICAgICAgICAgIGRhdGE6IHBhcnNlZEVycm9yLFxuICAgICAgICAgIGlzUmV0cnlhYmxlOiBpc1JldHJ5YWJsZT8uKHJlc3BvbnNlLCBwYXJzZWRFcnJvciksXG4gICAgICAgIH0pLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHZhbHVlOiBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICAgIHJlc3BvbnNlQm9keSxcbiAgICAgICAgICBpc1JldHJ5YWJsZTogaXNSZXRyeWFibGU/LihyZXNwb25zZSksXG4gICAgICAgIH0pLFxuICAgICAgfTtcbiAgICB9XG4gIH07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVFdmVudFNvdXJjZVJlc3BvbnNlSGFuZGxlciA9XG4gIDxUPihcbiAgICBjaHVua1NjaGVtYTogWm9kVHlwZTxUPixcbiAgKTogUmVzcG9uc2VIYW5kbGVyPFJlYWRhYmxlU3RyZWFtPFBhcnNlUmVzdWx0PFQ+Pj4gPT5cbiAgYXN5bmMgKHsgcmVzcG9uc2UgfTogeyByZXNwb25zZTogUmVzcG9uc2UgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuXG4gICAgaWYgKHJlc3BvbnNlLmJvZHkgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVtcHR5UmVzcG9uc2VCb2R5RXJyb3Ioe30pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICB2YWx1ZTogcGFyc2VKc29uRXZlbnRTdHJlYW0oe1xuICAgICAgICBzdHJlYW06IHJlc3BvbnNlLmJvZHksXG4gICAgICAgIHNjaGVtYTogY2h1bmtTY2hlbWEsXG4gICAgICB9KSxcbiAgICB9O1xuICB9O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlSnNvblN0cmVhbVJlc3BvbnNlSGFuZGxlciA9XG4gIDxUPihcbiAgICBjaHVua1NjaGVtYTogWm9kVHlwZTxUPixcbiAgKTogUmVzcG9uc2VIYW5kbGVyPFJlYWRhYmxlU3RyZWFtPFBhcnNlUmVzdWx0PFQ+Pj4gPT5cbiAgYXN5bmMgKHsgcmVzcG9uc2UgfTogeyByZXNwb25zZTogUmVzcG9uc2UgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuXG4gICAgaWYgKHJlc3BvbnNlLmJvZHkgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVtcHR5UmVzcG9uc2VCb2R5RXJyb3Ioe30pO1xuICAgIH1cblxuICAgIGxldCBidWZmZXIgPSAnJztcblxuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICB2YWx1ZTogcmVzcG9uc2UuYm9keS5waXBlVGhyb3VnaChuZXcgVGV4dERlY29kZXJTdHJlYW0oKSkucGlwZVRocm91Z2goXG4gICAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08c3RyaW5nLCBQYXJzZVJlc3VsdDxUPj4oe1xuICAgICAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVua1RleHQsIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGlmIChjaHVua1RleHQuZW5kc1dpdGgoJ1xcbicpKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShcbiAgICAgICAgICAgICAgICBhd2FpdCBzYWZlUGFyc2VKU09OKHtcbiAgICAgICAgICAgICAgICAgIHRleHQ6IGJ1ZmZlciArIGNodW5rVGV4dCxcbiAgICAgICAgICAgICAgICAgIHNjaGVtYTogY2h1bmtTY2hlbWEsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGJ1ZmZlciA9ICcnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYnVmZmVyICs9IGNodW5rVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICksXG4gICAgfTtcbiAgfTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgPVxuICA8VD4ocmVzcG9uc2VTY2hlbWE6IFpvZFR5cGU8VD4pOiBSZXNwb25zZUhhbmRsZXI8VD4gPT5cbiAgYXN5bmMgKHsgcmVzcG9uc2UsIHVybCwgcmVxdWVzdEJvZHlWYWx1ZXMgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcblxuICAgIGNvbnN0IHBhcnNlZFJlc3VsdCA9IGF3YWl0IHNhZmVQYXJzZUpTT04oe1xuICAgICAgdGV4dDogcmVzcG9uc2VCb2R5LFxuICAgICAgc2NoZW1hOiByZXNwb25zZVNjaGVtYSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IGV4dHJhY3RSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UpO1xuXG4gICAgaWYgKCFwYXJzZWRSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgdGhyb3cgbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIEpTT04gcmVzcG9uc2UnLFxuICAgICAgICBjYXVzZTogcGFyc2VkUmVzdWx0LmVycm9yLFxuICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgcmVzcG9uc2VCb2R5LFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiBwYXJzZWRSZXN1bHQudmFsdWUsXG4gICAgICByYXdWYWx1ZTogcGFyc2VkUmVzdWx0LnJhd1ZhbHVlLFxuICAgIH07XG4gIH07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVCaW5hcnlSZXNwb25zZUhhbmRsZXIgPVxuICAoKTogUmVzcG9uc2VIYW5kbGVyPFVpbnQ4QXJyYXk+ID0+XG4gIGFzeW5jICh7IHJlc3BvbnNlLCB1cmwsIHJlcXVlc3RCb2R5VmFsdWVzIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZUhlYWRlcnMgPSBleHRyYWN0UmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlKTtcblxuICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6ICdSZXNwb25zZSBib2R5IGlzIGVtcHR5JyxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlcyxcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHJlc3BvbnNlQm9keTogdW5kZWZpbmVkLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZUhlYWRlcnMsXG4gICAgICAgIHZhbHVlOiBuZXcgVWludDhBcnJheShidWZmZXIpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUNhbGxFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcmVhZCByZXNwb25zZSBhcyBhcnJheSBidWZmZXInLFxuICAgICAgICB1cmwsXG4gICAgICAgIHJlcXVlc3RCb2R5VmFsdWVzLFxuICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgcmVzcG9uc2VCb2R5OiB1bmRlZmluZWQsXG4gICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVN0YXR1c0NvZGVFcnJvclJlc3BvbnNlSGFuZGxlciA9XG4gICgpOiBSZXNwb25zZUhhbmRsZXI8QVBJQ2FsbEVycm9yPiA9PlxuICBhc3luYyAoeyByZXNwb25zZSwgdXJsLCByZXF1ZXN0Qm9keVZhbHVlcyB9KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gZXh0cmFjdFJlc3BvbnNlSGVhZGVycyhyZXNwb25zZSk7XG4gICAgY29uc3QgcmVzcG9uc2VCb2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgIHZhbHVlOiBuZXcgQVBJQ2FsbEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0Qm9keVZhbHVlczogcmVxdWVzdEJvZHlWYWx1ZXMgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICByZXNwb25zZUJvZHksXG4gICAgICB9KSxcbiAgICB9O1xuICB9O1xuIiwgImltcG9ydCB7IEpTT05TY2hlbWE3IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB6b2RUb0pzb25TY2hlbWEgZnJvbSAnem9kLXRvLWpzb24tc2NoZW1hJztcbmltcG9ydCB7IGpzb25TY2hlbWEsIFNjaGVtYSB9IGZyb20gJy4vc2NoZW1hJztcblxuZXhwb3J0IGZ1bmN0aW9uIHpvZDNTY2hlbWE8T0JKRUNUPihcbiAgem9kU2NoZW1hOiB6My5TY2hlbWE8T0JKRUNULCB6My5ab2RUeXBlRGVmLCBhbnk+LFxuICBvcHRpb25zPzoge1xuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgc3VwcG9ydCBmb3IgcmVmZXJlbmNlcyBpbiB0aGUgc2NoZW1hLlxuICAgICAqIFRoaXMgaXMgcmVxdWlyZWQgZm9yIHJlY3Vyc2l2ZSBzY2hlbWFzLCBlLmcuIHdpdGggYHoubGF6eWAuXG4gICAgICogSG93ZXZlciwgbm90IGFsbCBsYW5ndWFnZSBtb2RlbHMgYW5kIHByb3ZpZGVycyBzdXBwb3J0IHN1Y2ggcmVmZXJlbmNlcy5cbiAgICAgKiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgICAqL1xuICAgIHVzZVJlZmVyZW5jZXM/OiBib29sZWFuO1xuICB9LFxuKTogU2NoZW1hPE9CSkVDVD4ge1xuICAvLyBkZWZhdWx0IHRvIG5vIHJlZmVyZW5jZXMgKHRvIHN1cHBvcnQgb3BlbmFwaSBjb252ZXJzaW9uIGZvciBnb29nbGUpXG4gIGNvbnN0IHVzZVJlZmVyZW5jZXMgPSBvcHRpb25zPy51c2VSZWZlcmVuY2VzID8/IGZhbHNlO1xuXG4gIHJldHVybiBqc29uU2NoZW1hKFxuICAgIHpvZFRvSnNvblNjaGVtYSh6b2RTY2hlbWEsIHtcbiAgICAgICRyZWZTdHJhdGVneTogdXNlUmVmZXJlbmNlcyA/ICdyb290JyA6ICdub25lJyxcbiAgICAgIHRhcmdldDogJ2pzb25TY2hlbWE3JywgLy8gbm90ZTogb3BlbmFpIG1vZGUgYnJlYWtzIHZhcmlvdXMgZ2VtaW5pIGNvbnZlcnNpb25zXG4gICAgfSkgYXMgSlNPTlNjaGVtYTcsXG4gICAge1xuICAgICAgdmFsaWRhdGU6IGFzeW5jIHZhbHVlID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgem9kU2NoZW1hLnNhZmVQYXJzZUFzeW5jKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5zdWNjZXNzXG4gICAgICAgICAgPyB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiByZXN1bHQuZGF0YSB9XG4gICAgICAgICAgOiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogcmVzdWx0LmVycm9yIH07XG4gICAgICB9LFxuICAgIH0sXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB6b2Q0U2NoZW1hPE9CSkVDVD4oXG4gIHpvZFNjaGVtYTogejQuY29yZS4kWm9kVHlwZTxPQkpFQ1QsIGFueT4sXG4gIG9wdGlvbnM/OiB7XG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBzdXBwb3J0IGZvciByZWZlcmVuY2VzIGluIHRoZSBzY2hlbWEuXG4gICAgICogVGhpcyBpcyByZXF1aXJlZCBmb3IgcmVjdXJzaXZlIHNjaGVtYXMsIGUuZy4gd2l0aCBgei5sYXp5YC5cbiAgICAgKiBIb3dldmVyLCBub3QgYWxsIGxhbmd1YWdlIG1vZGVscyBhbmQgcHJvdmlkZXJzIHN1cHBvcnQgc3VjaCByZWZlcmVuY2VzLlxuICAgICAqIERlZmF1bHRzIHRvIGBmYWxzZWAuXG4gICAgICovXG4gICAgdXNlUmVmZXJlbmNlcz86IGJvb2xlYW47XG4gIH0sXG4pOiBTY2hlbWE8T0JKRUNUPiB7XG4gIC8vIGRlZmF1bHQgdG8gbm8gcmVmZXJlbmNlcyAodG8gc3VwcG9ydCBvcGVuYXBpIGNvbnZlcnNpb24gZm9yIGdvb2dsZSlcbiAgY29uc3QgdXNlUmVmZXJlbmNlcyA9IG9wdGlvbnM/LnVzZVJlZmVyZW5jZXMgPz8gZmFsc2U7XG5cbiAgY29uc3QgejRKU09OU2NoZW1hID0gejQudG9KU09OU2NoZW1hKHpvZFNjaGVtYSwge1xuICAgIHRhcmdldDogJ2RyYWZ0LTcnLFxuICAgIGlvOiAnb3V0cHV0JyxcbiAgICByZXVzZWQ6IHVzZVJlZmVyZW5jZXMgPyAncmVmJyA6ICdpbmxpbmUnLFxuICB9KSBhcyBKU09OU2NoZW1hNztcblxuICByZXR1cm4ganNvblNjaGVtYSh6NEpTT05TY2hlbWEsIHtcbiAgICB2YWxpZGF0ZTogYXN5bmMgdmFsdWUgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgejQuc2FmZVBhcnNlQXN5bmMoem9kU2NoZW1hLCB2YWx1ZSk7XG4gICAgICByZXR1cm4gcmVzdWx0LnN1Y2Nlc3NcbiAgICAgICAgPyB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiByZXN1bHQuZGF0YSB9XG4gICAgICAgIDogeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHJlc3VsdC5lcnJvciB9O1xuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNab2Q0U2NoZW1hKFxuICB6b2RTY2hlbWE6IHo0LmNvcmUuJFpvZFR5cGU8YW55LCBhbnk+IHwgejMuU2NoZW1hPGFueSwgejMuWm9kVHlwZURlZiwgYW55Pixcbik6IHpvZFNjaGVtYSBpcyB6NC5jb3JlLiRab2RUeXBlPGFueSwgYW55PiB7XG4gIC8vIGh0dHBzOi8vem9kLmRldi9saWJyYXJ5LWF1dGhvcnM/aWQ9aG93LXRvLXN1cHBvcnQtem9kLTMtYW5kLXpvZC00LXNpbXVsdGFuZW91c2x5XG4gIHJldHVybiAnX3pvZCcgaW4gem9kU2NoZW1hO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gem9kU2NoZW1hPE9CSkVDVD4oXG4gIHpvZFNjaGVtYTpcbiAgICB8IHo0LmNvcmUuJFpvZFR5cGU8T0JKRUNULCBhbnk+XG4gICAgfCB6My5TY2hlbWE8T0JKRUNULCB6My5ab2RUeXBlRGVmLCBhbnk+LFxuICBvcHRpb25zPzoge1xuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgc3VwcG9ydCBmb3IgcmVmZXJlbmNlcyBpbiB0aGUgc2NoZW1hLlxuICAgICAqIFRoaXMgaXMgcmVxdWlyZWQgZm9yIHJlY3Vyc2l2ZSBzY2hlbWFzLCBlLmcuIHdpdGggYHoubGF6eWAuXG4gICAgICogSG93ZXZlciwgbm90IGFsbCBsYW5ndWFnZSBtb2RlbHMgYW5kIHByb3ZpZGVycyBzdXBwb3J0IHN1Y2ggcmVmZXJlbmNlcy5cbiAgICAgKiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgICAqL1xuICAgIHVzZVJlZmVyZW5jZXM/OiBib29sZWFuO1xuICB9LFxuKTogU2NoZW1hPE9CSkVDVD4ge1xuICBpZiAoaXNab2Q0U2NoZW1hKHpvZFNjaGVtYSkpIHtcbiAgICByZXR1cm4gem9kNFNjaGVtYSh6b2RTY2hlbWEsIG9wdGlvbnMpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB6b2QzU2NoZW1hKHpvZFNjaGVtYSwgb3B0aW9ucyk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBWYWxpZGF0b3IsIHZhbGlkYXRvclN5bWJvbCwgdHlwZSBWYWxpZGF0aW9uUmVzdWx0IH0gZnJvbSAnLi92YWxpZGF0b3InO1xuaW1wb3J0IHsgSlNPTlNjaGVtYTcgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCAqIGFzIHozIGZyb20gJ3pvZC92Myc7XG5pbXBvcnQgKiBhcyB6NCBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgem9kU2NoZW1hIH0gZnJvbSAnLi96b2Qtc2NoZW1hJztcblxuLyoqXG4gKiBVc2VkIHRvIG1hcmsgc2NoZW1hcyBzbyB3ZSBjYW4gc3VwcG9ydCBib3RoIFpvZCBhbmQgY3VzdG9tIHNjaGVtYXMuXG4gKi9cbmNvbnN0IHNjaGVtYVN5bWJvbCA9IFN5bWJvbC5mb3IoJ3ZlcmNlbC5haS5zY2hlbWEnKTtcblxuZXhwb3J0IHR5cGUgU2NoZW1hPE9CSkVDVCA9IHVua25vd24+ID0gVmFsaWRhdG9yPE9CSkVDVD4gJiB7XG4gIC8qKlxuICAgKiBVc2VkIHRvIG1hcmsgc2NoZW1hcyBzbyB3ZSBjYW4gc3VwcG9ydCBib3RoIFpvZCBhbmQgY3VzdG9tIHNjaGVtYXMuXG4gICAqL1xuICBbc2NoZW1hU3ltYm9sXTogdHJ1ZTtcblxuICAvKipcbiAgICogU2NoZW1hIHR5cGUgZm9yIGluZmVyZW5jZS5cbiAgICovXG4gIF90eXBlOiBPQkpFQ1Q7XG5cbiAgLyoqXG4gICAqIFRoZSBKU09OIFNjaGVtYSBmb3IgdGhlIHNjaGVtYS4gSXQgaXMgcGFzc2VkIHRvIHRoZSBwcm92aWRlcnMuXG4gICAqL1xuICByZWFkb25seSBqc29uU2NoZW1hOiBKU09OU2NoZW1hNztcbn07XG5cbi8vIE5vdGU6IFpvZCB0eXBlcyBoZXJlIGV4YWN0bHkgbWF0Y2ggdGhlIHR5cGVzIGluIHpvZC1zY2hlbWEudHNcbi8vIHRvIHByZXZlbnQgdHlwZSBlcnJvcnMgd2hlbiB1c2luZyB6b2Qgc2NoZW1hcyB3aXRoIGZsZXhpYmxlIHNjaGVtYXMuXG5leHBvcnQgdHlwZSBGbGV4aWJsZVNjaGVtYTxUPiA9XG4gIHwgejQuY29yZS4kWm9kVHlwZTxULCBhbnk+XG4gIHwgejMuU2NoZW1hPFQsIHozLlpvZFR5cGVEZWYsIGFueT5cbiAgfCBTY2hlbWE8VD47XG5cbmV4cG9ydCB0eXBlIEluZmVyU2NoZW1hPFNDSEVNQT4gPSBTQ0hFTUEgZXh0ZW5kcyB6My5TY2hlbWFcbiAgPyB6My5pbmZlcjxTQ0hFTUE+XG4gIDogU0NIRU1BIGV4dGVuZHMgejQuY29yZS4kWm9kVHlwZVxuICAgID8gejQuaW5mZXI8U0NIRU1BPlxuICAgIDogU0NIRU1BIGV4dGVuZHMgU2NoZW1hPGluZmVyIFQ+XG4gICAgICA/IFRcbiAgICAgIDogbmV2ZXI7XG5cbi8qKlxuICogQ3JlYXRlIGEgc2NoZW1hIHVzaW5nIGEgSlNPTiBTY2hlbWEuXG4gKlxuICogQHBhcmFtIGpzb25TY2hlbWEgVGhlIEpTT04gU2NoZW1hIGZvciB0aGUgc2NoZW1hLlxuICogQHBhcmFtIG9wdGlvbnMudmFsaWRhdGUgT3B0aW9uYWwuIEEgdmFsaWRhdGlvbiBmdW5jdGlvbiBmb3IgdGhlIHNjaGVtYS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGpzb25TY2hlbWE8T0JKRUNUID0gdW5rbm93bj4oXG4gIGpzb25TY2hlbWE6IEpTT05TY2hlbWE3LFxuICB7XG4gICAgdmFsaWRhdGUsXG4gIH06IHtcbiAgICB2YWxpZGF0ZT86IChcbiAgICAgIHZhbHVlOiB1bmtub3duLFxuICAgICkgPT4gVmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+IHwgUHJvbWlzZUxpa2U8VmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+PjtcbiAgfSA9IHt9LFxuKTogU2NoZW1hPE9CSkVDVD4ge1xuICByZXR1cm4ge1xuICAgIFtzY2hlbWFTeW1ib2xdOiB0cnVlLFxuICAgIF90eXBlOiB1bmRlZmluZWQgYXMgT0JKRUNULCAvLyBzaG91bGQgbmV2ZXIgYmUgdXNlZCBkaXJlY3RseVxuICAgIFt2YWxpZGF0b3JTeW1ib2xdOiB0cnVlLFxuICAgIGpzb25TY2hlbWEsXG4gICAgdmFsaWRhdGUsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGlzU2NoZW1hKHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgU2NoZW1hIHtcbiAgcmV0dXJuIChcbiAgICB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgdmFsdWUgIT09IG51bGwgJiZcbiAgICBzY2hlbWFTeW1ib2wgaW4gdmFsdWUgJiZcbiAgICB2YWx1ZVtzY2hlbWFTeW1ib2xdID09PSB0cnVlICYmXG4gICAgJ2pzb25TY2hlbWEnIGluIHZhbHVlICYmXG4gICAgJ3ZhbGlkYXRlJyBpbiB2YWx1ZVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNTY2hlbWE8T0JKRUNUPihcbiAgc2NoZW1hOlxuICAgIHwgejQuY29yZS4kWm9kVHlwZTxPQkpFQ1QsIGFueT5cbiAgICB8IHozLlNjaGVtYTxPQkpFQ1QsIHozLlpvZFR5cGVEZWYsIGFueT5cbiAgICB8IFNjaGVtYTxPQkpFQ1Q+XG4gICAgfCB1bmRlZmluZWQsXG4pOiBTY2hlbWE8T0JKRUNUPiB7XG4gIHJldHVybiBzY2hlbWEgPT0gbnVsbFxuICAgID8ganNvblNjaGVtYSh7XG4gICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogZmFsc2UsXG4gICAgICB9KVxuICAgIDogaXNTY2hlbWEoc2NoZW1hKVxuICAgICAgPyBzY2hlbWFcbiAgICAgIDogem9kU2NoZW1hKHNjaGVtYSk7XG59XG4iLCAiLy8gYnRvYSBhbmQgYXRvYiBuZWVkIHRvIGJlIGludm9rZWQgYXMgYSBmdW5jdGlvbiBjYWxsLCBub3QgYXMgYSBtZXRob2QgY2FsbC5cbi8vIE90aGVyd2lzZSBDbG91ZEZsYXJlIHdpbGwgdGhyb3cgYVxuLy8gXCJUeXBlRXJyb3I6IElsbGVnYWwgaW52b2NhdGlvbjogZnVuY3Rpb24gY2FsbGVkIHdpdGggaW5jb3JyZWN0IHRoaXMgcmVmZXJlbmNlXCJcbmNvbnN0IHsgYnRvYSwgYXRvYiB9ID0gZ2xvYmFsVGhpcztcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRCYXNlNjRUb1VpbnQ4QXJyYXkoYmFzZTY0U3RyaW5nOiBzdHJpbmcpIHtcbiAgY29uc3QgYmFzZTY0VXJsID0gYmFzZTY0U3RyaW5nLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XG4gIGNvbnN0IGxhdGluMXN0cmluZyA9IGF0b2IoYmFzZTY0VXJsKTtcbiAgcmV0dXJuIFVpbnQ4QXJyYXkuZnJvbShsYXRpbjFzdHJpbmcsIGJ5dGUgPT4gYnl0ZS5jb2RlUG9pbnRBdCgwKSEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFVpbnQ4QXJyYXlUb0Jhc2U2NChhcnJheTogVWludDhBcnJheSk6IHN0cmluZyB7XG4gIGxldCBsYXRpbjFzdHJpbmcgPSAnJztcblxuICAvLyBOb3RlOiByZWd1bGFyIGZvciBsb29wIHRvIHN1cHBvcnQgb2xkZXIgSmF2YVNjcmlwdCB2ZXJzaW9ucyB0aGF0XG4gIC8vIGRvIG5vdCBzdXBwb3J0IGZvci4ub2Ygb24gVWludDhBcnJheVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgbGF0aW4xc3RyaW5nICs9IFN0cmluZy5mcm9tQ29kZVBvaW50KGFycmF5W2ldKTtcbiAgfVxuXG4gIHJldHVybiBidG9hKGxhdGluMXN0cmluZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9CYXNlNjQodmFsdWU6IHN0cmluZyB8IFVpbnQ4QXJyYXkpOiBzdHJpbmcge1xuICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gY29udmVydFVpbnQ4QXJyYXlUb0Jhc2U2NCh2YWx1ZSkgOiB2YWx1ZTtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gd2l0aG91dFRyYWlsaW5nU2xhc2godXJsOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgcmV0dXJuIHVybD8ucmVwbGFjZSgvXFwvJC8sICcnKTtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gaXNBc3luY0l0ZXJhYmxlPFQgPSBhbnk+KG9iajogYW55KTogb2JqIGlzIEFzeW5jSXRlcmFibGU8VD4ge1xuICByZXR1cm4gb2JqICE9IG51bGwgJiYgdHlwZW9mIG9ialtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPT09ICdmdW5jdGlvbic7XG59XG4iLCAiaW1wb3J0IHsgVG9vbCwgVG9vbENhbGxPcHRpb25zLCBUb29sRXhlY3V0ZUZ1bmN0aW9uIH0gZnJvbSAnLi90b29sJztcbmltcG9ydCB7IGlzQXN5bmNJdGVyYWJsZSB9IGZyb20gJy4uL2lzLWFzeW5jLWl0ZXJhYmxlJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uKiBleGVjdXRlVG9vbDxJTlBVVCwgT1VUUFVUPih7XG4gIGV4ZWN1dGUsXG4gIGlucHV0LFxuICBvcHRpb25zLFxufToge1xuICBleGVjdXRlOiBUb29sRXhlY3V0ZUZ1bmN0aW9uPElOUFVULCBPVVRQVVQ+O1xuICBpbnB1dDogSU5QVVQ7XG4gIG9wdGlvbnM6IFRvb2xDYWxsT3B0aW9ucztcbn0pOiBBc3luY0dlbmVyYXRvcjxcbiAgeyB0eXBlOiAncHJlbGltaW5hcnknOyBvdXRwdXQ6IE9VVFBVVCB9IHwgeyB0eXBlOiAnZmluYWwnOyBvdXRwdXQ6IE9VVFBVVCB9XG4+IHtcbiAgY29uc3QgcmVzdWx0ID0gZXhlY3V0ZShpbnB1dCwgb3B0aW9ucyk7XG5cbiAgaWYgKGlzQXN5bmNJdGVyYWJsZShyZXN1bHQpKSB7XG4gICAgbGV0IGxhc3RPdXRwdXQ6IE9VVFBVVCB8IHVuZGVmaW5lZDtcbiAgICBmb3IgYXdhaXQgKGNvbnN0IG91dHB1dCBvZiByZXN1bHQpIHtcbiAgICAgIGxhc3RPdXRwdXQgPSBvdXRwdXQ7XG4gICAgICB5aWVsZCB7IHR5cGU6ICdwcmVsaW1pbmFyeScsIG91dHB1dCB9O1xuICAgIH1cbiAgICB5aWVsZCB7IHR5cGU6ICdmaW5hbCcsIG91dHB1dDogbGFzdE91dHB1dCEgfTtcbiAgfSBlbHNlIHtcbiAgICB5aWVsZCB7IHR5cGU6ICdmaW5hbCcsIG91dHB1dDogYXdhaXQgcmVzdWx0IH07XG4gIH1cbn1cbiIsICJleHBvcnQgKiBmcm9tICcuL2NvbWJpbmUtaGVhZGVycyc7XG5leHBvcnQgeyBjb252ZXJ0QXN5bmNJdGVyYXRvclRvUmVhZGFibGVTdHJlYW0gfSBmcm9tICcuL2NvbnZlcnQtYXN5bmMtaXRlcmF0b3ItdG8tcmVhZGFibGUtc3RyZWFtJztcbmV4cG9ydCAqIGZyb20gJy4vZGVsYXknO1xuZXhwb3J0ICogZnJvbSAnLi9leHRyYWN0LXJlc3BvbnNlLWhlYWRlcnMnO1xuZXhwb3J0ICogZnJvbSAnLi9mZXRjaC1mdW5jdGlvbic7XG5leHBvcnQgeyBjcmVhdGVJZEdlbmVyYXRvciwgZ2VuZXJhdGVJZCwgdHlwZSBJZEdlbmVyYXRvciB9IGZyb20gJy4vZ2VuZXJhdGUtaWQnO1xuZXhwb3J0ICogZnJvbSAnLi9nZXQtZXJyb3ItbWVzc2FnZSc7XG5leHBvcnQgKiBmcm9tICcuL2dldC1mcm9tLWFwaSc7XG5leHBvcnQgKiBmcm9tICcuL2lzLWFib3J0LWVycm9yJztcbmV4cG9ydCB7IGlzVXJsU3VwcG9ydGVkIH0gZnJvbSAnLi9pcy11cmwtc3VwcG9ydGVkJztcbmV4cG9ydCAqIGZyb20gJy4vbG9hZC1hcGkta2V5JztcbmV4cG9ydCB7IGxvYWRPcHRpb25hbFNldHRpbmcgfSBmcm9tICcuL2xvYWQtb3B0aW9uYWwtc2V0dGluZyc7XG5leHBvcnQgeyBsb2FkU2V0dGluZyB9IGZyb20gJy4vbG9hZC1zZXR0aW5nJztcbmV4cG9ydCAqIGZyb20gJy4vcGFyc2UtanNvbic7XG5leHBvcnQgeyBwYXJzZUpzb25FdmVudFN0cmVhbSB9IGZyb20gJy4vcGFyc2UtanNvbi1ldmVudC1zdHJlYW0nO1xuZXhwb3J0IHsgcGFyc2VQcm92aWRlck9wdGlvbnMgfSBmcm9tICcuL3BhcnNlLXByb3ZpZGVyLW9wdGlvbnMnO1xuZXhwb3J0ICogZnJvbSAnLi9wb3N0LXRvLWFwaSc7XG5leHBvcnQge1xuICBjcmVhdGVQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeSxcbiAgdHlwZSBQcm92aWRlckRlZmluZWRUb29sRmFjdG9yeSxcbiAgY3JlYXRlUHJvdmlkZXJEZWZpbmVkVG9vbEZhY3RvcnlXaXRoT3V0cHV0U2NoZW1hLFxuICB0eXBlIFByb3ZpZGVyRGVmaW5lZFRvb2xGYWN0b3J5V2l0aE91dHB1dFNjaGVtYSxcbn0gZnJvbSAnLi9wcm92aWRlci1kZWZpbmVkLXRvb2wtZmFjdG9yeSc7XG5leHBvcnQgKiBmcm9tICcuL3JlbW92ZS11bmRlZmluZWQtZW50cmllcyc7XG5leHBvcnQgKiBmcm9tICcuL3Jlc29sdmUnO1xuZXhwb3J0ICogZnJvbSAnLi9yZXNwb25zZS1oYW5kbGVyJztcbmV4cG9ydCB7XG4gIGFzU2NoZW1hLFxuICBqc29uU2NoZW1hLFxuICB0eXBlIEZsZXhpYmxlU2NoZW1hLFxuICB0eXBlIEluZmVyU2NoZW1hLFxuICB0eXBlIFNjaGVtYSxcbn0gZnJvbSAnLi9zY2hlbWEnO1xuZXhwb3J0ICogZnJvbSAnLi91aW50OC11dGlscyc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbGlkYXRlLXR5cGVzJztcbmV4cG9ydCAqIGZyb20gJy4vdmFsaWRhdG9yJztcbmV4cG9ydCAqIGZyb20gJy4vd2l0aG91dC10cmFpbGluZy1zbGFzaCc7XG5leHBvcnQgeyB6b2RTY2hlbWEgfSBmcm9tICcuL3pvZC1zY2hlbWEnO1xuXG4vLyBmb2xkZXIgcmUtZXhwb3J0c1xuZXhwb3J0ICogZnJvbSAnLi90eXBlcyc7XG5cbi8vIGV4dGVybmFsIHJlLWV4cG9ydHNcbmV4cG9ydCAqIGZyb20gJ0BzdGFuZGFyZC1zY2hlbWEvc3BlYyc7XG5leHBvcnQge1xuICBFdmVudFNvdXJjZVBhcnNlclN0cmVhbSxcbiAgdHlwZSBFdmVudFNvdXJjZU1lc3NhZ2UsXG59IGZyb20gJ2V2ZW50c291cmNlLXBhcnNlci9zdHJlYW0nO1xuIiwgIi8vIHJlLWV4cG9ydHM6XG5leHBvcnQge1xuICBhc1NjaGVtYSxcbiAgY3JlYXRlSWRHZW5lcmF0b3IsXG4gIGR5bmFtaWNUb29sLFxuICBnZW5lcmF0ZUlkLFxuICBqc29uU2NoZW1hLFxuICB0b29sLFxuICB6b2RTY2hlbWEsXG4gIHR5cGUgSWRHZW5lcmF0b3IsXG4gIHR5cGUgSW5mZXJUb29sSW5wdXQsXG4gIHR5cGUgSW5mZXJUb29sT3V0cHV0LFxuICB0eXBlIFNjaGVtYSxcbiAgdHlwZSBUb29sLFxuICB0eXBlIFRvb2xDYWxsT3B0aW9ucyxcbiAgdHlwZSBUb29sRXhlY3V0ZUZ1bmN0aW9uLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcblxuLy8gZGlyZWN0b3J5IGV4cG9ydHNcbmV4cG9ydCAqIGZyb20gJy4vYWdlbnQnO1xuZXhwb3J0ICogZnJvbSAnLi9lbWJlZCc7XG5leHBvcnQgKiBmcm9tICcuL2Vycm9yJztcbmV4cG9ydCAqIGZyb20gJy4vZ2VuZXJhdGUtaW1hZ2UnO1xuZXhwb3J0ICogZnJvbSAnLi9nZW5lcmF0ZS1vYmplY3QnO1xuZXhwb3J0ICogZnJvbSAnLi9nZW5lcmF0ZS1zcGVlY2gnO1xuZXhwb3J0ICogZnJvbSAnLi9nZW5lcmF0ZS10ZXh0JztcbmV4cG9ydCAqIGZyb20gJy4vbWlkZGxld2FyZSc7XG5leHBvcnQgKiBmcm9tICcuL3Byb21wdCc7XG5leHBvcnQgKiBmcm9tICcuL3JlZ2lzdHJ5JztcbmV4cG9ydCAqIGZyb20gJy4vdGV4dC1zdHJlYW0nO1xuZXhwb3J0ICogZnJvbSAnLi90b29sJztcbmV4cG9ydCAqIGZyb20gJy4vdHJhbnNjcmliZSc7XG5leHBvcnQgKiBmcm9tICcuL3R5cGVzJztcbmV4cG9ydCAqIGZyb20gJy4vdWknO1xuZXhwb3J0ICogZnJvbSAnLi91aS1tZXNzYWdlLXN0cmVhbSc7XG5leHBvcnQgKiBmcm9tICcuL3V0aWwnO1xuXG4vLyB0ZWxlbWV0cnkgdHlwZXM6XG5leHBvcnQgdHlwZSB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi90ZWxlbWV0cnkvdGVsZW1ldHJ5LXNldHRpbmdzJztcblxuLy8gaW1wb3J0IGdsb2JhbHNcbmltcG9ydCAnLi9nbG9iYWwnO1xuIiwgImltcG9ydCB7XG4gIExhbmd1YWdlTW9kZWxWMixcbiAgTGFuZ3VhZ2VNb2RlbFYyQ29udGVudCxcbiAgTGFuZ3VhZ2VNb2RlbFYyVG9vbENhbGwsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlSWRHZW5lcmF0b3IsXG4gIGV4ZWN1dGVUb29sLFxuICBnZXRFcnJvck1lc3NhZ2UsXG4gIElkR2VuZXJhdG9yLFxuICBQcm92aWRlck9wdGlvbnMsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgVHJhY2VyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvYXBpJztcbmltcG9ydCB7IE5vT3V0cHV0U3BlY2lmaWVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vdXRwdXQtc3BlY2lmaWVkLWVycm9yJztcbmltcG9ydCB7IHJlc29sdmVMYW5ndWFnZU1vZGVsIH0gZnJvbSAnLi4vbW9kZWwvcmVzb2x2ZS1tb2RlbCc7XG5pbXBvcnQgeyBNb2RlbE1lc3NhZ2UgfSBmcm9tICcuLi9wcm9tcHQnO1xuaW1wb3J0IHsgQ2FsbFNldHRpbmdzIH0gZnJvbSAnLi4vcHJvbXB0L2NhbGwtc2V0dGluZ3MnO1xuaW1wb3J0IHsgY29udmVydFRvTGFuZ3VhZ2VNb2RlbFByb21wdCB9IGZyb20gJy4uL3Byb21wdC9jb252ZXJ0LXRvLWxhbmd1YWdlLW1vZGVsLXByb21wdCc7XG5pbXBvcnQgeyBwcmVwYXJlQ2FsbFNldHRpbmdzIH0gZnJvbSAnLi4vcHJvbXB0L3ByZXBhcmUtY2FsbC1zZXR0aW5ncyc7XG5pbXBvcnQgeyBwcmVwYXJlVG9vbHNBbmRUb29sQ2hvaWNlIH0gZnJvbSAnLi4vcHJvbXB0L3ByZXBhcmUtdG9vbHMtYW5kLXRvb2wtY2hvaWNlJztcbmltcG9ydCB7IFByb21wdCB9IGZyb20gJy4uL3Byb21wdC9wcm9tcHQnO1xuaW1wb3J0IHsgc3RhbmRhcmRpemVQcm9tcHQgfSBmcm9tICcuLi9wcm9tcHQvc3RhbmRhcmRpemUtcHJvbXB0JztcbmltcG9ydCB7IHdyYXBHYXRld2F5RXJyb3IgfSBmcm9tICcuLi9wcm9tcHQvd3JhcC1nYXRld2F5LWVycm9yJztcbmltcG9ydCB7IGFzc2VtYmxlT3BlcmF0aW9uTmFtZSB9IGZyb20gJy4uL3RlbGVtZXRyeS9hc3NlbWJsZS1vcGVyYXRpb24tbmFtZSc7XG5pbXBvcnQgeyBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtYmFzZS10ZWxlbWV0cnktYXR0cmlidXRlcyc7XG5pbXBvcnQgeyBnZXRUcmFjZXIgfSBmcm9tICcuLi90ZWxlbWV0cnkvZ2V0LXRyYWNlcic7XG5pbXBvcnQgeyByZWNvcmRFcnJvck9uU3BhbiwgcmVjb3JkU3BhbiB9IGZyb20gJy4uL3RlbGVtZXRyeS9yZWNvcmQtc3Bhbic7XG5pbXBvcnQgeyBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3NlbGVjdC10ZWxlbWV0cnktYXR0cmlidXRlcyc7XG5pbXBvcnQgeyBzdHJpbmdpZnlGb3JUZWxlbWV0cnkgfSBmcm9tICcuLi90ZWxlbWV0cnkvc3RyaW5naWZ5LWZvci10ZWxlbWV0cnknO1xuaW1wb3J0IHsgVGVsZW1ldHJ5U2V0dGluZ3MgfSBmcm9tICcuLi90ZWxlbWV0cnkvdGVsZW1ldHJ5LXNldHRpbmdzJztcbmltcG9ydCB7IExhbmd1YWdlTW9kZWwsIFRvb2xDaG9pY2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBhZGRMYW5ndWFnZU1vZGVsVXNhZ2UsIExhbmd1YWdlTW9kZWxVc2FnZSB9IGZyb20gJy4uL3R5cGVzL3VzYWdlJztcbmltcG9ydCB7IGFzQXJyYXkgfSBmcm9tICcuLi91dGlsL2FzLWFycmF5JztcbmltcG9ydCB7IHByZXBhcmVSZXRyaWVzIH0gZnJvbSAnLi4vdXRpbC9wcmVwYXJlLXJldHJpZXMnO1xuaW1wb3J0IHsgQ29udGVudFBhcnQgfSBmcm9tICcuL2NvbnRlbnQtcGFydCc7XG5pbXBvcnQgeyBleHRyYWN0Q29udGVudFRleHQgfSBmcm9tICcuL2V4dHJhY3QtY29udGVudC10ZXh0JztcbmltcG9ydCB7IEdlbmVyYXRlVGV4dFJlc3VsdCB9IGZyb20gJy4vZ2VuZXJhdGUtdGV4dC1yZXN1bHQnO1xuaW1wb3J0IHsgRGVmYXVsdEdlbmVyYXRlZEZpbGUgfSBmcm9tICcuL2dlbmVyYXRlZC1maWxlJztcbmltcG9ydCB7IE91dHB1dCB9IGZyb20gJy4vb3V0cHV0JztcbmltcG9ydCB7IHBhcnNlVG9vbENhbGwgfSBmcm9tICcuL3BhcnNlLXRvb2wtY2FsbCc7XG5pbXBvcnQgeyBQcmVwYXJlU3RlcEZ1bmN0aW9uIH0gZnJvbSAnLi9wcmVwYXJlLXN0ZXAnO1xuaW1wb3J0IHsgUmVzcG9uc2VNZXNzYWdlIH0gZnJvbSAnLi9yZXNwb25zZS1tZXNzYWdlJztcbmltcG9ydCB7IERlZmF1bHRTdGVwUmVzdWx0LCBTdGVwUmVzdWx0IH0gZnJvbSAnLi9zdGVwLXJlc3VsdCc7XG5pbXBvcnQge1xuICBpc1N0b3BDb25kaXRpb25NZXQsXG4gIHN0ZXBDb3VudElzLFxuICBTdG9wQ29uZGl0aW9uLFxufSBmcm9tICcuL3N0b3AtY29uZGl0aW9uJztcbmltcG9ydCB7IHRvUmVzcG9uc2VNZXNzYWdlcyB9IGZyb20gJy4vdG8tcmVzcG9uc2UtbWVzc2FnZXMnO1xuaW1wb3J0IHsgVHlwZWRUb29sQ2FsbCB9IGZyb20gJy4vdG9vbC1jYWxsJztcbmltcG9ydCB7IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb24gfSBmcm9tICcuL3Rvb2wtY2FsbC1yZXBhaXItZnVuY3Rpb24nO1xuaW1wb3J0IHsgVHlwZWRUb29sRXJyb3IgfSBmcm9tICcuL3Rvb2wtZXJyb3InO1xuaW1wb3J0IHsgVG9vbE91dHB1dCB9IGZyb20gJy4vdG9vbC1vdXRwdXQnO1xuaW1wb3J0IHsgVHlwZWRUb29sUmVzdWx0IH0gZnJvbSAnLi90b29sLXJlc3VsdCc7XG5pbXBvcnQgeyBUb29sU2V0IH0gZnJvbSAnLi90b29sLXNldCc7XG5cbmNvbnN0IG9yaWdpbmFsR2VuZXJhdGVJZCA9IGNyZWF0ZUlkR2VuZXJhdG9yKHtcbiAgcHJlZml4OiAnYWl0eHQnLFxuICBzaXplOiAyNCxcbn0pO1xuXG4vKipcbkNhbGxiYWNrIHRoYXQgaXMgc2V0IHVzaW5nIHRoZSBgb25TdGVwRmluaXNoYCBvcHRpb24uXG5cbkBwYXJhbSBzdGVwUmVzdWx0IC0gVGhlIHJlc3VsdCBvZiB0aGUgc3RlcC5cbiAqL1xuZXhwb3J0IHR5cGUgR2VuZXJhdGVUZXh0T25TdGVwRmluaXNoQ2FsbGJhY2s8VE9PTFMgZXh0ZW5kcyBUb29sU2V0PiA9IChcbiAgc3RlcFJlc3VsdDogU3RlcFJlc3VsdDxUT09MUz4sXG4pID0+IFByb21pc2U8dm9pZD4gfCB2b2lkO1xuXG4vKipcbkdlbmVyYXRlIGEgdGV4dCBhbmQgY2FsbCB0b29scyBmb3IgYSBnaXZlbiBwcm9tcHQgdXNpbmcgYSBsYW5ndWFnZSBtb2RlbC5cblxuVGhpcyBmdW5jdGlvbiBkb2VzIG5vdCBzdHJlYW0gdGhlIG91dHB1dC4gSWYgeW91IHdhbnQgdG8gc3RyZWFtIHRoZSBvdXRwdXQsIHVzZSBgc3RyZWFtVGV4dGAgaW5zdGVhZC5cblxuQHBhcmFtIG1vZGVsIC0gVGhlIGxhbmd1YWdlIG1vZGVsIHRvIHVzZS5cblxuQHBhcmFtIHRvb2xzIC0gVG9vbHMgdGhhdCBhcmUgYWNjZXNzaWJsZSB0byBhbmQgY2FuIGJlIGNhbGxlZCBieSB0aGUgbW9kZWwuIFRoZSBtb2RlbCBuZWVkcyB0byBzdXBwb3J0IGNhbGxpbmcgdG9vbHMuXG5AcGFyYW0gdG9vbENob2ljZSAtIFRoZSB0b29sIGNob2ljZSBzdHJhdGVneS4gRGVmYXVsdDogJ2F1dG8nLlxuXG5AcGFyYW0gc3lzdGVtIC0gQSBzeXN0ZW0gbWVzc2FnZSB0aGF0IHdpbGwgYmUgcGFydCBvZiB0aGUgcHJvbXB0LlxuQHBhcmFtIHByb21wdCAtIEEgc2ltcGxlIHRleHQgcHJvbXB0LiBZb3UgY2FuIGVpdGhlciB1c2UgYHByb21wdGAgb3IgYG1lc3NhZ2VzYCBidXQgbm90IGJvdGguXG5AcGFyYW0gbWVzc2FnZXMgLSBBIGxpc3Qgb2YgbWVzc2FnZXMuIFlvdSBjYW4gZWl0aGVyIHVzZSBgcHJvbXB0YCBvciBgbWVzc2FnZXNgIGJ1dCBub3QgYm90aC5cblxuQHBhcmFtIG1heE91dHB1dFRva2VucyAtIE1heGltdW0gbnVtYmVyIG9mIHRva2VucyB0byBnZW5lcmF0ZS5cbkBwYXJhbSB0ZW1wZXJhdHVyZSAtIFRlbXBlcmF0dXJlIHNldHRpbmcuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuSXQgaXMgcmVjb21tZW5kZWQgdG8gc2V0IGVpdGhlciBgdGVtcGVyYXR1cmVgIG9yIGB0b3BQYCwgYnV0IG5vdCBib3RoLlxuQHBhcmFtIHRvcFAgLSBOdWNsZXVzIHNhbXBsaW5nLlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkl0IGlzIHJlY29tbWVuZGVkIHRvIHNldCBlaXRoZXIgYHRlbXBlcmF0dXJlYCBvciBgdG9wUGAsIGJ1dCBub3QgYm90aC5cbkBwYXJhbSB0b3BLIC0gT25seSBzYW1wbGUgZnJvbSB0aGUgdG9wIEsgb3B0aW9ucyBmb3IgZWFjaCBzdWJzZXF1ZW50IHRva2VuLlxuVXNlZCB0byByZW1vdmUgXCJsb25nIHRhaWxcIiBsb3cgcHJvYmFiaWxpdHkgcmVzcG9uc2VzLlxuUmVjb21tZW5kZWQgZm9yIGFkdmFuY2VkIHVzZSBjYXNlcyBvbmx5LiBZb3UgdXN1YWxseSBvbmx5IG5lZWQgdG8gdXNlIHRlbXBlcmF0dXJlLlxuQHBhcmFtIHByZXNlbmNlUGVuYWx0eSAtIFByZXNlbmNlIHBlbmFsdHkgc2V0dGluZy5cbkl0IGFmZmVjdHMgdGhlIGxpa2VsaWhvb2Qgb2YgdGhlIG1vZGVsIHRvIHJlcGVhdCBpbmZvcm1hdGlvbiB0aGF0IGlzIGFscmVhZHkgaW4gdGhlIHByb21wdC5cblRoZSB2YWx1ZSBpcyBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXIuIFRoZSByYW5nZSBkZXBlbmRzIG9uIHRoZSBwcm92aWRlciBhbmQgbW9kZWwuXG5AcGFyYW0gZnJlcXVlbmN5UGVuYWx0eSAtIEZyZXF1ZW5jeSBwZW5hbHR5IHNldHRpbmcuXG5JdCBhZmZlY3RzIHRoZSBsaWtlbGlob29kIG9mIHRoZSBtb2RlbCB0byByZXBlYXRlZGx5IHVzZSB0aGUgc2FtZSB3b3JkcyBvciBwaHJhc2VzLlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkBwYXJhbSBzdG9wU2VxdWVuY2VzIC0gU3RvcCBzZXF1ZW5jZXMuXG5JZiBzZXQsIHRoZSBtb2RlbCB3aWxsIHN0b3AgZ2VuZXJhdGluZyB0ZXh0IHdoZW4gb25lIG9mIHRoZSBzdG9wIHNlcXVlbmNlcyBpcyBnZW5lcmF0ZWQuXG5AcGFyYW0gc2VlZCAtIFRoZSBzZWVkIChpbnRlZ2VyKSB0byB1c2UgZm9yIHJhbmRvbSBzYW1wbGluZy5cbklmIHNldCBhbmQgc3VwcG9ydGVkIGJ5IHRoZSBtb2RlbCwgY2FsbHMgd2lsbCBnZW5lcmF0ZSBkZXRlcm1pbmlzdGljIHJlc3VsdHMuXG5cbkBwYXJhbSBtYXhSZXRyaWVzIC0gTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcy4gU2V0IHRvIDAgdG8gZGlzYWJsZSByZXRyaWVzLiBEZWZhdWx0OiAyLlxuQHBhcmFtIGFib3J0U2lnbmFsIC0gQW4gb3B0aW9uYWwgYWJvcnQgc2lnbmFsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FuY2VsIHRoZSBjYWxsLlxuQHBhcmFtIGhlYWRlcnMgLSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBiZSBzZW50IHdpdGggdGhlIHJlcXVlc3QuIE9ubHkgYXBwbGljYWJsZSBmb3IgSFRUUC1iYXNlZCBwcm92aWRlcnMuXG5cbkBwYXJhbSBleHBlcmltZW50YWxfZ2VuZXJhdGVNZXNzYWdlSWQgLSBHZW5lcmF0ZSBhIHVuaXF1ZSBJRCBmb3IgZWFjaCBtZXNzYWdlLlxuXG5AcGFyYW0gb25TdGVwRmluaXNoIC0gQ2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiBlYWNoIHN0ZXAgKExMTSBjYWxsKSBpcyBmaW5pc2hlZCwgaW5jbHVkaW5nIGludGVybWVkaWF0ZSBzdGVwcy5cblxuQHJldHVybnNcbkEgcmVzdWx0IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBnZW5lcmF0ZWQgdGV4dCwgdGhlIHJlc3VsdHMgb2YgdGhlIHRvb2wgY2FsbHMsIGFuZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVUZXh0PFxuICBUT09MUyBleHRlbmRzIFRvb2xTZXQsXG4gIE9VVFBVVCA9IG5ldmVyLFxuICBPVVRQVVRfUEFSVElBTCA9IG5ldmVyLFxuPih7XG4gIG1vZGVsOiBtb2RlbEFyZyxcbiAgdG9vbHMsXG4gIHRvb2xDaG9pY2UsXG4gIHN5c3RlbSxcbiAgcHJvbXB0LFxuICBtZXNzYWdlcyxcbiAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgYWJvcnRTaWduYWwsXG4gIGhlYWRlcnMsXG4gIHN0b3BXaGVuID0gc3RlcENvdW50SXMoMSksXG4gIGV4cGVyaW1lbnRhbF9vdXRwdXQ6IG91dHB1dCxcbiAgZXhwZXJpbWVudGFsX3RlbGVtZXRyeTogdGVsZW1ldHJ5LFxuICBwcm92aWRlck9wdGlvbnMsXG4gIGV4cGVyaW1lbnRhbF9hY3RpdmVUb29scyxcbiAgYWN0aXZlVG9vbHMgPSBleHBlcmltZW50YWxfYWN0aXZlVG9vbHMsXG4gIGV4cGVyaW1lbnRhbF9wcmVwYXJlU3RlcCxcbiAgcHJlcGFyZVN0ZXAgPSBleHBlcmltZW50YWxfcHJlcGFyZVN0ZXAsXG4gIGV4cGVyaW1lbnRhbF9yZXBhaXJUb29sQ2FsbDogcmVwYWlyVG9vbENhbGwsXG4gIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxuICBfaW50ZXJuYWw6IHtcbiAgICBnZW5lcmF0ZUlkID0gb3JpZ2luYWxHZW5lcmF0ZUlkLFxuICAgIGN1cnJlbnREYXRlID0gKCkgPT4gbmV3IERhdGUoKSxcbiAgfSA9IHt9LFxuICBvblN0ZXBGaW5pc2gsXG4gIC4uLnNldHRpbmdzXG59OiBDYWxsU2V0dGluZ3MgJlxuICBQcm9tcHQgJiB7XG4gICAgLyoqXG5UaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICAgIG1vZGVsOiBMYW5ndWFnZU1vZGVsO1xuXG4gICAgLyoqXG5UaGUgdG9vbHMgdGhhdCB0aGUgbW9kZWwgY2FuIGNhbGwuIFRoZSBtb2RlbCBuZWVkcyB0byBzdXBwb3J0IGNhbGxpbmcgdG9vbHMuXG4qL1xuICAgIHRvb2xzPzogVE9PTFM7XG5cbiAgICAvKipcblRoZSB0b29sIGNob2ljZSBzdHJhdGVneS4gRGVmYXVsdDogJ2F1dG8nLlxuICAgICAqL1xuICAgIHRvb2xDaG9pY2U/OiBUb29sQ2hvaWNlPE5vSW5mZXI8VE9PTFM+PjtcblxuICAgIC8qKlxuQ29uZGl0aW9uIGZvciBzdG9wcGluZyB0aGUgZ2VuZXJhdGlvbiB3aGVuIHRoZXJlIGFyZSB0b29sIHJlc3VsdHMgaW4gdGhlIGxhc3Qgc3RlcC5cbldoZW4gdGhlIGNvbmRpdGlvbiBpcyBhbiBhcnJheSwgYW55IG9mIHRoZSBjb25kaXRpb25zIGNhbiBiZSBtZXQgdG8gc3RvcCB0aGUgZ2VuZXJhdGlvbi5cblxuQGRlZmF1bHQgc3RlcENvdW50SXMoMSlcbiAgICAgKi9cbiAgICBzdG9wV2hlbj86XG4gICAgICB8IFN0b3BDb25kaXRpb248Tm9JbmZlcjxUT09MUz4+XG4gICAgICB8IEFycmF5PFN0b3BDb25kaXRpb248Tm9JbmZlcjxUT09MUz4+PjtcblxuICAgIC8qKlxuT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG4gICAgICovXG4gICAgZXhwZXJpbWVudGFsX3RlbGVtZXRyeT86IFRlbGVtZXRyeVNldHRpbmdzO1xuXG4gICAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG50byB0aGUgcHJvdmlkZXIgZnJvbSB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbmZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cbiAqL1xuICAgIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIFVzZSBgYWN0aXZlVG9vbHNgIGluc3RlYWQuXG4gICAgICovXG4gICAgZXhwZXJpbWVudGFsX2FjdGl2ZVRvb2xzPzogQXJyYXk8a2V5b2YgTm9JbmZlcjxUT09MUz4+O1xuXG4gICAgLyoqXG5MaW1pdHMgdGhlIHRvb2xzIHRoYXQgYXJlIGF2YWlsYWJsZSBmb3IgdGhlIG1vZGVsIHRvIGNhbGwgd2l0aG91dFxuY2hhbmdpbmcgdGhlIHRvb2wgY2FsbCBhbmQgcmVzdWx0IHR5cGVzIGluIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgYWN0aXZlVG9vbHM/OiBBcnJheTxrZXlvZiBOb0luZmVyPFRPT0xTPj47XG5cbiAgICAvKipcbk9wdGlvbmFsIHNwZWNpZmljYXRpb24gZm9yIHBhcnNpbmcgc3RydWN0dXJlZCBvdXRwdXRzIGZyb20gdGhlIExMTSByZXNwb25zZS5cbiAgICAgKi9cbiAgICBleHBlcmltZW50YWxfb3V0cHV0PzogT3V0cHV0PE9VVFBVVCwgT1VUUFVUX1BBUlRJQUw+O1xuXG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWQgVXNlIGBwcmVwYXJlU3RlcGAgaW5zdGVhZC5cbiAgICAgKi9cbiAgICBleHBlcmltZW50YWxfcHJlcGFyZVN0ZXA/OiBQcmVwYXJlU3RlcEZ1bmN0aW9uPE5vSW5mZXI8VE9PTFM+PjtcblxuICAgIC8qKlxuT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB5b3UgY2FuIHVzZSB0byBwcm92aWRlIGRpZmZlcmVudCBzZXR0aW5ncyBmb3IgYSBzdGVwLlxuICAgICovXG4gICAgcHJlcGFyZVN0ZXA/OiBQcmVwYXJlU3RlcEZ1bmN0aW9uPE5vSW5mZXI8VE9PTFM+PjtcblxuICAgIC8qKlxuQSBmdW5jdGlvbiB0aGF0IGF0dGVtcHRzIHRvIHJlcGFpciBhIHRvb2wgY2FsbCB0aGF0IGZhaWxlZCB0byBwYXJzZS5cbiAgICAgKi9cbiAgICBleHBlcmltZW50YWxfcmVwYWlyVG9vbENhbGw/OiBUb29sQ2FsbFJlcGFpckZ1bmN0aW9uPE5vSW5mZXI8VE9PTFM+PjtcblxuICAgIC8qKlxuICAgIENhbGxiYWNrIHRoYXQgaXMgY2FsbGVkIHdoZW4gZWFjaCBzdGVwIChMTE0gY2FsbCkgaXMgZmluaXNoZWQsIGluY2x1ZGluZyBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gICAgKi9cbiAgICBvblN0ZXBGaW5pc2g/OiBHZW5lcmF0ZVRleHRPblN0ZXBGaW5pc2hDYWxsYmFjazxOb0luZmVyPFRPT0xTPj47XG5cbiAgICAvKipcbiAgICAgKiBDb250ZXh0IHRoYXQgaXMgcGFzc2VkIGludG8gdG9vbCBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBFeHBlcmltZW50YWwgKGNhbiBicmVhayBpbiBwYXRjaCByZWxlYXNlcykuXG4gICAgICpcbiAgICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBleHBlcmltZW50YWxfY29udGV4dD86IHVua25vd247XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbC4gRm9yIHRlc3QgdXNlIG9ubHkuIE1heSBjaGFuZ2Ugd2l0aG91dCBub3RpY2UuXG4gICAgICovXG4gICAgX2ludGVybmFsPzoge1xuICAgICAgZ2VuZXJhdGVJZD86IElkR2VuZXJhdG9yO1xuICAgICAgY3VycmVudERhdGU/OiAoKSA9PiBEYXRlO1xuICAgIH07XG4gIH0pOiBQcm9taXNlPEdlbmVyYXRlVGV4dFJlc3VsdDxUT09MUywgT1VUUFVUPj4ge1xuICBjb25zdCBtb2RlbCA9IHJlc29sdmVMYW5ndWFnZU1vZGVsKG1vZGVsQXJnKTtcbiAgY29uc3Qgc3RvcENvbmRpdGlvbnMgPSBhc0FycmF5KHN0b3BXaGVuKTtcbiAgY29uc3QgeyBtYXhSZXRyaWVzLCByZXRyeSB9ID0gcHJlcGFyZVJldHJpZXMoe1xuICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gICAgYWJvcnRTaWduYWwsXG4gIH0pO1xuXG4gIGNvbnN0IGNhbGxTZXR0aW5ncyA9IHByZXBhcmVDYWxsU2V0dGluZ3Moc2V0dGluZ3MpO1xuXG4gIGNvbnN0IGJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzID0gZ2V0QmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgIG1vZGVsLFxuICAgIHRlbGVtZXRyeSxcbiAgICBoZWFkZXJzLFxuICAgIHNldHRpbmdzOiB7IC4uLmNhbGxTZXR0aW5ncywgbWF4UmV0cmllcyB9LFxuICB9KTtcblxuICBjb25zdCBpbml0aWFsUHJvbXB0ID0gYXdhaXQgc3RhbmRhcmRpemVQcm9tcHQoe1xuICAgIHN5c3RlbSxcbiAgICBwcm9tcHQsXG4gICAgbWVzc2FnZXMsXG4gIH0pO1xuXG4gIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcih0ZWxlbWV0cnkpO1xuXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IHJlY29yZFNwYW4oe1xuICAgICAgbmFtZTogJ2FpLmdlbmVyYXRlVGV4dCcsXG4gICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgIG9wZXJhdGlvbklkOiAnYWkuZ2VuZXJhdGVUZXh0JyxcbiAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgICAvLyBtb2RlbDpcbiAgICAgICAgICAnYWkubW9kZWwucHJvdmlkZXInOiBtb2RlbC5wcm92aWRlcixcbiAgICAgICAgICAnYWkubW9kZWwuaWQnOiBtb2RlbC5tb2RlbElkLFxuICAgICAgICAgIC8vIHNwZWNpZmljIHNldHRpbmdzIHRoYXQgb25seSBtYWtlIHNlbnNlIG9uIHRoZSBvdXRlciBsZXZlbDpcbiAgICAgICAgICAnYWkucHJvbXB0Jzoge1xuICAgICAgICAgICAgaW5wdXQ6ICgpID0+IEpTT04uc3RyaW5naWZ5KHsgc3lzdGVtLCBwcm9tcHQsIG1lc3NhZ2VzIH0pLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICAgIHRyYWNlcixcbiAgICAgIGZuOiBhc3luYyBzcGFuID0+IHtcbiAgICAgICAgY29uc3QgY2FsbFNldHRpbmdzID0gcHJlcGFyZUNhbGxTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgICAgICAgbGV0IGN1cnJlbnRNb2RlbFJlc3BvbnNlOiBBd2FpdGVkPFxuICAgICAgICAgIFJldHVyblR5cGU8TGFuZ3VhZ2VNb2RlbFYyWydkb0dlbmVyYXRlJ10+XG4gICAgICAgID4gJiB7IHJlc3BvbnNlOiB7IGlkOiBzdHJpbmc7IHRpbWVzdGFtcDogRGF0ZTsgbW9kZWxJZDogc3RyaW5nIH0gfTtcbiAgICAgICAgbGV0IGNsaWVudFRvb2xDYWxsczogQXJyYXk8VHlwZWRUb29sQ2FsbDxUT09MUz4+ID0gW107XG4gICAgICAgIGxldCBjbGllbnRUb29sT3V0cHV0czogQXJyYXk8VG9vbE91dHB1dDxUT09MUz4+ID0gW107XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlTWVzc2FnZXM6IEFycmF5PFJlc3BvbnNlTWVzc2FnZT4gPSBbXTtcbiAgICAgICAgY29uc3Qgc3RlcHM6IEdlbmVyYXRlVGV4dFJlc3VsdDxUT09MUywgT1VUUFVUPlsnc3RlcHMnXSA9IFtdO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICBjb25zdCBzdGVwSW5wdXRNZXNzYWdlcyA9IFtcbiAgICAgICAgICAgIC4uLmluaXRpYWxQcm9tcHQubWVzc2FnZXMsXG4gICAgICAgICAgICAuLi5yZXNwb25zZU1lc3NhZ2VzLFxuICAgICAgICAgIF07XG5cbiAgICAgICAgICBjb25zdCBwcmVwYXJlU3RlcFJlc3VsdCA9IGF3YWl0IHByZXBhcmVTdGVwPy4oe1xuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICBzdGVwcyxcbiAgICAgICAgICAgIHN0ZXBOdW1iZXI6IHN0ZXBzLmxlbmd0aCxcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBzdGVwSW5wdXRNZXNzYWdlcyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnN0IHByb21wdE1lc3NhZ2VzID0gYXdhaXQgY29udmVydFRvTGFuZ3VhZ2VNb2RlbFByb21wdCh7XG4gICAgICAgICAgICBwcm9tcHQ6IHtcbiAgICAgICAgICAgICAgc3lzdGVtOiBwcmVwYXJlU3RlcFJlc3VsdD8uc3lzdGVtID8/IGluaXRpYWxQcm9tcHQuc3lzdGVtLFxuICAgICAgICAgICAgICBtZXNzYWdlczogcHJlcGFyZVN0ZXBSZXN1bHQ/Lm1lc3NhZ2VzID8/IHN0ZXBJbnB1dE1lc3NhZ2VzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1cHBvcnRlZFVybHM6IGF3YWl0IG1vZGVsLnN1cHBvcnRlZFVybHMsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBzdGVwTW9kZWwgPSByZXNvbHZlTGFuZ3VhZ2VNb2RlbChcbiAgICAgICAgICAgIHByZXBhcmVTdGVwUmVzdWx0Py5tb2RlbCA/PyBtb2RlbCxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgY29uc3QgeyB0b29sQ2hvaWNlOiBzdGVwVG9vbENob2ljZSwgdG9vbHM6IHN0ZXBUb29scyB9ID1cbiAgICAgICAgICAgIHByZXBhcmVUb29sc0FuZFRvb2xDaG9pY2Uoe1xuICAgICAgICAgICAgICB0b29scyxcbiAgICAgICAgICAgICAgdG9vbENob2ljZTogcHJlcGFyZVN0ZXBSZXN1bHQ/LnRvb2xDaG9pY2UgPz8gdG9vbENob2ljZSxcbiAgICAgICAgICAgICAgYWN0aXZlVG9vbHM6IHByZXBhcmVTdGVwUmVzdWx0Py5hY3RpdmVUb29scyA/PyBhY3RpdmVUb29scyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY3VycmVudE1vZGVsUmVzcG9uc2UgPSBhd2FpdCByZXRyeSgoKSA9PlxuICAgICAgICAgICAgcmVjb3JkU3Bhbih7XG4gICAgICAgICAgICAgIG5hbWU6ICdhaS5nZW5lcmF0ZVRleHQuZG9HZW5lcmF0ZScsXG4gICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAuLi5hc3NlbWJsZU9wZXJhdGlvbk5hbWUoe1xuICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb25JZDogJ2FpLmdlbmVyYXRlVGV4dC5kb0dlbmVyYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgIC8vIG1vZGVsOlxuICAgICAgICAgICAgICAgICAgJ2FpLm1vZGVsLnByb3ZpZGVyJzogc3RlcE1vZGVsLnByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgJ2FpLm1vZGVsLmlkJzogc3RlcE1vZGVsLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAvLyBwcm9tcHQ6XG4gICAgICAgICAgICAgICAgICAnYWkucHJvbXB0Lm1lc3NhZ2VzJzoge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dDogKCkgPT4gc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5KHByb21wdE1lc3NhZ2VzKSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAnYWkucHJvbXB0LnRvb2xzJzoge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IHRoZSBsYW5ndWFnZSBtb2RlbCBsZXZlbCB0b29sczpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+IHN0ZXBUb29scz8ubWFwKHRvb2wgPT4gSlNPTi5zdHJpbmdpZnkodG9vbCkpLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICdhaS5wcm9tcHQudG9vbENob2ljZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFRvb2xDaG9pY2UgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeShzdGVwVG9vbENob2ljZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgLy8gc3RhbmRhcmRpemVkIGdlbi1haSBsbG0gc3BhbiBhdHRyaWJ1dGVzOlxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5zeXN0ZW0nOiBzdGVwTW9kZWwucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubW9kZWwnOiBzdGVwTW9kZWwubW9kZWxJZCxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC5mcmVxdWVuY3lfcGVuYWx0eSc6IHNldHRpbmdzLmZyZXF1ZW5jeVBlbmFsdHksXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubWF4X3Rva2Vucyc6IHNldHRpbmdzLm1heE91dHB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC5wcmVzZW5jZV9wZW5hbHR5Jzogc2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5LFxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0LnN0b3Bfc2VxdWVuY2VzJzogc2V0dGluZ3Muc3RvcFNlcXVlbmNlcyxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC50ZW1wZXJhdHVyZSc6XG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLnRlbXBlcmF0dXJlID8/IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC50b3Bfayc6IHNldHRpbmdzLnRvcEssXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX3AnOiBzZXR0aW5ncy50b3BQLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB0cmFjZXIsXG4gICAgICAgICAgICAgIGZuOiBhc3luYyBzcGFuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdGVwTW9kZWwuZG9HZW5lcmF0ZSh7XG4gICAgICAgICAgICAgICAgICAuLi5jYWxsU2V0dGluZ3MsXG4gICAgICAgICAgICAgICAgICB0b29sczogc3RlcFRvb2xzLFxuICAgICAgICAgICAgICAgICAgdG9vbENob2ljZTogc3RlcFRvb2xDaG9pY2UsXG4gICAgICAgICAgICAgICAgICByZXNwb25zZUZvcm1hdDogb3V0cHV0Py5yZXNwb25zZUZvcm1hdCxcbiAgICAgICAgICAgICAgICAgIHByb21wdDogcHJvbXB0TWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBGaWxsIGluIGRlZmF1bHQgdmFsdWVzOlxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgIGlkOiByZXN1bHQucmVzcG9uc2U/LmlkID8/IGdlbmVyYXRlSWQoKSxcbiAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogcmVzdWx0LnJlc3BvbnNlPy50aW1lc3RhbXAgPz8gY3VycmVudERhdGUoKSxcbiAgICAgICAgICAgICAgICAgIG1vZGVsSWQ6IHJlc3VsdC5yZXNwb25zZT8ubW9kZWxJZCA/PyBzdGVwTW9kZWwubW9kZWxJZCxcbiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlc3VsdC5yZXNwb25zZT8uaGVhZGVycyxcbiAgICAgICAgICAgICAgICAgIGJvZHk6IHJlc3VsdC5yZXNwb25zZT8uYm9keSxcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkIHJlc3BvbnNlIGluZm9ybWF0aW9uIHRvIHRoZSBzcGFuOlxuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyhcbiAgICAgICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuZmluaXNoUmVhc29uJzogcmVzdWx0LmZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudGV4dCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogKCkgPT4gZXh0cmFjdENvbnRlbnRUZXh0KHJlc3VsdC5jb250ZW50KSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS50b29sQ2FsbHMnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbENhbGxzID0gYXNUb29sQ2FsbHMocmVzdWx0LmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbENhbGxzID09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkodG9vbENhbGxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuaWQnOiByZXNwb25zZURhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLm1vZGVsJzogcmVzcG9uc2VEYXRhLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnRpbWVzdGFtcCc6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZURhdGEudGltZXN0YW1wLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnByb3ZpZGVyTWV0YWRhdGEnOiBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIHJlbmFtZSB0ZWxlbWV0cnkgYXR0cmlidXRlcyB0byBpbnB1dFRva2VucyBhbmQgb3V0cHV0VG9rZW5zXG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnVzYWdlLnByb21wdFRva2Vucyc6IHJlc3VsdC51c2FnZS5pbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuY29tcGxldGlvblRva2Vucyc6IHJlc3VsdC51c2FnZS5vdXRwdXRUb2tlbnMsXG5cbiAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFuZGFyZGl6ZWQgZ2VuLWFpIGxsbSBzcGFuIGF0dHJpYnV0ZXM6XG4gICAgICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXNwb25zZS5maW5pc2hfcmVhc29ucyc6IFtyZXN1bHQuZmluaXNoUmVhc29uXSxcbiAgICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLmlkJzogcmVzcG9uc2VEYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVzcG9uc2UubW9kZWwnOiByZXNwb25zZURhdGEubW9kZWxJZCxcbiAgICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnVzYWdlLmlucHV0X3Rva2Vucyc6IHJlc3VsdC51c2FnZS5pbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnVzYWdlLm91dHB1dF90b2tlbnMnOiByZXN1bHQudXNhZ2Uub3V0cHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7IC4uLnJlc3VsdCwgcmVzcG9uc2U6IHJlc3BvbnNlRGF0YSB9O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIHBhcnNlIHRvb2wgY2FsbHM6XG4gICAgICAgICAgY29uc3Qgc3RlcFRvb2xDYWxsczogVHlwZWRUb29sQ2FsbDxUT09MUz5bXSA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgICAgY3VycmVudE1vZGVsUmVzcG9uc2UuY29udGVudFxuICAgICAgICAgICAgICAuZmlsdGVyKFxuICAgICAgICAgICAgICAgIChwYXJ0KTogcGFydCBpcyBMYW5ndWFnZU1vZGVsVjJUb29sQ2FsbCA9PlxuICAgICAgICAgICAgICAgICAgcGFydC50eXBlID09PSAndG9vbC1jYWxsJyxcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAubWFwKHRvb2xDYWxsID0+XG4gICAgICAgICAgICAgICAgcGFyc2VUb29sQ2FsbCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbCxcbiAgICAgICAgICAgICAgICAgIHRvb2xzLFxuICAgICAgICAgICAgICAgICAgcmVwYWlyVG9vbENhbGwsXG4gICAgICAgICAgICAgICAgICBzeXN0ZW0sXG4gICAgICAgICAgICAgICAgICBtZXNzYWdlczogc3RlcElucHV0TWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIG5vdGlmeSB0aGUgdG9vbHMgdGhhdCB0aGUgdG9vbCBjYWxscyBhcmUgYXZhaWxhYmxlOlxuICAgICAgICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2Ygc3RlcFRvb2xDYWxscykge1xuICAgICAgICAgICAgaWYgKHRvb2xDYWxsLmludmFsaWQpIHtcbiAgICAgICAgICAgICAgY29udGludWU7IC8vIGlnbm9yZSBpbnZhbGlkIHRvb2wgY2FsbHNcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdG9vbCA9IHRvb2xzIVt0b29sQ2FsbC50b29sTmFtZV07XG4gICAgICAgICAgICBpZiAodG9vbD8ub25JbnB1dEF2YWlsYWJsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHRvb2wub25JbnB1dEF2YWlsYWJsZSh7XG4gICAgICAgICAgICAgICAgaW5wdXQ6IHRvb2xDYWxsLmlucHV0LFxuICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IHN0ZXBJbnB1dE1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgICAgIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBpbnNlcnQgZXJyb3IgdG9vbCBvdXRwdXRzIGZvciBpbnZhbGlkIHRvb2wgY2FsbHM6XG4gICAgICAgICAgLy8gVE9ETyBBSSBTREsgNjogaW52YWxpZCBpbnB1dHMgc2hvdWxkIG5vdCByZXF1aXJlIG91dHB1dCBwYXJ0c1xuICAgICAgICAgIGNvbnN0IGludmFsaWRUb29sQ2FsbHMgPSBzdGVwVG9vbENhbGxzLmZpbHRlcihcbiAgICAgICAgICAgIHRvb2xDYWxsID0+IHRvb2xDYWxsLmludmFsaWQgJiYgdG9vbENhbGwuZHluYW1pYyxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgY2xpZW50VG9vbE91dHB1dHMgPSBbXTtcblxuICAgICAgICAgIGZvciAoY29uc3QgdG9vbENhbGwgb2YgaW52YWxpZFRvb2xDYWxscykge1xuICAgICAgICAgICAgY2xpZW50VG9vbE91dHB1dHMucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6ICd0b29sLWVycm9yJyxcbiAgICAgICAgICAgICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgdG9vbE5hbWU6IHRvb2xDYWxsLnRvb2xOYW1lLFxuICAgICAgICAgICAgICBpbnB1dDogdG9vbENhbGwuaW5wdXQsXG4gICAgICAgICAgICAgIGVycm9yOiBnZXRFcnJvck1lc3NhZ2UodG9vbENhbGwuZXJyb3IhKSxcbiAgICAgICAgICAgICAgZHluYW1pYzogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIGV4ZWN1dGUgY2xpZW50IHRvb2wgY2FsbHM6XG4gICAgICAgICAgY2xpZW50VG9vbENhbGxzID0gc3RlcFRvb2xDYWxscy5maWx0ZXIoXG4gICAgICAgICAgICB0b29sQ2FsbCA9PiAhdG9vbENhbGwucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKHRvb2xzICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNsaWVudFRvb2xPdXRwdXRzLnB1c2goXG4gICAgICAgICAgICAgIC4uLihhd2FpdCBleGVjdXRlVG9vbHMoe1xuICAgICAgICAgICAgICAgIHRvb2xDYWxsczogY2xpZW50VG9vbENhbGxzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsID0+ICF0b29sQ2FsbC5pbnZhbGlkLFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgdG9vbHMsXG4gICAgICAgICAgICAgICAgdHJhY2VyLFxuICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogc3RlcElucHV0TWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgYWJvcnRTaWduYWwsXG4gICAgICAgICAgICAgICAgZXhwZXJpbWVudGFsX2NvbnRleHQsXG4gICAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gY29udGVudDpcbiAgICAgICAgICBjb25zdCBzdGVwQ29udGVudCA9IGFzQ29udGVudCh7XG4gICAgICAgICAgICBjb250ZW50OiBjdXJyZW50TW9kZWxSZXNwb25zZS5jb250ZW50LFxuICAgICAgICAgICAgdG9vbENhbGxzOiBzdGVwVG9vbENhbGxzLFxuICAgICAgICAgICAgdG9vbE91dHB1dHM6IGNsaWVudFRvb2xPdXRwdXRzLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gYXBwZW5kIHRvIG1lc3NhZ2VzIGZvciBwb3RlbnRpYWwgbmV4dCBzdGVwOlxuICAgICAgICAgIHJlc3BvbnNlTWVzc2FnZXMucHVzaChcbiAgICAgICAgICAgIC4uLnRvUmVzcG9uc2VNZXNzYWdlcyh7XG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHN0ZXBDb250ZW50LFxuICAgICAgICAgICAgICB0b29scyxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICAvLyBBZGQgc3RlcCBpbmZvcm1hdGlvbiAoYWZ0ZXIgcmVzcG9uc2UgbWVzc2FnZXMgYXJlIHVwZGF0ZWQpOlxuICAgICAgICAgIGNvbnN0IGN1cnJlbnRTdGVwUmVzdWx0OiBTdGVwUmVzdWx0PFRPT0xTPiA9IG5ldyBEZWZhdWx0U3RlcFJlc3VsdCh7XG4gICAgICAgICAgICBjb250ZW50OiBzdGVwQ29udGVudCxcbiAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogY3VycmVudE1vZGVsUmVzcG9uc2UuZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgdXNhZ2U6IGN1cnJlbnRNb2RlbFJlc3BvbnNlLnVzYWdlLFxuICAgICAgICAgICAgd2FybmluZ3M6IGN1cnJlbnRNb2RlbFJlc3BvbnNlLndhcm5pbmdzLFxuICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogY3VycmVudE1vZGVsUmVzcG9uc2UucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgIHJlcXVlc3Q6IGN1cnJlbnRNb2RlbFJlc3BvbnNlLnJlcXVlc3QgPz8ge30sXG4gICAgICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgICAgICAuLi5jdXJyZW50TW9kZWxSZXNwb25zZS5yZXNwb25zZSxcbiAgICAgICAgICAgICAgLy8gZGVlcCBjbG9uZSBtc2dzIHRvIGF2b2lkIG11dGF0aW5nIHBhc3QgbWVzc2FnZXMgaW4gbXVsdGktc3RlcDpcbiAgICAgICAgICAgICAgbWVzc2FnZXM6IHN0cnVjdHVyZWRDbG9uZShyZXNwb25zZU1lc3NhZ2VzKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBzdGVwcy5wdXNoKGN1cnJlbnRTdGVwUmVzdWx0KTtcbiAgICAgICAgICBhd2FpdCBvblN0ZXBGaW5pc2g/LihjdXJyZW50U3RlcFJlc3VsdCk7XG4gICAgICAgIH0gd2hpbGUgKFxuICAgICAgICAgIC8vIHRoZXJlIGFyZSB0b29sIGNhbGxzOlxuICAgICAgICAgIGNsaWVudFRvb2xDYWxscy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgLy8gYWxsIGN1cnJlbnQgdG9vbCBjYWxscyBoYXZlIG91dHB1dHMgKGluY2wuIGV4ZWN1dGlvbiBlcnJvcnMpOlxuICAgICAgICAgIGNsaWVudFRvb2xPdXRwdXRzLmxlbmd0aCA9PT0gY2xpZW50VG9vbENhbGxzLmxlbmd0aCAmJlxuICAgICAgICAgIC8vIGNvbnRpbnVlIHVudGlsIGEgc3RvcCBjb25kaXRpb24gaXMgbWV0OlxuICAgICAgICAgICEoYXdhaXQgaXNTdG9wQ29uZGl0aW9uTWV0KHsgc3RvcENvbmRpdGlvbnMsIHN0ZXBzIH0pKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEFkZCByZXNwb25zZSBpbmZvcm1hdGlvbiB0byB0aGUgc3BhbjpcbiAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuZmluaXNoUmVhc29uJzogY3VycmVudE1vZGVsUmVzcG9uc2UuZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudGV4dCc6IHtcbiAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+IGV4dHJhY3RDb250ZW50VGV4dChjdXJyZW50TW9kZWxSZXNwb25zZS5jb250ZW50KSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnRvb2xDYWxscyc6IHtcbiAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2xDYWxscyA9IGFzVG9vbENhbGxzKGN1cnJlbnRNb2RlbFJlc3BvbnNlLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvb2xDYWxscyA9PSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIDogSlNPTi5zdHJpbmdpZnkodG9vbENhbGxzKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAnYWkucmVzcG9uc2UucHJvdmlkZXJNZXRhZGF0YSc6IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgICAgIGN1cnJlbnRNb2RlbFJlc3BvbnNlLnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgICAgLy8gVE9ETyByZW5hbWUgdGVsZW1ldHJ5IGF0dHJpYnV0ZXMgdG8gaW5wdXRUb2tlbnMgYW5kIG91dHB1dFRva2Vuc1xuICAgICAgICAgICAgICAnYWkudXNhZ2UucHJvbXB0VG9rZW5zJzogY3VycmVudE1vZGVsUmVzcG9uc2UudXNhZ2UuaW5wdXRUb2tlbnMsXG4gICAgICAgICAgICAgICdhaS51c2FnZS5jb21wbGV0aW9uVG9rZW5zJzpcbiAgICAgICAgICAgICAgICBjdXJyZW50TW9kZWxSZXNwb25zZS51c2FnZS5vdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGxhc3RTdGVwID0gc3RlcHNbc3RlcHMubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgcmV0dXJuIG5ldyBEZWZhdWx0R2VuZXJhdGVUZXh0UmVzdWx0KHtcbiAgICAgICAgICBzdGVwcyxcbiAgICAgICAgICByZXNvbHZlZE91dHB1dDogYXdhaXQgb3V0cHV0Py5wYXJzZU91dHB1dChcbiAgICAgICAgICAgIHsgdGV4dDogbGFzdFN0ZXAudGV4dCB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICByZXNwb25zZTogbGFzdFN0ZXAucmVzcG9uc2UsXG4gICAgICAgICAgICAgIHVzYWdlOiBsYXN0U3RlcC51c2FnZSxcbiAgICAgICAgICAgICAgZmluaXNoUmVhc29uOiBsYXN0U3RlcC5maW5pc2hSZWFzb24sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICksXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyB3cmFwR2F0ZXdheUVycm9yKGVycm9yKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBleGVjdXRlVG9vbHM8VE9PTFMgZXh0ZW5kcyBUb29sU2V0Pih7XG4gIHRvb2xDYWxscyxcbiAgdG9vbHMsXG4gIHRyYWNlcixcbiAgdGVsZW1ldHJ5LFxuICBtZXNzYWdlcyxcbiAgYWJvcnRTaWduYWwsXG4gIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxufToge1xuICB0b29sQ2FsbHM6IEFycmF5PFR5cGVkVG9vbENhbGw8VE9PTFM+PjtcbiAgdG9vbHM6IFRPT0xTO1xuICB0cmFjZXI6IFRyYWNlcjtcbiAgdGVsZW1ldHJ5OiBUZWxlbWV0cnlTZXR0aW5ncyB8IHVuZGVmaW5lZDtcbiAgbWVzc2FnZXM6IE1vZGVsTWVzc2FnZVtdO1xuICBhYm9ydFNpZ25hbDogQWJvcnRTaWduYWwgfCB1bmRlZmluZWQ7XG4gIGV4cGVyaW1lbnRhbF9jb250ZXh0OiB1bmtub3duO1xufSk6IFByb21pc2U8QXJyYXk8VG9vbE91dHB1dDxUT09MUz4+PiB7XG4gIGNvbnN0IHRvb2xPdXRwdXRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgdG9vbENhbGxzLm1hcChhc3luYyAoeyB0b29sQ2FsbElkLCB0b29sTmFtZSwgaW5wdXQgfSkgPT4ge1xuICAgICAgY29uc3QgdG9vbCA9IHRvb2xzW3Rvb2xOYW1lXTtcblxuICAgICAgaWYgKHRvb2w/LmV4ZWN1dGUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVjb3JkU3Bhbih7XG4gICAgICAgIG5hbWU6ICdhaS50b29sQ2FsbCcsXG4gICAgICAgIGF0dHJpYnV0ZXM6IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAuLi5hc3NlbWJsZU9wZXJhdGlvbk5hbWUoe1xuICAgICAgICAgICAgICBvcGVyYXRpb25JZDogJ2FpLnRvb2xDYWxsJyxcbiAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAnYWkudG9vbENhbGwubmFtZSc6IHRvb2xOYW1lLFxuICAgICAgICAgICAgJ2FpLnRvb2xDYWxsLmlkJzogdG9vbENhbGxJZCxcbiAgICAgICAgICAgICdhaS50b29sQ2FsbC5hcmdzJzoge1xuICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+IEpTT04uc3RyaW5naWZ5KGlucHV0KSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIHRyYWNlcixcbiAgICAgICAgZm46IGFzeW5jIHNwYW4gPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdHJlYW0gPSBleGVjdXRlVG9vbCh7XG4gICAgICAgICAgICAgIGV4ZWN1dGU6IHRvb2wuZXhlY3V0ZSEuYmluZCh0b29sKSxcbiAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICB0b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgICAgIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBvdXRwdXQ6IHVua25vd247XG4gICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IHBhcnQgb2Ygc3RyZWFtKSB7XG4gICAgICAgICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdmaW5hbCcpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBwYXJ0Lm91dHB1dDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAnYWkudG9vbENhbGwucmVzdWx0Jzoge1xuICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkob3V0cHV0KSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGNhdGNoIChpZ25vcmVkKSB7XG4gICAgICAgICAgICAgIC8vIEpTT04gc3RyaW5naWZ5IG1pZ2h0IGZhaWwgaWYgdGhlIHJlc3VsdCBpcyBub3Qgc2VyaWFsaXphYmxlLFxuICAgICAgICAgICAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGp1c3QgaWdub3JlIGl0LiBJbiB0aGUgZnV0dXJlIHdlIG1pZ2h0IHdhbnQgdG9cbiAgICAgICAgICAgICAgLy8gYWRkIGFuIG9wdGlvbmFsIHNlcmlhbGl6ZSBtZXRob2QgdG8gdGhlIHRvb2wgaW50ZXJmYWNlIGFuZCB3YXJuXG4gICAgICAgICAgICAgIC8vIGlmIHRoZSByZXN1bHQgaXMgbm90IHNlcmlhbGl6YWJsZS5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyxcbiAgICAgICAgICAgICAgdG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICBvdXRwdXQsXG4gICAgICAgICAgICAgIGR5bmFtaWM6IHRvb2wudHlwZSA9PT0gJ2R5bmFtaWMnLFxuICAgICAgICAgICAgfSBhcyBUeXBlZFRvb2xSZXN1bHQ8VE9PTFM+O1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZWNvcmRFcnJvck9uU3BhbihzcGFuLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB0eXBlOiAndG9vbC1lcnJvcicsXG4gICAgICAgICAgICAgIHRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgIHRvb2xOYW1lLFxuICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAgIGR5bmFtaWM6IHRvb2wudHlwZSA9PT0gJ2R5bmFtaWMnLFxuICAgICAgICAgICAgfSBhcyBUeXBlZFRvb2xFcnJvcjxUT09MUz47XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSksXG4gICk7XG5cbiAgcmV0dXJuIHRvb2xPdXRwdXRzLmZpbHRlcihcbiAgICAob3V0cHV0KTogb3V0cHV0IGlzIE5vbk51bGxhYmxlPHR5cGVvZiBvdXRwdXQ+ID0+IG91dHB1dCAhPSBudWxsLFxuICApO1xufVxuXG5jbGFzcyBEZWZhdWx0R2VuZXJhdGVUZXh0UmVzdWx0PFRPT0xTIGV4dGVuZHMgVG9vbFNldCwgT1VUUFVUPlxuICBpbXBsZW1lbnRzIEdlbmVyYXRlVGV4dFJlc3VsdDxUT09MUywgT1VUUFVUPlxue1xuICByZWFkb25seSBzdGVwczogR2VuZXJhdGVUZXh0UmVzdWx0PFRPT0xTLCBPVVRQVVQ+WydzdGVwcyddO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzb2x2ZWRPdXRwdXQ6IE9VVFBVVDtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiB7XG4gICAgc3RlcHM6IEdlbmVyYXRlVGV4dFJlc3VsdDxUT09MUywgT1VUUFVUPlsnc3RlcHMnXTtcbiAgICByZXNvbHZlZE91dHB1dDogT1VUUFVUO1xuICB9KSB7XG4gICAgdGhpcy5zdGVwcyA9IG9wdGlvbnMuc3RlcHM7XG4gICAgdGhpcy5yZXNvbHZlZE91dHB1dCA9IG9wdGlvbnMucmVzb2x2ZWRPdXRwdXQ7XG4gIH1cblxuICBwcml2YXRlIGdldCBmaW5hbFN0ZXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RlcHNbdGhpcy5zdGVwcy5sZW5ndGggLSAxXTtcbiAgfVxuXG4gIGdldCBjb250ZW50KCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC5jb250ZW50O1xuICB9XG5cbiAgZ2V0IHRleHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRleHQ7XG4gIH1cblxuICBnZXQgZmlsZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLmZpbGVzO1xuICB9XG5cbiAgZ2V0IHJlYXNvbmluZ1RleHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnJlYXNvbmluZ1RleHQ7XG4gIH1cblxuICBnZXQgcmVhc29uaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC5yZWFzb25pbmc7XG4gIH1cblxuICBnZXQgdG9vbENhbGxzKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50b29sQ2FsbHM7XG4gIH1cblxuICBnZXQgc3RhdGljVG9vbENhbGxzKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC5zdGF0aWNUb29sQ2FsbHM7XG4gIH1cblxuICBnZXQgZHluYW1pY1Rvb2xDYWxscygpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAuZHluYW1pY1Rvb2xDYWxscztcbiAgfVxuXG4gIGdldCB0b29sUmVzdWx0cygpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAudG9vbFJlc3VsdHM7XG4gIH1cblxuICBnZXQgc3RhdGljVG9vbFJlc3VsdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnN0YXRpY1Rvb2xSZXN1bHRzO1xuICB9XG5cbiAgZ2V0IGR5bmFtaWNUb29sUmVzdWx0cygpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAuZHluYW1pY1Rvb2xSZXN1bHRzO1xuICB9XG5cbiAgZ2V0IHNvdXJjZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnNvdXJjZXM7XG4gIH1cblxuICBnZXQgZmluaXNoUmVhc29uKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC5maW5pc2hSZWFzb247XG4gIH1cblxuICBnZXQgd2FybmluZ3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLndhcm5pbmdzO1xuICB9XG5cbiAgZ2V0IHByb3ZpZGVyTWV0YWRhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnByb3ZpZGVyTWV0YWRhdGE7XG4gIH1cblxuICBnZXQgcmVzcG9uc2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnJlc3BvbnNlO1xuICB9XG5cbiAgZ2V0IHJlcXVlc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnJlcXVlc3Q7XG4gIH1cblxuICBnZXQgdXNhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnVzYWdlO1xuICB9XG5cbiAgZ2V0IHRvdGFsVXNhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RlcHMucmVkdWNlKFxuICAgICAgKHRvdGFsVXNhZ2UsIHN0ZXApID0+IHtcbiAgICAgICAgcmV0dXJuIGFkZExhbmd1YWdlTW9kZWxVc2FnZSh0b3RhbFVzYWdlLCBzdGVwLnVzYWdlKTtcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlucHV0VG9rZW5zOiB1bmRlZmluZWQsXG4gICAgICAgIG91dHB1dFRva2VuczogdW5kZWZpbmVkLFxuICAgICAgICB0b3RhbFRva2VuczogdW5kZWZpbmVkLFxuICAgICAgICByZWFzb25pbmdUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgY2FjaGVkSW5wdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgIH0gYXMgTGFuZ3VhZ2VNb2RlbFVzYWdlLFxuICAgICk7XG4gIH1cblxuICBnZXQgZXhwZXJpbWVudGFsX291dHB1dCgpIHtcbiAgICBpZiAodGhpcy5yZXNvbHZlZE91dHB1dCA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgTm9PdXRwdXRTcGVjaWZpZWRFcnJvcigpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlc29sdmVkT3V0cHV0O1xuICB9XG59XG5cbmZ1bmN0aW9uIGFzVG9vbENhbGxzKGNvbnRlbnQ6IEFycmF5PExhbmd1YWdlTW9kZWxWMkNvbnRlbnQ+KSB7XG4gIGNvbnN0IHBhcnRzID0gY29udGVudC5maWx0ZXIoXG4gICAgKHBhcnQpOiBwYXJ0IGlzIExhbmd1YWdlTW9kZWxWMlRvb2xDYWxsID0+IHBhcnQudHlwZSA9PT0gJ3Rvb2wtY2FsbCcsXG4gICk7XG5cbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICByZXR1cm4gcGFydHMubWFwKHRvb2xDYWxsID0+ICh7XG4gICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICB0b29sTmFtZTogdG9vbENhbGwudG9vbE5hbWUsXG4gICAgaW5wdXQ6IHRvb2xDYWxsLmlucHV0LFxuICB9KSk7XG59XG5cbmZ1bmN0aW9uIGFzQ29udGVudDxUT09MUyBleHRlbmRzIFRvb2xTZXQ+KHtcbiAgY29udGVudCxcbiAgdG9vbENhbGxzLFxuICB0b29sT3V0cHV0cyxcbn06IHtcbiAgY29udGVudDogQXJyYXk8TGFuZ3VhZ2VNb2RlbFYyQ29udGVudD47XG4gIHRvb2xDYWxsczogQXJyYXk8VHlwZWRUb29sQ2FsbDxUT09MUz4+O1xuICB0b29sT3V0cHV0czogQXJyYXk8VG9vbE91dHB1dDxUT09MUz4+O1xufSk6IEFycmF5PENvbnRlbnRQYXJ0PFRPT0xTPj4ge1xuICByZXR1cm4gW1xuICAgIC4uLmNvbnRlbnQubWFwKHBhcnQgPT4ge1xuICAgICAgc3dpdGNoIChwYXJ0LnR5cGUpIHtcbiAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgIGNhc2UgJ3JlYXNvbmluZyc6XG4gICAgICAgIGNhc2UgJ3NvdXJjZSc6XG4gICAgICAgICAgcmV0dXJuIHBhcnQ7XG5cbiAgICAgICAgY2FzZSAnZmlsZSc6IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2ZpbGUnIGFzIGNvbnN0LFxuICAgICAgICAgICAgZmlsZTogbmV3IERlZmF1bHRHZW5lcmF0ZWRGaWxlKHBhcnQpLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlICd0b29sLWNhbGwnOiB7XG4gICAgICAgICAgcmV0dXJuIHRvb2xDYWxscy5maW5kKFxuICAgICAgICAgICAgdG9vbENhbGwgPT4gdG9vbENhbGwudG9vbENhbGxJZCA9PT0gcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICkhO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSAndG9vbC1yZXN1bHQnOiB7XG4gICAgICAgICAgY29uc3QgdG9vbENhbGwgPSB0b29sQ2FsbHMuZmluZChcbiAgICAgICAgICAgIHRvb2xDYWxsID0+IHRvb2xDYWxsLnRvb2xDYWxsSWQgPT09IHBhcnQudG9vbENhbGxJZCxcbiAgICAgICAgICApITtcblxuICAgICAgICAgIGlmICh0b29sQ2FsbCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRvb2wgY2FsbCAke3BhcnQudG9vbENhbGxJZH0gbm90IGZvdW5kLmApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwYXJ0LmlzRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHR5cGU6ICd0b29sLWVycm9yJyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICB0b29sTmFtZTogcGFydC50b29sTmFtZSBhcyBrZXlvZiBUT09MUyAmIHN0cmluZyxcbiAgICAgICAgICAgICAgaW5wdXQ6IHRvb2xDYWxsLmlucHV0LFxuICAgICAgICAgICAgICBlcnJvcjogcGFydC5yZXN1bHQsXG4gICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGR5bmFtaWM6IHRvb2xDYWxsLmR5bmFtaWMsXG4gICAgICAgICAgICB9IGFzIFR5cGVkVG9vbEVycm9yPFRPT0xTPjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyBhcyBjb25zdCxcbiAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHBhcnQudG9vbENhbGxJZCxcbiAgICAgICAgICAgIHRvb2xOYW1lOiBwYXJ0LnRvb2xOYW1lIGFzIGtleW9mIFRPT0xTICYgc3RyaW5nLFxuICAgICAgICAgICAgaW5wdXQ6IHRvb2xDYWxsLmlucHV0LFxuICAgICAgICAgICAgb3V0cHV0OiBwYXJ0LnJlc3VsdCxcbiAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHRydWUsXG4gICAgICAgICAgICBkeW5hbWljOiB0b29sQ2FsbC5keW5hbWljLFxuICAgICAgICAgIH0gYXMgVHlwZWRUb29sUmVzdWx0PFRPT0xTPjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIC4uLnRvb2xPdXRwdXRzLFxuICBdO1xufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob091dHB1dFNwZWNpZmllZEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuVGhyb3duIHdoZW4gbm8gb3V0cHV0IHR5cGUgaXMgc3BlY2lmaWVkIGFuZCBvdXRwdXQtcmVsYXRlZCBtZXRob2RzIGFyZSBjYWxsZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBOb091dHB1dFNwZWNpZmllZEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7IG1lc3NhZ2UgPSAnTm8gb3V0cHV0IHNwZWNpZmllZC4nIH06IHsgbWVzc2FnZT86IHN0cmluZyB9ID0ge30pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UgfSk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vT3V0cHV0U3BlY2lmaWVkRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IGdhdGV3YXkgfSBmcm9tICdAYWktc2RrL2dhdGV3YXknO1xuaW1wb3J0IHtcbiAgRW1iZWRkaW5nTW9kZWxWMixcbiAgTGFuZ3VhZ2VNb2RlbFYyLFxuICBQcm92aWRlclYyLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3IgfSBmcm9tICcuLi9lcnJvcic7XG5pbXBvcnQgeyBFbWJlZGRpbmdNb2RlbCB9IGZyb20gJy4uL3R5cGVzL2VtYmVkZGluZy1tb2RlbCc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsIH0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwnO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZUxhbmd1YWdlTW9kZWwobW9kZWw6IExhbmd1YWdlTW9kZWwpOiBMYW5ndWFnZU1vZGVsVjIge1xuICBpZiAodHlwZW9mIG1vZGVsICE9PSAnc3RyaW5nJykge1xuICAgIGlmIChtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbiAhPT0gJ3YyJykge1xuICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3Ioe1xuICAgICAgICB2ZXJzaW9uOiBtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbixcbiAgICAgICAgcHJvdmlkZXI6IG1vZGVsLnByb3ZpZGVyLFxuICAgICAgICBtb2RlbElkOiBtb2RlbC5tb2RlbElkLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vZGVsO1xuICB9XG5cbiAgcmV0dXJuIGdldEdsb2JhbFByb3ZpZGVyKCkubGFuZ3VhZ2VNb2RlbChtb2RlbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlRW1iZWRkaW5nTW9kZWw8VkFMVUUgPSBzdHJpbmc+KFxuICBtb2RlbDogRW1iZWRkaW5nTW9kZWw8VkFMVUU+LFxuKTogRW1iZWRkaW5nTW9kZWxWMjxWQUxVRT4ge1xuICBpZiAodHlwZW9mIG1vZGVsICE9PSAnc3RyaW5nJykge1xuICAgIGlmIChtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbiAhPT0gJ3YyJykge1xuICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3Ioe1xuICAgICAgICB2ZXJzaW9uOiBtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbixcbiAgICAgICAgcHJvdmlkZXI6IG1vZGVsLnByb3ZpZGVyLFxuICAgICAgICBtb2RlbElkOiBtb2RlbC5tb2RlbElkLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vZGVsO1xuICB9XG5cbiAgLy8gVE9ETyBBSSBTREsgNjogZmlndXJlIG91dCBob3cgdG8gY2xlYW5seSBzdXBwb3J0IGRpZmZlcmVudCBnZW5lcmljIHR5cGVzXG4gIHJldHVybiBnZXRHbG9iYWxQcm92aWRlcigpLnRleHRFbWJlZGRpbmdNb2RlbChcbiAgICBtb2RlbCxcbiAgKSBhcyBFbWJlZGRpbmdNb2RlbFYyPFZBTFVFPjtcbn1cblxuZnVuY3Rpb24gZ2V0R2xvYmFsUHJvdmlkZXIoKTogUHJvdmlkZXJWMiB7XG4gIHJldHVybiBnbG9iYWxUaGlzLkFJX1NES19ERUZBVUxUX1BST1ZJREVSID8/IGdhdGV3YXk7XG59XG4iLCAiZXhwb3J0IHtcbiAgQUlTREtFcnJvcixcbiAgQVBJQ2FsbEVycm9yLFxuICBFbXB0eVJlc3BvbnNlQm9keUVycm9yLFxuICBJbnZhbGlkUHJvbXB0RXJyb3IsXG4gIEludmFsaWRSZXNwb25zZURhdGFFcnJvcixcbiAgSlNPTlBhcnNlRXJyb3IsXG4gIExvYWRBUElLZXlFcnJvcixcbiAgTm9Db250ZW50R2VuZXJhdGVkRXJyb3IsXG4gIE5vU3VjaE1vZGVsRXJyb3IsXG4gIFR5cGVWYWxpZGF0aW9uRXJyb3IsXG4gIFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuZXhwb3J0IHsgSW52YWxpZEFyZ3VtZW50RXJyb3IgfSBmcm9tICcuL2ludmFsaWQtYXJndW1lbnQtZXJyb3InO1xuZXhwb3J0IHsgSW52YWxpZFN0cmVhbVBhcnRFcnJvciB9IGZyb20gJy4vaW52YWxpZC1zdHJlYW0tcGFydC1lcnJvcic7XG5leHBvcnQgeyBJbnZhbGlkVG9vbElucHV0RXJyb3IgfSBmcm9tICcuL2ludmFsaWQtdG9vbC1pbnB1dC1lcnJvcic7XG5leHBvcnQgeyBNQ1BDbGllbnRFcnJvciB9IGZyb20gJy4vbWNwLWNsaWVudC1lcnJvcic7XG5leHBvcnQgeyBOb0ltYWdlR2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuL25vLWltYWdlLWdlbmVyYXRlZC1lcnJvcic7XG5leHBvcnQgeyBOb09iamVjdEdlbmVyYXRlZEVycm9yIH0gZnJvbSAnLi9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yJztcbmV4cG9ydCB7IE5vT3V0cHV0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuL25vLW91dHB1dC1nZW5lcmF0ZWQtZXJyb3InO1xuZXhwb3J0IHsgTm9PdXRwdXRTcGVjaWZpZWRFcnJvciB9IGZyb20gJy4vbm8tb3V0cHV0LXNwZWNpZmllZC1lcnJvcic7XG5leHBvcnQgeyBOb1N1Y2hUb29sRXJyb3IgfSBmcm9tICcuL25vLXN1Y2gtdG9vbC1lcnJvcic7XG5leHBvcnQgeyBUb29sQ2FsbFJlcGFpckVycm9yIH0gZnJvbSAnLi90b29sLWNhbGwtcmVwYWlyLWVycm9yJztcbmV4cG9ydCB7IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3IgfSBmcm9tICcuL3Vuc3VwcG9ydGVkLW1vZGVsLXZlcnNpb24tZXJyb3InO1xuXG5leHBvcnQgeyBJbnZhbGlkRGF0YUNvbnRlbnRFcnJvciB9IGZyb20gJy4uL3Byb21wdC9pbnZhbGlkLWRhdGEtY29udGVudC1lcnJvcic7XG5leHBvcnQgeyBJbnZhbGlkTWVzc2FnZVJvbGVFcnJvciB9IGZyb20gJy4uL3Byb21wdC9pbnZhbGlkLW1lc3NhZ2Utcm9sZS1lcnJvcic7XG5leHBvcnQgeyBNZXNzYWdlQ29udmVyc2lvbkVycm9yIH0gZnJvbSAnLi4vcHJvbXB0L21lc3NhZ2UtY29udmVyc2lvbi1lcnJvcic7XG5leHBvcnQgeyBEb3dubG9hZEVycm9yIH0gZnJvbSAnLi4vdXRpbC9kb3dubG9hZC1lcnJvcic7XG5leHBvcnQgeyBSZXRyeUVycm9yIH0gZnJvbSAnLi4vdXRpbC9yZXRyeS1lcnJvcic7XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5jb25zdCBuYW1lID0gJ0FJX0ludmFsaWRBcmd1bWVudEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBJbnZhbGlkQXJndW1lbnRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcGFyYW1ldGVyOiBzdHJpbmc7XG4gIHJlYWRvbmx5IHZhbHVlOiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBwYXJhbWV0ZXIsXG4gICAgdmFsdWUsXG4gICAgbWVzc2FnZSxcbiAgfToge1xuICAgIHBhcmFtZXRlcjogc3RyaW5nO1xuICAgIHZhbHVlOiB1bmtub3duO1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgfSkge1xuICAgIHN1cGVyKHtcbiAgICAgIG5hbWUsXG4gICAgICBtZXNzYWdlOiBgSW52YWxpZCBhcmd1bWVudCBmb3IgcGFyYW1ldGVyICR7cGFyYW1ldGVyfTogJHttZXNzYWdlfWAsXG4gICAgfSk7XG5cbiAgICB0aGlzLnBhcmFtZXRlciA9IHBhcmFtZXRlcjtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEludmFsaWRBcmd1bWVudEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBTaW5nbGVSZXF1ZXN0VGV4dFN0cmVhbVBhcnQgfSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L3J1bi10b29scy10cmFuc2Zvcm1hdGlvbic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZFN0cmVhbVBhcnRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgSW52YWxpZFN0cmVhbVBhcnRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgY2h1bms6IFNpbmdsZVJlcXVlc3RUZXh0U3RyZWFtUGFydDxhbnk+O1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBjaHVuayxcbiAgICBtZXNzYWdlLFxuICB9OiB7XG4gICAgY2h1bms6IFNpbmdsZVJlcXVlc3RUZXh0U3RyZWFtUGFydDxhbnk+O1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMuY2h1bmsgPSBjaHVuaztcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgSW52YWxpZFN0cmVhbVBhcnRFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciwgZ2V0RXJyb3JNZXNzYWdlIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZFRvb2xJbnB1dEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBJbnZhbGlkVG9vbElucHV0RXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIHJlYWRvbmx5IHRvb2xOYW1lOiBzdHJpbmc7XG4gIHJlYWRvbmx5IHRvb2xJbnB1dDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICB0b29sSW5wdXQsXG4gICAgdG9vbE5hbWUsXG4gICAgY2F1c2UsXG4gICAgbWVzc2FnZSA9IGBJbnZhbGlkIGlucHV0IGZvciB0b29sICR7dG9vbE5hbWV9OiAke2dldEVycm9yTWVzc2FnZShjYXVzZSl9YCxcbiAgfToge1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gICAgdG9vbElucHV0OiBzdHJpbmc7XG4gICAgdG9vbE5hbWU6IHN0cmluZztcbiAgICBjYXVzZTogdW5rbm93bjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLnRvb2xJbnB1dCA9IHRvb2xJbnB1dDtcbiAgICB0aGlzLnRvb2xOYW1lID0gdG9vbE5hbWU7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIEludmFsaWRUb29sSW5wdXRFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5jb25zdCBuYW1lID0gJ0FJX01DUENsaWVudEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuICogQW4gZXJyb3Igb2NjdXJyZWQgd2l0aCB0aGUgTUNQIGNsaWVudC5cbiAqL1xuZXhwb3J0IGNsYXNzIE1DUENsaWVudEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBuYW1lID0gJ01DUENsaWVudEVycm9yJyxcbiAgICBtZXNzYWdlLFxuICAgIGNhdXNlLFxuICB9OiB7XG4gICAgbmFtZT86IHN0cmluZztcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgY2F1c2U/OiB1bmtub3duO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlLCBjYXVzZSB9KTtcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgTUNQQ2xpZW50RXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IEltYWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvaW1hZ2UtbW9kZWwtcmVzcG9uc2UtbWV0YWRhdGEnO1xuXG5jb25zdCBuYW1lID0gJ0FJX05vSW1hZ2VHZW5lcmF0ZWRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG4vKipcblRocm93biB3aGVuIG5vIGltYWdlIGNvdWxkIGJlIGdlbmVyYXRlZC4gVGhpcyBjYW4gaGF2ZSBtdWx0aXBsZSBjYXVzZXM6XG5cbi0gVGhlIG1vZGVsIGZhaWxlZCB0byBnZW5lcmF0ZSBhIHJlc3BvbnNlLlxuLSBUaGUgbW9kZWwgZ2VuZXJhdGVkIGEgcmVzcG9uc2UgdGhhdCBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICovXG5leHBvcnQgY2xhc3MgTm9JbWFnZUdlbmVyYXRlZEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICAvKipcblRoZSByZXNwb25zZSBtZXRhZGF0YSBmb3IgZWFjaCBjYWxsLlxuICAgKi9cbiAgcmVhZG9ubHkgcmVzcG9uc2VzOiBBcnJheTxJbWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YT4gfCB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lc3NhZ2UgPSAnTm8gaW1hZ2UgZ2VuZXJhdGVkLicsXG4gICAgY2F1c2UsXG4gICAgcmVzcG9uc2VzLFxuICB9OiB7XG4gICAgbWVzc2FnZT86IHN0cmluZztcbiAgICBjYXVzZT86IEVycm9yO1xuICAgIHJlc3BvbnNlcz86IEFycmF5PEltYWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhPjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLnJlc3BvbnNlcyA9IHJlc3BvbnNlcztcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgTm9JbWFnZUdlbmVyYXRlZEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBGaW5pc2hSZWFzb24gfSBmcm9tICcuLi90eXBlcy9sYW5ndWFnZS1tb2RlbCc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsLXJlc3BvbnNlLW1ldGFkYXRhJztcbmltcG9ydCB7IExhbmd1YWdlTW9kZWxVc2FnZSB9IGZyb20gJy4uL3R5cGVzL3VzYWdlJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob09iamVjdEdlbmVyYXRlZEVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbi8qKlxuVGhyb3duIHdoZW4gbm8gb2JqZWN0IGNvdWxkIGJlIGdlbmVyYXRlZC4gVGhpcyBjYW4gaGF2ZSBzZXZlcmFsIGNhdXNlczpcblxuLSBUaGUgbW9kZWwgZmFpbGVkIHRvIGdlbmVyYXRlIGEgcmVzcG9uc2UuXG4tIFRoZSBtb2RlbCBnZW5lcmF0ZWQgYSByZXNwb25zZSB0aGF0IGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4tIFRoZSBtb2RlbCBnZW5lcmF0ZWQgYSByZXNwb25zZSB0aGF0IGNvdWxkIG5vdCBiZSB2YWxpZGF0ZWQgYWdhaW5zdCB0aGUgc2NoZW1hLlxuXG5UaGUgZXJyb3IgY29udGFpbnMgdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxuXG4tIGB0ZXh0YDogVGhlIHRleHQgdGhhdCB3YXMgZ2VuZXJhdGVkIGJ5IHRoZSBtb2RlbC4gVGhpcyBjYW4gYmUgdGhlIHJhdyB0ZXh0IG9yIHRoZSB0b29sIGNhbGwgdGV4dCwgZGVwZW5kaW5nIG9uIHRoZSBtb2RlbC5cbiAqL1xuZXhwb3J0IGNsYXNzIE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIC8qKlxuICBUaGUgdGV4dCB0aGF0IHdhcyBnZW5lcmF0ZWQgYnkgdGhlIG1vZGVsLiBUaGlzIGNhbiBiZSB0aGUgcmF3IHRleHQgb3IgdGhlIHRvb2wgY2FsbCB0ZXh0LCBkZXBlbmRpbmcgb24gdGhlIG1vZGVsLlxuICAgKi9cbiAgcmVhZG9ubHkgdGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICBUaGUgcmVzcG9uc2UgbWV0YWRhdGEuXG4gICAqL1xuICByZWFkb25seSByZXNwb25zZTogTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gIFRoZSB1c2FnZSBvZiB0aGUgbW9kZWwuXG4gICAqL1xuICByZWFkb25seSB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICBSZWFzb24gd2h5IHRoZSBtb2RlbCBmaW5pc2hlZCBnZW5lcmF0aW5nIGEgcmVzcG9uc2UuXG4gICAqL1xuICByZWFkb25seSBmaW5pc2hSZWFzb246IEZpbmlzaFJlYXNvbiB8IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdObyBvYmplY3QgZ2VuZXJhdGVkLicsXG4gICAgY2F1c2UsXG4gICAgdGV4dCxcbiAgICByZXNwb25zZSxcbiAgICB1c2FnZSxcbiAgICBmaW5pc2hSZWFzb24sXG4gIH06IHtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIGNhdXNlPzogRXJyb3I7XG4gICAgdGV4dD86IHN0cmluZztcbiAgICByZXNwb25zZTogTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGE7XG4gICAgdXNhZ2U6IExhbmd1YWdlTW9kZWxVc2FnZTtcbiAgICBmaW5pc2hSZWFzb246IEZpbmlzaFJlYXNvbjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICB0aGlzLnVzYWdlID0gdXNhZ2U7XG4gICAgdGhpcy5maW5pc2hSZWFzb24gPSBmaW5pc2hSZWFzb247XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vT2JqZWN0R2VuZXJhdGVkRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Tm9PYmplY3RHZW5lcmF0ZWRFcnJvcihcbiAgZXJyb3I6IHVua25vd24sXG4gIGV4cGVjdGVkOiB7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIHJlc3BvbnNlOiBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSAmIHtcbiAgICAgIGJvZHk/OiBzdHJpbmc7XG4gICAgfTtcbiAgICB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlO1xuICAgIGZpbmlzaFJlYXNvbjogRmluaXNoUmVhc29uO1xuICB9LFxuKSB7XG4gIGV4cGVjdChOb09iamVjdEdlbmVyYXRlZEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpKS50b0JlVHJ1dGh5KCk7XG4gIGNvbnN0IG5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgPSBlcnJvciBhcyBOb09iamVjdEdlbmVyYXRlZEVycm9yO1xuICBleHBlY3Qobm9PYmplY3RHZW5lcmF0ZWRFcnJvci5tZXNzYWdlKS50b0VxdWFsKGV4cGVjdGVkLm1lc3NhZ2UpO1xuICBleHBlY3Qobm9PYmplY3RHZW5lcmF0ZWRFcnJvci5yZXNwb25zZSkudG9FcXVhbChleHBlY3RlZC5yZXNwb25zZSk7XG4gIGV4cGVjdChub09iamVjdEdlbmVyYXRlZEVycm9yLnVzYWdlKS50b0VxdWFsKGV4cGVjdGVkLnVzYWdlKTtcbiAgZXhwZWN0KG5vT2JqZWN0R2VuZXJhdGVkRXJyb3IuZmluaXNoUmVhc29uKS50b0VxdWFsKGV4cGVjdGVkLmZpbmlzaFJlYXNvbik7XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5jb25zdCBuYW1lID0gJ0FJX05vT3V0cHV0R2VuZXJhdGVkRXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuLyoqXG5UaHJvd24gd2hlbiBubyBMTE0gb3V0cHV0IHdhcyBnZW5lcmF0ZWQsIGUuZy4gYmVjYXVzZSBvZiBlcnJvcnMuXG4gKi9cbmV4cG9ydCBjbGFzcyBOb091dHB1dEdlbmVyYXRlZEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9ICdObyBvdXRwdXQgZ2VuZXJhdGVkLicsXG4gICAgY2F1c2UsXG4gIH06IHtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIGNhdXNlPzogRXJyb3I7XG4gIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vT3V0cHV0R2VuZXJhdGVkRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ob1N1Y2hUb29sRXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGNsYXNzIE5vU3VjaFRvb2xFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdG9vbE5hbWU6IHN0cmluZztcbiAgcmVhZG9ubHkgYXZhaWxhYmxlVG9vbHM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICB0b29sTmFtZSxcbiAgICBhdmFpbGFibGVUb29scyA9IHVuZGVmaW5lZCxcbiAgICBtZXNzYWdlID0gYE1vZGVsIHRyaWVkIHRvIGNhbGwgdW5hdmFpbGFibGUgdG9vbCAnJHt0b29sTmFtZX0nLiAke1xuICAgICAgYXZhaWxhYmxlVG9vbHMgPT09IHVuZGVmaW5lZFxuICAgICAgICA/ICdObyB0b29scyBhcmUgYXZhaWxhYmxlLidcbiAgICAgICAgOiBgQXZhaWxhYmxlIHRvb2xzOiAke2F2YWlsYWJsZVRvb2xzLmpvaW4oJywgJyl9LmBcbiAgICB9YCxcbiAgfToge1xuICAgIHRvb2xOYW1lOiBzdHJpbmc7XG4gICAgYXZhaWxhYmxlVG9vbHM/OiBzdHJpbmdbXSB8IHVuZGVmaW5lZDtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlIH0pO1xuXG4gICAgdGhpcy50b29sTmFtZSA9IHRvb2xOYW1lO1xuICAgIHRoaXMuYXZhaWxhYmxlVG9vbHMgPSBhdmFpbGFibGVUb29scztcbiAgfVxuXG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yOiB1bmtub3duKTogZXJyb3IgaXMgTm9TdWNoVG9vbEVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yLCBnZXRFcnJvck1lc3NhZ2UgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IEludmFsaWRUb29sSW5wdXRFcnJvciB9IGZyb20gJy4vaW52YWxpZC10b29sLWlucHV0LWVycm9yJztcbmltcG9ydCB7IE5vU3VjaFRvb2xFcnJvciB9IGZyb20gJy4vbm8tc3VjaC10b29sLWVycm9yJztcblxuY29uc3QgbmFtZSA9ICdBSV9Ub29sQ2FsbFJlcGFpckVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBUb29sQ2FsbFJlcGFpckVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBvcmlnaW5hbEVycm9yOiBOb1N1Y2hUb29sRXJyb3IgfCBJbnZhbGlkVG9vbElucHV0RXJyb3I7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIGNhdXNlLFxuICAgIG9yaWdpbmFsRXJyb3IsXG4gICAgbWVzc2FnZSA9IGBFcnJvciByZXBhaXJpbmcgdG9vbCBjYWxsOiAke2dldEVycm9yTWVzc2FnZShjYXVzZSl9YCxcbiAgfToge1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gICAgY2F1c2U6IHVua25vd247XG4gICAgb3JpZ2luYWxFcnJvcjogTm9TdWNoVG9vbEVycm9yIHwgSW52YWxpZFRvb2xJbnB1dEVycm9yO1xuICB9KSB7XG4gICAgc3VwZXIoeyBuYW1lLCBtZXNzYWdlLCBjYXVzZSB9KTtcbiAgICB0aGlzLm9yaWdpbmFsRXJyb3IgPSBvcmlnaW5hbEVycm9yO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBUb29sQ2FsbFJlcGFpckVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbi8qKlxuRXJyb3IgdGhhdCBpcyB0aHJvd24gd2hlbiBhIG1vZGVsIHdpdGggYW4gdW5zdXBwb3J0ZWQgdmVyc2lvbiBpcyB1c2VkLlxuICovXG5leHBvcnQgY2xhc3MgVW5zdXBwb3J0ZWRNb2RlbFZlcnNpb25FcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICByZWFkb25seSB2ZXJzaW9uOiBzdHJpbmc7XG4gIHJlYWRvbmx5IHByb3ZpZGVyOiBzdHJpbmc7XG4gIHJlYWRvbmx5IG1vZGVsSWQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiB7IHZlcnNpb246IHN0cmluZzsgcHJvdmlkZXI6IHN0cmluZzsgbW9kZWxJZDogc3RyaW5nIH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lOiAnQUlfVW5zdXBwb3J0ZWRNb2RlbFZlcnNpb25FcnJvcicsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICBgVW5zdXBwb3J0ZWQgbW9kZWwgdmVyc2lvbiAke29wdGlvbnMudmVyc2lvbn0gZm9yIHByb3ZpZGVyIFwiJHtvcHRpb25zLnByb3ZpZGVyfVwiIGFuZCBtb2RlbCBcIiR7b3B0aW9ucy5tb2RlbElkfVwiLiBgICtcbiAgICAgICAgYEFJIFNESyA1IG9ubHkgc3VwcG9ydHMgbW9kZWxzIHRoYXQgaW1wbGVtZW50IHNwZWNpZmljYXRpb24gdmVyc2lvbiBcInYyXCIuYCxcbiAgICB9KTtcblxuICAgIHRoaXMudmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvbjtcbiAgICB0aGlzLnByb3ZpZGVyID0gb3B0aW9ucy5wcm92aWRlcjtcbiAgICB0aGlzLm1vZGVsSWQgPSBvcHRpb25zLm1vZGVsSWQ7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfSW52YWxpZERhdGFDb250ZW50RXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGNsYXNzIEludmFsaWREYXRhQ29udGVudEVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICByZWFkb25seSBjb250ZW50OiB1bmtub3duO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBjb250ZW50LFxuICAgIGNhdXNlLFxuICAgIG1lc3NhZ2UgPSBgSW52YWxpZCBkYXRhIGNvbnRlbnQuIEV4cGVjdGVkIGEgYmFzZTY0IHN0cmluZywgVWludDhBcnJheSwgQXJyYXlCdWZmZXIsIG9yIEJ1ZmZlciwgYnV0IGdvdCAke3R5cGVvZiBjb250ZW50fS5gLFxuICB9OiB7XG4gICAgY29udGVudDogdW5rbm93bjtcbiAgICBjYXVzZT86IHVua25vd247XG4gICAgbWVzc2FnZT86IHN0cmluZztcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLmNvbnRlbnQgPSBjb250ZW50O1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBJbnZhbGlkRGF0YUNvbnRlbnRFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5jb25zdCBuYW1lID0gJ0FJX0ludmFsaWRNZXNzYWdlUm9sZUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCBjbGFzcyBJbnZhbGlkTWVzc2FnZVJvbGVFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcm9sZTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICByb2xlLFxuICAgIG1lc3NhZ2UgPSBgSW52YWxpZCBtZXNzYWdlIHJvbGU6ICcke3JvbGV9Jy4gTXVzdCBiZSBvbmUgb2Y6IFwic3lzdGVtXCIsIFwidXNlclwiLCBcImFzc2lzdGFudFwiLCBcInRvb2xcIi5gLFxuICB9OiB7XG4gICAgcm9sZTogc3RyaW5nO1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG4gIH0pIHtcbiAgICBzdXBlcih7IG5hbWUsIG1lc3NhZ2UgfSk7XG5cbiAgICB0aGlzLnJvbGUgPSByb2xlO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBJbnZhbGlkTWVzc2FnZVJvbGVFcnJvciB7XG4gICAgcmV0dXJuIEFJU0RLRXJyb3IuaGFzTWFya2VyKGVycm9yLCBtYXJrZXIpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQUlTREtFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgVUlNZXNzYWdlIH0gZnJvbSAnLi4vdWkvdWktbWVzc2FnZXMnO1xuXG5jb25zdCBuYW1lID0gJ0FJX01lc3NhZ2VDb252ZXJzaW9uRXJyb3InO1xuY29uc3QgbWFya2VyID0gYHZlcmNlbC5haS5lcnJvci4ke25hbWV9YDtcbmNvbnN0IHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcblxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VDb252ZXJzaW9uRXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBbc3ltYm9sXSA9IHRydWU7IC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuXG4gIHJlYWRvbmx5IG9yaWdpbmFsTWVzc2FnZTogT21pdDxVSU1lc3NhZ2UsICdpZCc+O1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBvcmlnaW5hbE1lc3NhZ2UsXG4gICAgbWVzc2FnZSxcbiAgfToge1xuICAgIG9yaWdpbmFsTWVzc2FnZTogT21pdDxVSU1lc3NhZ2UsICdpZCc+O1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMub3JpZ2luYWxNZXNzYWdlID0gb3JpZ2luYWxNZXNzYWdlO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBNZXNzYWdlQ29udmVyc2lvbkVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfRG93bmxvYWRFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgRG93bmxvYWRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgdXJsOiBzdHJpbmc7XG4gIHJlYWRvbmx5IHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gIHJlYWRvbmx5IHN0YXR1c1RleHQ/OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIHVybCxcbiAgICBzdGF0dXNDb2RlLFxuICAgIHN0YXR1c1RleHQsXG4gICAgY2F1c2UsXG4gICAgbWVzc2FnZSA9IGNhdXNlID09IG51bGxcbiAgICAgID8gYEZhaWxlZCB0byBkb3dubG9hZCAke3VybH06ICR7c3RhdHVzQ29kZX0gJHtzdGF0dXNUZXh0fWBcbiAgICAgIDogYEZhaWxlZCB0byBkb3dubG9hZCAke3VybH06ICR7Y2F1c2V9YCxcbiAgfToge1xuICAgIHVybDogc3RyaW5nO1xuICAgIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gICAgc3RhdHVzVGV4dD86IHN0cmluZztcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICAgIGNhdXNlPzogdW5rbm93bjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSwgY2F1c2UgfSk7XG5cbiAgICB0aGlzLnVybCA9IHVybDtcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgIHRoaXMuc3RhdHVzVGV4dCA9IHN0YXR1c1RleHQ7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIERvd25sb2FkRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuY29uc3QgbmFtZSA9ICdBSV9SZXRyeUVycm9yJztcbmNvbnN0IG1hcmtlciA9IGB2ZXJjZWwuYWkuZXJyb3IuJHtuYW1lfWA7XG5jb25zdCBzeW1ib2wgPSBTeW1ib2wuZm9yKG1hcmtlcik7XG5cbmV4cG9ydCB0eXBlIFJldHJ5RXJyb3JSZWFzb24gPVxuICB8ICdtYXhSZXRyaWVzRXhjZWVkZWQnXG4gIHwgJ2Vycm9yTm90UmV0cnlhYmxlJ1xuICB8ICdhYm9ydCc7XG5cbmV4cG9ydCBjbGFzcyBSZXRyeUVycm9yIGV4dGVuZHMgQUlTREtFcnJvciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgW3N5bWJvbF0gPSB0cnVlOyAvLyB1c2VkIGluIGlzSW5zdGFuY2VcblxuICAvLyBub3RlOiBwcm9wZXJ0eSBvcmRlciBkZXRlcm1pbmVzIGRlYnVnZ2luZyBvdXRwdXRcbiAgcmVhZG9ubHkgcmVhc29uOiBSZXRyeUVycm9yUmVhc29uO1xuICByZWFkb25seSBsYXN0RXJyb3I6IHVua25vd247XG4gIHJlYWRvbmx5IGVycm9yczogQXJyYXk8dW5rbm93bj47XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lc3NhZ2UsXG4gICAgcmVhc29uLFxuICAgIGVycm9ycyxcbiAgfToge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICByZWFzb246IFJldHJ5RXJyb3JSZWFzb247XG4gICAgZXJyb3JzOiBBcnJheTx1bmtub3duPjtcbiAgfSkge1xuICAgIHN1cGVyKHsgbmFtZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMucmVhc29uID0gcmVhc29uO1xuICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xuXG4gICAgLy8gc2VwYXJhdGUgb3VyIGxhc3QgZXJyb3IgdG8gbWFrZSBkZWJ1Z2dpbmcgdmlhIGxvZyBlYXNpZXI6XG4gICAgdGhpcy5sYXN0RXJyb3IgPSBlcnJvcnNbZXJyb3JzLmxlbmd0aCAtIDFdO1xuICB9XG5cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3I6IHVua25vd24pOiBlcnJvciBpcyBSZXRyeUVycm9yIHtcbiAgICByZXR1cm4gQUlTREtFcnJvci5oYXNNYXJrZXIoZXJyb3IsIG1hcmtlcik7XG4gIH1cbn1cbiIsICJpbXBvcnQge1xuICBMYW5ndWFnZU1vZGVsVjJGaWxlUGFydCxcbiAgTGFuZ3VhZ2VNb2RlbFYyTWVzc2FnZSxcbiAgTGFuZ3VhZ2VNb2RlbFYyUHJvbXB0LFxuICBMYW5ndWFnZU1vZGVsVjJUZXh0UGFydCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBEYXRhQ29udGVudCxcbiAgRmlsZVBhcnQsXG4gIEltYWdlUGFydCxcbiAgaXNVcmxTdXBwb3J0ZWQsXG4gIE1vZGVsTWVzc2FnZSxcbiAgVGV4dFBhcnQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHtcbiAgZGV0ZWN0TWVkaWFUeXBlLFxuICBpbWFnZU1lZGlhVHlwZVNpZ25hdHVyZXMsXG59IGZyb20gJy4uL3V0aWwvZGV0ZWN0LW1lZGlhLXR5cGUnO1xuaW1wb3J0IHsgZG93bmxvYWQgfSBmcm9tICcuLi91dGlsL2Rvd25sb2FkJztcbmltcG9ydCB7IGNvbnZlcnRUb0xhbmd1YWdlTW9kZWxWMkRhdGFDb250ZW50IH0gZnJvbSAnLi9kYXRhLWNvbnRlbnQnO1xuaW1wb3J0IHsgSW52YWxpZE1lc3NhZ2VSb2xlRXJyb3IgfSBmcm9tICcuL2ludmFsaWQtbWVzc2FnZS1yb2xlLWVycm9yJztcbmltcG9ydCB7IFN0YW5kYXJkaXplZFByb21wdCB9IGZyb20gJy4vc3RhbmRhcmRpemUtcHJvbXB0JztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRUb0xhbmd1YWdlTW9kZWxQcm9tcHQoe1xuICBwcm9tcHQsXG4gIHN1cHBvcnRlZFVybHMsXG4gIGRvd25sb2FkSW1wbGVtZW50YXRpb24gPSBkb3dubG9hZCxcbn06IHtcbiAgcHJvbXB0OiBTdGFuZGFyZGl6ZWRQcm9tcHQ7XG4gIHN1cHBvcnRlZFVybHM6IFJlY29yZDxzdHJpbmcsIFJlZ0V4cFtdPjtcbiAgZG93bmxvYWRJbXBsZW1lbnRhdGlvbj86IHR5cGVvZiBkb3dubG9hZDtcbn0pOiBQcm9taXNlPExhbmd1YWdlTW9kZWxWMlByb21wdD4ge1xuICBjb25zdCBkb3dubG9hZGVkQXNzZXRzID0gYXdhaXQgZG93bmxvYWRBc3NldHMoXG4gICAgcHJvbXB0Lm1lc3NhZ2VzLFxuICAgIGRvd25sb2FkSW1wbGVtZW50YXRpb24sXG4gICAgc3VwcG9ydGVkVXJscyxcbiAgKTtcblxuICByZXR1cm4gW1xuICAgIC4uLihwcm9tcHQuc3lzdGVtICE9IG51bGxcbiAgICAgID8gW3sgcm9sZTogJ3N5c3RlbScgYXMgY29uc3QsIGNvbnRlbnQ6IHByb21wdC5zeXN0ZW0gfV1cbiAgICAgIDogW10pLFxuICAgIC4uLnByb21wdC5tZXNzYWdlcy5tYXAobWVzc2FnZSA9PlxuICAgICAgY29udmVydFRvTGFuZ3VhZ2VNb2RlbE1lc3NhZ2UoeyBtZXNzYWdlLCBkb3dubG9hZGVkQXNzZXRzIH0pLFxuICAgICksXG4gIF07XG59XG5cbi8qKlxuICogQ29udmVydCBhIE1vZGVsTWVzc2FnZSB0byBhIExhbmd1YWdlTW9kZWxWMk1lc3NhZ2UuXG4gKlxuICogQHBhcmFtIG1lc3NhZ2UgVGhlIE1vZGVsTWVzc2FnZSB0byBjb252ZXJ0LlxuICogQHBhcmFtIGRvd25sb2FkZWRBc3NldHMgQSBtYXAgb2YgVVJMcyB0byB0aGVpciBkb3dubG9hZGVkIGRhdGEuIE9ubHlcbiAqICAgYXZhaWxhYmxlIGlmIHRoZSBtb2RlbCBkb2VzIG5vdCBzdXBwb3J0IFVSTHMsIG51bGwgb3RoZXJ3aXNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFRvTGFuZ3VhZ2VNb2RlbE1lc3NhZ2Uoe1xuICBtZXNzYWdlLFxuICBkb3dubG9hZGVkQXNzZXRzLFxufToge1xuICBtZXNzYWdlOiBNb2RlbE1lc3NhZ2U7XG4gIGRvd25sb2FkZWRBc3NldHM6IFJlY29yZDxcbiAgICBzdHJpbmcsXG4gICAgeyBtZWRpYVR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDsgZGF0YTogVWludDhBcnJheSB9XG4gID47XG59KTogTGFuZ3VhZ2VNb2RlbFYyTWVzc2FnZSB7XG4gIGNvbnN0IHJvbGUgPSBtZXNzYWdlLnJvbGU7XG4gIHN3aXRjaCAocm9sZSkge1xuICAgIGNhc2UgJ3N5c3RlbSc6IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlLmNvbnRlbnQsXG4gICAgICAgIHByb3ZpZGVyT3B0aW9uczogbWVzc2FnZS5wcm92aWRlck9wdGlvbnMsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNhc2UgJ3VzZXInOiB7XG4gICAgICBpZiAodHlwZW9mIG1lc3NhZ2UuY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogW3sgdHlwZTogJ3RleHQnLCB0ZXh0OiBtZXNzYWdlLmNvbnRlbnQgfV0sXG4gICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBtZXNzYWdlLnByb3ZpZGVyT3B0aW9ucyxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlLmNvbnRlbnRcbiAgICAgICAgICAubWFwKHBhcnQgPT4gY29udmVydFBhcnRUb0xhbmd1YWdlTW9kZWxQYXJ0KHBhcnQsIGRvd25sb2FkZWRBc3NldHMpKVxuICAgICAgICAgIC8vIHJlbW92ZSBlbXB0eSB0ZXh0IHBhcnRzOlxuICAgICAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgIT09ICd0ZXh0JyB8fCBwYXJ0LnRleHQgIT09ICcnKSxcbiAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBtZXNzYWdlLnByb3ZpZGVyT3B0aW9ucyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY2FzZSAnYXNzaXN0YW50Jzoge1xuICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgY29udGVudDogW3sgdHlwZTogJ3RleHQnLCB0ZXh0OiBtZXNzYWdlLmNvbnRlbnQgfV0sXG4gICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBtZXNzYWdlLnByb3ZpZGVyT3B0aW9ucyxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UuY29udGVudFxuICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAvLyByZW1vdmUgZW1wdHkgdGV4dCBwYXJ0czpcbiAgICAgICAgICAgIHBhcnQgPT4gcGFydC50eXBlICE9PSAndGV4dCcgfHwgcGFydC50ZXh0ICE9PSAnJyxcbiAgICAgICAgICApXG4gICAgICAgICAgLm1hcChwYXJ0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVyT3B0aW9ucyA9IHBhcnQucHJvdmlkZXJPcHRpb25zO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHBhcnQudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlICdmaWxlJzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YSwgbWVkaWFUeXBlIH0gPSBjb252ZXJ0VG9MYW5ndWFnZU1vZGVsVjJEYXRhQ29udGVudChcbiAgICAgICAgICAgICAgICAgIHBhcnQuZGF0YSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAnZmlsZScsXG4gICAgICAgICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHBhcnQuZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICBtZWRpYVR5cGU6IG1lZGlhVHlwZSA/PyBwYXJ0Lm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgJ3JlYXNvbmluZyc6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ3JlYXNvbmluZycsXG4gICAgICAgICAgICAgICAgICB0ZXh0OiBwYXJ0LnRleHQsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjYXNlICd0ZXh0Jzoge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcgYXMgY29uc3QsXG4gICAgICAgICAgICAgICAgICB0ZXh0OiBwYXJ0LnRleHQsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjYXNlICd0b29sLWNhbGwnOiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICd0b29sLWNhbGwnIGFzIGNvbnN0LFxuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogcGFydC5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHBhcnQucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNhc2UgJ3Rvb2wtcmVzdWx0Jzoge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1yZXN1bHQnIGFzIGNvbnN0LFxuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBvdXRwdXQ6IHBhcnQub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSxcbiAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBtZXNzYWdlLnByb3ZpZGVyT3B0aW9ucyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY2FzZSAndG9vbCc6IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJvbGU6ICd0b29sJyxcbiAgICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50Lm1hcChwYXJ0ID0+ICh7XG4gICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyBhcyBjb25zdCxcbiAgICAgICAgICB0b29sQ2FsbElkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgb3V0cHV0OiBwYXJ0Lm91dHB1dCxcbiAgICAgICAgICBwcm92aWRlck9wdGlvbnM6IHBhcnQucHJvdmlkZXJPcHRpb25zLFxuICAgICAgICB9KSksXG4gICAgICAgIHByb3ZpZGVyT3B0aW9uczogbWVzc2FnZS5wcm92aWRlck9wdGlvbnMsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIGNvbnN0IF9leGhhdXN0aXZlQ2hlY2s6IG5ldmVyID0gcm9sZTtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkTWVzc2FnZVJvbGVFcnJvcih7IHJvbGU6IF9leGhhdXN0aXZlQ2hlY2sgfSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRG93bmxvYWRzIGltYWdlcyBhbmQgZmlsZXMgZnJvbSBVUkxzIGluIHRoZSBtZXNzYWdlcy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZG93bmxvYWRBc3NldHMoXG4gIG1lc3NhZ2VzOiBNb2RlbE1lc3NhZ2VbXSxcbiAgZG93bmxvYWRJbXBsZW1lbnRhdGlvbjogdHlwZW9mIGRvd25sb2FkLFxuICBzdXBwb3J0ZWRVcmxzOiBSZWNvcmQ8c3RyaW5nLCBSZWdFeHBbXT4sXG4pOiBQcm9taXNlPFxuICBSZWNvcmQ8c3RyaW5nLCB7IG1lZGlhVHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkOyBkYXRhOiBVaW50OEFycmF5IH0+XG4+IHtcbiAgY29uc3QgdXJscyA9IG1lc3NhZ2VzXG4gICAgLmZpbHRlcihtZXNzYWdlID0+IG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKVxuICAgIC5tYXAobWVzc2FnZSA9PiBtZXNzYWdlLmNvbnRlbnQpXG4gICAgLmZpbHRlcigoY29udGVudCk6IGNvbnRlbnQgaXMgQXJyYXk8VGV4dFBhcnQgfCBJbWFnZVBhcnQgfCBGaWxlUGFydD4gPT5cbiAgICAgIEFycmF5LmlzQXJyYXkoY29udGVudCksXG4gICAgKVxuICAgIC5mbGF0KClcbiAgICAuZmlsdGVyKFxuICAgICAgKHBhcnQpOiBwYXJ0IGlzIEltYWdlUGFydCB8IEZpbGVQYXJ0ID0+XG4gICAgICAgIHBhcnQudHlwZSA9PT0gJ2ltYWdlJyB8fCBwYXJ0LnR5cGUgPT09ICdmaWxlJyxcbiAgICApXG4gICAgLm1hcChwYXJ0ID0+IHtcbiAgICAgIGNvbnN0IG1lZGlhVHlwZSA9XG4gICAgICAgIHBhcnQubWVkaWFUeXBlID8/IChwYXJ0LnR5cGUgPT09ICdpbWFnZScgPyAnaW1hZ2UvKicgOiB1bmRlZmluZWQpO1xuXG4gICAgICBsZXQgZGF0YSA9IHBhcnQudHlwZSA9PT0gJ2ltYWdlJyA/IHBhcnQuaW1hZ2UgOiBwYXJ0LmRhdGE7XG4gICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZGF0YSA9IG5ldyBVUkwoZGF0YSk7XG4gICAgICAgIH0gY2F0Y2ggKGlnbm9yZWQpIHt9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IG1lZGlhVHlwZSwgZGF0YSB9O1xuICAgIH0pXG4gICAgLyoqXG4gICAgICogRmlsdGVyIG91dCBVUkxzIHRoYXQgdGhlIG1vZGVsIHN1cHBvcnRzIG5hdGl2ZWx5LCBzbyB3ZSBkb24ndCBkb3dubG9hZCB0aGVtLlxuICAgICAqL1xuICAgIC5maWx0ZXIoXG4gICAgICAocGFydCk6IHBhcnQgaXMgeyBtZWRpYVR5cGU6IHN0cmluZzsgZGF0YTogVVJMIH0gPT5cbiAgICAgICAgcGFydC5kYXRhIGluc3RhbmNlb2YgVVJMICYmXG4gICAgICAgIHBhcnQubWVkaWFUeXBlICE9IG51bGwgJiZcbiAgICAgICAgIWlzVXJsU3VwcG9ydGVkKHtcbiAgICAgICAgICB1cmw6IHBhcnQuZGF0YS50b1N0cmluZygpLFxuICAgICAgICAgIG1lZGlhVHlwZTogcGFydC5tZWRpYVR5cGUsXG4gICAgICAgICAgc3VwcG9ydGVkVXJscyxcbiAgICAgICAgfSksXG4gICAgKVxuICAgIC5tYXAocGFydCA9PiBwYXJ0LmRhdGEpO1xuXG4gIC8vIGRvd25sb2FkIGluIHBhcmFsbGVsOlxuICBjb25zdCBkb3dubG9hZGVkSW1hZ2VzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgdXJscy5tYXAoYXN5bmMgdXJsID0+ICh7XG4gICAgICB1cmwsXG4gICAgICBkYXRhOiBhd2FpdCBkb3dubG9hZEltcGxlbWVudGF0aW9uKHsgdXJsIH0pLFxuICAgIH0pKSxcbiAgKTtcblxuICByZXR1cm4gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIGRvd25sb2FkZWRJbWFnZXMubWFwKCh7IHVybCwgZGF0YSB9KSA9PiBbdXJsLnRvU3RyaW5nKCksIGRhdGFdKSxcbiAgKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0IHBhcnQgb2YgYSBtZXNzYWdlIHRvIGEgTGFuZ3VhZ2VNb2RlbFYyUGFydC5cbiAqIEBwYXJhbSBwYXJ0IFRoZSBwYXJ0IHRvIGNvbnZlcnQuXG4gKiBAcGFyYW0gZG93bmxvYWRlZEFzc2V0cyBBIG1hcCBvZiBVUkxzIHRvIHRoZWlyIGRvd25sb2FkZWQgZGF0YS4gT25seVxuICogIGF2YWlsYWJsZSBpZiB0aGUgbW9kZWwgZG9lcyBub3Qgc3VwcG9ydCBVUkxzLCBudWxsIG90aGVyd2lzZS5cbiAqXG4gKiBAcmV0dXJucyBUaGUgY29udmVydGVkIHBhcnQuXG4gKi9cbmZ1bmN0aW9uIGNvbnZlcnRQYXJ0VG9MYW5ndWFnZU1vZGVsUGFydChcbiAgcGFydDogVGV4dFBhcnQgfCBJbWFnZVBhcnQgfCBGaWxlUGFydCxcbiAgZG93bmxvYWRlZEFzc2V0czogUmVjb3JkPFxuICAgIHN0cmluZyxcbiAgICB7IG1lZGlhVHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkOyBkYXRhOiBVaW50OEFycmF5IH1cbiAgPixcbik6IExhbmd1YWdlTW9kZWxWMlRleHRQYXJ0IHwgTGFuZ3VhZ2VNb2RlbFYyRmlsZVBhcnQge1xuICBpZiAocGFydC50eXBlID09PSAndGV4dCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgdGV4dDogcGFydC50ZXh0LFxuICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyT3B0aW9ucyxcbiAgICB9O1xuICB9XG5cbiAgbGV0IG9yaWdpbmFsRGF0YTogRGF0YUNvbnRlbnQgfCBVUkw7XG4gIGNvbnN0IHR5cGUgPSBwYXJ0LnR5cGU7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ2ltYWdlJzpcbiAgICAgIG9yaWdpbmFsRGF0YSA9IHBhcnQuaW1hZ2U7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdmaWxlJzpcbiAgICAgIG9yaWdpbmFsRGF0YSA9IHBhcnQuZGF0YTtcblxuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgcGFydCB0eXBlOiAke3R5cGV9YCk7XG4gIH1cblxuICBjb25zdCB7IGRhdGE6IGNvbnZlcnRlZERhdGEsIG1lZGlhVHlwZTogY29udmVydGVkTWVkaWFUeXBlIH0gPVxuICAgIGNvbnZlcnRUb0xhbmd1YWdlTW9kZWxWMkRhdGFDb250ZW50KG9yaWdpbmFsRGF0YSk7XG5cbiAgbGV0IG1lZGlhVHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gY29udmVydGVkTWVkaWFUeXBlID8/IHBhcnQubWVkaWFUeXBlO1xuICBsZXQgZGF0YTogVWludDhBcnJheSB8IHN0cmluZyB8IFVSTCA9IGNvbnZlcnRlZERhdGE7IC8vIGJpbmFyeSB8IGJhc2U2NCB8IHVybFxuXG4gIC8vIElmIHRoZSBjb250ZW50IGlzIGEgVVJMLCB3ZSBjaGVjayBpZiBpdCB3YXMgZG93bmxvYWRlZDpcbiAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVUkwpIHtcbiAgICBjb25zdCBkb3dubG9hZGVkRmlsZSA9IGRvd25sb2FkZWRBc3NldHNbZGF0YS50b1N0cmluZygpXTtcbiAgICBpZiAoZG93bmxvYWRlZEZpbGUpIHtcbiAgICAgIGRhdGEgPSBkb3dubG9hZGVkRmlsZS5kYXRhO1xuICAgICAgbWVkaWFUeXBlID8/PSBkb3dubG9hZGVkRmlsZS5tZWRpYVR5cGU7XG4gICAgfVxuICB9XG5cbiAgLy8gTm93IHRoYXQgd2UgaGF2ZSB0aGUgbm9ybWFsaXplZCBkYXRhIGVpdGhlciBhcyBhIFVSTCBvciBhIFVpbnQ4QXJyYXksXG4gIC8vIHdlIGNhbiBjcmVhdGUgdGhlIExhbmd1YWdlTW9kZWxWMlBhcnQuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ2ltYWdlJzoge1xuICAgICAgLy8gV2hlbiBwb3NzaWJsZSwgdHJ5IHRvIGRldGVjdCB0aGUgbWVkaWEgdHlwZSBhdXRvbWF0aWNhbGx5XG4gICAgICAvLyB0byBkZWFsIHdpdGggaW5jb3JyZWN0IG1lZGlhIHR5cGUgaW5wdXRzLlxuICAgICAgLy8gV2hlbiBkZXRlY3Rpb24gZmFpbHMsIHVzZSBwcm92aWRlZCBtZWRpYSB0eXBlLlxuICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8IHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgICBtZWRpYVR5cGUgPVxuICAgICAgICAgIGRldGVjdE1lZGlhVHlwZSh7IGRhdGEsIHNpZ25hdHVyZXM6IGltYWdlTWVkaWFUeXBlU2lnbmF0dXJlcyB9KSA/P1xuICAgICAgICAgIG1lZGlhVHlwZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ2ZpbGUnLFxuICAgICAgICBtZWRpYVR5cGU6IG1lZGlhVHlwZSA/PyAnaW1hZ2UvKicsIC8vIGFueSBpbWFnZVxuICAgICAgICBmaWxlbmFtZTogdW5kZWZpbmVkLFxuICAgICAgICBkYXRhLFxuICAgICAgICBwcm92aWRlck9wdGlvbnM6IHBhcnQucHJvdmlkZXJPcHRpb25zLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlICdmaWxlJzoge1xuICAgICAgLy8gV2UgbXVzdCBoYXZlIGEgbWVkaWFUeXBlIGZvciBmaWxlcywgaWYgbm90LCB0aHJvdyBhbiBlcnJvci5cbiAgICAgIGlmIChtZWRpYVR5cGUgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1lZGlhIHR5cGUgaXMgbWlzc2luZyBmb3IgZmlsZSBwYXJ0YCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdmaWxlJyxcbiAgICAgICAgbWVkaWFUeXBlLFxuICAgICAgICBmaWxlbmFtZTogcGFydC5maWxlbmFtZSxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyT3B0aW9ucyxcbiAgICAgIH07XG4gICAgfVxuICB9XG59XG4iLCAiaW1wb3J0IHsgY29udmVydEJhc2U2NFRvVWludDhBcnJheSB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuXG5leHBvcnQgY29uc3QgaW1hZ2VNZWRpYVR5cGVTaWduYXR1cmVzID0gW1xuICB7XG4gICAgbWVkaWFUeXBlOiAnaW1hZ2UvZ2lmJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4NDcsIDB4NDksIDB4NDZdLFxuICAgIGJhc2U2NFByZWZpeDogJ1IwbEcnLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnaW1hZ2UvcG5nJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4ODksIDB4NTAsIDB4NGUsIDB4NDddLFxuICAgIGJhc2U2NFByZWZpeDogJ2lWQk9SdycsXG4gIH0sXG4gIHtcbiAgICBtZWRpYVR5cGU6ICdpbWFnZS9qcGVnJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4ZmYsIDB4ZDhdLFxuICAgIGJhc2U2NFByZWZpeDogJy85ai8nLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnaW1hZ2Uvd2VicCcgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweDUyLCAweDQ5LCAweDQ2LCAweDQ2XSxcbiAgICBiYXNlNjRQcmVmaXg6ICdVa2xHUmcnLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnaW1hZ2UvYm1wJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4NDIsIDB4NGRdLFxuICAgIGJhc2U2NFByZWZpeDogJ1FrJyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2ltYWdlL3RpZmYnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHg0OSwgMHg0OSwgMHgyYSwgMHgwMF0sXG4gICAgYmFzZTY0UHJlZml4OiAnU1VrcUFBJyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2ltYWdlL3RpZmYnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHg0ZCwgMHg0ZCwgMHgwMCwgMHgyYV0sXG4gICAgYmFzZTY0UHJlZml4OiAnVFUwQUtnJyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2ltYWdlL2F2aWYnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbXG4gICAgICAweDAwLCAweDAwLCAweDAwLCAweDIwLCAweDY2LCAweDc0LCAweDc5LCAweDcwLCAweDYxLCAweDc2LCAweDY5LCAweDY2LFxuICAgIF0sXG4gICAgYmFzZTY0UHJlZml4OiAnQUFBQUlHWjBlWEJoZG1sbScsXG4gIH0sXG4gIHtcbiAgICBtZWRpYVR5cGU6ICdpbWFnZS9oZWljJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogW1xuICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgyMCwgMHg2NiwgMHg3NCwgMHg3OSwgMHg3MCwgMHg2OCwgMHg2NSwgMHg2OSwgMHg2MyxcbiAgICBdLFxuICAgIGJhc2U2NFByZWZpeDogJ0FBQUFJR1owZVhCb1pXbGonLFxuICB9LFxuXSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IGF1ZGlvTWVkaWFUeXBlU2lnbmF0dXJlcyA9IFtcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL21wZWcnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHhmZiwgMHhmYl0sXG4gICAgYmFzZTY0UHJlZml4OiAnLy9zPScsXG4gIH0sXG4gIHtcbiAgICBtZWRpYVR5cGU6ICdhdWRpby9tcGVnJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4ZmYsIDB4ZmFdLFxuICAgIGJhc2U2NFByZWZpeDogJy8vbz0nLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnYXVkaW8vbXBlZycgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweGZmLCAweGYzXSxcbiAgICBiYXNlNjRQcmVmaXg6ICcvL009JyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL21wZWcnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHhmZiwgMHhmMl0sXG4gICAgYmFzZTY0UHJlZml4OiAnLy9JPScsXG4gIH0sXG4gIHtcbiAgICBtZWRpYVR5cGU6ICdhdWRpby9tcGVnJyBhcyBjb25zdCxcbiAgICBieXRlc1ByZWZpeDogWzB4ZmYsIDB4ZTNdLFxuICAgIGJhc2U2NFByZWZpeDogJy8rTT0nLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnYXVkaW8vbXBlZycgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweGZmLCAweGUyXSxcbiAgICBiYXNlNjRQcmVmaXg6ICcvK0k9JyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL3dhdicgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweDUyLCAweDQ5LCAweDQ2LCAweDQ2XSxcbiAgICBiYXNlNjRQcmVmaXg6ICdVa2xHUicsXG4gIH0sXG4gIHtcbiAgICBtZWRpYVR5cGU6ICdhdWRpby9vZ2cnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHg0ZiwgMHg2NywgMHg2NywgMHg1M10sXG4gICAgYmFzZTY0UHJlZml4OiAnVDJkblV3JyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL2ZsYWMnIGFzIGNvbnN0LFxuICAgIGJ5dGVzUHJlZml4OiBbMHg2NiwgMHg0YywgMHg2MSwgMHg0M10sXG4gICAgYmFzZTY0UHJlZml4OiAnWmt4aFF3JyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL2FhYycgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweDQwLCAweDE1LCAweDAwLCAweDAwXSxcbiAgICBiYXNlNjRQcmVmaXg6ICdRQlVBJyxcbiAgfSxcbiAge1xuICAgIG1lZGlhVHlwZTogJ2F1ZGlvL21wNCcgYXMgY29uc3QsXG4gICAgYnl0ZXNQcmVmaXg6IFsweDY2LCAweDc0LCAweDc5LCAweDcwXSxcbiAgICBiYXNlNjRQcmVmaXg6ICdablI1Y0EnLFxuICB9LFxuICB7XG4gICAgbWVkaWFUeXBlOiAnYXVkaW8vd2VibScsXG4gICAgYnl0ZXNQcmVmaXg6IFsweDFhLCAweDQ1LCAweGRmLCAweGEzXSxcbiAgICBiYXNlNjRQcmVmaXg6ICdHa1hmJyxcbiAgfSxcbl0gYXMgY29uc3Q7XG5cbmNvbnN0IHN0cmlwSUQzID0gKGRhdGE6IFVpbnQ4QXJyYXkgfCBzdHJpbmcpID0+IHtcbiAgY29uc3QgYnl0ZXMgPVxuICAgIHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyA/IGNvbnZlcnRCYXNlNjRUb1VpbnQ4QXJyYXkoZGF0YSkgOiBkYXRhO1xuICBjb25zdCBpZDNTaXplID1cbiAgICAoKGJ5dGVzWzZdICYgMHg3ZikgPDwgMjEpIHxcbiAgICAoKGJ5dGVzWzddICYgMHg3ZikgPDwgMTQpIHxcbiAgICAoKGJ5dGVzWzhdICYgMHg3ZikgPDwgNykgfFxuICAgIChieXRlc1s5XSAmIDB4N2YpO1xuXG4gIC8vIFRoZSByYXcgTVAzIHN0YXJ0cyBoZXJlXG4gIHJldHVybiBieXRlcy5zbGljZShpZDNTaXplICsgMTApO1xufTtcblxuZnVuY3Rpb24gc3RyaXBJRDNUYWdzSWZQcmVzZW50KGRhdGE6IFVpbnQ4QXJyYXkgfCBzdHJpbmcpOiBVaW50OEFycmF5IHwgc3RyaW5nIHtcbiAgY29uc3QgaGFzSWQzID1cbiAgICAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnICYmIGRhdGEuc3RhcnRzV2l0aCgnU1VReicpKSB8fFxuICAgICh0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycgJiZcbiAgICAgIGRhdGEubGVuZ3RoID4gMTAgJiZcbiAgICAgIGRhdGFbMF0gPT09IDB4NDkgJiYgLy8gJ0knXG4gICAgICBkYXRhWzFdID09PSAweDQ0ICYmIC8vICdEJ1xuICAgICAgZGF0YVsyXSA9PT0gMHgzMyk7IC8vICczJ1xuXG4gIHJldHVybiBoYXNJZDMgPyBzdHJpcElEMyhkYXRhKSA6IGRhdGE7XG59XG5cbi8qKlxuICogRGV0ZWN0IHRoZSBtZWRpYSBJQU5BIG1lZGlhIHR5cGUgb2YgYSBmaWxlIHVzaW5nIGEgbGlzdCBvZiBzaWduYXR1cmVzLlxuICpcbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGZpbGUgZGF0YS5cbiAqIEBwYXJhbSBzaWduYXR1cmVzIC0gVGhlIHNpZ25hdHVyZXMgdG8gdXNlIGZvciBkZXRlY3Rpb24uXG4gKiBAcmV0dXJucyBUaGUgbWVkaWEgdHlwZSBvZiB0aGUgZmlsZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdE1lZGlhVHlwZSh7XG4gIGRhdGEsXG4gIHNpZ25hdHVyZXMsXG59OiB7XG4gIGRhdGE6IFVpbnQ4QXJyYXkgfCBzdHJpbmc7XG4gIHNpZ25hdHVyZXM6IHR5cGVvZiBhdWRpb01lZGlhVHlwZVNpZ25hdHVyZXMgfCB0eXBlb2YgaW1hZ2VNZWRpYVR5cGVTaWduYXR1cmVzO1xufSk6ICh0eXBlb2Ygc2lnbmF0dXJlcylbbnVtYmVyXVsnbWVkaWFUeXBlJ10gfCB1bmRlZmluZWQge1xuICBjb25zdCBwcm9jZXNzZWREYXRhID0gc3RyaXBJRDNUYWdzSWZQcmVzZW50KGRhdGEpO1xuXG4gIGZvciAoY29uc3Qgc2lnbmF0dXJlIG9mIHNpZ25hdHVyZXMpIHtcbiAgICBpZiAoXG4gICAgICB0eXBlb2YgcHJvY2Vzc2VkRGF0YSA9PT0gJ3N0cmluZydcbiAgICAgICAgPyBwcm9jZXNzZWREYXRhLnN0YXJ0c1dpdGgoc2lnbmF0dXJlLmJhc2U2NFByZWZpeClcbiAgICAgICAgOiBwcm9jZXNzZWREYXRhLmxlbmd0aCA+PSBzaWduYXR1cmUuYnl0ZXNQcmVmaXgubGVuZ3RoICYmXG4gICAgICAgICAgc2lnbmF0dXJlLmJ5dGVzUHJlZml4LmV2ZXJ5KFxuICAgICAgICAgICAgKGJ5dGUsIGluZGV4KSA9PiBwcm9jZXNzZWREYXRhW2luZGV4XSA9PT0gYnl0ZSxcbiAgICAgICAgICApXG4gICAgKSB7XG4gICAgICByZXR1cm4gc2lnbmF0dXJlLm1lZGlhVHlwZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuIiwgImltcG9ydCB7IERvd25sb2FkRXJyb3IgfSBmcm9tICcuL2Rvd25sb2FkLWVycm9yJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkKHsgdXJsIH06IHsgdXJsOiBVUkwgfSk6IFByb21pc2U8e1xuICBkYXRhOiBVaW50OEFycmF5O1xuICBtZWRpYVR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcbn0+IHtcbiAgY29uc3QgdXJsVGV4dCA9IHVybC50b1N0cmluZygpO1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsVGV4dCk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRG93bmxvYWRFcnJvcih7XG4gICAgICAgIHVybDogdXJsVGV4dCxcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IG5ldyBVaW50OEFycmF5KGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpLFxuICAgICAgbWVkaWFUeXBlOiByZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgPz8gdW5kZWZpbmVkLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKERvd25sb2FkRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cblxuICAgIHRocm93IG5ldyBEb3dubG9hZEVycm9yKHsgdXJsOiB1cmxUZXh0LCBjYXVzZTogZXJyb3IgfSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yLCBMYW5ndWFnZU1vZGVsVjJEYXRhQ29udGVudCB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgY29udmVydEJhc2U2NFRvVWludDhBcnJheSxcbiAgY29udmVydFVpbnQ4QXJyYXlUb0Jhc2U2NCxcbiAgRGF0YUNvbnRlbnQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQgeyBJbnZhbGlkRGF0YUNvbnRlbnRFcnJvciB9IGZyb20gJy4vaW52YWxpZC1kYXRhLWNvbnRlbnQtZXJyb3InO1xuaW1wb3J0IHsgc3BsaXREYXRhVXJsIH0gZnJvbSAnLi9zcGxpdC1kYXRhLXVybCc7XG5cbi8qKlxuQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBkYXRhQ29udGVudFNjaGVtYTogei5ab2RUeXBlPERhdGFDb250ZW50PiA9IHoudW5pb24oW1xuICB6LnN0cmluZygpLFxuICB6Lmluc3RhbmNlb2YoVWludDhBcnJheSksXG4gIHouaW5zdGFuY2VvZihBcnJheUJ1ZmZlciksXG4gIHouY3VzdG9tPEJ1ZmZlcj4oXG4gICAgLy8gQnVmZmVyIG1pZ2h0IG5vdCBiZSBhdmFpbGFibGUgaW4gc29tZSBlbnZpcm9ubWVudHMgc3VjaCBhcyBDbG91ZEZsYXJlOlxuICAgICh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEJ1ZmZlciA9PlxuICAgICAgZ2xvYmFsVGhpcy5CdWZmZXI/LmlzQnVmZmVyKHZhbHVlKSA/PyBmYWxzZSxcbiAgICB7IG1lc3NhZ2U6ICdNdXN0IGJlIGEgQnVmZmVyJyB9LFxuICApLFxuXSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9MYW5ndWFnZU1vZGVsVjJEYXRhQ29udGVudChcbiAgY29udGVudDogRGF0YUNvbnRlbnQgfCBVUkwsXG4pOiB7XG4gIGRhdGE6IExhbmd1YWdlTW9kZWxWMkRhdGFDb250ZW50O1xuICBtZWRpYVR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZDtcbn0ge1xuICAvLyBCdWZmZXIgJiBVaW50OEFycmF5OlxuICBpZiAoY29udGVudCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICByZXR1cm4geyBkYXRhOiBjb250ZW50LCBtZWRpYVR5cGU6IHVuZGVmaW5lZCB9O1xuICB9XG5cbiAgLy8gQXJyYXlCdWZmZXIgbmVlZHMgY29udmVyc2lvbiB0byBVaW50OEFycmF5IChsaWdodHdlaWdodCk6XG4gIGlmIChjb250ZW50IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICByZXR1cm4geyBkYXRhOiBuZXcgVWludDhBcnJheShjb250ZW50KSwgbWVkaWFUeXBlOiB1bmRlZmluZWQgfTtcbiAgfVxuXG4gIC8vIEF0dGVtcHQgdG8gY3JlYXRlIGEgVVJMIGZyb20gdGhlIGRhdGEuIElmIGl0IGZhaWxzLCB3ZSBjYW4gYXNzdW1lIHRoZSBkYXRhXG4gIC8vIGlzIG5vdCBhIFVSTCBhbmQgbGlrZWx5IHNvbWUgb3RoZXIgc29ydCBvZiBkYXRhLlxuICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnRlbnQgPSBuZXcgVVJMKGNvbnRlbnQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBpZ25vcmVkXG4gICAgfVxuICB9XG5cbiAgLy8gRXh0cmFjdCBkYXRhIGZyb20gZGF0YSBVUkw6XG4gIGlmIChjb250ZW50IGluc3RhbmNlb2YgVVJMICYmIGNvbnRlbnQucHJvdG9jb2wgPT09ICdkYXRhOicpIHtcbiAgICBjb25zdCB7IG1lZGlhVHlwZTogZGF0YVVybE1lZGlhVHlwZSwgYmFzZTY0Q29udGVudCB9ID0gc3BsaXREYXRhVXJsKFxuICAgICAgY29udGVudC50b1N0cmluZygpLFxuICAgICk7XG5cbiAgICBpZiAoZGF0YVVybE1lZGlhVHlwZSA9PSBudWxsIHx8IGJhc2U2NENvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEFJU0RLRXJyb3Ioe1xuICAgICAgICBuYW1lOiAnSW52YWxpZERhdGFDb250ZW50RXJyb3InLFxuICAgICAgICBtZXNzYWdlOiBgSW52YWxpZCBkYXRhIFVSTCBmb3JtYXQgaW4gY29udGVudCAke2NvbnRlbnQudG9TdHJpbmcoKX1gLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZGF0YTogYmFzZTY0Q29udGVudCwgbWVkaWFUeXBlOiBkYXRhVXJsTWVkaWFUeXBlIH07XG4gIH1cblxuICByZXR1cm4geyBkYXRhOiBjb250ZW50LCBtZWRpYVR5cGU6IHVuZGVmaW5lZCB9O1xufVxuXG4vKipcbkNvbnZlcnRzIGRhdGEgY29udGVudCB0byBhIGJhc2U2NC1lbmNvZGVkIHN0cmluZy5cblxuQHBhcmFtIGNvbnRlbnQgLSBEYXRhIGNvbnRlbnQgdG8gY29udmVydC5cbkByZXR1cm5zIEJhc2U2NC1lbmNvZGVkIHN0cmluZy5cbiovXG5leHBvcnQgZnVuY3Rpb24gY29udmVydERhdGFDb250ZW50VG9CYXNlNjRTdHJpbmcoY29udGVudDogRGF0YUNvbnRlbnQpOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cblxuICBpZiAoY29udGVudCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGNvbnZlcnRVaW50OEFycmF5VG9CYXNlNjQobmV3IFVpbnQ4QXJyYXkoY29udGVudCkpO1xuICB9XG5cbiAgcmV0dXJuIGNvbnZlcnRVaW50OEFycmF5VG9CYXNlNjQoY29udGVudCk7XG59XG5cbi8qKlxuQ29udmVydHMgZGF0YSBjb250ZW50IHRvIGEgVWludDhBcnJheS5cblxuQHBhcmFtIGNvbnRlbnQgLSBEYXRhIGNvbnRlbnQgdG8gY29udmVydC5cbkByZXR1cm5zIFVpbnQ4QXJyYXkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0RGF0YUNvbnRlbnRUb1VpbnQ4QXJyYXkoXG4gIGNvbnRlbnQ6IERhdGFDb250ZW50LFxuKTogVWludDhBcnJheSB7XG4gIGlmIChjb250ZW50IGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gY29udmVydEJhc2U2NFRvVWludDhBcnJheShjb250ZW50KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWREYXRhQ29udGVudEVycm9yKHtcbiAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAnSW52YWxpZCBkYXRhIGNvbnRlbnQuIENvbnRlbnQgc3RyaW5nIGlzIG5vdCBhIGJhc2U2NC1lbmNvZGVkIG1lZGlhLicsXG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjb250ZW50IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoY29udGVudCk7XG4gIH1cblxuICB0aHJvdyBuZXcgSW52YWxpZERhdGFDb250ZW50RXJyb3IoeyBjb250ZW50IH0pO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgVWludDhBcnJheSB0byBhIHN0cmluZyBvZiB0ZXh0LlxuICpcbiAqIEBwYXJhbSB1aW50OEFycmF5IC0gVGhlIFVpbnQ4QXJyYXkgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIFRoZSBjb252ZXJ0ZWQgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFVpbnQ4QXJyYXlUb1RleHQodWludDhBcnJheTogVWludDhBcnJheSk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZSh1aW50OEFycmF5KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm9yIGRlY29kaW5nIFVpbnQ4QXJyYXkgdG8gdGV4dCcpO1xuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIHNwbGl0RGF0YVVybChkYXRhVXJsOiBzdHJpbmcpOiB7XG4gIG1lZGlhVHlwZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBiYXNlNjRDb250ZW50OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG59IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBbaGVhZGVyLCBiYXNlNjRDb250ZW50XSA9IGRhdGFVcmwuc3BsaXQoJywnKTtcbiAgICByZXR1cm4ge1xuICAgICAgbWVkaWFUeXBlOiBoZWFkZXIuc3BsaXQoJzsnKVswXS5zcGxpdCgnOicpWzFdLFxuICAgICAgYmFzZTY0Q29udGVudCxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBtZWRpYVR5cGU6IHVuZGVmaW5lZCxcbiAgICAgIGJhc2U2NENvbnRlbnQ6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG59XG4iLCAiaW1wb3J0IHsgSW52YWxpZEFyZ3VtZW50RXJyb3IgfSBmcm9tICcuLi9lcnJvci9pbnZhbGlkLWFyZ3VtZW50LWVycm9yJztcbmltcG9ydCB7IENhbGxTZXR0aW5ncyB9IGZyb20gJy4vY2FsbC1zZXR0aW5ncyc7XG5cbi8qKlxuICogVmFsaWRhdGVzIGNhbGwgc2V0dGluZ3MgYW5kIHJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggbGltaXRlZCB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlQ2FsbFNldHRpbmdzKHtcbiAgbWF4T3V0cHV0VG9rZW5zLFxuICB0ZW1wZXJhdHVyZSxcbiAgdG9wUCxcbiAgdG9wSyxcbiAgcHJlc2VuY2VQZW5hbHR5LFxuICBmcmVxdWVuY3lQZW5hbHR5LFxuICBzZWVkLFxuICBzdG9wU2VxdWVuY2VzLFxufTogT21pdDxDYWxsU2V0dGluZ3MsICdhYm9ydFNpZ25hbCcgfCAnaGVhZGVycycgfCAnbWF4UmV0cmllcyc+KTogT21pdDxcbiAgQ2FsbFNldHRpbmdzLFxuICAnYWJvcnRTaWduYWwnIHwgJ2hlYWRlcnMnIHwgJ21heFJldHJpZXMnXG4+IHtcbiAgaWYgKG1heE91dHB1dFRva2VucyAhPSBudWxsKSB7XG4gICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG1heE91dHB1dFRva2VucykpIHtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgIHBhcmFtZXRlcjogJ21heE91dHB1dFRva2VucycsXG4gICAgICAgIHZhbHVlOiBtYXhPdXRwdXRUb2tlbnMsXG4gICAgICAgIG1lc3NhZ2U6ICdtYXhPdXRwdXRUb2tlbnMgbXVzdCBiZSBhbiBpbnRlZ2VyJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChtYXhPdXRwdXRUb2tlbnMgPCAxKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdtYXhPdXRwdXRUb2tlbnMnLFxuICAgICAgICB2YWx1ZTogbWF4T3V0cHV0VG9rZW5zLFxuICAgICAgICBtZXNzYWdlOiAnbWF4T3V0cHV0VG9rZW5zIG11c3QgYmUgPj0gMScsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBpZiAodGVtcGVyYXR1cmUgIT0gbnVsbCkge1xuICAgIGlmICh0eXBlb2YgdGVtcGVyYXR1cmUgIT09ICdudW1iZXInKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICd0ZW1wZXJhdHVyZScsXG4gICAgICAgIHZhbHVlOiB0ZW1wZXJhdHVyZSxcbiAgICAgICAgbWVzc2FnZTogJ3RlbXBlcmF0dXJlIG11c3QgYmUgYSBudW1iZXInLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRvcFAgIT0gbnVsbCkge1xuICAgIGlmICh0eXBlb2YgdG9wUCAhPT0gJ251bWJlcicpIHtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgIHBhcmFtZXRlcjogJ3RvcFAnLFxuICAgICAgICB2YWx1ZTogdG9wUCxcbiAgICAgICAgbWVzc2FnZTogJ3RvcFAgbXVzdCBiZSBhIG51bWJlcicsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBpZiAodG9wSyAhPSBudWxsKSB7XG4gICAgaWYgKHR5cGVvZiB0b3BLICE9PSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAndG9wSycsXG4gICAgICAgIHZhbHVlOiB0b3BLLFxuICAgICAgICBtZXNzYWdlOiAndG9wSyBtdXN0IGJlIGEgbnVtYmVyJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcmVzZW5jZVBlbmFsdHkgIT0gbnVsbCkge1xuICAgIGlmICh0eXBlb2YgcHJlc2VuY2VQZW5hbHR5ICE9PSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAncHJlc2VuY2VQZW5hbHR5JyxcbiAgICAgICAgdmFsdWU6IHByZXNlbmNlUGVuYWx0eSxcbiAgICAgICAgbWVzc2FnZTogJ3ByZXNlbmNlUGVuYWx0eSBtdXN0IGJlIGEgbnVtYmVyJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChmcmVxdWVuY3lQZW5hbHR5ICE9IG51bGwpIHtcbiAgICBpZiAodHlwZW9mIGZyZXF1ZW5jeVBlbmFsdHkgIT09ICdudW1iZXInKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdmcmVxdWVuY3lQZW5hbHR5JyxcbiAgICAgICAgdmFsdWU6IGZyZXF1ZW5jeVBlbmFsdHksXG4gICAgICAgIG1lc3NhZ2U6ICdmcmVxdWVuY3lQZW5hbHR5IG11c3QgYmUgYSBudW1iZXInLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHNlZWQgIT0gbnVsbCkge1xuICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihzZWVkKSkge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAnc2VlZCcsXG4gICAgICAgIHZhbHVlOiBzZWVkLFxuICAgICAgICBtZXNzYWdlOiAnc2VlZCBtdXN0IGJlIGFuIGludGVnZXInLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBtYXhPdXRwdXRUb2tlbnMsXG4gICAgdGVtcGVyYXR1cmUsXG4gICAgdG9wUCxcbiAgICB0b3BLLFxuICAgIHByZXNlbmNlUGVuYWx0eSxcbiAgICBmcmVxdWVuY3lQZW5hbHR5LFxuICAgIHN0b3BTZXF1ZW5jZXMsXG4gICAgc2VlZCxcbiAgfTtcbn1cbiIsICJpbXBvcnQge1xuICBMYW5ndWFnZU1vZGVsVjJGdW5jdGlvblRvb2wsXG4gIExhbmd1YWdlTW9kZWxWMlByb3ZpZGVyRGVmaW5lZFRvb2wsXG4gIExhbmd1YWdlTW9kZWxWMlRvb2xDaG9pY2UsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgYXNTY2hlbWEgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IGlzTm9uRW1wdHlPYmplY3QgfSBmcm9tICcuLi91dGlsL2lzLW5vbi1lbXB0eS1vYmplY3QnO1xuaW1wb3J0IHsgVG9vbFNldCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQnO1xuaW1wb3J0IHsgVG9vbENob2ljZSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsJztcblxuZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVUb29sc0FuZFRvb2xDaG9pY2U8VE9PTFMgZXh0ZW5kcyBUb29sU2V0Pih7XG4gIHRvb2xzLFxuICB0b29sQ2hvaWNlLFxuICBhY3RpdmVUb29scyxcbn06IHtcbiAgdG9vbHM6IFRPT0xTIHwgdW5kZWZpbmVkO1xuICB0b29sQ2hvaWNlOiBUb29sQ2hvaWNlPFRPT0xTPiB8IHVuZGVmaW5lZDtcbiAgYWN0aXZlVG9vbHM6IEFycmF5PGtleW9mIFRPT0xTPiB8IHVuZGVmaW5lZDtcbn0pOiB7XG4gIHRvb2xzOlxuICAgIHwgQXJyYXk8TGFuZ3VhZ2VNb2RlbFYyRnVuY3Rpb25Ub29sIHwgTGFuZ3VhZ2VNb2RlbFYyUHJvdmlkZXJEZWZpbmVkVG9vbD5cbiAgICB8IHVuZGVmaW5lZDtcbiAgdG9vbENob2ljZTogTGFuZ3VhZ2VNb2RlbFYyVG9vbENob2ljZSB8IHVuZGVmaW5lZDtcbn0ge1xuICBpZiAoIWlzTm9uRW1wdHlPYmplY3QodG9vbHMpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvb2xzOiB1bmRlZmluZWQsXG4gICAgICB0b29sQ2hvaWNlOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxuXG4gIC8vIHdoZW4gYWN0aXZlVG9vbHMgaXMgcHJvdmlkZWQsIHdlIG9ubHkgaW5jbHVkZSB0aGUgdG9vbHMgdGhhdCBhcmUgaW4gdGhlIGxpc3Q6XG4gIGNvbnN0IGZpbHRlcmVkVG9vbHMgPVxuICAgIGFjdGl2ZVRvb2xzICE9IG51bGxcbiAgICAgID8gT2JqZWN0LmVudHJpZXModG9vbHMpLmZpbHRlcigoW25hbWVdKSA9PlxuICAgICAgICAgIGFjdGl2ZVRvb2xzLmluY2x1ZGVzKG5hbWUgYXMga2V5b2YgVE9PTFMpLFxuICAgICAgICApXG4gICAgICA6IE9iamVjdC5lbnRyaWVzKHRvb2xzKTtcblxuICByZXR1cm4ge1xuICAgIHRvb2xzOiBmaWx0ZXJlZFRvb2xzLm1hcCgoW25hbWUsIHRvb2xdKSA9PiB7XG4gICAgICBjb25zdCB0b29sVHlwZSA9IHRvb2wudHlwZTtcbiAgICAgIHN3aXRjaCAodG9vbFR5cGUpIHtcbiAgICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIGNhc2UgJ2R5bmFtaWMnOlxuICAgICAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdmdW5jdGlvbicgYXMgY29uc3QsXG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRvb2wuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBpbnB1dFNjaGVtYTogYXNTY2hlbWEodG9vbC5pbnB1dFNjaGVtYSkuanNvblNjaGVtYSxcbiAgICAgICAgICAgIHByb3ZpZGVyT3B0aW9uczogdG9vbC5wcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAncHJvdmlkZXItZGVmaW5lZCc6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdwcm92aWRlci1kZWZpbmVkJyBhcyBjb25zdCxcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBpZDogdG9vbC5pZCxcbiAgICAgICAgICAgIGFyZ3M6IHRvb2wuYXJncyxcbiAgICAgICAgICB9O1xuICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgY29uc3QgZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IHRvb2xUeXBlO1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgdG9vbCB0eXBlOiAke2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIHRvb2xDaG9pY2U6XG4gICAgICB0b29sQ2hvaWNlID09IG51bGxcbiAgICAgICAgPyB7IHR5cGU6ICdhdXRvJyB9XG4gICAgICAgIDogdHlwZW9mIHRvb2xDaG9pY2UgPT09ICdzdHJpbmcnXG4gICAgICAgICAgPyB7IHR5cGU6IHRvb2xDaG9pY2UgfVxuICAgICAgICAgIDogeyB0eXBlOiAndG9vbCcgYXMgY29uc3QsIHRvb2xOYW1lOiB0b29sQ2hvaWNlLnRvb2xOYW1lIGFzIHN0cmluZyB9LFxuICB9O1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBpc05vbkVtcHR5T2JqZWN0KFxuICBvYmplY3Q6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHwgdW5kZWZpbmVkIHwgbnVsbCxcbik6IG9iamVjdCBpcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIHJldHVybiBvYmplY3QgIT0gbnVsbCAmJiBPYmplY3Qua2V5cyhvYmplY3QpLmxlbmd0aCA+IDA7XG59XG4iLCAiaW1wb3J0IHsgSW52YWxpZFByb21wdEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBNb2RlbE1lc3NhZ2UsIHNhZmVWYWxpZGF0ZVR5cGVzIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IG1vZGVsTWVzc2FnZVNjaGVtYSB9IGZyb20gJy4vbWVzc2FnZSc7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tICcuL3Byb21wdCc7XG5cbmV4cG9ydCB0eXBlIFN0YW5kYXJkaXplZFByb21wdCA9IHtcbiAgLyoqXG4gICAqIFN5c3RlbSBtZXNzYWdlLlxuICAgKi9cbiAgc3lzdGVtPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBNZXNzYWdlcy5cbiAgICovXG4gIG1lc3NhZ2VzOiBNb2RlbE1lc3NhZ2VbXTtcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFuZGFyZGl6ZVByb21wdChcbiAgcHJvbXB0OiBQcm9tcHQsXG4pOiBQcm9taXNlPFN0YW5kYXJkaXplZFByb21wdD4ge1xuICBpZiAocHJvbXB0LnByb21wdCA9PSBudWxsICYmIHByb21wdC5tZXNzYWdlcyA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOiAncHJvbXB0IG9yIG1lc3NhZ2VzIG11c3QgYmUgZGVmaW5lZCcsXG4gICAgfSk7XG4gIH1cblxuICBpZiAocHJvbXB0LnByb21wdCAhPSBudWxsICYmIHByb21wdC5tZXNzYWdlcyAhPSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOiAncHJvbXB0IGFuZCBtZXNzYWdlcyBjYW5ub3QgYmUgZGVmaW5lZCBhdCB0aGUgc2FtZSB0aW1lJyxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHZhbGlkYXRlIHRoYXQgc3lzdGVtIGlzIGEgc3RyaW5nXG4gIGlmIChwcm9tcHQuc3lzdGVtICE9IG51bGwgJiYgdHlwZW9mIHByb21wdC5zeXN0ZW0gIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOiAnc3lzdGVtIG11c3QgYmUgYSBzdHJpbmcnLFxuICAgIH0pO1xuICB9XG5cbiAgbGV0IG1lc3NhZ2VzOiBNb2RlbE1lc3NhZ2VbXTtcblxuICBpZiAocHJvbXB0LnByb21wdCAhPSBudWxsICYmIHR5cGVvZiBwcm9tcHQucHJvbXB0ID09PSAnc3RyaW5nJykge1xuICAgIG1lc3NhZ2VzID0gW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQucHJvbXB0IH1dO1xuICB9IGVsc2UgaWYgKHByb21wdC5wcm9tcHQgIT0gbnVsbCAmJiBBcnJheS5pc0FycmF5KHByb21wdC5wcm9tcHQpKSB7XG4gICAgbWVzc2FnZXMgPSBwcm9tcHQucHJvbXB0O1xuICB9IGVsc2UgaWYgKHByb21wdC5tZXNzYWdlcyAhPSBudWxsKSB7XG4gICAgbWVzc2FnZXMgPSBwcm9tcHQubWVzc2FnZXM7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOiAncHJvbXB0IG9yIG1lc3NhZ2VzIG11c3QgYmUgZGVmaW5lZCcsXG4gICAgfSk7XG4gIH1cblxuICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOiAnbWVzc2FnZXMgbXVzdCBub3QgYmUgZW1wdHknLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IGF3YWl0IHNhZmVWYWxpZGF0ZVR5cGVzKHtcbiAgICB2YWx1ZTogbWVzc2FnZXMsXG4gICAgc2NoZW1hOiB6LmFycmF5KG1vZGVsTWVzc2FnZVNjaGVtYSksXG4gIH0pO1xuXG4gIGlmICghdmFsaWRhdGlvblJlc3VsdC5zdWNjZXNzKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRQcm9tcHRFcnJvcih7XG4gICAgICBwcm9tcHQsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICAnVGhlIG1lc3NhZ2VzIG11c3QgYmUgYSBNb2RlbE1lc3NhZ2VbXS4gJyArXG4gICAgICAgICdJZiB5b3UgaGF2ZSBwYXNzZWQgYSBVSU1lc3NhZ2VbXSwgeW91IGNhbiB1c2UgY29udmVydFRvTW9kZWxNZXNzYWdlcyB0byBjb252ZXJ0IHRoZW0uJyxcbiAgICAgIGNhdXNlOiB2YWxpZGF0aW9uUmVzdWx0LmVycm9yLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBtZXNzYWdlcyxcbiAgICBzeXN0ZW06IHByb21wdC5zeXN0ZW0sXG4gIH07XG59XG4iLCAiaW1wb3J0IHtcbiAgQXNzaXN0YW50TW9kZWxNZXNzYWdlLFxuICBNb2RlbE1lc3NhZ2UsXG4gIFN5c3RlbU1vZGVsTWVzc2FnZSxcbiAgVG9vbE1vZGVsTWVzc2FnZSxcbiAgVXNlck1vZGVsTWVzc2FnZSxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEgfSBmcm9tICcuLi90eXBlcy9wcm92aWRlci1tZXRhZGF0YSc7XG5pbXBvcnQge1xuICBmaWxlUGFydFNjaGVtYSxcbiAgaW1hZ2VQYXJ0U2NoZW1hLFxuICByZWFzb25pbmdQYXJ0U2NoZW1hLFxuICB0ZXh0UGFydFNjaGVtYSxcbiAgdG9vbENhbGxQYXJ0U2NoZW1hLFxuICB0b29sUmVzdWx0UGFydFNjaGVtYSxcbn0gZnJvbSAnLi9jb250ZW50LXBhcnQnO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgU3lzdGVtTW9kZWxNZXNzYWdlYCBpbnN0ZWFkLlxuICovXG4vLyBUT0RPIHJlbW92ZSBpbiBBSSBTREsgNlxuZXhwb3J0IHR5cGUgQ29yZVN5c3RlbU1lc3NhZ2UgPSBTeXN0ZW1Nb2RlbE1lc3NhZ2U7XG5cbmV4cG9ydCBjb25zdCBzeXN0ZW1Nb2RlbE1lc3NhZ2VTY2hlbWE6IHouWm9kVHlwZTxTeXN0ZW1Nb2RlbE1lc3NhZ2U+ID0gei5vYmplY3QoXG4gIHtcbiAgICByb2xlOiB6LmxpdGVyYWwoJ3N5c3RlbScpLFxuICAgIGNvbnRlbnQ6IHouc3RyaW5nKCksXG4gICAgcHJvdmlkZXJPcHRpb25zOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0sXG4pO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgc3lzdGVtTW9kZWxNZXNzYWdlU2NoZW1hYCBpbnN0ZWFkLlxuICovXG4vLyBUT0RPIHJlbW92ZSBpbiBBSSBTREsgNlxuZXhwb3J0IGNvbnN0IGNvcmVTeXN0ZW1NZXNzYWdlU2NoZW1hID0gc3lzdGVtTW9kZWxNZXNzYWdlU2NoZW1hO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgVXNlck1vZGVsTWVzc2FnZWAgaW5zdGVhZC5cbiAqL1xuLy8gVE9ETyByZW1vdmUgaW4gQUkgU0RLIDZcbmV4cG9ydCB0eXBlIENvcmVVc2VyTWVzc2FnZSA9IFVzZXJNb2RlbE1lc3NhZ2U7XG5cbmV4cG9ydCBjb25zdCB1c2VyTW9kZWxNZXNzYWdlU2NoZW1hOiB6LlpvZFR5cGU8VXNlck1vZGVsTWVzc2FnZT4gPSB6Lm9iamVjdCh7XG4gIHJvbGU6IHoubGl0ZXJhbCgndXNlcicpLFxuICBjb250ZW50OiB6LnVuaW9uKFtcbiAgICB6LnN0cmluZygpLFxuICAgIHouYXJyYXkoei51bmlvbihbdGV4dFBhcnRTY2hlbWEsIGltYWdlUGFydFNjaGVtYSwgZmlsZVBhcnRTY2hlbWFdKSksXG4gIF0pLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgdXNlck1vZGVsTWVzc2FnZVNjaGVtYWAgaW5zdGVhZC5cbiAqL1xuLy8gVE9ETyByZW1vdmUgaW4gQUkgU0RLIDZcbmV4cG9ydCBjb25zdCBjb3JlVXNlck1lc3NhZ2VTY2hlbWEgPSB1c2VyTW9kZWxNZXNzYWdlU2NoZW1hO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgQXNzaXN0YW50TW9kZWxNZXNzYWdlYCBpbnN0ZWFkLlxuICovXG4vLyBUT0RPIHJlbW92ZSBpbiBBSSBTREsgNlxuZXhwb3J0IHR5cGUgQ29yZUFzc2lzdGFudE1lc3NhZ2UgPSBBc3Npc3RhbnRNb2RlbE1lc3NhZ2U7XG5cbmV4cG9ydCBjb25zdCBhc3Npc3RhbnRNb2RlbE1lc3NhZ2VTY2hlbWE6IHouWm9kVHlwZTxBc3Npc3RhbnRNb2RlbE1lc3NhZ2U+ID1cbiAgei5vYmplY3Qoe1xuICAgIHJvbGU6IHoubGl0ZXJhbCgnYXNzaXN0YW50JyksXG4gICAgY29udGVudDogei51bmlvbihbXG4gICAgICB6LnN0cmluZygpLFxuICAgICAgei5hcnJheShcbiAgICAgICAgei51bmlvbihbXG4gICAgICAgICAgdGV4dFBhcnRTY2hlbWEsXG4gICAgICAgICAgZmlsZVBhcnRTY2hlbWEsXG4gICAgICAgICAgcmVhc29uaW5nUGFydFNjaGVtYSxcbiAgICAgICAgICB0b29sQ2FsbFBhcnRTY2hlbWEsXG4gICAgICAgICAgdG9vbFJlc3VsdFBhcnRTY2hlbWEsXG4gICAgICAgIF0pLFxuICAgICAgKSxcbiAgICBdKSxcbiAgICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbiAgfSk7XG5cbi8qKlxuQGRlcHJlY2F0ZWQgVXNlIGBhc3Npc3RhbnRNb2RlbE1lc3NhZ2VTY2hlbWFgIGluc3RlYWQuXG4gKi9cbi8vIFRPRE8gcmVtb3ZlIGluIEFJIFNESyA2XG5leHBvcnQgY29uc3QgY29yZUFzc2lzdGFudE1lc3NhZ2VTY2hlbWEgPSBhc3Npc3RhbnRNb2RlbE1lc3NhZ2VTY2hlbWE7XG5cbi8qKlxuQGRlcHJlY2F0ZWQgVXNlIGBUb29sTW9kZWxNZXNzYWdlYCBpbnN0ZWFkLlxuICovXG4vLyBUT0RPIHJlbW92ZSBpbiBBSSBTREsgNlxuZXhwb3J0IHR5cGUgQ29yZVRvb2xNZXNzYWdlID0gVG9vbE1vZGVsTWVzc2FnZTtcblxuZXhwb3J0IGNvbnN0IHRvb2xNb2RlbE1lc3NhZ2VTY2hlbWE6IHouWm9kVHlwZTxUb29sTW9kZWxNZXNzYWdlPiA9IHoub2JqZWN0KHtcbiAgcm9sZTogei5saXRlcmFsKCd0b29sJyksXG4gIGNvbnRlbnQ6IHouYXJyYXkodG9vbFJlc3VsdFBhcnRTY2hlbWEpLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgdG9vbE1vZGVsTWVzc2FnZVNjaGVtYWAgaW5zdGVhZC5cbiAqL1xuLy8gVE9ETyByZW1vdmUgaW4gQUkgU0RLIDZcbmV4cG9ydCBjb25zdCBjb3JlVG9vbE1lc3NhZ2VTY2hlbWEgPSB0b29sTW9kZWxNZXNzYWdlU2NoZW1hO1xuXG4vKipcbkBkZXByZWNhdGVkIFVzZSBgTW9kZWxNZXNzYWdlYCBpbnN0ZWFkLlxuICAgKi9cbi8vIFRPRE8gcmVtb3ZlIGluIEFJIFNESyA2XG5leHBvcnQgdHlwZSBDb3JlTWVzc2FnZSA9IE1vZGVsTWVzc2FnZTtcblxuZXhwb3J0IGNvbnN0IG1vZGVsTWVzc2FnZVNjaGVtYTogei5ab2RUeXBlPE1vZGVsTWVzc2FnZT4gPSB6LnVuaW9uKFtcbiAgc3lzdGVtTW9kZWxNZXNzYWdlU2NoZW1hLFxuICB1c2VyTW9kZWxNZXNzYWdlU2NoZW1hLFxuICBhc3Npc3RhbnRNb2RlbE1lc3NhZ2VTY2hlbWEsXG4gIHRvb2xNb2RlbE1lc3NhZ2VTY2hlbWEsXG5dKTtcblxuLyoqXG5AZGVwcmVjYXRlZCBVc2UgYG1vZGVsTWVzc2FnZVNjaGVtYWAgaW5zdGVhZC5cbiAqL1xuLy8gVE9ETyByZW1vdmUgaW4gQUkgU0RLIDZcbmV4cG9ydCBjb25zdCBjb3JlTWVzc2FnZVNjaGVtYTogei5ab2RUeXBlPENvcmVNZXNzYWdlPiA9IG1vZGVsTWVzc2FnZVNjaGVtYTtcbiIsICJpbXBvcnQgeyBTaGFyZWRWMlByb3ZpZGVyTWV0YWRhdGEgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsganNvblZhbHVlU2NoZW1hIH0gZnJvbSAnLi9qc29uLXZhbHVlJztcblxuLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhIHRoYXQgaXMgcmV0dXJuZWQgZnJvbSB0aGUgcHJvdmlkZXIuXG5cblRoaXMgaXMgbmVlZGVkIHRvIGVuYWJsZSBwcm92aWRlci1zcGVjaWZpYyBmdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlXG5mdWxseSBlbmNhcHN1bGF0ZWQgaW4gdGhlIHByb3ZpZGVyLlxuICovXG5leHBvcnQgdHlwZSBQcm92aWRlck1ldGFkYXRhID0gU2hhcmVkVjJQcm92aWRlck1ldGFkYXRhO1xuXG5leHBvcnQgY29uc3QgcHJvdmlkZXJNZXRhZGF0YVNjaGVtYTogei5ab2RUeXBlPFByb3ZpZGVyTWV0YWRhdGE+ID0gei5yZWNvcmQoXG4gIHouc3RyaW5nKCksXG4gIHoucmVjb3JkKHouc3RyaW5nKCksIGpzb25WYWx1ZVNjaGVtYSksXG4pO1xuIiwgImltcG9ydCB7IEpTT05WYWx1ZSBhcyBPcmlnaW5hbEpTT05WYWx1ZSB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZC92NCc7XG5cbmV4cG9ydCBjb25zdCBqc29uVmFsdWVTY2hlbWE6IHouWm9kVHlwZTxKU09OVmFsdWU+ID0gei5sYXp5KCgpID0+XG4gIHoudW5pb24oW1xuICAgIHoubnVsbCgpLFxuICAgIHouc3RyaW5nKCksXG4gICAgei5udW1iZXIoKSxcbiAgICB6LmJvb2xlYW4oKSxcbiAgICB6LnJlY29yZCh6LnN0cmluZygpLCBqc29uVmFsdWVTY2hlbWEpLFxuICAgIHouYXJyYXkoanNvblZhbHVlU2NoZW1hKSxcbiAgXSksXG4pO1xuXG5leHBvcnQgdHlwZSBKU09OVmFsdWUgPSBPcmlnaW5hbEpTT05WYWx1ZTtcbiIsICJpbXBvcnQgeyBMYW5ndWFnZU1vZGVsVjJUb29sUmVzdWx0T3V0cHV0IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBGaWxlUGFydCxcbiAgSW1hZ2VQYXJ0LFxuICBQcm92aWRlck9wdGlvbnMsXG4gIFJlYXNvbmluZ1BhcnQsXG4gIFRleHRQYXJ0LFxuICBUb29sUmVzdWx0UGFydCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IGpzb25WYWx1ZVNjaGVtYSB9IGZyb20gJy4uL3R5cGVzL2pzb24tdmFsdWUnO1xuaW1wb3J0IHsgcHJvdmlkZXJNZXRhZGF0YVNjaGVtYSB9IGZyb20gJy4uL3R5cGVzL3Byb3ZpZGVyLW1ldGFkYXRhJztcbmltcG9ydCB7IGRhdGFDb250ZW50U2NoZW1hIH0gZnJvbSAnLi9kYXRhLWNvbnRlbnQnO1xuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgdGV4dFBhcnRTY2hlbWE6IHouWm9kVHlwZTxUZXh0UGFydD4gPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbCgndGV4dCcpLFxuICB0ZXh0OiB6LnN0cmluZygpLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgaW1hZ2VQYXJ0U2NoZW1hOiB6LlpvZFR5cGU8SW1hZ2VQYXJ0PiA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKCdpbWFnZScpLFxuICBpbWFnZTogei51bmlvbihbZGF0YUNvbnRlbnRTY2hlbWEsIHouaW5zdGFuY2VvZihVUkwpXSksXG4gIG1lZGlhVHlwZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgZmlsZVBhcnRTY2hlbWE6IHouWm9kVHlwZTxGaWxlUGFydD4gPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbCgnZmlsZScpLFxuICBkYXRhOiB6LnVuaW9uKFtkYXRhQ29udGVudFNjaGVtYSwgei5pbnN0YW5jZW9mKFVSTCldKSxcbiAgZmlsZW5hbWU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgbWVkaWFUeXBlOiB6LnN0cmluZygpLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgcmVhc29uaW5nUGFydFNjaGVtYTogei5ab2RUeXBlPFJlYXNvbmluZ1BhcnQ+ID0gei5vYmplY3Qoe1xuICB0eXBlOiB6LmxpdGVyYWwoJ3JlYXNvbmluZycpLFxuICB0ZXh0OiB6LnN0cmluZygpLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG4vKipcblRvb2wgY2FsbCBjb250ZW50IHBhcnQgb2YgYSBwcm9tcHQuIEl0IGNvbnRhaW5zIGEgdG9vbCBjYWxsICh1c3VhbGx5IGdlbmVyYXRlZCBieSB0aGUgQUkgbW9kZWwpLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRvb2xDYWxsUGFydCB7XG4gIHR5cGU6ICd0b29sLWNhbGwnO1xuXG4gIC8qKlxuSUQgb2YgdGhlIHRvb2wgY2FsbC4gVGhpcyBJRCBpcyB1c2VkIHRvIG1hdGNoIHRoZSB0b29sIGNhbGwgd2l0aCB0aGUgdG9vbCByZXN1bHQuXG4gKi9cbiAgdG9vbENhbGxJZDogc3RyaW5nO1xuXG4gIC8qKlxuTmFtZSBvZiB0aGUgdG9vbCB0aGF0IGlzIGJlaW5nIGNhbGxlZC5cbiAqL1xuICB0b29sTmFtZTogc3RyaW5nO1xuXG4gIC8qKlxuQXJndW1lbnRzIG9mIHRoZSB0b29sIGNhbGwuIFRoaXMgaXMgYSBKU09OLXNlcmlhbGl6YWJsZSBvYmplY3QgdGhhdCBtYXRjaGVzIHRoZSB0b29sJ3MgaW5wdXQgc2NoZW1hLlxuICAgKi9cbiAgaW5wdXQ6IHVua25vd247XG5cbiAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxudG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5mdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gKi9cbiAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xufVxuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgdG9vbENhbGxQYXJ0U2NoZW1hOiB6LlpvZFR5cGU8VG9vbENhbGxQYXJ0PiA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKCd0b29sLWNhbGwnKSxcbiAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgdG9vbE5hbWU6IHouc3RyaW5nKCksXG4gIGlucHV0OiB6LnVua25vd24oKSxcbiAgcHJvdmlkZXJPcHRpb25zOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIHByb3ZpZGVyRXhlY3V0ZWQ6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG59KSBhcyB6LlpvZFR5cGU8VG9vbENhbGxQYXJ0PjsgLy8gbmVjZXNzYXJ5IGJjIGlucHV0IGlzIG9wdGlvbmFsIG9uIFpvZCB0eXBlXG5cbi8qKlxuQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBvdXRwdXRTY2hlbWE6IHouWm9kVHlwZTxMYW5ndWFnZU1vZGVsVjJUb29sUmVzdWx0T3V0cHV0PiA9XG4gIHouZGlzY3JpbWluYXRlZFVuaW9uKCd0eXBlJywgW1xuICAgIHoub2JqZWN0KHtcbiAgICAgIHR5cGU6IHoubGl0ZXJhbCgndGV4dCcpLFxuICAgICAgdmFsdWU6IHouc3RyaW5nKCksXG4gICAgfSksXG4gICAgei5vYmplY3Qoe1xuICAgICAgdHlwZTogei5saXRlcmFsKCdqc29uJyksXG4gICAgICB2YWx1ZToganNvblZhbHVlU2NoZW1hLFxuICAgIH0pLFxuICAgIHoub2JqZWN0KHtcbiAgICAgIHR5cGU6IHoubGl0ZXJhbCgnZXJyb3ItdGV4dCcpLFxuICAgICAgdmFsdWU6IHouc3RyaW5nKCksXG4gICAgfSksXG4gICAgei5vYmplY3Qoe1xuICAgICAgdHlwZTogei5saXRlcmFsKCdlcnJvci1qc29uJyksXG4gICAgICB2YWx1ZToganNvblZhbHVlU2NoZW1hLFxuICAgIH0pLFxuICAgIHoub2JqZWN0KHtcbiAgICAgIHR5cGU6IHoubGl0ZXJhbCgnY29udGVudCcpLFxuICAgICAgdmFsdWU6IHouYXJyYXkoXG4gICAgICAgIHoudW5pb24oW1xuICAgICAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgICAgIHR5cGU6IHoubGl0ZXJhbCgndGV4dCcpLFxuICAgICAgICAgICAgdGV4dDogei5zdHJpbmcoKSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB6Lm9iamVjdCh7XG4gICAgICAgICAgICB0eXBlOiB6LmxpdGVyYWwoJ21lZGlhJyksXG4gICAgICAgICAgICBkYXRhOiB6LnN0cmluZygpLFxuICAgICAgICAgICAgbWVkaWFUeXBlOiB6LnN0cmluZygpLFxuICAgICAgICAgIH0pLFxuICAgICAgICBdKSxcbiAgICAgICksXG4gICAgfSksXG4gIF0pO1xuXG4vKipcbkBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgdG9vbFJlc3VsdFBhcnRTY2hlbWE6IHouWm9kVHlwZTxUb29sUmVzdWx0UGFydD4gPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbCgndG9vbC1yZXN1bHQnKSxcbiAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgdG9vbE5hbWU6IHouc3RyaW5nKCksXG4gIG91dHB1dDogb3V0cHV0U2NoZW1hLFxuICBwcm92aWRlck9wdGlvbnM6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pIGFzIHouWm9kVHlwZTxUb29sUmVzdWx0UGFydD47IC8vIG5lY2Vzc2FyeSBiYyByZXN1bHQgaXMgb3B0aW9uYWwgb24gWm9kIHR5cGVcbiIsICJpbXBvcnQge1xuICBHYXRld2F5QXV0aGVudGljYXRpb25FcnJvcixcbiAgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvcixcbn0gZnJvbSAnQGFpLXNkay9nYXRld2F5JztcbmltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBHYXRld2F5RXJyb3IoZXJyb3I6IHVua25vd24pOiB1bmtub3duIHtcbiAgaWYgKFxuICAgIEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yLmlzSW5zdGFuY2UoZXJyb3IpIHx8XG4gICAgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvci5pc0luc3RhbmNlKGVycm9yKVxuICApIHtcbiAgICByZXR1cm4gbmV3IEFJU0RLRXJyb3Ioe1xuICAgICAgbmFtZTogJ0dhdGV3YXlFcnJvcicsXG4gICAgICBtZXNzYWdlOlxuICAgICAgICAnVmVyY2VsIEFJIEdhdGV3YXkgYWNjZXNzIGZhaWxlZC4gJyArXG4gICAgICAgICdJZiB5b3Ugd2FudCB0byB1c2UgQUkgU0RLIHByb3ZpZGVycyBkaXJlY3RseSwgdXNlIHRoZSBwcm92aWRlcnMsIGUuZy4gQGFpLXNkay9vcGVuYWksICcgK1xuICAgICAgICAnb3IgcmVnaXN0ZXIgYSBkaWZmZXJlbnQgZ2xvYmFsIGRlZmF1bHQgcHJvdmlkZXIuJyxcbiAgICAgIGNhdXNlOiBlcnJvcixcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBlcnJvcjtcbn1cbiIsICJpbXBvcnQgeyBUZWxlbWV0cnlTZXR0aW5ncyB9IGZyb20gJy4vdGVsZW1ldHJ5LXNldHRpbmdzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7XG4gIG9wZXJhdGlvbklkLFxuICB0ZWxlbWV0cnksXG59OiB7XG4gIG9wZXJhdGlvbklkOiBzdHJpbmc7XG4gIHRlbGVtZXRyeT86IFRlbGVtZXRyeVNldHRpbmdzO1xufSkge1xuICByZXR1cm4ge1xuICAgIC8vIHN0YW5kYXJkaXplZCBvcGVyYXRpb24gYW5kIHJlc291cmNlIG5hbWU6XG4gICAgJ29wZXJhdGlvbi5uYW1lJzogYCR7b3BlcmF0aW9uSWR9JHtcbiAgICAgIHRlbGVtZXRyeT8uZnVuY3Rpb25JZCAhPSBudWxsID8gYCAke3RlbGVtZXRyeS5mdW5jdGlvbklkfWAgOiAnJ1xuICAgIH1gLFxuICAgICdyZXNvdXJjZS5uYW1lJzogdGVsZW1ldHJ5Py5mdW5jdGlvbklkLFxuXG4gICAgLy8gZGV0YWlsZWQsIEFJIFNESyBzcGVjaWZpYyBkYXRhOlxuICAgICdhaS5vcGVyYXRpb25JZCc6IG9wZXJhdGlvbklkLFxuICAgICdhaS50ZWxlbWV0cnkuZnVuY3Rpb25JZCc6IHRlbGVtZXRyeT8uZnVuY3Rpb25JZCxcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvYXBpJztcbmltcG9ydCB7IENhbGxTZXR0aW5ncyB9IGZyb20gJy4uL3Byb21wdC9jYWxsLXNldHRpbmdzJztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi90ZWxlbWV0cnktc2V0dGluZ3MnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICBtb2RlbCxcbiAgc2V0dGluZ3MsXG4gIHRlbGVtZXRyeSxcbiAgaGVhZGVycyxcbn06IHtcbiAgbW9kZWw6IHsgbW9kZWxJZDogc3RyaW5nOyBwcm92aWRlcjogc3RyaW5nIH07XG4gIHNldHRpbmdzOiBPbWl0PENhbGxTZXR0aW5ncywgJ2Fib3J0U2lnbmFsJyB8ICdoZWFkZXJzJyB8ICd0ZW1wZXJhdHVyZSc+O1xuICB0ZWxlbWV0cnk6IFRlbGVtZXRyeVNldHRpbmdzIHwgdW5kZWZpbmVkO1xuICBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+IHwgdW5kZWZpbmVkO1xufSk6IEF0dHJpYnV0ZXMge1xuICByZXR1cm4ge1xuICAgICdhaS5tb2RlbC5wcm92aWRlcic6IG1vZGVsLnByb3ZpZGVyLFxuICAgICdhaS5tb2RlbC5pZCc6IG1vZGVsLm1vZGVsSWQsXG5cbiAgICAvLyBzZXR0aW5nczpcbiAgICAuLi5PYmplY3QuZW50cmllcyhzZXR0aW5ncykucmVkdWNlKChhdHRyaWJ1dGVzLCBba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGF0dHJpYnV0ZXNbYGFpLnNldHRpbmdzLiR7a2V5fWBdID0gdmFsdWU7XG4gICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICB9LCB7fSBhcyBBdHRyaWJ1dGVzKSxcblxuICAgIC8vIGFkZCBtZXRhZGF0YSBhcyBhdHRyaWJ1dGVzOlxuICAgIC4uLk9iamVjdC5lbnRyaWVzKHRlbGVtZXRyeT8ubWV0YWRhdGEgPz8ge30pLnJlZHVjZShcbiAgICAgIChhdHRyaWJ1dGVzLCBba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgYXR0cmlidXRlc1tgYWkudGVsZW1ldHJ5Lm1ldGFkYXRhLiR7a2V5fWBdID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICAgICAgfSxcbiAgICAgIHt9IGFzIEF0dHJpYnV0ZXMsXG4gICAgKSxcblxuICAgIC8vIHJlcXVlc3QgaGVhZGVyc1xuICAgIC4uLk9iamVjdC5lbnRyaWVzKGhlYWRlcnMgPz8ge30pLnJlZHVjZSgoYXR0cmlidXRlcywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBhdHRyaWJ1dGVzW2BhaS5yZXF1ZXN0LmhlYWRlcnMuJHtrZXl9YF0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICAgIH0sIHt9IGFzIEF0dHJpYnV0ZXMpLFxuICB9O1xufVxuIiwgImltcG9ydCB7IFRyYWNlciwgdHJhY2UgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9hcGknO1xuaW1wb3J0IHsgbm9vcFRyYWNlciB9IGZyb20gJy4vbm9vcC10cmFjZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VHJhY2VyKHtcbiAgaXNFbmFibGVkID0gZmFsc2UsXG4gIHRyYWNlcixcbn06IHtcbiAgaXNFbmFibGVkPzogYm9vbGVhbjtcbiAgdHJhY2VyPzogVHJhY2VyO1xufSA9IHt9KTogVHJhY2VyIHtcbiAgaWYgKCFpc0VuYWJsZWQpIHtcbiAgICByZXR1cm4gbm9vcFRyYWNlcjtcbiAgfVxuXG4gIGlmICh0cmFjZXIpIHtcbiAgICByZXR1cm4gdHJhY2VyO1xuICB9XG5cbiAgcmV0dXJuIHRyYWNlLmdldFRyYWNlcignYWknKTtcbn1cbiIsICJpbXBvcnQgeyBTcGFuLCBTcGFuQ29udGV4dCwgVHJhY2VyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvYXBpJztcblxuLyoqXG4gKiBUcmFjZXIgaW1wbGVtZW50YXRpb24gdGhhdCBkb2VzIG5vdGhpbmcgKG51bGwgb2JqZWN0KS5cbiAqL1xuZXhwb3J0IGNvbnN0IG5vb3BUcmFjZXI6IFRyYWNlciA9IHtcbiAgc3RhcnRTcGFuKCk6IFNwYW4ge1xuICAgIHJldHVybiBub29wU3BhbjtcbiAgfSxcblxuICBzdGFydEFjdGl2ZVNwYW48RiBleHRlbmRzIChzcGFuOiBTcGFuKSA9PiB1bmtub3duPihcbiAgICBuYW1lOiB1bmtub3duLFxuICAgIGFyZzE6IHVua25vd24sXG4gICAgYXJnMj86IHVua25vd24sXG4gICAgYXJnMz86IEYsXG4gICk6IFJldHVyblR5cGU8YW55PiB7XG4gICAgaWYgKHR5cGVvZiBhcmcxID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gYXJnMShub29wU3Bhbik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgYXJnMiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGFyZzIobm9vcFNwYW4pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGFyZzMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBhcmczKG5vb3BTcGFuKTtcbiAgICB9XG4gIH0sXG59O1xuXG5jb25zdCBub29wU3BhbjogU3BhbiA9IHtcbiAgc3BhbkNvbnRleHQoKSB7XG4gICAgcmV0dXJuIG5vb3BTcGFuQ29udGV4dDtcbiAgfSxcbiAgc2V0QXR0cmlidXRlKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBzZXRBdHRyaWJ1dGVzKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBhZGRFdmVudCgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgYWRkTGluaygpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgYWRkTGlua3MoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHNldFN0YXR1cygpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgdXBkYXRlTmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgZW5kKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBpc1JlY29yZGluZygpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIHJlY29yZEV4Y2VwdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbn07XG5cbmNvbnN0IG5vb3BTcGFuQ29udGV4dDogU3BhbkNvbnRleHQgPSB7XG4gIHRyYWNlSWQ6ICcnLFxuICBzcGFuSWQ6ICcnLFxuICB0cmFjZUZsYWdzOiAwLFxufTtcbiIsICJpbXBvcnQgeyBBdHRyaWJ1dGVzLCBTcGFuLCBUcmFjZXIsIFNwYW5TdGF0dXNDb2RlIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvYXBpJztcblxuZXhwb3J0IGZ1bmN0aW9uIHJlY29yZFNwYW48VD4oe1xuICBuYW1lLFxuICB0cmFjZXIsXG4gIGF0dHJpYnV0ZXMsXG4gIGZuLFxuICBlbmRXaGVuRG9uZSA9IHRydWUsXG59OiB7XG4gIG5hbWU6IHN0cmluZztcbiAgdHJhY2VyOiBUcmFjZXI7XG4gIGF0dHJpYnV0ZXM6IEF0dHJpYnV0ZXM7XG4gIGZuOiAoc3BhbjogU3BhbikgPT4gUHJvbWlzZTxUPjtcbiAgZW5kV2hlbkRvbmU/OiBib29sZWFuO1xufSkge1xuICByZXR1cm4gdHJhY2VyLnN0YXJ0QWN0aXZlU3BhbihuYW1lLCB7IGF0dHJpYnV0ZXMgfSwgYXN5bmMgc3BhbiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZuKHNwYW4pO1xuXG4gICAgICBpZiAoZW5kV2hlbkRvbmUpIHtcbiAgICAgICAgc3Bhbi5lbmQoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVjb3JkRXJyb3JPblNwYW4oc3BhbiwgZXJyb3IpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgLy8gYWx3YXlzIHN0b3AgdGhlIHNwYW4gd2hlbiB0aGVyZSBpcyBhbiBlcnJvcjpcbiAgICAgICAgc3Bhbi5lbmQoKTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBSZWNvcmQgYW4gZXJyb3Igb24gYSBzcGFuLiBJZiB0aGUgZXJyb3IgaXMgYW4gaW5zdGFuY2Ugb2YgRXJyb3IsIGFuIGV4Y2VwdGlvbiBldmVudCB3aWxsIGJlIHJlY29yZGVkIG9uIHRoZSBzcGFuLCBvdGhlcndpc2VcbiAqIHRoZSBzcGFuIHdpbGwgYmUgc2V0IHRvIGFuIGVycm9yIHN0YXR1cy5cbiAqXG4gKiBAcGFyYW0gc3BhbiAtIFRoZSBzcGFuIHRvIHJlY29yZCB0aGUgZXJyb3Igb24uXG4gKiBAcGFyYW0gZXJyb3IgLSBUaGUgZXJyb3IgdG8gcmVjb3JkIG9uIHRoZSBzcGFuLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkRXJyb3JPblNwYW4oc3BhbjogU3BhbiwgZXJyb3I6IHVua25vd24pIHtcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICBzcGFuLnJlY29yZEV4Y2VwdGlvbih7XG4gICAgICBuYW1lOiBlcnJvci5uYW1lLFxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICB9KTtcbiAgICBzcGFuLnNldFN0YXR1cyh7XG4gICAgICBjb2RlOiBTcGFuU3RhdHVzQ29kZS5FUlJPUixcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgc3Bhbi5zZXRTdGF0dXMoeyBjb2RlOiBTcGFuU3RhdHVzQ29kZS5FUlJPUiB9KTtcbiAgfVxufVxuIiwgImltcG9ydCB0eXBlIHsgQXR0cmlidXRlcywgQXR0cmlidXRlVmFsdWUgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9hcGknO1xuaW1wb3J0IHR5cGUgeyBUZWxlbWV0cnlTZXR0aW5ncyB9IGZyb20gJy4vdGVsZW1ldHJ5LXNldHRpbmdzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICB0ZWxlbWV0cnksXG4gIGF0dHJpYnV0ZXMsXG59OiB7XG4gIHRlbGVtZXRyeT86IFRlbGVtZXRyeVNldHRpbmdzO1xuICBhdHRyaWJ1dGVzOiB7XG4gICAgW2F0dHJpYnV0ZUtleTogc3RyaW5nXTpcbiAgICAgIHwgQXR0cmlidXRlVmFsdWVcbiAgICAgIHwgeyBpbnB1dDogKCkgPT4gQXR0cmlidXRlVmFsdWUgfCB1bmRlZmluZWQgfVxuICAgICAgfCB7IG91dHB1dDogKCkgPT4gQXR0cmlidXRlVmFsdWUgfCB1bmRlZmluZWQgfVxuICAgICAgfCB1bmRlZmluZWQ7XG4gIH07XG59KTogQXR0cmlidXRlcyB7XG4gIC8vIHdoZW4gdGVsZW1ldHJ5IGlzIGRpc2FibGVkLCByZXR1cm4gYW4gZW1wdHkgb2JqZWN0IHRvIGF2b2lkIHNlcmlhbGl6YXRpb24gb3ZlcmhlYWQ6XG4gIGlmICh0ZWxlbWV0cnk/LmlzRW5hYmxlZCAhPT0gdHJ1ZSkge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIHJldHVybiBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKS5yZWR1Y2UoKGF0dHJpYnV0ZXMsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICB9XG5cbiAgICAvLyBpbnB1dCB2YWx1ZSwgY2hlY2sgaWYgaXQgc2hvdWxkIGJlIHJlY29yZGVkOlxuICAgIGlmIChcbiAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgICdpbnB1dCcgaW4gdmFsdWUgJiZcbiAgICAgIHR5cGVvZiB2YWx1ZS5pbnB1dCA9PT0gJ2Z1bmN0aW9uJ1xuICAgICkge1xuICAgICAgLy8gZGVmYXVsdCB0byB0cnVlOlxuICAgICAgaWYgKHRlbGVtZXRyeT8ucmVjb3JkSW5wdXRzID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsdWUuaW5wdXQoKTtcblxuICAgICAgcmV0dXJuIHJlc3VsdCA9PSBudWxsID8gYXR0cmlidXRlcyA6IHsgLi4uYXR0cmlidXRlcywgW2tleV06IHJlc3VsdCB9O1xuICAgIH1cblxuICAgIC8vIG91dHB1dCB2YWx1ZSwgY2hlY2sgaWYgaXQgc2hvdWxkIGJlIHJlY29yZGVkOlxuICAgIGlmIChcbiAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgICdvdXRwdXQnIGluIHZhbHVlICYmXG4gICAgICB0eXBlb2YgdmFsdWUub3V0cHV0ID09PSAnZnVuY3Rpb24nXG4gICAgKSB7XG4gICAgICAvLyBkZWZhdWx0IHRvIHRydWU6XG4gICAgICBpZiAodGVsZW1ldHJ5Py5yZWNvcmRPdXRwdXRzID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsdWUub3V0cHV0KCk7XG5cbiAgICAgIHJldHVybiByZXN1bHQgPT0gbnVsbCA/IGF0dHJpYnV0ZXMgOiB7IC4uLmF0dHJpYnV0ZXMsIFtrZXldOiByZXN1bHQgfTtcbiAgICB9XG5cbiAgICAvLyB2YWx1ZSBpcyBhbiBhdHRyaWJ1dGUgdmFsdWUgYWxyZWFkeTpcbiAgICByZXR1cm4geyAuLi5hdHRyaWJ1dGVzLCBba2V5XTogdmFsdWUgfTtcbiAgfSwge30pO1xufVxuIiwgImltcG9ydCB7XG4gIExhbmd1YWdlTW9kZWxWMk1lc3NhZ2UsXG4gIExhbmd1YWdlTW9kZWxWMlByb21wdCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBjb252ZXJ0RGF0YUNvbnRlbnRUb0Jhc2U2NFN0cmluZyB9IGZyb20gJy4uL3Byb21wdC9kYXRhLWNvbnRlbnQnO1xuXG4vKipcbiAqIEhlbHBlciB1dGlsaXR5IHRvIHNlcmlhbGl6ZSBwcm9tcHQgY29udGVudCBmb3IgT3BlblRlbGVtZXRyeSB0cmFjaW5nLlxuICogSXQgaXMgaW5pdGlhbGx5IGNyZWF0ZWQgYmVjYXVzZSBub3JtYWxpemVkIExhbmd1YWdlTW9kZWxWMVByb21wdCBjYXJyaWVzXG4gKiBpbWFnZXMgYXMgVWludDhBcnJheXMsIG9uIHdoaWNoIEpTT04uc3RyaW5naWZ5IGFjdHMgd2VpcmRseSwgY29udmVydGluZ1xuICogdGhlbSB0byBvYmplY3RzIHdpdGggc3RyaW5naWZpZWQgaW5kaWNlcyBhcyBrZXlzLCBlLmcuIHtcIjBcIjogNDIsIFwiMVwiOiA2OSB9LlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5KHByb21wdDogTGFuZ3VhZ2VNb2RlbFYyUHJvbXB0KTogc3RyaW5nIHtcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KFxuICAgIHByb21wdC5tYXAoKG1lc3NhZ2U6IExhbmd1YWdlTW9kZWxWMk1lc3NhZ2UpID0+ICh7XG4gICAgICAuLi5tZXNzYWdlLFxuICAgICAgY29udGVudDpcbiAgICAgICAgdHlwZW9mIG1lc3NhZ2UuY29udGVudCA9PT0gJ3N0cmluZydcbiAgICAgICAgICA/IG1lc3NhZ2UuY29udGVudFxuICAgICAgICAgIDogbWVzc2FnZS5jb250ZW50Lm1hcChwYXJ0ID0+XG4gICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ2ZpbGUnXG4gICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcnQsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6XG4gICAgICAgICAgICAgICAgICAgICAgcGFydC5kYXRhIGluc3RhbmNlb2YgVWludDhBcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBjb252ZXJ0RGF0YUNvbnRlbnRUb0Jhc2U2NFN0cmluZyhwYXJ0LmRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHBhcnQuZGF0YSxcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IHBhcnQsXG4gICAgICAgICAgICApLFxuICAgIH0pKSxcbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBMYW5ndWFnZU1vZGVsVjJVc2FnZSB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG4vKipcblJlcHJlc2VudHMgdGhlIG51bWJlciBvZiB0b2tlbnMgdXNlZCBpbiBhIHByb21wdCBhbmQgY29tcGxldGlvbi5cbiAqL1xuZXhwb3J0IHR5cGUgTGFuZ3VhZ2VNb2RlbFVzYWdlID0gTGFuZ3VhZ2VNb2RlbFYyVXNhZ2U7XG5cbi8qKlxuUmVwcmVzZW50cyB0aGUgbnVtYmVyIG9mIHRva2VucyB1c2VkIGluIGFuIGVtYmVkZGluZy5cbiAqL1xuLy8gVE9ETyByZXBsYWNlIHdpdGggRW1iZWRkaW5nTW9kZWxWMlVzYWdlXG5leHBvcnQgdHlwZSBFbWJlZGRpbmdNb2RlbFVzYWdlID0ge1xuICAvKipcblRoZSBudW1iZXIgb2YgdG9rZW5zIHVzZWQgaW4gdGhlIGVtYmVkZGluZy5cbiAgICovXG4gIHRva2VuczogbnVtYmVyO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZExhbmd1YWdlTW9kZWxVc2FnZShcbiAgdXNhZ2UxOiBMYW5ndWFnZU1vZGVsVXNhZ2UsXG4gIHVzYWdlMjogTGFuZ3VhZ2VNb2RlbFVzYWdlLFxuKTogTGFuZ3VhZ2VNb2RlbFVzYWdlIHtcbiAgcmV0dXJuIHtcbiAgICBpbnB1dFRva2VuczogYWRkVG9rZW5Db3VudHModXNhZ2UxLmlucHV0VG9rZW5zLCB1c2FnZTIuaW5wdXRUb2tlbnMpLFxuICAgIG91dHB1dFRva2VuczogYWRkVG9rZW5Db3VudHModXNhZ2UxLm91dHB1dFRva2VucywgdXNhZ2UyLm91dHB1dFRva2VucyksXG4gICAgdG90YWxUb2tlbnM6IGFkZFRva2VuQ291bnRzKHVzYWdlMS50b3RhbFRva2VucywgdXNhZ2UyLnRvdGFsVG9rZW5zKSxcbiAgICByZWFzb25pbmdUb2tlbnM6IGFkZFRva2VuQ291bnRzKFxuICAgICAgdXNhZ2UxLnJlYXNvbmluZ1Rva2VucyxcbiAgICAgIHVzYWdlMi5yZWFzb25pbmdUb2tlbnMsXG4gICAgKSxcbiAgICBjYWNoZWRJbnB1dFRva2VuczogYWRkVG9rZW5Db3VudHMoXG4gICAgICB1c2FnZTEuY2FjaGVkSW5wdXRUb2tlbnMsXG4gICAgICB1c2FnZTIuY2FjaGVkSW5wdXRUb2tlbnMsXG4gICAgKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYWRkVG9rZW5Db3VudHMoXG4gIHRva2VuQ291bnQxOiBudW1iZXIgfCB1bmRlZmluZWQsXG4gIHRva2VuQ291bnQyOiBudW1iZXIgfCB1bmRlZmluZWQsXG4pOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICByZXR1cm4gdG9rZW5Db3VudDEgPT0gbnVsbCAmJiB0b2tlbkNvdW50MiA9PSBudWxsXG4gICAgPyB1bmRlZmluZWRcbiAgICA6ICh0b2tlbkNvdW50MSA/PyAwKSArICh0b2tlbkNvdW50MiA/PyAwKTtcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gYXNBcnJheTxUPih2YWx1ZTogVCB8IFRbXSB8IHVuZGVmaW5lZCk6IFRbXSB7XG4gIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gW10gOiBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbn1cbiIsICJpbXBvcnQgeyBBUElDYWxsRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IGRlbGF5LCBnZXRFcnJvck1lc3NhZ2UsIGlzQWJvcnRFcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgUmV0cnlFcnJvciB9IGZyb20gJy4vcmV0cnktZXJyb3InO1xuXG5leHBvcnQgdHlwZSBSZXRyeUZ1bmN0aW9uID0gPE9VVFBVVD4oXG4gIGZuOiAoKSA9PiBQcm9taXNlTGlrZTxPVVRQVVQ+LFxuKSA9PiBQcm9taXNlTGlrZTxPVVRQVVQ+O1xuXG5mdW5jdGlvbiBnZXRSZXRyeURlbGF5SW5Ncyh7XG4gIGVycm9yLFxuICBleHBvbmVudGlhbEJhY2tvZmZEZWxheSxcbn06IHtcbiAgZXJyb3I6IEFQSUNhbGxFcnJvcjtcbiAgZXhwb25lbnRpYWxCYWNrb2ZmRGVsYXk6IG51bWJlcjtcbn0pOiBudW1iZXIge1xuICBjb25zdCBoZWFkZXJzID0gZXJyb3IucmVzcG9uc2VIZWFkZXJzO1xuXG4gIGlmICghaGVhZGVycykgcmV0dXJuIGV4cG9uZW50aWFsQmFja29mZkRlbGF5O1xuXG4gIGxldCBtczogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gIC8vIHJldHJ5LW1zIGlzIG1vcmUgcHJlY2lzZSB0aGFuIHJldHJ5LWFmdGVyIGFuZCB1c2VkIGJ5IGUuZy4gT3BlbkFJXG4gIGNvbnN0IHJldHJ5QWZ0ZXJNcyA9IGhlYWRlcnNbJ3JldHJ5LWFmdGVyLW1zJ107XG4gIGlmIChyZXRyeUFmdGVyTXMpIHtcbiAgICBjb25zdCB0aW1lb3V0TXMgPSBwYXJzZUZsb2F0KHJldHJ5QWZ0ZXJNcyk7XG4gICAgaWYgKCFOdW1iZXIuaXNOYU4odGltZW91dE1zKSkge1xuICAgICAgbXMgPSB0aW1lb3V0TXM7XG4gICAgfVxuICB9XG5cbiAgLy8gQWJvdXQgdGhlIFJldHJ5LUFmdGVyIGhlYWRlcjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9IZWFkZXJzL1JldHJ5LUFmdGVyXG4gIGNvbnN0IHJldHJ5QWZ0ZXIgPSBoZWFkZXJzWydyZXRyeS1hZnRlciddO1xuICBpZiAocmV0cnlBZnRlciAmJiBtcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgdGltZW91dFNlY29uZHMgPSBwYXJzZUZsb2F0KHJldHJ5QWZ0ZXIpO1xuICAgIGlmICghTnVtYmVyLmlzTmFOKHRpbWVvdXRTZWNvbmRzKSkge1xuICAgICAgbXMgPSB0aW1lb3V0U2Vjb25kcyAqIDEwMDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1zID0gRGF0ZS5wYXJzZShyZXRyeUFmdGVyKSAtIERhdGUubm93KCk7XG4gICAgfVxuICB9XG5cbiAgLy8gY2hlY2sgdGhhdCB0aGUgZGVsYXkgaXMgcmVhc29uYWJsZTpcbiAgaWYgKFxuICAgIG1zICE9IG51bGwgJiZcbiAgICAhTnVtYmVyLmlzTmFOKG1zKSAmJlxuICAgIDAgPD0gbXMgJiZcbiAgICAobXMgPCA2MCAqIDEwMDAgfHwgbXMgPCBleHBvbmVudGlhbEJhY2tvZmZEZWxheSlcbiAgKSB7XG4gICAgcmV0dXJuIG1zO1xuICB9XG5cbiAgcmV0dXJuIGV4cG9uZW50aWFsQmFja29mZkRlbGF5O1xufVxuXG4vKipcblRoZSBgcmV0cnlXaXRoRXhwb25lbnRpYWxCYWNrb2ZmUmVzcGVjdGluZ1JldHJ5SGVhZGVyc2Agc3RyYXRlZ3kgcmV0cmllcyBhIGZhaWxlZCBBUEkgY2FsbCB3aXRoIGFuIGV4cG9uZW50aWFsIGJhY2tvZmYsXG53aGlsZSByZXNwZWN0aW5nIHJhdGUgbGltaXQgaGVhZGVycyAocmV0cnktYWZ0ZXItbXMgYW5kIHJldHJ5LWFmdGVyKSBpZiB0aGV5IGFyZSBwcm92aWRlZCBhbmQgcmVhc29uYWJsZSAoMC02MCBzZWNvbmRzKS5cbllvdSBjYW4gY29uZmlndXJlIHRoZSBtYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLCB0aGUgaW5pdGlhbCBkZWxheSwgYW5kIHRoZSBiYWNrb2ZmIGZhY3Rvci5cbiAqL1xuZXhwb3J0IGNvbnN0IHJldHJ5V2l0aEV4cG9uZW50aWFsQmFja29mZlJlc3BlY3RpbmdSZXRyeUhlYWRlcnMgPVxuICAoe1xuICAgIG1heFJldHJpZXMgPSAyLFxuICAgIGluaXRpYWxEZWxheUluTXMgPSAyMDAwLFxuICAgIGJhY2tvZmZGYWN0b3IgPSAyLFxuICAgIGFib3J0U2lnbmFsLFxuICB9OiB7XG4gICAgbWF4UmV0cmllcz86IG51bWJlcjtcbiAgICBpbml0aWFsRGVsYXlJbk1zPzogbnVtYmVyO1xuICAgIGJhY2tvZmZGYWN0b3I/OiBudW1iZXI7XG4gICAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgfSA9IHt9KTogUmV0cnlGdW5jdGlvbiA9PlxuICBhc3luYyA8T1VUUFVUPihmOiAoKSA9PiBQcm9taXNlTGlrZTxPVVRQVVQ+KSA9PlxuICAgIF9yZXRyeVdpdGhFeHBvbmVudGlhbEJhY2tvZmYoZiwge1xuICAgICAgbWF4UmV0cmllcyxcbiAgICAgIGRlbGF5SW5NczogaW5pdGlhbERlbGF5SW5NcyxcbiAgICAgIGJhY2tvZmZGYWN0b3IsXG4gICAgICBhYm9ydFNpZ25hbCxcbiAgICB9KTtcblxuYXN5bmMgZnVuY3Rpb24gX3JldHJ5V2l0aEV4cG9uZW50aWFsQmFja29mZjxPVVRQVVQ+KFxuICBmOiAoKSA9PiBQcm9taXNlTGlrZTxPVVRQVVQ+LFxuICB7XG4gICAgbWF4UmV0cmllcyxcbiAgICBkZWxheUluTXMsXG4gICAgYmFja29mZkZhY3RvcixcbiAgICBhYm9ydFNpZ25hbCxcbiAgfToge1xuICAgIG1heFJldHJpZXM6IG51bWJlcjtcbiAgICBkZWxheUluTXM6IG51bWJlcjtcbiAgICBiYWNrb2ZmRmFjdG9yOiBudW1iZXI7XG4gICAgYWJvcnRTaWduYWw6IEFib3J0U2lnbmFsIHwgdW5kZWZpbmVkO1xuICB9LFxuICBlcnJvcnM6IHVua25vd25bXSA9IFtdLFxuKTogUHJvbWlzZTxPVVRQVVQ+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZigpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChpc0Fib3J0RXJyb3IoZXJyb3IpKSB7XG4gICAgICB0aHJvdyBlcnJvcjsgLy8gZG9uJ3QgcmV0cnkgd2hlbiB0aGUgcmVxdWVzdCB3YXMgYWJvcnRlZFxuICAgIH1cblxuICAgIGlmIChtYXhSZXRyaWVzID09PSAwKSB7XG4gICAgICB0aHJvdyBlcnJvcjsgLy8gZG9uJ3Qgd3JhcCB0aGUgZXJyb3Igd2hlbiByZXRyaWVzIGFyZSBkaXNhYmxlZFxuICAgIH1cblxuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGdldEVycm9yTWVzc2FnZShlcnJvcik7XG4gICAgY29uc3QgbmV3RXJyb3JzID0gWy4uLmVycm9ycywgZXJyb3JdO1xuICAgIGNvbnN0IHRyeU51bWJlciA9IG5ld0Vycm9ycy5sZW5ndGg7XG5cbiAgICBpZiAodHJ5TnVtYmVyID4gbWF4UmV0cmllcykge1xuICAgICAgdGhyb3cgbmV3IFJldHJ5RXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIGFmdGVyICR7dHJ5TnVtYmVyfSBhdHRlbXB0cy4gTGFzdCBlcnJvcjogJHtlcnJvck1lc3NhZ2V9YCxcbiAgICAgICAgcmVhc29uOiAnbWF4UmV0cmllc0V4Y2VlZGVkJyxcbiAgICAgICAgZXJyb3JzOiBuZXdFcnJvcnMsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmXG4gICAgICBBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikgJiZcbiAgICAgIGVycm9yLmlzUmV0cnlhYmxlID09PSB0cnVlICYmXG4gICAgICB0cnlOdW1iZXIgPD0gbWF4UmV0cmllc1xuICAgICkge1xuICAgICAgYXdhaXQgZGVsYXkoXG4gICAgICAgIGdldFJldHJ5RGVsYXlJbk1zKHtcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgICBleHBvbmVudGlhbEJhY2tvZmZEZWxheTogZGVsYXlJbk1zLFxuICAgICAgICB9KSxcbiAgICAgICAgeyBhYm9ydFNpZ25hbCB9LFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIF9yZXRyeVdpdGhFeHBvbmVudGlhbEJhY2tvZmYoXG4gICAgICAgIGYsXG4gICAgICAgIHtcbiAgICAgICAgICBtYXhSZXRyaWVzLFxuICAgICAgICAgIGRlbGF5SW5NczogYmFja29mZkZhY3RvciAqIGRlbGF5SW5NcyxcbiAgICAgICAgICBiYWNrb2ZmRmFjdG9yLFxuICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICB9LFxuICAgICAgICBuZXdFcnJvcnMsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICh0cnlOdW1iZXIgPT09IDEpIHtcbiAgICAgIHRocm93IGVycm9yOyAvLyBkb24ndCB3cmFwIHRoZSBlcnJvciB3aGVuIGEgbm9uLXJldHJ5YWJsZSBlcnJvciBvY2N1cnMgb24gdGhlIGZpcnN0IHRyeVxuICAgIH1cblxuICAgIHRocm93IG5ldyBSZXRyeUVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgYWZ0ZXIgJHt0cnlOdW1iZXJ9IGF0dGVtcHRzIHdpdGggbm9uLXJldHJ5YWJsZSBlcnJvcjogJyR7ZXJyb3JNZXNzYWdlfSdgLFxuICAgICAgcmVhc29uOiAnZXJyb3JOb3RSZXRyeWFibGUnLFxuICAgICAgZXJyb3JzOiBuZXdFcnJvcnMsXG4gICAgfSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBJbnZhbGlkQXJndW1lbnRFcnJvciB9IGZyb20gJy4uL2Vycm9yL2ludmFsaWQtYXJndW1lbnQtZXJyb3InO1xuaW1wb3J0IHtcbiAgUmV0cnlGdW5jdGlvbixcbiAgcmV0cnlXaXRoRXhwb25lbnRpYWxCYWNrb2ZmUmVzcGVjdGluZ1JldHJ5SGVhZGVycyxcbn0gZnJvbSAnLi4vdXRpbC9yZXRyeS13aXRoLWV4cG9uZW50aWFsLWJhY2tvZmYnO1xuXG4vKipcbiAqIFZhbGlkYXRlIGFuZCBwcmVwYXJlIHJldHJpZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlUmV0cmllcyh7XG4gIG1heFJldHJpZXMsXG4gIGFib3J0U2lnbmFsLFxufToge1xuICBtYXhSZXRyaWVzOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIGFib3J0U2lnbmFsOiBBYm9ydFNpZ25hbCB8IHVuZGVmaW5lZDtcbn0pOiB7XG4gIG1heFJldHJpZXM6IG51bWJlcjtcbiAgcmV0cnk6IFJldHJ5RnVuY3Rpb247XG59IHtcbiAgaWYgKG1heFJldHJpZXMgIT0gbnVsbCkge1xuICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihtYXhSZXRyaWVzKSkge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAnbWF4UmV0cmllcycsXG4gICAgICAgIHZhbHVlOiBtYXhSZXRyaWVzLFxuICAgICAgICBtZXNzYWdlOiAnbWF4UmV0cmllcyBtdXN0IGJlIGFuIGludGVnZXInLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKG1heFJldHJpZXMgPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdtYXhSZXRyaWVzJyxcbiAgICAgICAgdmFsdWU6IG1heFJldHJpZXMsXG4gICAgICAgIG1lc3NhZ2U6ICdtYXhSZXRyaWVzIG11c3QgYmUgPj0gMCcsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBtYXhSZXRyaWVzUmVzdWx0ID0gbWF4UmV0cmllcyA/PyAyO1xuXG4gIHJldHVybiB7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc1Jlc3VsdCxcbiAgICByZXRyeTogcmV0cnlXaXRoRXhwb25lbnRpYWxCYWNrb2ZmUmVzcGVjdGluZ1JldHJ5SGVhZGVycyh7XG4gICAgICBtYXhSZXRyaWVzOiBtYXhSZXRyaWVzUmVzdWx0LFxuICAgICAgYWJvcnRTaWduYWwsXG4gICAgfSksXG4gIH07XG59XG4iLCAiaW1wb3J0IHsgTGFuZ3VhZ2VNb2RlbFYyQ29udGVudCwgTGFuZ3VhZ2VNb2RlbFYyVGV4dCB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdENvbnRlbnRUZXh0KFxuICBjb250ZW50OiBMYW5ndWFnZU1vZGVsVjJDb250ZW50W10sXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBjb25zdCBwYXJ0cyA9IGNvbnRlbnQuZmlsdGVyKFxuICAgIChjb250ZW50KTogY29udGVudCBpcyBMYW5ndWFnZU1vZGVsVjJUZXh0ID0+IGNvbnRlbnQudHlwZSA9PT0gJ3RleHQnLFxuICApO1xuXG4gIGlmIChwYXJ0cy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgcmV0dXJuIHBhcnRzLm1hcChjb250ZW50ID0+IGNvbnRlbnQudGV4dCkuam9pbignJyk7XG59XG4iLCAiaW1wb3J0IHtcbiAgY29udmVydEJhc2U2NFRvVWludDhBcnJheSxcbiAgY29udmVydFVpbnQ4QXJyYXlUb0Jhc2U2NCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5cbi8qKlxuICogQSBnZW5lcmF0ZWQgZmlsZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRGaWxlIHtcbiAgLyoqXG5GaWxlIGFzIGEgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxuICAgICAqL1xuICByZWFkb25seSBiYXNlNjQ6IHN0cmluZztcblxuICAvKipcbkZpbGUgYXMgYSBVaW50OEFycmF5LlxuICAgICAqL1xuICByZWFkb25seSB1aW50OEFycmF5OiBVaW50OEFycmF5O1xuXG4gIC8qKlxuVGhlIElBTkEgbWVkaWEgdHlwZSBvZiB0aGUgZmlsZS5cblxuQHNlZSBodHRwczovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9tZWRpYS10eXBlcy9tZWRpYS10eXBlcy54aHRtbFxuICAgKi9cbiAgcmVhZG9ubHkgbWVkaWFUeXBlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0R2VuZXJhdGVkRmlsZSBpbXBsZW1lbnRzIEdlbmVyYXRlZEZpbGUge1xuICBwcml2YXRlIGJhc2U2NERhdGE6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSB1aW50OEFycmF5RGF0YTogVWludDhBcnJheSB8IHVuZGVmaW5lZDtcblxuICByZWFkb25seSBtZWRpYVR5cGU6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgZGF0YSxcbiAgICBtZWRpYVR5cGUsXG4gIH06IHtcbiAgICBkYXRhOiBzdHJpbmcgfCBVaW50OEFycmF5O1xuICAgIG1lZGlhVHlwZTogc3RyaW5nO1xuICB9KSB7XG4gICAgY29uc3QgaXNVaW50OEFycmF5ID0gZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXk7XG4gICAgdGhpcy5iYXNlNjREYXRhID0gaXNVaW50OEFycmF5ID8gdW5kZWZpbmVkIDogZGF0YTtcbiAgICB0aGlzLnVpbnQ4QXJyYXlEYXRhID0gaXNVaW50OEFycmF5ID8gZGF0YSA6IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lZGlhVHlwZSA9IG1lZGlhVHlwZTtcbiAgfVxuXG4gIC8vIGxhenkgY29udmVyc2lvbiB3aXRoIGNhY2hpbmcgdG8gYXZvaWQgdW5uZWNlc3NhcnkgY29udmVyc2lvbiBvdmVyaGVhZDpcbiAgZ2V0IGJhc2U2NCgpIHtcbiAgICBpZiAodGhpcy5iYXNlNjREYXRhID09IG51bGwpIHtcbiAgICAgIHRoaXMuYmFzZTY0RGF0YSA9IGNvbnZlcnRVaW50OEFycmF5VG9CYXNlNjQodGhpcy51aW50OEFycmF5RGF0YSEpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5iYXNlNjREYXRhO1xuICB9XG5cbiAgLy8gbGF6eSBjb252ZXJzaW9uIHdpdGggY2FjaGluZyB0byBhdm9pZCB1bm5lY2Vzc2FyeSBjb252ZXJzaW9uIG92ZXJoZWFkOlxuICBnZXQgdWludDhBcnJheSgpIHtcbiAgICBpZiAodGhpcy51aW50OEFycmF5RGF0YSA9PSBudWxsKSB7XG4gICAgICB0aGlzLnVpbnQ4QXJyYXlEYXRhID0gY29udmVydEJhc2U2NFRvVWludDhBcnJheSh0aGlzLmJhc2U2NERhdGEhKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudWludDhBcnJheURhdGE7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERlZmF1bHRHZW5lcmF0ZWRGaWxlV2l0aFR5cGUgZXh0ZW5kcyBEZWZhdWx0R2VuZXJhdGVkRmlsZSB7XG4gIHJlYWRvbmx5IHR5cGUgPSAnZmlsZSc7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogeyBkYXRhOiBzdHJpbmcgfCBVaW50OEFycmF5OyBtZWRpYVR5cGU6IHN0cmluZyB9KSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBMYW5ndWFnZU1vZGVsVjJUb29sQ2FsbCB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgYXNTY2hlbWEsXG4gIE1vZGVsTWVzc2FnZSxcbiAgc2FmZVBhcnNlSlNPTixcbiAgc2FmZVZhbGlkYXRlVHlwZXMsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgSW52YWxpZFRvb2xJbnB1dEVycm9yIH0gZnJvbSAnLi4vZXJyb3IvaW52YWxpZC10b29sLWlucHV0LWVycm9yJztcbmltcG9ydCB7IE5vU3VjaFRvb2xFcnJvciB9IGZyb20gJy4uL2Vycm9yL25vLXN1Y2gtdG9vbC1lcnJvcic7XG5pbXBvcnQgeyBUb29sQ2FsbFJlcGFpckVycm9yIH0gZnJvbSAnLi4vZXJyb3IvdG9vbC1jYWxsLXJlcGFpci1lcnJvcic7XG5pbXBvcnQgeyBUeXBlZFRvb2xDYWxsIH0gZnJvbSAnLi90b29sLWNhbGwnO1xuaW1wb3J0IHsgVG9vbENhbGxSZXBhaXJGdW5jdGlvbiB9IGZyb20gJy4vdG9vbC1jYWxsLXJlcGFpci1mdW5jdGlvbic7XG5pbXBvcnQgeyBUb29sU2V0IH0gZnJvbSAnLi90b29sLXNldCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVRvb2xDYWxsPFRPT0xTIGV4dGVuZHMgVG9vbFNldD4oe1xuICB0b29sQ2FsbCxcbiAgdG9vbHMsXG4gIHJlcGFpclRvb2xDYWxsLFxuICBzeXN0ZW0sXG4gIG1lc3NhZ2VzLFxufToge1xuICB0b29sQ2FsbDogTGFuZ3VhZ2VNb2RlbFYyVG9vbENhbGw7XG4gIHRvb2xzOiBUT09MUyB8IHVuZGVmaW5lZDtcbiAgcmVwYWlyVG9vbENhbGw6IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb248VE9PTFM+IHwgdW5kZWZpbmVkO1xuICBzeXN0ZW06IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgbWVzc2FnZXM6IE1vZGVsTWVzc2FnZVtdO1xufSk6IFByb21pc2U8VHlwZWRUb29sQ2FsbDxUT09MUz4+IHtcbiAgdHJ5IHtcbiAgICBpZiAodG9vbHMgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IE5vU3VjaFRvb2xFcnJvcih7IHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSB9KTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGRvUGFyc2VUb29sQ2FsbCh7IHRvb2xDYWxsLCB0b29scyB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKFxuICAgICAgICByZXBhaXJUb29sQ2FsbCA9PSBudWxsIHx8XG4gICAgICAgICEoXG4gICAgICAgICAgTm9TdWNoVG9vbEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpIHx8XG4gICAgICAgICAgSW52YWxpZFRvb2xJbnB1dEVycm9yLmlzSW5zdGFuY2UoZXJyb3IpXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cblxuICAgICAgbGV0IHJlcGFpcmVkVG9vbENhbGw6IExhbmd1YWdlTW9kZWxWMlRvb2xDYWxsIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHJlcGFpcmVkVG9vbENhbGwgPSBhd2FpdCByZXBhaXJUb29sQ2FsbCh7XG4gICAgICAgICAgdG9vbENhbGwsXG4gICAgICAgICAgdG9vbHMsXG4gICAgICAgICAgaW5wdXRTY2hlbWE6ICh7IHRvb2xOYW1lIH0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgaW5wdXRTY2hlbWEgfSA9IHRvb2xzW3Rvb2xOYW1lXTtcbiAgICAgICAgICAgIHJldHVybiBhc1NjaGVtYShpbnB1dFNjaGVtYSkuanNvblNjaGVtYTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN5c3RlbSxcbiAgICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChyZXBhaXJFcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgVG9vbENhbGxSZXBhaXJFcnJvcih7XG4gICAgICAgICAgY2F1c2U6IHJlcGFpckVycm9yLFxuICAgICAgICAgIG9yaWdpbmFsRXJyb3I6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gbm8gcmVwYWlyZWQgdG9vbCBjYWxsIHJldHVybmVkXG4gICAgICBpZiAocmVwYWlyZWRUb29sQ2FsbCA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXdhaXQgZG9QYXJzZVRvb2xDYWxsKHsgdG9vbENhbGw6IHJlcGFpcmVkVG9vbENhbGwsIHRvb2xzIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBUT0RPIEFJIFNESyA2OiBzcGVjaWFsIGludmFsaWQgdG9vbCBjYWxsIHBhcnRzXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICd0b29sLWNhbGwnLFxuICAgICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgIGlucHV0OiB0b29sQ2FsbC5pbnB1dCxcbiAgICAgIGR5bmFtaWM6IHRydWUsXG4gICAgICBpbnZhbGlkOiB0cnVlLFxuICAgICAgZXJyb3IsXG4gICAgfTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBkb1BhcnNlVG9vbENhbGw8VE9PTFMgZXh0ZW5kcyBUb29sU2V0Pih7XG4gIHRvb2xDYWxsLFxuICB0b29scyxcbn06IHtcbiAgdG9vbENhbGw6IExhbmd1YWdlTW9kZWxWMlRvb2xDYWxsO1xuICB0b29sczogVE9PTFM7XG59KTogUHJvbWlzZTxUeXBlZFRvb2xDYWxsPFRPT0xTPj4ge1xuICBjb25zdCB0b29sTmFtZSA9IHRvb2xDYWxsLnRvb2xOYW1lIGFzIGtleW9mIFRPT0xTICYgc3RyaW5nO1xuXG4gIGNvbnN0IHRvb2wgPSB0b29sc1t0b29sTmFtZV07XG5cbiAgaWYgKHRvb2wgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBOb1N1Y2hUb29sRXJyb3Ioe1xuICAgICAgdG9vbE5hbWU6IHRvb2xDYWxsLnRvb2xOYW1lLFxuICAgICAgYXZhaWxhYmxlVG9vbHM6IE9iamVjdC5rZXlzKHRvb2xzKSxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHNjaGVtYSA9IGFzU2NoZW1hKHRvb2wuaW5wdXRTY2hlbWEpO1xuXG4gIC8vIHdoZW4gdGhlIHRvb2wgY2FsbCBoYXMgbm8gYXJndW1lbnRzLCB3ZSB0cnkgcGFzc2luZyBhbiBlbXB0eSBvYmplY3QgdG8gdGhlIHNjaGVtYVxuICAvLyAobWFueSBMTE1zIGdlbmVyYXRlIGVtcHR5IHN0cmluZ3MgZm9yIHRvb2wgY2FsbHMgd2l0aCBubyBhcmd1bWVudHMpXG4gIGNvbnN0IHBhcnNlUmVzdWx0ID1cbiAgICB0b29sQ2FsbC5pbnB1dC50cmltKCkgPT09ICcnXG4gICAgICA/IGF3YWl0IHNhZmVWYWxpZGF0ZVR5cGVzKHsgdmFsdWU6IHt9LCBzY2hlbWEgfSlcbiAgICAgIDogYXdhaXQgc2FmZVBhcnNlSlNPTih7IHRleHQ6IHRvb2xDYWxsLmlucHV0LCBzY2hlbWEgfSk7XG5cbiAgaWYgKHBhcnNlUmVzdWx0LnN1Y2Nlc3MgPT09IGZhbHNlKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRUb29sSW5wdXRFcnJvcih7XG4gICAgICB0b29sTmFtZSxcbiAgICAgIHRvb2xJbnB1dDogdG9vbENhbGwuaW5wdXQsXG4gICAgICBjYXVzZTogcGFyc2VSZXN1bHQuZXJyb3IsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gdG9vbC50eXBlID09PSAnZHluYW1pYydcbiAgICA/IHtcbiAgICAgICAgdHlwZTogJ3Rvb2wtY2FsbCcsXG4gICAgICAgIHRvb2xDYWxsSWQ6IHRvb2xDYWxsLnRvb2xDYWxsSWQsXG4gICAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgICAgaW5wdXQ6IHBhcnNlUmVzdWx0LnZhbHVlLFxuICAgICAgICBwcm92aWRlckV4ZWN1dGVkOiB0b29sQ2FsbC5wcm92aWRlckV4ZWN1dGVkLFxuICAgICAgICBwcm92aWRlck1ldGFkYXRhOiB0b29sQ2FsbC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICBkeW5hbWljOiB0cnVlLFxuICAgICAgfVxuICAgIDoge1xuICAgICAgICB0eXBlOiAndG9vbC1jYWxsJyxcbiAgICAgICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgIGlucHV0OiBwYXJzZVJlc3VsdC52YWx1ZSxcbiAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogdG9vbENhbGwucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogdG9vbENhbGwucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgIH07XG59XG4iLCAiaW1wb3J0IHsgUmVhc29uaW5nUGFydCB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHtcbiAgQ2FsbFdhcm5pbmcsXG4gIEZpbmlzaFJlYXNvbixcbiAgTGFuZ3VhZ2VNb2RlbFJlcXVlc3RNZXRhZGF0YSxcbiAgTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGEsXG4gIFByb3ZpZGVyTWV0YWRhdGEsXG59IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IFNvdXJjZSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsJztcbmltcG9ydCB7IExhbmd1YWdlTW9kZWxVc2FnZSB9IGZyb20gJy4uL3R5cGVzL3VzYWdlJztcbmltcG9ydCB7IENvbnRlbnRQYXJ0IH0gZnJvbSAnLi9jb250ZW50LXBhcnQnO1xuaW1wb3J0IHsgR2VuZXJhdGVkRmlsZSB9IGZyb20gJy4vZ2VuZXJhdGVkLWZpbGUnO1xuaW1wb3J0IHsgUmVzcG9uc2VNZXNzYWdlIH0gZnJvbSAnLi9yZXNwb25zZS1tZXNzYWdlJztcbmltcG9ydCB7IER5bmFtaWNUb29sQ2FsbCwgU3RhdGljVG9vbENhbGwsIFR5cGVkVG9vbENhbGwgfSBmcm9tICcuL3Rvb2wtY2FsbCc7XG5pbXBvcnQge1xuICBEeW5hbWljVG9vbFJlc3VsdCxcbiAgU3RhdGljVG9vbFJlc3VsdCxcbiAgVHlwZWRUb29sUmVzdWx0LFxufSBmcm9tICcuL3Rvb2wtcmVzdWx0JztcbmltcG9ydCB7IFRvb2xTZXQgfSBmcm9tICcuL3Rvb2wtc2V0JztcblxuLyoqXG4gKiBUaGUgcmVzdWx0IG9mIGEgc2luZ2xlIHN0ZXAgaW4gdGhlIGdlbmVyYXRpb24gcHJvY2Vzcy5cbiAqL1xuZXhwb3J0IHR5cGUgU3RlcFJlc3VsdDxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0ge1xuICAvKipcblRoZSBjb250ZW50IHRoYXQgd2FzIGdlbmVyYXRlZCBpbiB0aGUgbGFzdCBzdGVwLlxuICAgKi9cbiAgcmVhZG9ubHkgY29udGVudDogQXJyYXk8Q29udGVudFBhcnQ8VE9PTFM+PjtcblxuICAvKipcblRoZSBnZW5lcmF0ZWQgdGV4dC5cbiovXG4gIHJlYWRvbmx5IHRleHQ6IHN0cmluZztcblxuICAvKipcblRoZSByZWFzb25pbmcgdGhhdCB3YXMgZ2VuZXJhdGVkIGR1cmluZyB0aGUgZ2VuZXJhdGlvbi5cbiovXG4gIHJlYWRvbmx5IHJlYXNvbmluZzogQXJyYXk8UmVhc29uaW5nUGFydD47XG5cbiAgLyoqXG5UaGUgcmVhc29uaW5nIHRleHQgdGhhdCB3YXMgZ2VuZXJhdGVkIGR1cmluZyB0aGUgZ2VuZXJhdGlvbi5cbiovXG4gIHJlYWRvbmx5IHJlYXNvbmluZ1RleHQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICAvKipcblRoZSBmaWxlcyB0aGF0IHdlcmUgZ2VuZXJhdGVkIGR1cmluZyB0aGUgZ2VuZXJhdGlvbi5cbiovXG4gIHJlYWRvbmx5IGZpbGVzOiBBcnJheTxHZW5lcmF0ZWRGaWxlPjtcblxuICAvKipcblRoZSBzb3VyY2VzIHRoYXQgd2VyZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0ZXh0LlxuKi9cbiAgcmVhZG9ubHkgc291cmNlczogQXJyYXk8U291cmNlPjtcblxuICAvKipcblRoZSB0b29sIGNhbGxzIHRoYXQgd2VyZSBtYWRlIGR1cmluZyB0aGUgZ2VuZXJhdGlvbi5cbiovXG4gIHJlYWRvbmx5IHRvb2xDYWxsczogQXJyYXk8VHlwZWRUb29sQ2FsbDxUT09MUz4+O1xuXG4gIC8qKlxuVGhlIHN0YXRpYyB0b29sIGNhbGxzIHRoYXQgd2VyZSBtYWRlIGluIHRoZSBsYXN0IHN0ZXAuXG4qL1xuICByZWFkb25seSBzdGF0aWNUb29sQ2FsbHM6IEFycmF5PFN0YXRpY1Rvb2xDYWxsPFRPT0xTPj47XG5cbiAgLyoqXG5UaGUgZHluYW1pYyB0b29sIGNhbGxzIHRoYXQgd2VyZSBtYWRlIGluIHRoZSBsYXN0IHN0ZXAuXG4qL1xuICByZWFkb25seSBkeW5hbWljVG9vbENhbGxzOiBBcnJheTxEeW5hbWljVG9vbENhbGw+O1xuXG4gIC8qKlxuVGhlIHJlc3VsdHMgb2YgdGhlIHRvb2wgY2FsbHMuXG4qL1xuICByZWFkb25seSB0b29sUmVzdWx0czogQXJyYXk8VHlwZWRUb29sUmVzdWx0PFRPT0xTPj47XG5cbiAgLyoqXG5UaGUgc3RhdGljIHRvb2wgcmVzdWx0cyB0aGF0IHdlcmUgbWFkZSBpbiB0aGUgbGFzdCBzdGVwLlxuKi9cbiAgcmVhZG9ubHkgc3RhdGljVG9vbFJlc3VsdHM6IEFycmF5PFN0YXRpY1Rvb2xSZXN1bHQ8VE9PTFM+PjtcblxuICAvKipcblRoZSBkeW5hbWljIHRvb2wgcmVzdWx0cyB0aGF0IHdlcmUgbWFkZSBpbiB0aGUgbGFzdCBzdGVwLlxuKi9cbiAgcmVhZG9ubHkgZHluYW1pY1Rvb2xSZXN1bHRzOiBBcnJheTxEeW5hbWljVG9vbFJlc3VsdD47XG5cbiAgLyoqXG5UaGUgcmVhc29uIHdoeSB0aGUgZ2VuZXJhdGlvbiBmaW5pc2hlZC5cbiovXG4gIHJlYWRvbmx5IGZpbmlzaFJlYXNvbjogRmluaXNoUmVhc29uO1xuXG4gIC8qKlxuVGhlIHRva2VuIHVzYWdlIG9mIHRoZSBnZW5lcmF0ZWQgdGV4dC5cbiovXG4gIHJlYWRvbmx5IHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG5cbiAgLyoqXG5XYXJuaW5ncyBmcm9tIHRoZSBtb2RlbCBwcm92aWRlciAoZS5nLiB1bnN1cHBvcnRlZCBzZXR0aW5ncykuXG4qL1xuICByZWFkb25seSB3YXJuaW5nczogQ2FsbFdhcm5pbmdbXSB8IHVuZGVmaW5lZDtcblxuICAvKipcbkFkZGl0aW9uYWwgcmVxdWVzdCBpbmZvcm1hdGlvbi5cbiAgICovXG4gIHJlYWRvbmx5IHJlcXVlc3Q6IExhbmd1YWdlTW9kZWxSZXF1ZXN0TWV0YWRhdGE7XG5cbiAgLyoqXG5BZGRpdGlvbmFsIHJlc3BvbnNlIGluZm9ybWF0aW9uLlxuKi9cbiAgcmVhZG9ubHkgcmVzcG9uc2U6IExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhICYge1xuICAgIC8qKlxuVGhlIHJlc3BvbnNlIG1lc3NhZ2VzIHRoYXQgd2VyZSBnZW5lcmF0ZWQgZHVyaW5nIHRoZSBjYWxsLlxuUmVzcG9uc2UgbWVzc2FnZXMgY2FuIGJlIGVpdGhlciBhc3Npc3RhbnQgbWVzc2FnZXMgb3IgdG9vbCBtZXNzYWdlcy5cblRoZXkgY29udGFpbiBhIGdlbmVyYXRlZCBpZC5cbiovXG4gICAgcmVhZG9ubHkgbWVzc2FnZXM6IEFycmF5PFJlc3BvbnNlTWVzc2FnZT47XG5cbiAgICAvKipcblJlc3BvbnNlIGJvZHkgKGF2YWlsYWJsZSBvbmx5IGZvciBwcm92aWRlcnMgdGhhdCB1c2UgSFRUUCByZXF1ZXN0cykuXG4gICAgICovXG4gICAgYm9keT86IHVua25vd247XG4gIH07XG5cbiAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxuZnJvbSB0aGUgcHJvdmlkZXIgdG8gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5yZXN1bHRzIHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gICAqL1xuICByZWFkb25seSBwcm92aWRlck1ldGFkYXRhOiBQcm92aWRlck1ldGFkYXRhIHwgdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGNsYXNzIERlZmF1bHRTdGVwUmVzdWx0PFRPT0xTIGV4dGVuZHMgVG9vbFNldD5cbiAgaW1wbGVtZW50cyBTdGVwUmVzdWx0PFRPT0xTPlxue1xuICByZWFkb25seSBjb250ZW50OiBTdGVwUmVzdWx0PFRPT0xTPlsnY29udGVudCddO1xuICByZWFkb25seSBmaW5pc2hSZWFzb246IFN0ZXBSZXN1bHQ8VE9PTFM+WydmaW5pc2hSZWFzb24nXTtcbiAgcmVhZG9ubHkgdXNhZ2U6IFN0ZXBSZXN1bHQ8VE9PTFM+Wyd1c2FnZSddO1xuICByZWFkb25seSB3YXJuaW5nczogU3RlcFJlc3VsdDxUT09MUz5bJ3dhcm5pbmdzJ107XG4gIHJlYWRvbmx5IHJlcXVlc3Q6IFN0ZXBSZXN1bHQ8VE9PTFM+WydyZXF1ZXN0J107XG4gIHJlYWRvbmx5IHJlc3BvbnNlOiBTdGVwUmVzdWx0PFRPT0xTPlsncmVzcG9uc2UnXTtcbiAgcmVhZG9ubHkgcHJvdmlkZXJNZXRhZGF0YTogU3RlcFJlc3VsdDxUT09MUz5bJ3Byb3ZpZGVyTWV0YWRhdGEnXTtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgY29udGVudCxcbiAgICBmaW5pc2hSZWFzb24sXG4gICAgdXNhZ2UsXG4gICAgd2FybmluZ3MsXG4gICAgcmVxdWVzdCxcbiAgICByZXNwb25zZSxcbiAgICBwcm92aWRlck1ldGFkYXRhLFxuICB9OiB7XG4gICAgY29udGVudDogU3RlcFJlc3VsdDxUT09MUz5bJ2NvbnRlbnQnXTtcbiAgICBmaW5pc2hSZWFzb246IFN0ZXBSZXN1bHQ8VE9PTFM+WydmaW5pc2hSZWFzb24nXTtcbiAgICB1c2FnZTogU3RlcFJlc3VsdDxUT09MUz5bJ3VzYWdlJ107XG4gICAgd2FybmluZ3M6IFN0ZXBSZXN1bHQ8VE9PTFM+Wyd3YXJuaW5ncyddO1xuICAgIHJlcXVlc3Q6IFN0ZXBSZXN1bHQ8VE9PTFM+WydyZXF1ZXN0J107XG4gICAgcmVzcG9uc2U6IFN0ZXBSZXN1bHQ8VE9PTFM+WydyZXNwb25zZSddO1xuICAgIHByb3ZpZGVyTWV0YWRhdGE6IFN0ZXBSZXN1bHQ8VE9PTFM+Wydwcm92aWRlck1ldGFkYXRhJ107XG4gIH0pIHtcbiAgICB0aGlzLmNvbnRlbnQgPSBjb250ZW50O1xuICAgIHRoaXMuZmluaXNoUmVhc29uID0gZmluaXNoUmVhc29uO1xuICAgIHRoaXMudXNhZ2UgPSB1c2FnZTtcbiAgICB0aGlzLndhcm5pbmdzID0gd2FybmluZ3M7XG4gICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gICAgdGhpcy5wcm92aWRlck1ldGFkYXRhID0gcHJvdmlkZXJNZXRhZGF0YTtcbiAgfVxuXG4gIGdldCB0ZXh0KCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRlbnRcbiAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICd0ZXh0JylcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnRleHQpXG4gICAgICAuam9pbignJyk7XG4gIH1cblxuICBnZXQgcmVhc29uaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRlbnQuZmlsdGVyKHBhcnQgPT4gcGFydC50eXBlID09PSAncmVhc29uaW5nJyk7XG4gIH1cblxuICBnZXQgcmVhc29uaW5nVGV4dCgpIHtcbiAgICByZXR1cm4gdGhpcy5yZWFzb25pbmcubGVuZ3RoID09PSAwXG4gICAgICA/IHVuZGVmaW5lZFxuICAgICAgOiB0aGlzLnJlYXNvbmluZy5tYXAocGFydCA9PiBwYXJ0LnRleHQpLmpvaW4oJycpO1xuICB9XG5cbiAgZ2V0IGZpbGVzKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRlbnRcbiAgICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICdmaWxlJylcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LmZpbGUpO1xuICB9XG5cbiAgZ2V0IHNvdXJjZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udGVudC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICdzb3VyY2UnKTtcbiAgfVxuXG4gIGdldCB0b29sQ2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udGVudC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICd0b29sLWNhbGwnKTtcbiAgfVxuXG4gIGdldCBzdGF0aWNUb29sQ2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMudG9vbENhbGxzLmZpbHRlcihcbiAgICAgICh0b29sQ2FsbCk6IHRvb2xDYWxsIGlzIFN0YXRpY1Rvb2xDYWxsPFRPT0xTPiA9PlxuICAgICAgICB0b29sQ2FsbC5keW5hbWljID09PSBmYWxzZSxcbiAgICApO1xuICB9XG5cbiAgZ2V0IGR5bmFtaWNUb29sQ2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMudG9vbENhbGxzLmZpbHRlcihcbiAgICAgICh0b29sQ2FsbCk6IHRvb2xDYWxsIGlzIER5bmFtaWNUb29sQ2FsbCA9PiB0b29sQ2FsbC5keW5hbWljID09PSB0cnVlLFxuICAgICk7XG4gIH1cblxuICBnZXQgdG9vbFJlc3VsdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udGVudC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICd0b29sLXJlc3VsdCcpO1xuICB9XG5cbiAgZ2V0IHN0YXRpY1Rvb2xSZXN1bHRzKCkge1xuICAgIHJldHVybiB0aGlzLnRvb2xSZXN1bHRzLmZpbHRlcihcbiAgICAgICh0b29sUmVzdWx0KTogdG9vbFJlc3VsdCBpcyBTdGF0aWNUb29sUmVzdWx0PFRPT0xTPiA9PlxuICAgICAgICB0b29sUmVzdWx0LmR5bmFtaWMgPT09IGZhbHNlLFxuICAgICk7XG4gIH1cblxuICBnZXQgZHluYW1pY1Rvb2xSZXN1bHRzKCkge1xuICAgIHJldHVybiB0aGlzLnRvb2xSZXN1bHRzLmZpbHRlcihcbiAgICAgICh0b29sUmVzdWx0KTogdG9vbFJlc3VsdCBpcyBEeW5hbWljVG9vbFJlc3VsdCA9PlxuICAgICAgICB0b29sUmVzdWx0LmR5bmFtaWMgPT09IHRydWUsXG4gICAgKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IFN0ZXBSZXN1bHQgfSBmcm9tICcuL3N0ZXAtcmVzdWx0JztcbmltcG9ydCB7IFRvb2xTZXQgfSBmcm9tICcuL3Rvb2wtc2V0JztcblxuZXhwb3J0IHR5cGUgU3RvcENvbmRpdGlvbjxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0gKG9wdGlvbnM6IHtcbiAgc3RlcHM6IEFycmF5PFN0ZXBSZXN1bHQ8VE9PTFM+Pjtcbn0pID0+IFByb21pc2VMaWtlPGJvb2xlYW4+IHwgYm9vbGVhbjtcblxuZXhwb3J0IGZ1bmN0aW9uIHN0ZXBDb3VudElzKHN0ZXBDb3VudDogbnVtYmVyKTogU3RvcENvbmRpdGlvbjxhbnk+IHtcbiAgcmV0dXJuICh7IHN0ZXBzIH0pID0+IHN0ZXBzLmxlbmd0aCA9PT0gc3RlcENvdW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzVG9vbENhbGwodG9vbE5hbWU6IHN0cmluZyk6IFN0b3BDb25kaXRpb248YW55PiB7XG4gIHJldHVybiAoeyBzdGVwcyB9KSA9PlxuICAgIHN0ZXBzW3N0ZXBzLmxlbmd0aCAtIDFdPy50b29sQ2FsbHM/LnNvbWUoXG4gICAgICB0b29sQ2FsbCA9PiB0b29sQ2FsbC50b29sTmFtZSA9PT0gdG9vbE5hbWUsXG4gICAgKSA/PyBmYWxzZTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzU3RvcENvbmRpdGlvbk1ldDxUT09MUyBleHRlbmRzIFRvb2xTZXQ+KHtcbiAgc3RvcENvbmRpdGlvbnMsXG4gIHN0ZXBzLFxufToge1xuICBzdG9wQ29uZGl0aW9uczogQXJyYXk8U3RvcENvbmRpdGlvbjxUT09MUz4+O1xuICBzdGVwczogQXJyYXk8U3RlcFJlc3VsdDxUT09MUz4+O1xufSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gKFxuICAgIGF3YWl0IFByb21pc2UuYWxsKHN0b3BDb25kaXRpb25zLm1hcChjb25kaXRpb24gPT4gY29uZGl0aW9uKHsgc3RlcHMgfSkpKVxuICApLnNvbWUocmVzdWx0ID0+IHJlc3VsdCk7XG59XG4iLCAiaW1wb3J0IHtcbiAgZ2V0RXJyb3JNZXNzYWdlLFxuICBKU09OVmFsdWUsXG4gIExhbmd1YWdlTW9kZWxWMlRvb2xSZXN1bHRPdXRwdXQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgVG9vbCB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVG9vbE1vZGVsT3V0cHV0KHtcbiAgb3V0cHV0LFxuICB0b29sLFxuICBlcnJvck1vZGUsXG59OiB7XG4gIG91dHB1dDogdW5rbm93bjtcbiAgdG9vbDogVG9vbCB8IHVuZGVmaW5lZDtcbiAgZXJyb3JNb2RlOiAnbm9uZScgfCAndGV4dCcgfCAnanNvbic7XG59KTogTGFuZ3VhZ2VNb2RlbFYyVG9vbFJlc3VsdE91dHB1dCB7XG4gIGlmIChlcnJvck1vZGUgPT09ICd0ZXh0Jykge1xuICAgIHJldHVybiB7IHR5cGU6ICdlcnJvci10ZXh0JywgdmFsdWU6IGdldEVycm9yTWVzc2FnZShvdXRwdXQpIH07XG4gIH0gZWxzZSBpZiAoZXJyb3JNb2RlID09PSAnanNvbicpIHtcbiAgICByZXR1cm4geyB0eXBlOiAnZXJyb3ItanNvbicsIHZhbHVlOiB0b0pTT05WYWx1ZShvdXRwdXQpIH07XG4gIH1cblxuICBpZiAodG9vbD8udG9Nb2RlbE91dHB1dCkge1xuICAgIHJldHVybiB0b29sLnRvTW9kZWxPdXRwdXQob3V0cHV0KTtcbiAgfVxuXG4gIHJldHVybiB0eXBlb2Ygb3V0cHV0ID09PSAnc3RyaW5nJ1xuICAgID8geyB0eXBlOiAndGV4dCcsIHZhbHVlOiBvdXRwdXQgfVxuICAgIDogeyB0eXBlOiAnanNvbicsIHZhbHVlOiB0b0pTT05WYWx1ZShvdXRwdXQpIH07XG59XG5cbmZ1bmN0aW9uIHRvSlNPTlZhbHVlKHZhbHVlOiB1bmtub3duKTogSlNPTlZhbHVlIHtcbiAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogKHZhbHVlIGFzIEpTT05WYWx1ZSk7XG59XG4iLCAiaW1wb3J0IHtcbiAgQXNzaXN0YW50Q29udGVudCxcbiAgQXNzaXN0YW50TW9kZWxNZXNzYWdlLFxuICBUb29sQ29udGVudCxcbiAgVG9vbE1vZGVsTWVzc2FnZSxcbn0gZnJvbSAnLi4vcHJvbXB0JztcbmltcG9ydCB7IGNyZWF0ZVRvb2xNb2RlbE91dHB1dCB9IGZyb20gJy4uL3Byb21wdC9jcmVhdGUtdG9vbC1tb2RlbC1vdXRwdXQnO1xuaW1wb3J0IHsgQ29udGVudFBhcnQgfSBmcm9tICcuL2NvbnRlbnQtcGFydCc7XG5pbXBvcnQgeyBUb29sU2V0IH0gZnJvbSAnLi90b29sLXNldCc7XG5cbi8qKlxuQ29udmVydHMgdGhlIHJlc3VsdCBvZiBhIGBnZW5lcmF0ZVRleHRgIG9yIGBzdHJlYW1UZXh0YCBjYWxsIHRvIGEgbGlzdCBvZiByZXNwb25zZSBtZXNzYWdlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvUmVzcG9uc2VNZXNzYWdlczxUT09MUyBleHRlbmRzIFRvb2xTZXQ+KHtcbiAgY29udGVudDogaW5wdXRDb250ZW50LFxuICB0b29scyxcbn06IHtcbiAgY29udGVudDogQXJyYXk8Q29udGVudFBhcnQ8VE9PTFM+PjtcbiAgdG9vbHM6IFRPT0xTIHwgdW5kZWZpbmVkO1xufSk6IEFycmF5PEFzc2lzdGFudE1vZGVsTWVzc2FnZSB8IFRvb2xNb2RlbE1lc3NhZ2U+IHtcbiAgY29uc3QgcmVzcG9uc2VNZXNzYWdlczogQXJyYXk8QXNzaXN0YW50TW9kZWxNZXNzYWdlIHwgVG9vbE1vZGVsTWVzc2FnZT4gPSBbXTtcblxuICBjb25zdCBjb250ZW50OiBBc3Npc3RhbnRDb250ZW50ID0gaW5wdXRDb250ZW50XG4gICAgLmZpbHRlcihwYXJ0ID0+IHBhcnQudHlwZSAhPT0gJ3NvdXJjZScpXG4gICAgLmZpbHRlcihcbiAgICAgIHBhcnQgPT5cbiAgICAgICAgKHBhcnQudHlwZSAhPT0gJ3Rvb2wtcmVzdWx0JyB8fCBwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQpICYmXG4gICAgICAgIChwYXJ0LnR5cGUgIT09ICd0b29sLWVycm9yJyB8fCBwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQpLFxuICAgIClcbiAgICAuZmlsdGVyKHBhcnQgPT4gcGFydC50eXBlICE9PSAndGV4dCcgfHwgcGFydC50ZXh0Lmxlbmd0aCA+IDApXG4gICAgLm1hcChwYXJ0ID0+IHtcbiAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3RleHQnOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICB0ZXh0OiBwYXJ0LnRleHQsXG4gICAgICAgICAgICBwcm92aWRlck9wdGlvbnM6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICB9O1xuICAgICAgICBjYXNlICdyZWFzb25pbmcnOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAncmVhc29uaW5nJyxcbiAgICAgICAgICAgIHRleHQ6IHBhcnQudGV4dCxcbiAgICAgICAgICAgIHByb3ZpZGVyT3B0aW9uczogcGFydC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgJ2ZpbGUnOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnZmlsZScsXG4gICAgICAgICAgICBkYXRhOiBwYXJ0LmZpbGUuYmFzZTY0LFxuICAgICAgICAgICAgbWVkaWFUeXBlOiBwYXJ0LmZpbGUubWVkaWFUeXBlLFxuICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAndG9vbC1jYWxsJzpcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ3Rvb2wtY2FsbCcsXG4gICAgICAgICAgICB0b29sQ2FsbElkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICB0b29sTmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgIGlucHV0OiBwYXJ0LmlucHV0LFxuICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogcGFydC5wcm92aWRlckV4ZWN1dGVkLFxuICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAndG9vbC1yZXN1bHQnOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAndG9vbC1yZXN1bHQnLFxuICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICBvdXRwdXQ6IGNyZWF0ZVRvb2xNb2RlbE91dHB1dCh7XG4gICAgICAgICAgICAgIHRvb2w6IHRvb2xzPy5bcGFydC50b29sTmFtZV0sXG4gICAgICAgICAgICAgIG91dHB1dDogcGFydC5vdXRwdXQsXG4gICAgICAgICAgICAgIGVycm9yTW9kZTogJ25vbmUnLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBwcm92aWRlckV4ZWN1dGVkOiB0cnVlLFxuICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAndG9vbC1lcnJvcic6XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICd0b29sLXJlc3VsdCcsXG4gICAgICAgICAgICB0b29sQ2FsbElkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICB0b29sTmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgIG91dHB1dDogY3JlYXRlVG9vbE1vZGVsT3V0cHV0KHtcbiAgICAgICAgICAgICAgdG9vbDogdG9vbHM/LltwYXJ0LnRvb2xOYW1lXSxcbiAgICAgICAgICAgICAgb3V0cHV0OiBwYXJ0LmVycm9yLFxuICAgICAgICAgICAgICBlcnJvck1vZGU6ICdqc29uJyxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcblxuICBpZiAoY29udGVudC5sZW5ndGggPiAwKSB7XG4gICAgcmVzcG9uc2VNZXNzYWdlcy5wdXNoKHtcbiAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgY29udGVudCxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHRvb2xSZXN1bHRDb250ZW50OiBUb29sQ29udGVudCA9IGlucHV0Q29udGVudFxuICAgIC5maWx0ZXIocGFydCA9PiBwYXJ0LnR5cGUgPT09ICd0b29sLXJlc3VsdCcgfHwgcGFydC50eXBlID09PSAndG9vbC1lcnJvcicpXG4gICAgLmZpbHRlcihwYXJ0ID0+ICFwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQpXG4gICAgLm1hcCh0b29sUmVzdWx0ID0+ICh7XG4gICAgICB0eXBlOiAndG9vbC1yZXN1bHQnLFxuICAgICAgdG9vbENhbGxJZDogdG9vbFJlc3VsdC50b29sQ2FsbElkLFxuICAgICAgdG9vbE5hbWU6IHRvb2xSZXN1bHQudG9vbE5hbWUsXG4gICAgICBvdXRwdXQ6IGNyZWF0ZVRvb2xNb2RlbE91dHB1dCh7XG4gICAgICAgIHRvb2w6IHRvb2xzPy5bdG9vbFJlc3VsdC50b29sTmFtZV0sXG4gICAgICAgIG91dHB1dDpcbiAgICAgICAgICB0b29sUmVzdWx0LnR5cGUgPT09ICd0b29sLXJlc3VsdCdcbiAgICAgICAgICAgID8gdG9vbFJlc3VsdC5vdXRwdXRcbiAgICAgICAgICAgIDogdG9vbFJlc3VsdC5lcnJvcixcbiAgICAgICAgZXJyb3JNb2RlOiB0b29sUmVzdWx0LnR5cGUgPT09ICd0b29sLWVycm9yJyA/ICd0ZXh0JyA6ICdub25lJyxcbiAgICAgIH0pLFxuICAgIH0pKTtcblxuICBpZiAodG9vbFJlc3VsdENvbnRlbnQubGVuZ3RoID4gMCkge1xuICAgIHJlc3BvbnNlTWVzc2FnZXMucHVzaCh7XG4gICAgICByb2xlOiAndG9vbCcsXG4gICAgICBjb250ZW50OiB0b29sUmVzdWx0Q29udGVudCxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZU1lc3NhZ2VzO1xufVxuIiwgImltcG9ydCB7XG4gIGdldEVycm9yTWVzc2FnZSxcbiAgTGFuZ3VhZ2VNb2RlbFYyLFxuICBMYW5ndWFnZU1vZGVsVjJDYWxsV2FybmluZyxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBjcmVhdGVJZEdlbmVyYXRvcixcbiAgSWRHZW5lcmF0b3IsXG4gIGlzQWJvcnRFcnJvcixcbiAgUHJvdmlkZXJPcHRpb25zLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IFNwYW4gfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9hcGknO1xuaW1wb3J0IHsgU2VydmVyUmVzcG9uc2UgfSBmcm9tICdub2RlOmh0dHAnO1xuaW1wb3J0IHsgTm9PdXRwdXRHZW5lcmF0ZWRFcnJvciB9IGZyb20gJy4uL2Vycm9yJztcbmltcG9ydCB7IE5vT3V0cHV0U3BlY2lmaWVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vdXRwdXQtc3BlY2lmaWVkLWVycm9yJztcbmltcG9ydCB7IHJlc29sdmVMYW5ndWFnZU1vZGVsIH0gZnJvbSAnLi4vbW9kZWwvcmVzb2x2ZS1tb2RlbCc7XG5pbXBvcnQgeyBDYWxsU2V0dGluZ3MgfSBmcm9tICcuLi9wcm9tcHQvY2FsbC1zZXR0aW5ncyc7XG5pbXBvcnQgeyBjb252ZXJ0VG9MYW5ndWFnZU1vZGVsUHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0L2NvbnZlcnQtdG8tbGFuZ3VhZ2UtbW9kZWwtcHJvbXB0JztcbmltcG9ydCB7IHByZXBhcmVDYWxsU2V0dGluZ3MgfSBmcm9tICcuLi9wcm9tcHQvcHJlcGFyZS1jYWxsLXNldHRpbmdzJztcbmltcG9ydCB7IHByZXBhcmVUb29sc0FuZFRvb2xDaG9pY2UgfSBmcm9tICcuLi9wcm9tcHQvcHJlcGFyZS10b29scy1hbmQtdG9vbC1jaG9pY2UnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0L3Byb21wdCc7XG5pbXBvcnQgeyBzdGFuZGFyZGl6ZVByb21wdCB9IGZyb20gJy4uL3Byb21wdC9zdGFuZGFyZGl6ZS1wcm9tcHQnO1xuaW1wb3J0IHsgd3JhcEdhdGV3YXlFcnJvciB9IGZyb20gJy4uL3Byb21wdC93cmFwLWdhdGV3YXktZXJyb3InO1xuaW1wb3J0IHsgYXNzZW1ibGVPcGVyYXRpb25OYW1lIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2Fzc2VtYmxlLW9wZXJhdGlvbi1uYW1lJztcbmltcG9ydCB7IGdldEJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2dldC1iYXNlLXRlbGVtZXRyeS1hdHRyaWJ1dGVzJztcbmltcG9ydCB7IGdldFRyYWNlciB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtdHJhY2VyJztcbmltcG9ydCB7IHJlY29yZFNwYW4gfSBmcm9tICcuLi90ZWxlbWV0cnkvcmVjb3JkLXNwYW4nO1xuaW1wb3J0IHsgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9zZWxlY3QtdGVsZW1ldHJ5LWF0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5IH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3N0cmluZ2lmeS1mb3ItdGVsZW1ldHJ5JztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3RlbGVtZXRyeS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBjcmVhdGVUZXh0U3RyZWFtUmVzcG9uc2UgfSBmcm9tICcuLi90ZXh0LXN0cmVhbS9jcmVhdGUtdGV4dC1zdHJlYW0tcmVzcG9uc2UnO1xuaW1wb3J0IHsgcGlwZVRleHRTdHJlYW1Ub1Jlc3BvbnNlIH0gZnJvbSAnLi4vdGV4dC1zdHJlYW0vcGlwZS10ZXh0LXN0cmVhbS10by1yZXNwb25zZSc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVxdWVzdE1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHtcbiAgQ2FsbFdhcm5pbmcsXG4gIEZpbmlzaFJlYXNvbixcbiAgTGFuZ3VhZ2VNb2RlbCxcbiAgVG9vbENob2ljZSxcbn0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwnO1xuaW1wb3J0IHsgUHJvdmlkZXJNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL3Byb3ZpZGVyLW1ldGFkYXRhJztcbmltcG9ydCB7IGFkZExhbmd1YWdlTW9kZWxVc2FnZSwgTGFuZ3VhZ2VNb2RlbFVzYWdlIH0gZnJvbSAnLi4vdHlwZXMvdXNhZ2UnO1xuaW1wb3J0IHsgVUlNZXNzYWdlIH0gZnJvbSAnLi4vdWknO1xuaW1wb3J0IHsgY3JlYXRlVUlNZXNzYWdlU3RyZWFtUmVzcG9uc2UgfSBmcm9tICcuLi91aS1tZXNzYWdlLXN0cmVhbS9jcmVhdGUtdWktbWVzc2FnZS1zdHJlYW0tcmVzcG9uc2UnO1xuaW1wb3J0IHsgZ2V0UmVzcG9uc2VVSU1lc3NhZ2VJZCB9IGZyb20gJy4uL3VpLW1lc3NhZ2Utc3RyZWFtL2dldC1yZXNwb25zZS11aS1tZXNzYWdlLWlkJztcbmltcG9ydCB7IGhhbmRsZVVJTWVzc2FnZVN0cmVhbUZpbmlzaCB9IGZyb20gJy4uL3VpLW1lc3NhZ2Utc3RyZWFtL2hhbmRsZS11aS1tZXNzYWdlLXN0cmVhbS1maW5pc2gnO1xuaW1wb3J0IHsgcGlwZVVJTWVzc2FnZVN0cmVhbVRvUmVzcG9uc2UgfSBmcm9tICcuLi91aS1tZXNzYWdlLXN0cmVhbS9waXBlLXVpLW1lc3NhZ2Utc3RyZWFtLXRvLXJlc3BvbnNlJztcbmltcG9ydCB7XG4gIEluZmVyVUlNZXNzYWdlQ2h1bmssXG4gIFVJTWVzc2FnZUNodW5rLFxufSBmcm9tICcuLi91aS1tZXNzYWdlLXN0cmVhbS91aS1tZXNzYWdlLWNodW5rcyc7XG5pbXBvcnQgeyBVSU1lc3NhZ2VTdHJlYW1SZXNwb25zZUluaXQgfSBmcm9tICcuLi91aS1tZXNzYWdlLXN0cmVhbS91aS1tZXNzYWdlLXN0cmVhbS1yZXNwb25zZS1pbml0JztcbmltcG9ydCB7IEluZmVyVUlNZXNzYWdlRGF0YSwgSW5mZXJVSU1lc3NhZ2VNZXRhZGF0YSB9IGZyb20gJy4uL3VpL3VpLW1lc3NhZ2VzJztcbmltcG9ydCB7IGFzQXJyYXkgfSBmcm9tICcuLi91dGlsL2FzLWFycmF5JztcbmltcG9ydCB7XG4gIEFzeW5jSXRlcmFibGVTdHJlYW0sXG4gIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0sXG59IGZyb20gJy4uL3V0aWwvYXN5bmMtaXRlcmFibGUtc3RyZWFtJztcbmltcG9ydCB7IGNvbnN1bWVTdHJlYW0gfSBmcm9tICcuLi91dGlsL2NvbnN1bWUtc3RyZWFtJztcbmltcG9ydCB7IGNyZWF0ZVN0aXRjaGFibGVTdHJlYW0gfSBmcm9tICcuLi91dGlsL2NyZWF0ZS1zdGl0Y2hhYmxlLXN0cmVhbSc7XG5pbXBvcnQgeyBEZWxheWVkUHJvbWlzZSB9IGZyb20gJy4uL3V0aWwvZGVsYXllZC1wcm9taXNlJztcbmltcG9ydCB7IGZpbHRlclN0cmVhbUVycm9ycyB9IGZyb20gJy4uL3V0aWwvZmlsdGVyLXN0cmVhbS1lcnJvcnMnO1xuaW1wb3J0IHsgbm93IGFzIG9yaWdpbmFsTm93IH0gZnJvbSAnLi4vdXRpbC9ub3cnO1xuaW1wb3J0IHsgcHJlcGFyZVJldHJpZXMgfSBmcm9tICcuLi91dGlsL3ByZXBhcmUtcmV0cmllcyc7XG5pbXBvcnQgeyBDb250ZW50UGFydCB9IGZyb20gJy4vY29udGVudC1wYXJ0JztcbmltcG9ydCB7IE91dHB1dCB9IGZyb20gJy4vb3V0cHV0JztcbmltcG9ydCB7IFByZXBhcmVTdGVwRnVuY3Rpb24gfSBmcm9tICcuL3ByZXBhcmUtc3RlcCc7XG5pbXBvcnQgeyBSZXNwb25zZU1lc3NhZ2UgfSBmcm9tICcuL3Jlc3BvbnNlLW1lc3NhZ2UnO1xuaW1wb3J0IHtcbiAgcnVuVG9vbHNUcmFuc2Zvcm1hdGlvbixcbiAgU2luZ2xlUmVxdWVzdFRleHRTdHJlYW1QYXJ0LFxufSBmcm9tICcuL3J1bi10b29scy10cmFuc2Zvcm1hdGlvbic7XG5pbXBvcnQgeyBEZWZhdWx0U3RlcFJlc3VsdCwgU3RlcFJlc3VsdCB9IGZyb20gJy4vc3RlcC1yZXN1bHQnO1xuaW1wb3J0IHtcbiAgaXNTdG9wQ29uZGl0aW9uTWV0LFxuICBzdGVwQ291bnRJcyxcbiAgU3RvcENvbmRpdGlvbixcbn0gZnJvbSAnLi9zdG9wLWNvbmRpdGlvbic7XG5pbXBvcnQge1xuICBDb25zdW1lU3RyZWFtT3B0aW9ucyxcbiAgU3RyZWFtVGV4dFJlc3VsdCxcbiAgVGV4dFN0cmVhbVBhcnQsXG4gIFVJTWVzc2FnZVN0cmVhbU9wdGlvbnMsXG59IGZyb20gJy4vc3RyZWFtLXRleHQtcmVzdWx0JztcbmltcG9ydCB7IHRvUmVzcG9uc2VNZXNzYWdlcyB9IGZyb20gJy4vdG8tcmVzcG9uc2UtbWVzc2FnZXMnO1xuaW1wb3J0IHsgVHlwZWRUb29sQ2FsbCB9IGZyb20gJy4vdG9vbC1jYWxsJztcbmltcG9ydCB7IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb24gfSBmcm9tICcuL3Rvb2wtY2FsbC1yZXBhaXItZnVuY3Rpb24nO1xuaW1wb3J0IHsgVG9vbE91dHB1dCB9IGZyb20gJy4vdG9vbC1vdXRwdXQnO1xuaW1wb3J0IHsgVG9vbFNldCB9IGZyb20gJy4vdG9vbC1zZXQnO1xuXG5jb25zdCBvcmlnaW5hbEdlbmVyYXRlSWQgPSBjcmVhdGVJZEdlbmVyYXRvcih7XG4gIHByZWZpeDogJ2FpdHh0JyxcbiAgc2l6ZTogMjQsXG59KTtcblxuLyoqXG5BIHRyYW5zZm9ybWF0aW9uIHRoYXQgaXMgYXBwbGllZCB0byB0aGUgc3RyZWFtLlxuXG5AcGFyYW0gc3RvcFN0cmVhbSAtIEEgZnVuY3Rpb24gdGhhdCBzdG9wcyB0aGUgc291cmNlIHN0cmVhbS5cbkBwYXJhbSB0b29scyAtIFRoZSB0b29scyB0aGF0IGFyZSBhY2Nlc3NpYmxlIHRvIGFuZCBjYW4gYmUgY2FsbGVkIGJ5IHRoZSBtb2RlbC4gVGhlIG1vZGVsIG5lZWRzIHRvIHN1cHBvcnQgY2FsbGluZyB0b29scy5cbiAqL1xuZXhwb3J0IHR5cGUgU3RyZWFtVGV4dFRyYW5zZm9ybTxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0gKG9wdGlvbnM6IHtcbiAgdG9vbHM6IFRPT0xTOyAvLyBmb3IgdHlwZSBpbmZlcmVuY2VcbiAgc3RvcFN0cmVhbTogKCkgPT4gdm9pZDtcbn0pID0+IFRyYW5zZm9ybVN0cmVhbTxUZXh0U3RyZWFtUGFydDxUT09MUz4sIFRleHRTdHJlYW1QYXJ0PFRPT0xTPj47XG5cbi8qKlxuQ2FsbGJhY2sgdGhhdCBpcyBzZXQgdXNpbmcgdGhlIGBvbkVycm9yYCBvcHRpb24uXG5cbkBwYXJhbSBldmVudCAtIFRoZSBldmVudCB0aGF0IGlzIHBhc3NlZCB0byB0aGUgY2FsbGJhY2suXG4gKi9cbmV4cG9ydCB0eXBlIFN0cmVhbVRleHRPbkVycm9yQ2FsbGJhY2sgPSAoZXZlbnQ6IHtcbiAgZXJyb3I6IHVua25vd247XG59KSA9PiBQcm9taXNlTGlrZTx2b2lkPiB8IHZvaWQ7XG5cbi8qKlxuQ2FsbGJhY2sgdGhhdCBpcyBzZXQgdXNpbmcgdGhlIGBvblN0ZXBGaW5pc2hgIG9wdGlvbi5cblxuQHBhcmFtIHN0ZXBSZXN1bHQgLSBUaGUgcmVzdWx0IG9mIHRoZSBzdGVwLlxuICovXG5leHBvcnQgdHlwZSBTdHJlYW1UZXh0T25TdGVwRmluaXNoQ2FsbGJhY2s8VE9PTFMgZXh0ZW5kcyBUb29sU2V0PiA9IChcbiAgc3RlcFJlc3VsdDogU3RlcFJlc3VsdDxUT09MUz4sXG4pID0+IFByb21pc2VMaWtlPHZvaWQ+IHwgdm9pZDtcblxuLyoqXG5DYWxsYmFjayB0aGF0IGlzIHNldCB1c2luZyB0aGUgYG9uQ2h1bmtgIG9wdGlvbi5cblxuQHBhcmFtIGV2ZW50IC0gVGhlIGV2ZW50IHRoYXQgaXMgcGFzc2VkIHRvIHRoZSBjYWxsYmFjay5cbiAqL1xuZXhwb3J0IHR5cGUgU3RyZWFtVGV4dE9uQ2h1bmtDYWxsYmFjazxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0gKGV2ZW50OiB7XG4gIGNodW5rOiBFeHRyYWN0PFxuICAgIFRleHRTdHJlYW1QYXJ0PFRPT0xTPixcbiAgICB7XG4gICAgICB0eXBlOlxuICAgICAgICB8ICd0ZXh0LWRlbHRhJ1xuICAgICAgICB8ICdyZWFzb25pbmctZGVsdGEnXG4gICAgICAgIHwgJ3NvdXJjZSdcbiAgICAgICAgfCAndG9vbC1jYWxsJ1xuICAgICAgICB8ICd0b29sLWlucHV0LXN0YXJ0J1xuICAgICAgICB8ICd0b29sLWlucHV0LWRlbHRhJ1xuICAgICAgICB8ICd0b29sLXJlc3VsdCdcbiAgICAgICAgfCAncmF3JztcbiAgICB9XG4gID47XG59KSA9PiBQcm9taXNlTGlrZTx2b2lkPiB8IHZvaWQ7XG5cbi8qKlxuQ2FsbGJhY2sgdGhhdCBpcyBzZXQgdXNpbmcgdGhlIGBvbkZpbmlzaGAgb3B0aW9uLlxuXG5AcGFyYW0gZXZlbnQgLSBUaGUgZXZlbnQgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGNhbGxiYWNrLlxuICovXG5leHBvcnQgdHlwZSBTdHJlYW1UZXh0T25GaW5pc2hDYWxsYmFjazxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0gKFxuICBldmVudDogU3RlcFJlc3VsdDxUT09MUz4gJiB7XG4gICAgLyoqXG5EZXRhaWxzIGZvciBhbGwgc3RlcHMuXG4gICAqL1xuICAgIHJlYWRvbmx5IHN0ZXBzOiBTdGVwUmVzdWx0PFRPT0xTPltdO1xuXG4gICAgLyoqXG5Ub3RhbCB1c2FnZSBmb3IgYWxsIHN0ZXBzLiBUaGlzIGlzIHRoZSBzdW0gb2YgdGhlIHVzYWdlIG9mIGFsbCBzdGVwcy5cbiAgICAgKi9cbiAgICByZWFkb25seSB0b3RhbFVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG4gIH0sXG4pID0+IFByb21pc2VMaWtlPHZvaWQ+IHwgdm9pZDtcblxuLyoqXG5DYWxsYmFjayB0aGF0IGlzIHNldCB1c2luZyB0aGUgYG9uQWJvcnRgIG9wdGlvbi5cblxuQHBhcmFtIGV2ZW50IC0gVGhlIGV2ZW50IHRoYXQgaXMgcGFzc2VkIHRvIHRoZSBjYWxsYmFjay5cbiAqL1xuZXhwb3J0IHR5cGUgU3RyZWFtVGV4dE9uQWJvcnRDYWxsYmFjazxUT09MUyBleHRlbmRzIFRvb2xTZXQ+ID0gKGV2ZW50OiB7XG4gIC8qKlxuRGV0YWlscyBmb3IgYWxsIHByZXZpb3VzbHkgZmluaXNoZWQgc3RlcHMuXG4gICAqL1xuICByZWFkb25seSBzdGVwczogU3RlcFJlc3VsdDxUT09MUz5bXTtcbn0pID0+IFByb21pc2VMaWtlPHZvaWQ+IHwgdm9pZDtcblxuLyoqXG5HZW5lcmF0ZSBhIHRleHQgYW5kIGNhbGwgdG9vbHMgZm9yIGEgZ2l2ZW4gcHJvbXB0IHVzaW5nIGEgbGFuZ3VhZ2UgbW9kZWwuXG5cblRoaXMgZnVuY3Rpb24gc3RyZWFtcyB0aGUgb3V0cHV0LiBJZiB5b3UgZG8gbm90IHdhbnQgdG8gc3RyZWFtIHRoZSBvdXRwdXQsIHVzZSBgZ2VuZXJhdGVUZXh0YCBpbnN0ZWFkLlxuXG5AcGFyYW0gbW9kZWwgLSBUaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlLlxuQHBhcmFtIHRvb2xzIC0gVG9vbHMgdGhhdCBhcmUgYWNjZXNzaWJsZSB0byBhbmQgY2FuIGJlIGNhbGxlZCBieSB0aGUgbW9kZWwuIFRoZSBtb2RlbCBuZWVkcyB0byBzdXBwb3J0IGNhbGxpbmcgdG9vbHMuXG5cbkBwYXJhbSBzeXN0ZW0gLSBBIHN5c3RlbSBtZXNzYWdlIHRoYXQgd2lsbCBiZSBwYXJ0IG9mIHRoZSBwcm9tcHQuXG5AcGFyYW0gcHJvbXB0IC0gQSBzaW1wbGUgdGV4dCBwcm9tcHQuIFlvdSBjYW4gZWl0aGVyIHVzZSBgcHJvbXB0YCBvciBgbWVzc2FnZXNgIGJ1dCBub3QgYm90aC5cbkBwYXJhbSBtZXNzYWdlcyAtIEEgbGlzdCBvZiBtZXNzYWdlcy4gWW91IGNhbiBlaXRoZXIgdXNlIGBwcm9tcHRgIG9yIGBtZXNzYWdlc2AgYnV0IG5vdCBib3RoLlxuXG5AcGFyYW0gbWF4T3V0cHV0VG9rZW5zIC0gTWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIHRvIGdlbmVyYXRlLlxuQHBhcmFtIHRlbXBlcmF0dXJlIC0gVGVtcGVyYXR1cmUgc2V0dGluZy5cblRoZSB2YWx1ZSBpcyBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXIuIFRoZSByYW5nZSBkZXBlbmRzIG9uIHRoZSBwcm92aWRlciBhbmQgbW9kZWwuXG5JdCBpcyByZWNvbW1lbmRlZCB0byBzZXQgZWl0aGVyIGB0ZW1wZXJhdHVyZWAgb3IgYHRvcFBgLCBidXQgbm90IGJvdGguXG5AcGFyYW0gdG9wUCAtIE51Y2xldXMgc2FtcGxpbmcuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuSXQgaXMgcmVjb21tZW5kZWQgdG8gc2V0IGVpdGhlciBgdGVtcGVyYXR1cmVgIG9yIGB0b3BQYCwgYnV0IG5vdCBib3RoLlxuQHBhcmFtIHRvcEsgLSBPbmx5IHNhbXBsZSBmcm9tIHRoZSB0b3AgSyBvcHRpb25zIGZvciBlYWNoIHN1YnNlcXVlbnQgdG9rZW4uXG5Vc2VkIHRvIHJlbW92ZSBcImxvbmcgdGFpbFwiIGxvdyBwcm9iYWJpbGl0eSByZXNwb25zZXMuXG5SZWNvbW1lbmRlZCBmb3IgYWR2YW5jZWQgdXNlIGNhc2VzIG9ubHkuIFlvdSB1c3VhbGx5IG9ubHkgbmVlZCB0byB1c2UgdGVtcGVyYXR1cmUuXG5AcGFyYW0gcHJlc2VuY2VQZW5hbHR5IC0gUHJlc2VuY2UgcGVuYWx0eSBzZXR0aW5nLlxuSXQgYWZmZWN0cyB0aGUgbGlrZWxpaG9vZCBvZiB0aGUgbW9kZWwgdG8gcmVwZWF0IGluZm9ybWF0aW9uIHRoYXQgaXMgYWxyZWFkeSBpbiB0aGUgcHJvbXB0LlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkBwYXJhbSBmcmVxdWVuY3lQZW5hbHR5IC0gRnJlcXVlbmN5IHBlbmFsdHkgc2V0dGluZy5cbkl0IGFmZmVjdHMgdGhlIGxpa2VsaWhvb2Qgb2YgdGhlIG1vZGVsIHRvIHJlcGVhdGVkbHkgdXNlIHRoZSBzYW1lIHdvcmRzIG9yIHBocmFzZXMuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuQHBhcmFtIHN0b3BTZXF1ZW5jZXMgLSBTdG9wIHNlcXVlbmNlcy5cbklmIHNldCwgdGhlIG1vZGVsIHdpbGwgc3RvcCBnZW5lcmF0aW5nIHRleHQgd2hlbiBvbmUgb2YgdGhlIHN0b3Agc2VxdWVuY2VzIGlzIGdlbmVyYXRlZC5cbkBwYXJhbSBzZWVkIC0gVGhlIHNlZWQgKGludGVnZXIpIHRvIHVzZSBmb3IgcmFuZG9tIHNhbXBsaW5nLlxuSWYgc2V0IGFuZCBzdXBwb3J0ZWQgYnkgdGhlIG1vZGVsLCBjYWxscyB3aWxsIGdlbmVyYXRlIGRldGVybWluaXN0aWMgcmVzdWx0cy5cblxuQHBhcmFtIG1heFJldHJpZXMgLSBNYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJldHJpZXMuIERlZmF1bHQ6IDIuXG5AcGFyYW0gYWJvcnRTaWduYWwgLSBBbiBvcHRpb25hbCBhYm9ydCBzaWduYWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIGNhbGwuXG5AcGFyYW0gaGVhZGVycyAtIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIGJlIHNlbnQgd2l0aCB0aGUgcmVxdWVzdC4gT25seSBhcHBsaWNhYmxlIGZvciBIVFRQLWJhc2VkIHByb3ZpZGVycy5cblxuQHBhcmFtIG1heFN0ZXBzIC0gTWF4aW11bSBudW1iZXIgb2Ygc2VxdWVudGlhbCBMTE0gY2FsbHMgKHN0ZXBzKSwgZS5nLiB3aGVuIHlvdSB1c2UgdG9vbCBjYWxscy5cblxuQHBhcmFtIG9uQ2h1bmsgLSBDYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBmb3IgZWFjaCBjaHVuayBvZiB0aGUgc3RyZWFtLiBUaGUgc3RyZWFtIHByb2Nlc3Npbmcgd2lsbCBwYXVzZSB1bnRpbCB0aGUgY2FsbGJhY2sgcHJvbWlzZSBpcyByZXNvbHZlZC5cbkBwYXJhbSBvbkVycm9yIC0gQ2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIHN0cmVhbWluZy4gWW91IGNhbiB1c2UgaXQgdG8gbG9nIGVycm9ycy5cbkBwYXJhbSBvblN0ZXBGaW5pc2ggLSBDYWxsYmFjayB0aGF0IGlzIGNhbGxlZCB3aGVuIGVhY2ggc3RlcCAoTExNIGNhbGwpIGlzIGZpbmlzaGVkLCBpbmNsdWRpbmcgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuQHBhcmFtIG9uRmluaXNoIC0gQ2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgTExNIHJlc3BvbnNlIGFuZCBhbGwgcmVxdWVzdCB0b29sIGV4ZWN1dGlvbnNcbihmb3IgdG9vbHMgdGhhdCBoYXZlIGFuIGBleGVjdXRlYCBmdW5jdGlvbikgYXJlIGZpbmlzaGVkLlxuXG5AcmV0dXJuXG5BIHJlc3VsdCBvYmplY3QgZm9yIGFjY2Vzc2luZyBkaWZmZXJlbnQgc3RyZWFtIHR5cGVzIGFuZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyZWFtVGV4dDxcbiAgVE9PTFMgZXh0ZW5kcyBUb29sU2V0LFxuICBPVVRQVVQgPSBuZXZlcixcbiAgUEFSVElBTF9PVVRQVVQgPSBuZXZlcixcbj4oe1xuICBtb2RlbCxcbiAgdG9vbHMsXG4gIHRvb2xDaG9pY2UsXG4gIHN5c3RlbSxcbiAgcHJvbXB0LFxuICBtZXNzYWdlcyxcbiAgbWF4UmV0cmllcyxcbiAgYWJvcnRTaWduYWwsXG4gIGhlYWRlcnMsXG4gIHN0b3BXaGVuID0gc3RlcENvdW50SXMoMSksXG4gIGV4cGVyaW1lbnRhbF9vdXRwdXQ6IG91dHB1dCxcbiAgZXhwZXJpbWVudGFsX3RlbGVtZXRyeTogdGVsZW1ldHJ5LFxuICBwcmVwYXJlU3RlcCxcbiAgcHJvdmlkZXJPcHRpb25zLFxuICBleHBlcmltZW50YWxfYWN0aXZlVG9vbHMsXG4gIGFjdGl2ZVRvb2xzID0gZXhwZXJpbWVudGFsX2FjdGl2ZVRvb2xzLFxuICBleHBlcmltZW50YWxfcmVwYWlyVG9vbENhbGw6IHJlcGFpclRvb2xDYWxsLFxuICBleHBlcmltZW50YWxfdHJhbnNmb3JtOiB0cmFuc2Zvcm0sXG4gIGluY2x1ZGVSYXdDaHVua3MgPSBmYWxzZSxcbiAgb25DaHVuayxcbiAgb25FcnJvciA9ICh7IGVycm9yIH0pID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgfSxcbiAgb25GaW5pc2gsXG4gIG9uQWJvcnQsXG4gIG9uU3RlcEZpbmlzaCxcbiAgZXhwZXJpbWVudGFsX2NvbnRleHQsXG4gIF9pbnRlcm5hbDoge1xuICAgIG5vdyA9IG9yaWdpbmFsTm93LFxuICAgIGdlbmVyYXRlSWQgPSBvcmlnaW5hbEdlbmVyYXRlSWQsXG4gICAgY3VycmVudERhdGUgPSAoKSA9PiBuZXcgRGF0ZSgpLFxuICB9ID0ge30sXG4gIC4uLnNldHRpbmdzXG59OiBDYWxsU2V0dGluZ3MgJlxuICBQcm9tcHQgJiB7XG4gICAgLyoqXG5UaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICAgIG1vZGVsOiBMYW5ndWFnZU1vZGVsO1xuXG4gICAgLyoqXG5UaGUgdG9vbHMgdGhhdCB0aGUgbW9kZWwgY2FuIGNhbGwuIFRoZSBtb2RlbCBuZWVkcyB0byBzdXBwb3J0IGNhbGxpbmcgdG9vbHMuXG4gICAgKi9cbiAgICB0b29scz86IFRPT0xTO1xuXG4gICAgLyoqXG5UaGUgdG9vbCBjaG9pY2Ugc3RyYXRlZ3kuIERlZmF1bHQ6ICdhdXRvJy5cbiAgICAgKi9cbiAgICB0b29sQ2hvaWNlPzogVG9vbENob2ljZTxUT09MUz47XG5cbiAgICAvKipcbkNvbmRpdGlvbiBmb3Igc3RvcHBpbmcgdGhlIGdlbmVyYXRpb24gd2hlbiB0aGVyZSBhcmUgdG9vbCByZXN1bHRzIGluIHRoZSBsYXN0IHN0ZXAuXG5XaGVuIHRoZSBjb25kaXRpb24gaXMgYW4gYXJyYXksIGFueSBvZiB0aGUgY29uZGl0aW9ucyBjYW4gYmUgbWV0IHRvIHN0b3AgdGhlIGdlbmVyYXRpb24uXG5cbkBkZWZhdWx0IHN0ZXBDb3VudElzKDEpXG4gICAgICovXG4gICAgc3RvcFdoZW4/OlxuICAgICAgfCBTdG9wQ29uZGl0aW9uPE5vSW5mZXI8VE9PTFM+PlxuICAgICAgfCBBcnJheTxTdG9wQ29uZGl0aW9uPE5vSW5mZXI8VE9PTFM+Pj47XG5cbiAgICAvKipcbk9wdGlvbmFsIHRlbGVtZXRyeSBjb25maWd1cmF0aW9uIChleHBlcmltZW50YWwpLlxuICAgICAqL1xuICAgIGV4cGVyaW1lbnRhbF90ZWxlbWV0cnk/OiBUZWxlbWV0cnlTZXR0aW5ncztcblxuICAgIC8qKlxuQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBvcHRpb25zLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxudG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5mdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gKi9cbiAgICBwcm92aWRlck9wdGlvbnM/OiBQcm92aWRlck9wdGlvbnM7XG5cbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCBVc2UgYGFjdGl2ZVRvb2xzYCBpbnN0ZWFkLlxuICAgICAqL1xuICAgIGV4cGVyaW1lbnRhbF9hY3RpdmVUb29scz86IEFycmF5PGtleW9mIE5vSW5mZXI8VE9PTFM+PjtcblxuICAgIC8qKlxuICAgTGltaXRzIHRoZSB0b29scyB0aGF0IGFyZSBhdmFpbGFibGUgZm9yIHRoZSBtb2RlbCB0byBjYWxsIHdpdGhvdXRcbiAgIGNoYW5naW5nIHRoZSB0b29sIGNhbGwgYW5kIHJlc3VsdCB0eXBlcyBpbiB0aGUgcmVzdWx0LlxuICAgICAgICAqL1xuICAgIGFjdGl2ZVRvb2xzPzogQXJyYXk8a2V5b2YgTm9JbmZlcjxUT09MUz4+O1xuXG4gICAgLyoqXG5PcHRpb25hbCBzcGVjaWZpY2F0aW9uIGZvciBwYXJzaW5nIHN0cnVjdHVyZWQgb3V0cHV0cyBmcm9tIHRoZSBMTE0gcmVzcG9uc2UuXG4gICAgICovXG4gICAgZXhwZXJpbWVudGFsX291dHB1dD86IE91dHB1dDxPVVRQVVQsIFBBUlRJQUxfT1VUUFVUPjtcblxuICAgIC8qKlxuT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB5b3UgY2FuIHVzZSB0byBwcm92aWRlIGRpZmZlcmVudCBzZXR0aW5ncyBmb3IgYSBzdGVwLlxuXG5AcGFyYW0gb3B0aW9ucyAtIFRoZSBvcHRpb25zIGZvciB0aGUgc3RlcC5cbkBwYXJhbSBvcHRpb25zLnN0ZXBzIC0gVGhlIHN0ZXBzIHRoYXQgaGF2ZSBiZWVuIGV4ZWN1dGVkIHNvIGZhci5cbkBwYXJhbSBvcHRpb25zLnN0ZXBOdW1iZXIgLSBUaGUgbnVtYmVyIG9mIHRoZSBzdGVwIHRoYXQgaXMgYmVpbmcgZXhlY3V0ZWQuXG5AcGFyYW0gb3B0aW9ucy5tb2RlbCAtIFRoZSBtb2RlbCB0aGF0IGlzIGJlaW5nIHVzZWQuXG5cbkByZXR1cm5zIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBzZXR0aW5ncyBmb3IgdGhlIHN0ZXAuXG5JZiB5b3UgcmV0dXJuIHVuZGVmaW5lZCAob3IgZm9yIHVuZGVmaW5lZCBzZXR0aW5ncyksIHRoZSBzZXR0aW5ncyBmcm9tIHRoZSBvdXRlciBsZXZlbCB3aWxsIGJlIHVzZWQuXG4gICAgKi9cbiAgICBwcmVwYXJlU3RlcD86IFByZXBhcmVTdGVwRnVuY3Rpb248Tm9JbmZlcjxUT09MUz4+O1xuXG4gICAgLyoqXG5BIGZ1bmN0aW9uIHRoYXQgYXR0ZW1wdHMgdG8gcmVwYWlyIGEgdG9vbCBjYWxsIHRoYXQgZmFpbGVkIHRvIHBhcnNlLlxuICAgICAqL1xuICAgIGV4cGVyaW1lbnRhbF9yZXBhaXJUb29sQ2FsbD86IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb248VE9PTFM+O1xuXG4gICAgLyoqXG5PcHRpb25hbCBzdHJlYW0gdHJhbnNmb3JtYXRpb25zLlxuVGhleSBhcmUgYXBwbGllZCBpbiB0aGUgb3JkZXIgdGhleSBhcmUgcHJvdmlkZWQuXG5UaGUgc3RyZWFtIHRyYW5zZm9ybWF0aW9ucyBtdXN0IG1haW50YWluIHRoZSBzdHJlYW0gc3RydWN0dXJlIGZvciBzdHJlYW1UZXh0IHRvIHdvcmsgY29ycmVjdGx5LlxuICAgICAqL1xuICAgIGV4cGVyaW1lbnRhbF90cmFuc2Zvcm0/OlxuICAgICAgfCBTdHJlYW1UZXh0VHJhbnNmb3JtPFRPT0xTPlxuICAgICAgfCBBcnJheTxTdHJlYW1UZXh0VHJhbnNmb3JtPFRPT0xTPj47XG5cbiAgICAvKipcbldoZXRoZXIgdG8gaW5jbHVkZSByYXcgY2h1bmtzIGZyb20gdGhlIHByb3ZpZGVyIGluIHRoZSBzdHJlYW0uXG5XaGVuIGVuYWJsZWQsIHlvdSB3aWxsIHJlY2VpdmUgcmF3IGNodW5rcyB3aXRoIHR5cGUgJ3JhdycgdGhhdCBjb250YWluIHRoZSB1bnByb2Nlc3NlZCBkYXRhIGZyb20gdGhlIHByb3ZpZGVyLlxuVGhpcyBhbGxvd3MgYWNjZXNzIHRvIGN1dHRpbmctZWRnZSBwcm92aWRlciBmZWF0dXJlcyBub3QgeWV0IHdyYXBwZWQgYnkgdGhlIEFJIFNESy5cbkRlZmF1bHRzIHRvIGZhbHNlLlxuICAgICAqL1xuICAgIGluY2x1ZGVSYXdDaHVua3M/OiBib29sZWFuO1xuXG4gICAgLyoqXG5DYWxsYmFjayB0aGF0IGlzIGNhbGxlZCBmb3IgZWFjaCBjaHVuayBvZiB0aGUgc3RyZWFtLlxuVGhlIHN0cmVhbSBwcm9jZXNzaW5nIHdpbGwgcGF1c2UgdW50aWwgdGhlIGNhbGxiYWNrIHByb21pc2UgaXMgcmVzb2x2ZWQuXG4gICAgICovXG4gICAgb25DaHVuaz86IFN0cmVhbVRleHRPbkNodW5rQ2FsbGJhY2s8VE9PTFM+O1xuXG4gICAgLyoqXG5DYWxsYmFjayB0aGF0IGlzIGludm9rZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIHN0cmVhbWluZy5cbllvdSBjYW4gdXNlIGl0IHRvIGxvZyBlcnJvcnMuXG5UaGUgc3RyZWFtIHByb2Nlc3Npbmcgd2lsbCBwYXVzZSB1bnRpbCB0aGUgY2FsbGJhY2sgcHJvbWlzZSBpcyByZXNvbHZlZC5cbiAgICAgKi9cbiAgICBvbkVycm9yPzogU3RyZWFtVGV4dE9uRXJyb3JDYWxsYmFjaztcblxuICAgIC8qKlxuQ2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGUgTExNIHJlc3BvbnNlIGFuZCBhbGwgcmVxdWVzdCB0b29sIGV4ZWN1dGlvbnNcbihmb3IgdG9vbHMgdGhhdCBoYXZlIGFuIGBleGVjdXRlYCBmdW5jdGlvbikgYXJlIGZpbmlzaGVkLlxuXG5UaGUgdXNhZ2UgaXMgdGhlIGNvbWJpbmVkIHVzYWdlIG9mIGFsbCBzdGVwcy5cbiAgICAgKi9cbiAgICBvbkZpbmlzaD86IFN0cmVhbVRleHRPbkZpbmlzaENhbGxiYWNrPFRPT0xTPjtcblxuICAgIG9uQWJvcnQ/OiBTdHJlYW1UZXh0T25BYm9ydENhbGxiYWNrPFRPT0xTPjtcblxuICAgIC8qKlxuQ2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiBlYWNoIHN0ZXAgKExMTSBjYWxsKSBpcyBmaW5pc2hlZCwgaW5jbHVkaW5nIGludGVybWVkaWF0ZSBzdGVwcy5cbiAgICAqL1xuICAgIG9uU3RlcEZpbmlzaD86IFN0cmVhbVRleHRPblN0ZXBGaW5pc2hDYWxsYmFjazxUT09MUz47XG5cbiAgICAvKipcbiAgICAgKiBDb250ZXh0IHRoYXQgaXMgcGFzc2VkIGludG8gdG9vbCBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBFeHBlcmltZW50YWwgKGNhbiBicmVhayBpbiBwYXRjaCByZWxlYXNlcykuXG4gICAgICpcbiAgICAgKiBAZGVmYXVsdCB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBleHBlcmltZW50YWxfY29udGV4dD86IHVua25vd247XG5cbiAgICAvKipcbkludGVybmFsLiBGb3IgdGVzdCB1c2Ugb25seS4gTWF5IGNoYW5nZSB3aXRob3V0IG5vdGljZS5cbiAgICAgKi9cbiAgICBfaW50ZXJuYWw/OiB7XG4gICAgICBub3c/OiAoKSA9PiBudW1iZXI7XG4gICAgICBnZW5lcmF0ZUlkPzogSWRHZW5lcmF0b3I7XG4gICAgICBjdXJyZW50RGF0ZT86ICgpID0+IERhdGU7XG4gICAgfTtcbiAgfSk6IFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPiB7XG4gIHJldHVybiBuZXcgRGVmYXVsdFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMsIE9VVFBVVCwgUEFSVElBTF9PVVRQVVQ+KHtcbiAgICBtb2RlbDogcmVzb2x2ZUxhbmd1YWdlTW9kZWwobW9kZWwpLFxuICAgIHRlbGVtZXRyeSxcbiAgICBoZWFkZXJzLFxuICAgIHNldHRpbmdzLFxuICAgIG1heFJldHJpZXMsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgc3lzdGVtLFxuICAgIHByb21wdCxcbiAgICBtZXNzYWdlcyxcbiAgICB0b29scyxcbiAgICB0b29sQ2hvaWNlLFxuICAgIHRyYW5zZm9ybXM6IGFzQXJyYXkodHJhbnNmb3JtKSxcbiAgICBhY3RpdmVUb29scyxcbiAgICByZXBhaXJUb29sQ2FsbCxcbiAgICBzdG9wQ29uZGl0aW9uczogYXNBcnJheShzdG9wV2hlbiksXG4gICAgb3V0cHV0LFxuICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICBwcmVwYXJlU3RlcCxcbiAgICBpbmNsdWRlUmF3Q2h1bmtzLFxuICAgIG9uQ2h1bmssXG4gICAgb25FcnJvcixcbiAgICBvbkZpbmlzaCxcbiAgICBvbkFib3J0LFxuICAgIG9uU3RlcEZpbmlzaCxcbiAgICBub3csXG4gICAgY3VycmVudERhdGUsXG4gICAgZ2VuZXJhdGVJZCxcbiAgICBleHBlcmltZW50YWxfY29udGV4dCxcbiAgfSk7XG59XG5cbnR5cGUgRW5yaWNoZWRTdHJlYW1QYXJ0PFRPT0xTIGV4dGVuZHMgVG9vbFNldCwgUEFSVElBTF9PVVRQVVQ+ID0ge1xuICBwYXJ0OiBUZXh0U3RyZWFtUGFydDxUT09MUz47XG4gIHBhcnRpYWxPdXRwdXQ6IFBBUlRJQUxfT1VUUFVUIHwgdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlT3V0cHV0VHJhbnNmb3JtU3RyZWFtPFxuICBUT09MUyBleHRlbmRzIFRvb2xTZXQsXG4gIE9VVFBVVCxcbiAgUEFSVElBTF9PVVRQVVQsXG4+KFxuICBvdXRwdXQ6IE91dHB1dDxPVVRQVVQsIFBBUlRJQUxfT1VUUFVUPiB8IHVuZGVmaW5lZCxcbik6IFRyYW5zZm9ybVN0cmVhbTxcbiAgVGV4dFN0cmVhbVBhcnQ8VE9PTFM+LFxuICBFbnJpY2hlZFN0cmVhbVBhcnQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPlxuPiB7XG4gIGlmICghb3V0cHV0KSB7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm1TdHJlYW08XG4gICAgICBUZXh0U3RyZWFtUGFydDxUT09MUz4sXG4gICAgICBFbnJpY2hlZFN0cmVhbVBhcnQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPlxuICAgID4oe1xuICAgICAgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHBhcnQ6IGNodW5rLCBwYXJ0aWFsT3V0cHV0OiB1bmRlZmluZWQgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgbGV0IGZpcnN0VGV4dENodW5rSWQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgbGV0IHRleHQgPSAnJztcbiAgbGV0IHRleHRDaHVuayA9ICcnO1xuICBsZXQgbGFzdFB1Ymxpc2hlZEpzb24gPSAnJztcblxuICBmdW5jdGlvbiBwdWJsaXNoVGV4dENodW5rKHtcbiAgICBjb250cm9sbGVyLFxuICAgIHBhcnRpYWxPdXRwdXQgPSB1bmRlZmluZWQsXG4gIH06IHtcbiAgICBjb250cm9sbGVyOiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcjxcbiAgICAgIEVucmljaGVkU3RyZWFtUGFydDxUT09MUywgUEFSVElBTF9PVVRQVVQ+XG4gICAgPjtcbiAgICBwYXJ0aWFsT3V0cHV0PzogUEFSVElBTF9PVVRQVVQ7XG4gIH0pIHtcbiAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgcGFydDoge1xuICAgICAgICB0eXBlOiAndGV4dC1kZWx0YScsXG4gICAgICAgIGlkOiBmaXJzdFRleHRDaHVua0lkISxcbiAgICAgICAgdGV4dDogdGV4dENodW5rLFxuICAgICAgfSxcbiAgICAgIHBhcnRpYWxPdXRwdXQsXG4gICAgfSk7XG4gICAgdGV4dENodW5rID0gJyc7XG4gIH1cblxuICByZXR1cm4gbmV3IFRyYW5zZm9ybVN0cmVhbTxcbiAgICBUZXh0U3RyZWFtUGFydDxUT09MUz4sXG4gICAgRW5yaWNoZWRTdHJlYW1QYXJ0PFRPT0xTLCBQQVJUSUFMX09VVFBVVD5cbiAgPih7XG4gICAgYXN5bmMgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAvLyBlbnN1cmUgdGhhdCB3ZSBwdWJsaXNoIHRoZSBsYXN0IHRleHQgY2h1bmsgYmVmb3JlIHRoZSBzdGVwIGZpbmlzaDpcbiAgICAgIGlmIChjaHVuay50eXBlID09PSAnZmluaXNoLXN0ZXAnICYmIHRleHRDaHVuay5sZW5ndGggPiAwKSB7XG4gICAgICAgIHB1Ymxpc2hUZXh0Q2h1bmsoeyBjb250cm9sbGVyIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGNodW5rLnR5cGUgIT09ICd0ZXh0LWRlbHRhJyAmJlxuICAgICAgICBjaHVuay50eXBlICE9PSAndGV4dC1zdGFydCcgJiZcbiAgICAgICAgY2h1bmsudHlwZSAhPT0gJ3RleHQtZW5kJ1xuICAgICAgKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHBhcnQ6IGNodW5rLCBwYXJ0aWFsT3V0cHV0OiB1bmRlZmluZWQgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gd2UgaGF2ZSB0byBwaWNrIGEgdGV4dCBjaHVuayB3aGljaCBjb250YWlucyB0aGUganNvbiB0ZXh0XG4gICAgICAvLyBzaW5jZSB3ZSBhcmUgc3RyZWFtaW5nLCB3ZSBoYXZlIHRvIHBpY2sgdGhlIGZpcnN0IHRleHQgY2h1bmtcbiAgICAgIGlmIChmaXJzdFRleHRDaHVua0lkID09IG51bGwpIHtcbiAgICAgICAgZmlyc3RUZXh0Q2h1bmtJZCA9IGNodW5rLmlkO1xuICAgICAgfSBlbHNlIGlmIChjaHVuay5pZCAhPT0gZmlyc3RUZXh0Q2h1bmtJZCkge1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyBwYXJ0OiBjaHVuaywgcGFydGlhbE91dHB1dDogdW5kZWZpbmVkIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChjaHVuay50eXBlID09PSAndGV4dC1zdGFydCcpIHtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgcGFydDogY2h1bmssIHBhcnRpYWxPdXRwdXQ6IHVuZGVmaW5lZCB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ3RleHQtZW5kJykge1xuICAgICAgICBpZiAodGV4dENodW5rLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBwdWJsaXNoVGV4dENodW5rKHsgY29udHJvbGxlciB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyBwYXJ0OiBjaHVuaywgcGFydGlhbE91dHB1dDogdW5kZWZpbmVkIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRleHQgKz0gY2h1bmsudGV4dDtcbiAgICAgIHRleHRDaHVuayArPSBjaHVuay50ZXh0O1xuXG4gICAgICAvLyBvbmx5IHB1Ymxpc2ggaWYgcGFydGlhbCBqc29uIGNhbiBiZSBwYXJzZWQ6XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBvdXRwdXQucGFyc2VQYXJ0aWFsKHsgdGV4dCB9KTtcbiAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCkge1xuICAgICAgICAvLyBvbmx5IHNlbmQgbmV3IGpzb24gaWYgaXQgaGFzIGNoYW5nZWQ6XG4gICAgICAgIGNvbnN0IGN1cnJlbnRKc29uID0gSlNPTi5zdHJpbmdpZnkocmVzdWx0LnBhcnRpYWwpO1xuICAgICAgICBpZiAoY3VycmVudEpzb24gIT09IGxhc3RQdWJsaXNoZWRKc29uKSB7XG4gICAgICAgICAgcHVibGlzaFRleHRDaHVuayh7IGNvbnRyb2xsZXIsIHBhcnRpYWxPdXRwdXQ6IHJlc3VsdC5wYXJ0aWFsIH0pO1xuICAgICAgICAgIGxhc3RQdWJsaXNoZWRKc29uID0gY3VycmVudEpzb247XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICB9KTtcbn1cblxuY2xhc3MgRGVmYXVsdFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMgZXh0ZW5kcyBUb29sU2V0LCBPVVRQVVQsIFBBUlRJQUxfT1VUUFVUPlxuICBpbXBsZW1lbnRzIFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPlxue1xuICBwcml2YXRlIHJlYWRvbmx5IF90b3RhbFVzYWdlID0gbmV3IERlbGF5ZWRQcm9taXNlPFxuICAgIEF3YWl0ZWQ8U3RyZWFtVGV4dFJlc3VsdDxUT09MUywgUEFSVElBTF9PVVRQVVQ+Wyd1c2FnZSddPlxuICA+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX2ZpbmlzaFJlYXNvbiA9IG5ldyBEZWxheWVkUHJvbWlzZTxcbiAgICBBd2FpdGVkPFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPlsnZmluaXNoUmVhc29uJ10+XG4gID4oKTtcbiAgcHJpdmF0ZSByZWFkb25seSBfc3RlcHMgPSBuZXcgRGVsYXllZFByb21pc2U8XG4gICAgQXdhaXRlZDxTdHJlYW1UZXh0UmVzdWx0PFRPT0xTLCBQQVJUSUFMX09VVFBVVD5bJ3N0ZXBzJ10+XG4gID4oKTtcblxuICBwcml2YXRlIHJlYWRvbmx5IGFkZFN0cmVhbTogKFxuICAgIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VGV4dFN0cmVhbVBhcnQ8VE9PTFM+PixcbiAgKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgY2xvc2VTdHJlYW06ICgpID0+IHZvaWQ7XG5cbiAgcHJpdmF0ZSBiYXNlU3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxFbnJpY2hlZFN0cmVhbVBhcnQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPj47XG5cbiAgcHJpdmF0ZSBvdXRwdXQ6IE91dHB1dDxPVVRQVVQsIFBBUlRJQUxfT1VUUFVUPiB8IHVuZGVmaW5lZDtcblxuICBwcml2YXRlIGluY2x1ZGVSYXdDaHVua3M6IGJvb2xlYW47XG5cbiAgcHJpdmF0ZSB0b29sczogVE9PTFMgfCB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIG1vZGVsLFxuICAgIHRlbGVtZXRyeSxcbiAgICBoZWFkZXJzLFxuICAgIHNldHRpbmdzLFxuICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgc3lzdGVtLFxuICAgIHByb21wdCxcbiAgICBtZXNzYWdlcyxcbiAgICB0b29scyxcbiAgICB0b29sQ2hvaWNlLFxuICAgIHRyYW5zZm9ybXMsXG4gICAgYWN0aXZlVG9vbHMsXG4gICAgcmVwYWlyVG9vbENhbGwsXG4gICAgc3RvcENvbmRpdGlvbnMsXG4gICAgb3V0cHV0LFxuICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICBwcmVwYXJlU3RlcCxcbiAgICBpbmNsdWRlUmF3Q2h1bmtzLFxuICAgIG5vdyxcbiAgICBjdXJyZW50RGF0ZSxcbiAgICBnZW5lcmF0ZUlkLFxuICAgIG9uQ2h1bmssXG4gICAgb25FcnJvcixcbiAgICBvbkZpbmlzaCxcbiAgICBvbkFib3J0LFxuICAgIG9uU3RlcEZpbmlzaCxcbiAgICBleHBlcmltZW50YWxfY29udGV4dCxcbiAgfToge1xuICAgIG1vZGVsOiBMYW5ndWFnZU1vZGVsVjI7XG4gICAgdGVsZW1ldHJ5OiBUZWxlbWV0cnlTZXR0aW5ncyB8IHVuZGVmaW5lZDtcbiAgICBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+IHwgdW5kZWZpbmVkO1xuICAgIHNldHRpbmdzOiBPbWl0PENhbGxTZXR0aW5ncywgJ2Fib3J0U2lnbmFsJyB8ICdoZWFkZXJzJz47XG4gICAgbWF4UmV0cmllczogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICAgIGFib3J0U2lnbmFsOiBBYm9ydFNpZ25hbCB8IHVuZGVmaW5lZDtcbiAgICBzeXN0ZW06IFByb21wdFsnc3lzdGVtJ107XG4gICAgcHJvbXB0OiBQcm9tcHRbJ3Byb21wdCddO1xuICAgIG1lc3NhZ2VzOiBQcm9tcHRbJ21lc3NhZ2VzJ107XG4gICAgdG9vbHM6IFRPT0xTIHwgdW5kZWZpbmVkO1xuICAgIHRvb2xDaG9pY2U6IFRvb2xDaG9pY2U8VE9PTFM+IHwgdW5kZWZpbmVkO1xuICAgIHRyYW5zZm9ybXM6IEFycmF5PFN0cmVhbVRleHRUcmFuc2Zvcm08VE9PTFM+PjtcbiAgICBhY3RpdmVUb29sczogQXJyYXk8a2V5b2YgVE9PTFM+IHwgdW5kZWZpbmVkO1xuICAgIHJlcGFpclRvb2xDYWxsOiBUb29sQ2FsbFJlcGFpckZ1bmN0aW9uPFRPT0xTPiB8IHVuZGVmaW5lZDtcbiAgICBzdG9wQ29uZGl0aW9uczogQXJyYXk8U3RvcENvbmRpdGlvbjxOb0luZmVyPFRPT0xTPj4+O1xuICAgIG91dHB1dDogT3V0cHV0PE9VVFBVVCwgUEFSVElBTF9PVVRQVVQ+IHwgdW5kZWZpbmVkO1xuICAgIHByb3ZpZGVyT3B0aW9uczogUHJvdmlkZXJPcHRpb25zIHwgdW5kZWZpbmVkO1xuICAgIHByZXBhcmVTdGVwOiBQcmVwYXJlU3RlcEZ1bmN0aW9uPE5vSW5mZXI8VE9PTFM+PiB8IHVuZGVmaW5lZDtcbiAgICBpbmNsdWRlUmF3Q2h1bmtzOiBib29sZWFuO1xuICAgIG5vdzogKCkgPT4gbnVtYmVyO1xuICAgIGN1cnJlbnREYXRlOiAoKSA9PiBEYXRlO1xuICAgIGdlbmVyYXRlSWQ6ICgpID0+IHN0cmluZztcbiAgICBleHBlcmltZW50YWxfY29udGV4dDogdW5rbm93bjtcblxuICAgIC8vIGNhbGxiYWNrczpcbiAgICBvbkNodW5rOiB1bmRlZmluZWQgfCBTdHJlYW1UZXh0T25DaHVua0NhbGxiYWNrPFRPT0xTPjtcbiAgICBvbkVycm9yOiBTdHJlYW1UZXh0T25FcnJvckNhbGxiYWNrO1xuICAgIG9uRmluaXNoOiB1bmRlZmluZWQgfCBTdHJlYW1UZXh0T25GaW5pc2hDYWxsYmFjazxUT09MUz47XG4gICAgb25BYm9ydDogdW5kZWZpbmVkIHwgU3RyZWFtVGV4dE9uQWJvcnRDYWxsYmFjazxUT09MUz47XG4gICAgb25TdGVwRmluaXNoOiB1bmRlZmluZWQgfCBTdHJlYW1UZXh0T25TdGVwRmluaXNoQ2FsbGJhY2s8VE9PTFM+O1xuICB9KSB7XG4gICAgdGhpcy5vdXRwdXQgPSBvdXRwdXQ7XG4gICAgdGhpcy5pbmNsdWRlUmF3Q2h1bmtzID0gaW5jbHVkZVJhd0NodW5rcztcbiAgICB0aGlzLnRvb2xzID0gdG9vbHM7XG5cbiAgICAvLyBwcm9taXNlIHRvIGVuc3VyZSB0aGF0IHRoZSBzdGVwIGhhcyBiZWVuIGZ1bGx5IHByb2Nlc3NlZCBieSB0aGUgZXZlbnQgcHJvY2Vzc29yXG4gICAgLy8gYmVmb3JlIGEgbmV3IHN0ZXAgaXMgc3RhcnRlZC4gVGhpcyBpcyByZXF1aXJlZCBiZWNhdXNlIHRoZSBjb250aW51YXRpb24gY29uZGl0aW9uXG4gICAgLy8gbmVlZHMgdGhlIHVwZGF0ZWQgc3RlcHMgdG8gZGV0ZXJtaW5lIGlmIGFub3RoZXIgc3RlcCBpcyBuZWVkZWQuXG4gICAgbGV0IHN0ZXBGaW5pc2ghOiBEZWxheWVkUHJvbWlzZTx2b2lkPjtcblxuICAgIGxldCByZWNvcmRlZENvbnRlbnQ6IEFycmF5PENvbnRlbnRQYXJ0PFRPT0xTPj4gPSBbXTtcbiAgICBjb25zdCByZWNvcmRlZFJlc3BvbnNlTWVzc2FnZXM6IEFycmF5PFJlc3BvbnNlTWVzc2FnZT4gPSBbXTtcbiAgICBsZXQgcmVjb3JkZWRGaW5pc2hSZWFzb246IEZpbmlzaFJlYXNvbiB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICBsZXQgcmVjb3JkZWRUb3RhbFVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2UgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgbGV0IHJlY29yZGVkUmVxdWVzdDogTGFuZ3VhZ2VNb2RlbFJlcXVlc3RNZXRhZGF0YSA9IHt9O1xuICAgIGxldCByZWNvcmRlZFdhcm5pbmdzOiBBcnJheTxDYWxsV2FybmluZz4gPSBbXTtcbiAgICBjb25zdCByZWNvcmRlZFN0ZXBzOiBTdGVwUmVzdWx0PFRPT0xTPltdID0gW107XG5cbiAgICBsZXQgcm9vdFNwYW4hOiBTcGFuO1xuXG4gICAgbGV0IGFjdGl2ZVRleHRDb250ZW50OiBSZWNvcmQ8XG4gICAgICBzdHJpbmcsXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICd0ZXh0JztcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBQcm92aWRlck1ldGFkYXRhIHwgdW5kZWZpbmVkO1xuICAgICAgfVxuICAgID4gPSB7fTtcblxuICAgIGxldCBhY3RpdmVSZWFzb25pbmdDb250ZW50OiBSZWNvcmQ8XG4gICAgICBzdHJpbmcsXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICdyZWFzb25pbmcnO1xuICAgICAgICB0ZXh0OiBzdHJpbmc7XG4gICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IFByb3ZpZGVyTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgPiA9IHt9O1xuXG4gICAgY29uc3QgZXZlbnRQcm9jZXNzb3IgPSBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgRW5yaWNoZWRTdHJlYW1QYXJ0PFRPT0xTLCBQQVJUSUFMX09VVFBVVD4sXG4gICAgICBFbnJpY2hlZFN0cmVhbVBhcnQ8VE9PTFMsIFBBUlRJQUxfT1VUUFVUPlxuICAgID4oe1xuICAgICAgYXN5bmMgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7IC8vIGZvcndhcmQgdGhlIGNodW5rIHRvIHRoZSBuZXh0IHN0cmVhbVxuXG4gICAgICAgIGNvbnN0IHsgcGFydCB9ID0gY2h1bms7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3RleHQtZGVsdGEnIHx8XG4gICAgICAgICAgcGFydC50eXBlID09PSAncmVhc29uaW5nLWRlbHRhJyB8fFxuICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3NvdXJjZScgfHxcbiAgICAgICAgICBwYXJ0LnR5cGUgPT09ICd0b29sLWNhbGwnIHx8XG4gICAgICAgICAgcGFydC50eXBlID09PSAndG9vbC1yZXN1bHQnIHx8XG4gICAgICAgICAgcGFydC50eXBlID09PSAndG9vbC1pbnB1dC1zdGFydCcgfHxcbiAgICAgICAgICBwYXJ0LnR5cGUgPT09ICd0b29sLWlucHV0LWRlbHRhJyB8fFxuICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3JhdydcbiAgICAgICAgKSB7XG4gICAgICAgICAgYXdhaXQgb25DaHVuaz8uKHsgY2h1bms6IHBhcnQgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFydC50eXBlID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgYXdhaXQgb25FcnJvcih7IGVycm9yOiB3cmFwR2F0ZXdheUVycm9yKHBhcnQuZXJyb3IpIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3RleHQtc3RhcnQnKSB7XG4gICAgICAgICAgYWN0aXZlVGV4dENvbnRlbnRbcGFydC5pZF0gPSB7XG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICB0ZXh0OiAnJyxcbiAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcmVjb3JkZWRDb250ZW50LnB1c2goYWN0aXZlVGV4dENvbnRlbnRbcGFydC5pZF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3RleHQtZGVsdGEnKSB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlVGV4dCA9IGFjdGl2ZVRleHRDb250ZW50W3BhcnQuaWRdO1xuXG4gICAgICAgICAgaWYgKGFjdGl2ZVRleHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgcGFydDoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGB0ZXh0IHBhcnQgJHtwYXJ0LmlkfSBub3QgZm91bmRgLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwYXJ0aWFsT3V0cHV0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhY3RpdmVUZXh0LnRleHQgKz0gcGFydC50ZXh0O1xuICAgICAgICAgIGFjdGl2ZVRleHQucHJvdmlkZXJNZXRhZGF0YSA9XG4gICAgICAgICAgICBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgPz8gYWN0aXZlVGV4dC5wcm92aWRlck1ldGFkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3RleHQtZW5kJykge1xuICAgICAgICAgIGRlbGV0ZSBhY3RpdmVUZXh0Q29udGVudFtwYXJ0LmlkXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdyZWFzb25pbmctc3RhcnQnKSB7XG4gICAgICAgICAgYWN0aXZlUmVhc29uaW5nQ29udGVudFtwYXJ0LmlkXSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmcnLFxuICAgICAgICAgICAgdGV4dDogJycsXG4gICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHJlY29yZGVkQ29udGVudC5wdXNoKGFjdGl2ZVJlYXNvbmluZ0NvbnRlbnRbcGFydC5pZF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3JlYXNvbmluZy1kZWx0YScpIHtcbiAgICAgICAgICBjb25zdCBhY3RpdmVSZWFzb25pbmcgPSBhY3RpdmVSZWFzb25pbmdDb250ZW50W3BhcnQuaWRdO1xuXG4gICAgICAgICAgaWYgKGFjdGl2ZVJlYXNvbmluZyA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICBwYXJ0OiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBlcnJvcjogYHJlYXNvbmluZyBwYXJ0ICR7cGFydC5pZH0gbm90IGZvdW5kYCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcGFydGlhbE91dHB1dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYWN0aXZlUmVhc29uaW5nLnRleHQgKz0gcGFydC50ZXh0O1xuICAgICAgICAgIGFjdGl2ZVJlYXNvbmluZy5wcm92aWRlck1ldGFkYXRhID1cbiAgICAgICAgICAgIHBhcnQucHJvdmlkZXJNZXRhZGF0YSA/PyBhY3RpdmVSZWFzb25pbmcucHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdyZWFzb25pbmctZW5kJykge1xuICAgICAgICAgIGNvbnN0IGFjdGl2ZVJlYXNvbmluZyA9IGFjdGl2ZVJlYXNvbmluZ0NvbnRlbnRbcGFydC5pZF07XG5cbiAgICAgICAgICBpZiAoYWN0aXZlUmVhc29uaW5nID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgIHBhcnQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgIGVycm9yOiBgcmVhc29uaW5nIHBhcnQgJHtwYXJ0LmlkfSBub3QgZm91bmRgLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwYXJ0aWFsT3V0cHV0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhY3RpdmVSZWFzb25pbmcucHJvdmlkZXJNZXRhZGF0YSA9XG4gICAgICAgICAgICBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgPz8gYWN0aXZlUmVhc29uaW5nLnByb3ZpZGVyTWV0YWRhdGE7XG5cbiAgICAgICAgICBkZWxldGUgYWN0aXZlUmVhc29uaW5nQ29udGVudFtwYXJ0LmlkXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdmaWxlJykge1xuICAgICAgICAgIHJlY29yZGVkQ29udGVudC5wdXNoKHsgdHlwZTogJ2ZpbGUnLCBmaWxlOiBwYXJ0LmZpbGUgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFydC50eXBlID09PSAnc291cmNlJykge1xuICAgICAgICAgIHJlY29yZGVkQ29udGVudC5wdXNoKHBhcnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3Rvb2wtY2FsbCcpIHtcbiAgICAgICAgICByZWNvcmRlZENvbnRlbnQucHVzaChwYXJ0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICd0b29sLXJlc3VsdCcgJiYgIXBhcnQucHJlbGltaW5hcnkpIHtcbiAgICAgICAgICByZWNvcmRlZENvbnRlbnQucHVzaChwYXJ0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICd0b29sLWVycm9yJykge1xuICAgICAgICAgIHJlY29yZGVkQ29udGVudC5wdXNoKHBhcnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ3N0YXJ0LXN0ZXAnKSB7XG4gICAgICAgICAgcmVjb3JkZWRSZXF1ZXN0ID0gcGFydC5yZXF1ZXN0O1xuICAgICAgICAgIHJlY29yZGVkV2FybmluZ3MgPSBwYXJ0Lndhcm5pbmdzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ2ZpbmlzaC1zdGVwJykge1xuICAgICAgICAgIGNvbnN0IHN0ZXBNZXNzYWdlcyA9IHRvUmVzcG9uc2VNZXNzYWdlcyh7XG4gICAgICAgICAgICBjb250ZW50OiByZWNvcmRlZENvbnRlbnQsXG4gICAgICAgICAgICB0b29scyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEFkZCBzdGVwIGluZm9ybWF0aW9uIChhZnRlciByZXNwb25zZSBtZXNzYWdlcyBhcmUgdXBkYXRlZCk6XG4gICAgICAgICAgY29uc3QgY3VycmVudFN0ZXBSZXN1bHQ6IFN0ZXBSZXN1bHQ8VE9PTFM+ID0gbmV3IERlZmF1bHRTdGVwUmVzdWx0KHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IHJlY29yZGVkQ29udGVudCxcbiAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogcGFydC5maW5pc2hSZWFzb24sXG4gICAgICAgICAgICB1c2FnZTogcGFydC51c2FnZSxcbiAgICAgICAgICAgIHdhcm5pbmdzOiByZWNvcmRlZFdhcm5pbmdzLFxuICAgICAgICAgICAgcmVxdWVzdDogcmVjb3JkZWRSZXF1ZXN0LFxuICAgICAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICAgICAgLi4ucGFydC5yZXNwb25zZSxcbiAgICAgICAgICAgICAgbWVzc2FnZXM6IFsuLi5yZWNvcmRlZFJlc3BvbnNlTWVzc2FnZXMsIC4uLnN0ZXBNZXNzYWdlc10sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogcGFydC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgYXdhaXQgb25TdGVwRmluaXNoPy4oY3VycmVudFN0ZXBSZXN1bHQpO1xuXG4gICAgICAgICAgcmVjb3JkZWRTdGVwcy5wdXNoKGN1cnJlbnRTdGVwUmVzdWx0KTtcblxuICAgICAgICAgIHJlY29yZGVkQ29udGVudCA9IFtdO1xuICAgICAgICAgIGFjdGl2ZVJlYXNvbmluZ0NvbnRlbnQgPSB7fTtcbiAgICAgICAgICBhY3RpdmVUZXh0Q29udGVudCA9IHt9O1xuXG4gICAgICAgICAgcmVjb3JkZWRSZXNwb25zZU1lc3NhZ2VzLnB1c2goLi4uc3RlcE1lc3NhZ2VzKTtcblxuICAgICAgICAgIC8vIHJlc29sdmUgdGhlIHByb21pc2UgdG8gc2lnbmFsIHRoYXQgdGhlIHN0ZXAgaGFzIGJlZW4gZnVsbHkgcHJvY2Vzc2VkXG4gICAgICAgICAgLy8gYnkgdGhlIGV2ZW50IHByb2Nlc3NvcjpcbiAgICAgICAgICBzdGVwRmluaXNoLnJlc29sdmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICdmaW5pc2gnKSB7XG4gICAgICAgICAgcmVjb3JkZWRUb3RhbFVzYWdlID0gcGFydC50b3RhbFVzYWdlO1xuICAgICAgICAgIHJlY29yZGVkRmluaXNoUmVhc29uID0gcGFydC5maW5pc2hSZWFzb247XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIGFzeW5jIGZsdXNoKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAocmVjb3JkZWRTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IE5vT3V0cHV0R2VuZXJhdGVkRXJyb3Ioe1xuICAgICAgICAgICAgICBtZXNzYWdlOiAnTm8gb3V0cHV0IGdlbmVyYXRlZC4gQ2hlY2sgdGhlIHN0cmVhbSBmb3IgZXJyb3JzLicsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2VsZi5fZmluaXNoUmVhc29uLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICBzZWxmLl90b3RhbFVzYWdlLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICBzZWxmLl9zdGVwcy5yZWplY3QoZXJyb3IpO1xuXG4gICAgICAgICAgICByZXR1cm47IC8vIG5vIHN0ZXBzIHJlY29yZGVkIChlLmcuIGluIGVycm9yIHNjZW5hcmlvKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIGRlcml2ZWQ6XG4gICAgICAgICAgY29uc3QgZmluaXNoUmVhc29uID0gcmVjb3JkZWRGaW5pc2hSZWFzb24gPz8gJ3Vua25vd24nO1xuICAgICAgICAgIGNvbnN0IHRvdGFsVXNhZ2UgPSByZWNvcmRlZFRvdGFsVXNhZ2UgPz8ge1xuICAgICAgICAgICAgaW5wdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG91dHB1dFRva2VuczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgdG90YWxUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gZnJvbSBmaW5pc2g6XG4gICAgICAgICAgc2VsZi5fZmluaXNoUmVhc29uLnJlc29sdmUoZmluaXNoUmVhc29uKTtcbiAgICAgICAgICBzZWxmLl90b3RhbFVzYWdlLnJlc29sdmUodG90YWxVc2FnZSk7XG5cbiAgICAgICAgICAvLyBhZ2dyZWdhdGUgcmVzdWx0czpcbiAgICAgICAgICBzZWxmLl9zdGVwcy5yZXNvbHZlKHJlY29yZGVkU3RlcHMpO1xuXG4gICAgICAgICAgLy8gY2FsbCBvbkZpbmlzaCBjYWxsYmFjazpcbiAgICAgICAgICBjb25zdCBmaW5hbFN0ZXAgPSByZWNvcmRlZFN0ZXBzW3JlY29yZGVkU3RlcHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgYXdhaXQgb25GaW5pc2g/Lih7XG4gICAgICAgICAgICBmaW5pc2hSZWFzb24sXG4gICAgICAgICAgICB0b3RhbFVzYWdlLFxuICAgICAgICAgICAgdXNhZ2U6IGZpbmFsU3RlcC51c2FnZSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGZpbmFsU3RlcC5jb250ZW50LFxuICAgICAgICAgICAgdGV4dDogZmluYWxTdGVwLnRleHQsXG4gICAgICAgICAgICByZWFzb25pbmdUZXh0OiBmaW5hbFN0ZXAucmVhc29uaW5nVGV4dCxcbiAgICAgICAgICAgIHJlYXNvbmluZzogZmluYWxTdGVwLnJlYXNvbmluZyxcbiAgICAgICAgICAgIGZpbGVzOiBmaW5hbFN0ZXAuZmlsZXMsXG4gICAgICAgICAgICBzb3VyY2VzOiBmaW5hbFN0ZXAuc291cmNlcyxcbiAgICAgICAgICAgIHRvb2xDYWxsczogZmluYWxTdGVwLnRvb2xDYWxscyxcbiAgICAgICAgICAgIHN0YXRpY1Rvb2xDYWxsczogZmluYWxTdGVwLnN0YXRpY1Rvb2xDYWxscyxcbiAgICAgICAgICAgIGR5bmFtaWNUb29sQ2FsbHM6IGZpbmFsU3RlcC5keW5hbWljVG9vbENhbGxzLFxuICAgICAgICAgICAgdG9vbFJlc3VsdHM6IGZpbmFsU3RlcC50b29sUmVzdWx0cyxcbiAgICAgICAgICAgIHN0YXRpY1Rvb2xSZXN1bHRzOiBmaW5hbFN0ZXAuc3RhdGljVG9vbFJlc3VsdHMsXG4gICAgICAgICAgICBkeW5hbWljVG9vbFJlc3VsdHM6IGZpbmFsU3RlcC5keW5hbWljVG9vbFJlc3VsdHMsXG4gICAgICAgICAgICByZXF1ZXN0OiBmaW5hbFN0ZXAucmVxdWVzdCxcbiAgICAgICAgICAgIHJlc3BvbnNlOiBmaW5hbFN0ZXAucmVzcG9uc2UsXG4gICAgICAgICAgICB3YXJuaW5nczogZmluYWxTdGVwLndhcm5pbmdzLFxuICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogZmluYWxTdGVwLnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICBzdGVwczogcmVjb3JkZWRTdGVwcyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEFkZCByZXNwb25zZSBpbmZvcm1hdGlvbiB0byB0aGUgcm9vdCBzcGFuOlxuICAgICAgICAgIHJvb3RTcGFuLnNldEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLmZpbmlzaFJlYXNvbic6IGZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudGV4dCc6IHsgb3V0cHV0OiAoKSA9PiBmaW5hbFN0ZXAudGV4dCB9LFxuICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS50b29sQ2FsbHMnOiB7XG4gICAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsU3RlcC50b29sQ2FsbHM/Lmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkoZmluYWxTdGVwLnRvb2xDYWxscylcbiAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5wcm92aWRlck1ldGFkYXRhJzogSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgICBmaW5hbFN0ZXAucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAgICAgJ2FpLnVzYWdlLmlucHV0VG9rZW5zJzogdG90YWxVc2FnZS5pbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAnYWkudXNhZ2Uub3V0cHV0VG9rZW5zJzogdG90YWxVc2FnZS5vdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgJ2FpLnVzYWdlLnRvdGFsVG9rZW5zJzogdG90YWxVc2FnZS50b3RhbFRva2VucyxcbiAgICAgICAgICAgICAgICAnYWkudXNhZ2UucmVhc29uaW5nVG9rZW5zJzogdG90YWxVc2FnZS5yZWFzb25pbmdUb2tlbnMsXG4gICAgICAgICAgICAgICAgJ2FpLnVzYWdlLmNhY2hlZElucHV0VG9rZW5zJzogdG90YWxVc2FnZS5jYWNoZWRJbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29udHJvbGxlci5lcnJvcihlcnJvcik7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgcm9vdFNwYW4uZW5kKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBpbml0aWFsaXplIHRoZSBzdGl0Y2hhYmxlIHN0cmVhbSBhbmQgdGhlIHRyYW5zZm9ybWVkIHN0cmVhbTpcbiAgICBjb25zdCBzdGl0Y2hhYmxlU3RyZWFtID0gY3JlYXRlU3RpdGNoYWJsZVN0cmVhbTxUZXh0U3RyZWFtUGFydDxUT09MUz4+KCk7XG4gICAgdGhpcy5hZGRTdHJlYW0gPSBzdGl0Y2hhYmxlU3RyZWFtLmFkZFN0cmVhbTtcbiAgICB0aGlzLmNsb3NlU3RyZWFtID0gc3RpdGNoYWJsZVN0cmVhbS5jbG9zZTtcblxuICAgIGxldCBzdHJlYW0gPSBzdGl0Y2hhYmxlU3RyZWFtLnN0cmVhbTtcblxuICAgIC8vIGZpbHRlciBvdXQgYWJvcnQgZXJyb3JzOlxuICAgIHN0cmVhbSA9IGZpbHRlclN0cmVhbUVycm9ycyhzdHJlYW0sICh7IGVycm9yLCBjb250cm9sbGVyIH0pID0+IHtcbiAgICAgIGlmIChpc0Fib3J0RXJyb3IoZXJyb3IpICYmIGFib3J0U2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICAgIG9uQWJvcnQ/Lih7IHN0ZXBzOiByZWNvcmRlZFN0ZXBzIH0pO1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAnYWJvcnQnIH0pO1xuICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250cm9sbGVyLmVycm9yKGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGFkZCBhIHN0cmVhbSB0aGF0IGVtaXRzIGEgc3RhcnQgZXZlbnQ6XG4gICAgc3RyZWFtID0gc3RyZWFtLnBpcGVUaHJvdWdoKFxuICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxUZXh0U3RyZWFtUGFydDxUT09MUz4sIFRleHRTdHJlYW1QYXJ0PFRPT0xTPj4oe1xuICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ3N0YXJ0JyB9KTtcbiAgICAgICAgfSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICAvLyB0cmFuc2Zvcm0gdGhlIHN0cmVhbSBiZWZvcmUgb3V0cHV0IHBhcnNpbmdcbiAgICAvLyB0byBlbmFibGUgcmVwbGFjZW1lbnQgb2Ygc3RyZWFtIHNlZ21lbnRzOlxuICAgIGZvciAoY29uc3QgdHJhbnNmb3JtIG9mIHRyYW5zZm9ybXMpIHtcbiAgICAgIHN0cmVhbSA9IHN0cmVhbS5waXBlVGhyb3VnaChcbiAgICAgICAgdHJhbnNmb3JtKHtcbiAgICAgICAgICB0b29sczogdG9vbHMgYXMgVE9PTFMsXG4gICAgICAgICAgc3RvcFN0cmVhbSgpIHtcbiAgICAgICAgICAgIHN0aXRjaGFibGVTdHJlYW0udGVybWluYXRlKCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMuYmFzZVN0cmVhbSA9IHN0cmVhbVxuICAgICAgLnBpcGVUaHJvdWdoKGNyZWF0ZU91dHB1dFRyYW5zZm9ybVN0cmVhbShvdXRwdXQpKVxuICAgICAgLnBpcGVUaHJvdWdoKGV2ZW50UHJvY2Vzc29yKTtcblxuICAgIGNvbnN0IHsgbWF4UmV0cmllcywgcmV0cnkgfSA9IHByZXBhcmVSZXRyaWVzKHtcbiAgICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gICAgICBhYm9ydFNpZ25hbCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcih0ZWxlbWV0cnkpO1xuXG4gICAgY29uc3QgY2FsbFNldHRpbmdzID0gcHJlcGFyZUNhbGxTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgICBjb25zdCBiYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyA9IGdldEJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgIG1vZGVsLFxuICAgICAgdGVsZW1ldHJ5LFxuICAgICAgaGVhZGVycyxcbiAgICAgIHNldHRpbmdzOiB7IC4uLmNhbGxTZXR0aW5ncywgbWF4UmV0cmllcyB9LFxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICByZWNvcmRTcGFuKHtcbiAgICAgIG5hbWU6ICdhaS5zdHJlYW1UZXh0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAuLi5hc3NlbWJsZU9wZXJhdGlvbk5hbWUoeyBvcGVyYXRpb25JZDogJ2FpLnN0cmVhbVRleHQnLCB0ZWxlbWV0cnkgfSksXG4gICAgICAgICAgLi4uYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMsXG4gICAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAgICdhaS5wcm9tcHQnOiB7XG4gICAgICAgICAgICBpbnB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkoeyBzeXN0ZW0sIHByb21wdCwgbWVzc2FnZXMgfSksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pLFxuICAgICAgdHJhY2VyLFxuICAgICAgZW5kV2hlbkRvbmU6IGZhbHNlLFxuICAgICAgZm46IGFzeW5jIHJvb3RTcGFuQXJnID0+IHtcbiAgICAgICAgcm9vdFNwYW4gPSByb290U3BhbkFyZztcblxuICAgICAgICBhc3luYyBmdW5jdGlvbiBzdHJlYW1TdGVwKHtcbiAgICAgICAgICBjdXJyZW50U3RlcCxcbiAgICAgICAgICByZXNwb25zZU1lc3NhZ2VzLFxuICAgICAgICAgIHVzYWdlLFxuICAgICAgICB9OiB7XG4gICAgICAgICAgY3VycmVudFN0ZXA6IG51bWJlcjtcbiAgICAgICAgICByZXNwb25zZU1lc3NhZ2VzOiBBcnJheTxSZXNwb25zZU1lc3NhZ2U+O1xuICAgICAgICAgIHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG4gICAgICAgIH0pIHtcbiAgICAgICAgICBjb25zdCBpbmNsdWRlUmF3Q2h1bmtzID0gc2VsZi5pbmNsdWRlUmF3Q2h1bmtzO1xuXG4gICAgICAgICAgc3RlcEZpbmlzaCA9IG5ldyBEZWxheWVkUHJvbWlzZTx2b2lkPigpO1xuXG4gICAgICAgICAgY29uc3QgaW5pdGlhbFByb21wdCA9IGF3YWl0IHN0YW5kYXJkaXplUHJvbXB0KHtcbiAgICAgICAgICAgIHN5c3RlbSxcbiAgICAgICAgICAgIHByb21wdCxcbiAgICAgICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3Qgc3RlcElucHV0TWVzc2FnZXMgPSBbXG4gICAgICAgICAgICAuLi5pbml0aWFsUHJvbXB0Lm1lc3NhZ2VzLFxuICAgICAgICAgICAgLi4ucmVzcG9uc2VNZXNzYWdlcyxcbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgY29uc3QgcHJlcGFyZVN0ZXBSZXN1bHQgPSBhd2FpdCBwcmVwYXJlU3RlcD8uKHtcbiAgICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgICAgc3RlcHM6IHJlY29yZGVkU3RlcHMsXG4gICAgICAgICAgICBzdGVwTnVtYmVyOiByZWNvcmRlZFN0ZXBzLmxlbmd0aCxcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBzdGVwSW5wdXRNZXNzYWdlcyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnN0IHByb21wdE1lc3NhZ2VzID0gYXdhaXQgY29udmVydFRvTGFuZ3VhZ2VNb2RlbFByb21wdCh7XG4gICAgICAgICAgICBwcm9tcHQ6IHtcbiAgICAgICAgICAgICAgc3lzdGVtOiBwcmVwYXJlU3RlcFJlc3VsdD8uc3lzdGVtID8/IGluaXRpYWxQcm9tcHQuc3lzdGVtLFxuICAgICAgICAgICAgICBtZXNzYWdlczogcHJlcGFyZVN0ZXBSZXN1bHQ/Lm1lc3NhZ2VzID8/IHN0ZXBJbnB1dE1lc3NhZ2VzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1cHBvcnRlZFVybHM6IGF3YWl0IG1vZGVsLnN1cHBvcnRlZFVybHMsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBzdGVwTW9kZWwgPSByZXNvbHZlTGFuZ3VhZ2VNb2RlbChcbiAgICAgICAgICAgIHByZXBhcmVTdGVwUmVzdWx0Py5tb2RlbCA/PyBtb2RlbCxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgY29uc3QgeyB0b29sQ2hvaWNlOiBzdGVwVG9vbENob2ljZSwgdG9vbHM6IHN0ZXBUb29scyB9ID1cbiAgICAgICAgICAgIHByZXBhcmVUb29sc0FuZFRvb2xDaG9pY2Uoe1xuICAgICAgICAgICAgICB0b29scyxcbiAgICAgICAgICAgICAgdG9vbENob2ljZTogcHJlcGFyZVN0ZXBSZXN1bHQ/LnRvb2xDaG9pY2UgPz8gdG9vbENob2ljZSxcbiAgICAgICAgICAgICAgYWN0aXZlVG9vbHM6IHByZXBhcmVTdGVwUmVzdWx0Py5hY3RpdmVUb29scyA/PyBhY3RpdmVUb29scyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcmVzdWx0OiB7IHN0cmVhbSwgcmVzcG9uc2UsIHJlcXVlc3QgfSxcbiAgICAgICAgICAgIGRvU3RyZWFtU3BhbixcbiAgICAgICAgICAgIHN0YXJ0VGltZXN0YW1wTXMsXG4gICAgICAgICAgfSA9IGF3YWl0IHJldHJ5KCgpID0+XG4gICAgICAgICAgICByZWNvcmRTcGFuKHtcbiAgICAgICAgICAgICAgbmFtZTogJ2FpLnN0cmVhbVRleHQuZG9TdHJlYW0nLFxuICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6ICdhaS5zdHJlYW1UZXh0LmRvU3RyZWFtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgIC8vIG1vZGVsOlxuICAgICAgICAgICAgICAgICAgJ2FpLm1vZGVsLnByb3ZpZGVyJzogc3RlcE1vZGVsLnByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgJ2FpLm1vZGVsLmlkJzogc3RlcE1vZGVsLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAvLyBwcm9tcHQ6XG4gICAgICAgICAgICAgICAgICAnYWkucHJvbXB0Lm1lc3NhZ2VzJzoge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dDogKCkgPT4gc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5KHByb21wdE1lc3NhZ2VzKSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAnYWkucHJvbXB0LnRvb2xzJzoge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IHRoZSBsYW5ndWFnZSBtb2RlbCBsZXZlbCB0b29sczpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+IHN0ZXBUb29scz8ubWFwKHRvb2wgPT4gSlNPTi5zdHJpbmdpZnkodG9vbCkpLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICdhaS5wcm9tcHQudG9vbENob2ljZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFRvb2xDaG9pY2UgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeShzdGVwVG9vbENob2ljZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgLy8gc3RhbmRhcmRpemVkIGdlbi1haSBsbG0gc3BhbiBhdHRyaWJ1dGVzOlxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5zeXN0ZW0nOiBzdGVwTW9kZWwucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubW9kZWwnOiBzdGVwTW9kZWwubW9kZWxJZCxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC5mcmVxdWVuY3lfcGVuYWx0eSc6XG4gICAgICAgICAgICAgICAgICAgIGNhbGxTZXR0aW5ncy5mcmVxdWVuY3lQZW5hbHR5LFxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0Lm1heF90b2tlbnMnOiBjYWxsU2V0dGluZ3MubWF4T3V0cHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0LnByZXNlbmNlX3BlbmFsdHknOlxuICAgICAgICAgICAgICAgICAgICBjYWxsU2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5LFxuICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0LnN0b3Bfc2VxdWVuY2VzJzogY2FsbFNldHRpbmdzLnN0b3BTZXF1ZW5jZXMsXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudGVtcGVyYXR1cmUnOiBjYWxsU2V0dGluZ3MudGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX2snOiBjYWxsU2V0dGluZ3MudG9wSyxcbiAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC50b3BfcCc6IGNhbGxTZXR0aW5ncy50b3BQLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB0cmFjZXIsXG4gICAgICAgICAgICAgIGVuZFdoZW5Eb25lOiBmYWxzZSxcbiAgICAgICAgICAgICAgZm46IGFzeW5jIGRvU3RyZWFtU3BhbiA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZXN0YW1wTXM6IG5vdygpLCAvLyBnZXQgYmVmb3JlIHRoZSBjYWxsXG4gICAgICAgICAgICAgICAgICBkb1N0cmVhbVNwYW4sXG4gICAgICAgICAgICAgICAgICByZXN1bHQ6IGF3YWl0IHN0ZXBNb2RlbC5kb1N0cmVhbSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLmNhbGxTZXR0aW5ncyxcbiAgICAgICAgICAgICAgICAgICAgdG9vbHM6IHN0ZXBUb29scyxcbiAgICAgICAgICAgICAgICAgICAgdG9vbENob2ljZTogc3RlcFRvb2xDaG9pY2UsXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlRm9ybWF0OiBvdXRwdXQ/LnJlc3BvbnNlRm9ybWF0LFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IHByb21wdE1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlUmF3Q2h1bmtzLFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBjb25zdCBzdHJlYW1XaXRoVG9vbFJlc3VsdHMgPSBydW5Ub29sc1RyYW5zZm9ybWF0aW9uKHtcbiAgICAgICAgICAgIHRvb2xzLFxuICAgICAgICAgICAgZ2VuZXJhdG9yU3RyZWFtOiBzdHJlYW0sXG4gICAgICAgICAgICB0cmFjZXIsXG4gICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICBzeXN0ZW0sXG4gICAgICAgICAgICBtZXNzYWdlczogc3RlcElucHV0TWVzc2FnZXMsXG4gICAgICAgICAgICByZXBhaXJUb29sQ2FsbCxcbiAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgZXhwZXJpbWVudGFsX2NvbnRleHQsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBzdGVwUmVxdWVzdCA9IHJlcXVlc3QgPz8ge307XG4gICAgICAgICAgY29uc3Qgc3RlcFRvb2xDYWxsczogVHlwZWRUb29sQ2FsbDxUT09MUz5bXSA9IFtdO1xuICAgICAgICAgIGNvbnN0IHN0ZXBUb29sT3V0cHV0czogVG9vbE91dHB1dDxUT09MUz5bXSA9IFtdO1xuICAgICAgICAgIGxldCB3YXJuaW5nczogTGFuZ3VhZ2VNb2RlbFYyQ2FsbFdhcm5pbmdbXSB8IHVuZGVmaW5lZDtcblxuICAgICAgICAgIGNvbnN0IGFjdGl2ZVRvb2xDYWxsVG9vbE5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG5cbiAgICAgICAgICBsZXQgc3RlcEZpbmlzaFJlYXNvbjogRmluaXNoUmVhc29uID0gJ3Vua25vd24nO1xuICAgICAgICAgIGxldCBzdGVwVXNhZ2U6IExhbmd1YWdlTW9kZWxVc2FnZSA9IHtcbiAgICAgICAgICAgIGlucHV0VG9rZW5zOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvdXRwdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHRvdGFsVG9rZW5zOiB1bmRlZmluZWQsXG4gICAgICAgICAgfTtcbiAgICAgICAgICBsZXQgc3RlcFByb3ZpZGVyTWV0YWRhdGE6IFByb3ZpZGVyTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgbGV0IHN0ZXBGaXJzdENodW5rID0gdHJ1ZTtcbiAgICAgICAgICBsZXQgc3RlcFJlc3BvbnNlOiB7IGlkOiBzdHJpbmc7IHRpbWVzdGFtcDogRGF0ZTsgbW9kZWxJZDogc3RyaW5nIH0gPSB7XG4gICAgICAgICAgICBpZDogZ2VuZXJhdGVJZCgpLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBjdXJyZW50RGF0ZSgpLFxuICAgICAgICAgICAgbW9kZWxJZDogbW9kZWwubW9kZWxJZCxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gcmF3IHRleHQgYXMgaXQgY29tZXMgZnJvbSB0aGUgcHJvdmlkZXIuIHJlY29yZGVkIGZvciB0ZWxlbWV0cnkuXG4gICAgICAgICAgbGV0IGFjdGl2ZVRleHQgPSAnJztcblxuICAgICAgICAgIHNlbGYuYWRkU3RyZWFtKFxuICAgICAgICAgICAgc3RyZWFtV2l0aFRvb2xSZXN1bHRzLnBpcGVUaHJvdWdoKFxuICAgICAgICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgICAgICAgICAgIFNpbmdsZVJlcXVlc3RUZXh0U3RyZWFtUGFydDxUT09MUz4sXG4gICAgICAgICAgICAgICAgVGV4dFN0cmVhbVBhcnQ8VE9PTFM+XG4gICAgICAgICAgICAgID4oe1xuICAgICAgICAgICAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAgICAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdzdHJlYW0tc3RhcnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdhcm5pbmdzID0gY2h1bmsud2FybmluZ3M7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gc3RyZWFtIHN0YXJ0IGNodW5rcyBhcmUgc2VudCBpbW1lZGlhdGVseSBhbmQgZG8gbm90IGNvdW50IGFzIGZpcnN0IGNodW5rXG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChzdGVwRmlyc3RDaHVuaykge1xuICAgICAgICAgICAgICAgICAgICAvLyBUZWxlbWV0cnkgZm9yIGZpcnN0IGNodW5rOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtc1RvRmlyc3RDaHVuayA9IG5vdygpIC0gc3RhcnRUaW1lc3RhbXBNcztcblxuICAgICAgICAgICAgICAgICAgICBzdGVwRmlyc3RDaHVuayA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5hZGRFdmVudCgnYWkuc3RyZWFtLmZpcnN0Q2h1bmsnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLm1zVG9GaXJzdENodW5rJzogbXNUb0ZpcnN0Q2h1bmssXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UubXNUb0ZpcnN0Q2h1bmsnOiBtc1RvRmlyc3RDaHVuayxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU3RlcCBzdGFydDpcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3RhcnQtc3RlcCcsXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdDogc3RlcFJlcXVlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgd2FybmluZ3M6IHdhcm5pbmdzID8/IFtdLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgY29uc3QgY2h1bmtUeXBlID0gY2h1bmsudHlwZTtcbiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2h1bmtUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RleHQtc3RhcnQnOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0ZXh0LWVuZCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGV4dC1kZWx0YSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoY2h1bmsuZGVsdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQtZGVsdGEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY2h1bmsuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGNodW5rLmRlbHRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBjaHVuay5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUZXh0ICs9IGNodW5rLmRlbHRhO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlYXNvbmluZy1zdGFydCc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlYXNvbmluZy1lbmQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlYXNvbmluZy1kZWx0YSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3JlYXNvbmluZy1kZWx0YScsXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogY2h1bmsuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjaHVuay5kZWx0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IGNodW5rLnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0b29sLWNhbGwnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSB0b29sIGNhbGxzIGZvciBvbkZpbmlzaCBjYWxsYmFjayBhbmQgdG9vbENhbGxzIHByb21pc2U6XG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFRvb2xDYWxscy5wdXNoKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Rvb2wtcmVzdWx0Jzoge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNodW5rLnByZWxpbWluYXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwVG9vbE91dHB1dHMucHVzaChjaHVuayk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICd0b29sLWVycm9yJzoge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7XG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFRvb2xPdXRwdXRzLnB1c2goY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVzcG9uc2UtbWV0YWRhdGEnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgc3RlcFJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNodW5rLmlkID8/IHN0ZXBSZXNwb25zZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogY2h1bmsudGltZXN0YW1wID8/IHN0ZXBSZXNwb25zZS50aW1lc3RhbXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbElkOiBjaHVuay5tb2RlbElkID8/IHN0ZXBSZXNwb25zZS5tb2RlbElkLFxuICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdmaW5pc2gnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogdG9vbCBleGVjdXRpb25zIG1pZ2h0IG5vdCBiZSBmaW5pc2hlZCB5ZXQgd2hlbiB0aGUgZmluaXNoIGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgdXNhZ2UgYW5kIGZpbmlzaCByZWFzb24gZm9yIHByb21pc2VzIGFuZCBvbkZpbmlzaCBjYWxsYmFjazpcbiAgICAgICAgICAgICAgICAgICAgICBzdGVwVXNhZ2UgPSBjaHVuay51c2FnZTtcbiAgICAgICAgICAgICAgICAgICAgICBzdGVwRmluaXNoUmVhc29uID0gY2h1bmsuZmluaXNoUmVhc29uO1xuICAgICAgICAgICAgICAgICAgICAgIHN0ZXBQcm92aWRlck1ldGFkYXRhID0gY2h1bmsucHJvdmlkZXJNZXRhZGF0YTtcblxuICAgICAgICAgICAgICAgICAgICAgIC8vIFRlbGVtZXRyeSBmb3IgZmluaXNoIGV2ZW50IHRpbWluZ1xuICAgICAgICAgICAgICAgICAgICAgIC8vIChzaW5jZSB0b29sIGV4ZWN1dGlvbnMgY2FuIHRha2UgbG9uZ2VyIGFuZCBkaXN0b3J0IGNhbGN1bGF0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtc1RvRmluaXNoID0gbm93KCkgLSBzdGFydFRpbWVzdGFtcE1zO1xuICAgICAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5hZGRFdmVudCgnYWkuc3RyZWFtLmZpbmlzaCcpO1xuICAgICAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5tc1RvRmluaXNoJzogbXNUb0ZpbmlzaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5hdmdPdXRwdXRUb2tlbnNQZXJTZWNvbmQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAoMTAwMCAqIChzdGVwVXNhZ2Uub3V0cHV0VG9rZW5zID8/IDApKSAvIG1zVG9GaW5pc2gsXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2ZpbGUnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvdXJjZSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1zdGFydCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUb29sQ2FsbFRvb2xOYW1lc1tjaHVuay5pZF0gPSBjaHVuay50b29sTmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2wgPSB0b29scz8uW2NodW5rLnRvb2xOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbD8ub25JbnB1dFN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRvb2wub25JbnB1dFN0YXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBzdGVwSW5wdXRNZXNzYWdlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnRTaWduYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmNodW5rLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHluYW1pYzogdG9vbD8udHlwZSA9PT0gJ2R5bmFtaWMnLFxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1lbmQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFjdGl2ZVRvb2xDYWxsVG9vbE5hbWVzW2NodW5rLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1kZWx0YSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b29sTmFtZSA9IGFjdGl2ZVRvb2xDYWxsVG9vbE5hbWVzW2NodW5rLmlkXTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b29sID0gdG9vbHM/Llt0b29sTmFtZV07XG5cbiAgICAgICAgICAgICAgICAgICAgICBpZiAodG9vbD8ub25JbnB1dERlbHRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRvb2wub25JbnB1dERlbHRhKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRUZXh0RGVsdGE6IGNodW5rLmRlbHRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBjaHVuay5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXM6IHN0ZXBJbnB1dE1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZXJpbWVudGFsX2NvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXJyb3InOiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICBzdGVwRmluaXNoUmVhc29uID0gJ2Vycm9yJztcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Jhdyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZVJhd0NodW5rcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IGNodW5rVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gY2h1bmsgdHlwZTogJHtleGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgLy8gaW52b2tlIG9uRmluaXNoIGNhbGxiYWNrIGFuZCByZXNvbHZlIHRvb2xSZXN1bHRzIHByb21pc2Ugd2hlbiB0aGUgc3RyZWFtIGlzIGFib3V0IHRvIGNsb3NlOlxuICAgICAgICAgICAgICAgIGFzeW5jIGZsdXNoKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZXBUb29sQ2FsbHNKc29uID1cbiAgICAgICAgICAgICAgICAgICAgc3RlcFRvb2xDYWxscy5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgICAgICAgPyBKU09OLnN0cmluZ2lmeShzdGVwVG9vbENhbGxzKVxuICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgICAvLyByZWNvcmQgdGVsZW1ldHJ5IGluZm9ybWF0aW9uIGZpcnN0IHRvIGVuc3VyZSBiZXN0IGVmZm9ydCB0aW1pbmdcbiAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuZmluaXNoUmVhc29uJzogc3RlcEZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnRleHQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PiBhY3RpdmVUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudG9vbENhbGxzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogKCkgPT4gc3RlcFRvb2xDYWxsc0pzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5pZCc6IHN0ZXBSZXNwb25zZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLm1vZGVsJzogc3RlcFJlc3BvbnNlLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS50aW1lc3RhbXAnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBSZXNwb25zZS50aW1lc3RhbXAudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnByb3ZpZGVyTWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHN0ZXBQcm92aWRlck1ldGFkYXRhKSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuaW5wdXRUb2tlbnMnOiBzdGVwVXNhZ2UuaW5wdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS5vdXRwdXRUb2tlbnMnOiBzdGVwVXNhZ2Uub3V0cHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UudG90YWxUb2tlbnMnOiBzdGVwVXNhZ2UudG90YWxUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS5yZWFzb25pbmdUb2tlbnMnOiBzdGVwVXNhZ2UucmVhc29uaW5nVG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuY2FjaGVkSW5wdXRUb2tlbnMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBVc2FnZS5jYWNoZWRJbnB1dFRva2VucyxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFuZGFyZGl6ZWQgZ2VuLWFpIGxsbSBzcGFuIGF0dHJpYnV0ZXM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVzcG9uc2UuZmluaXNoX3JlYXNvbnMnOiBbc3RlcEZpbmlzaFJlYXNvbl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVzcG9uc2UuaWQnOiBzdGVwUmVzcG9uc2UuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdnZW5fYWkucmVzcG9uc2UubW9kZWwnOiBzdGVwUmVzcG9uc2UubW9kZWxJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dlbl9haS51c2FnZS5pbnB1dF90b2tlbnMnOiBzdGVwVXNhZ2UuaW5wdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdnZW5fYWkudXNhZ2Uub3V0cHV0X3Rva2Vucyc6IHN0ZXBVc2FnZS5vdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGVycm9yIHNldHRpbmcgdGVsZW1ldHJ5IGF0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZpbmlzaCBkb1N0cmVhbVNwYW4gYmVmb3JlIG90aGVyIG9wZXJhdGlvbnMgZm9yIGNvcnJlY3QgdGltaW5nOlxuICAgICAgICAgICAgICAgICAgICBkb1N0cmVhbVNwYW4uZW5kKCk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmaW5pc2gtc3RlcCcsXG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogc3RlcEZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAgICAgdXNhZ2U6IHN0ZXBVc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogc3RlcFByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgLi4uc3RlcFJlc3BvbnNlLFxuICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlPy5oZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkVXNhZ2UgPSBhZGRMYW5ndWFnZU1vZGVsVXNhZ2UodXNhZ2UsIHN0ZXBVc2FnZSk7XG5cbiAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBzdGVwIHRvIGJlIGZ1bGx5IHByb2Nlc3NlZCBieSB0aGUgZXZlbnQgcHJvY2Vzc29yXG4gICAgICAgICAgICAgICAgICAvLyB0byBlbnN1cmUgdGhhdCB0aGUgcmVjb3JkZWQgc3RlcHMgYXJlIGNvbXBsZXRlOlxuICAgICAgICAgICAgICAgICAgYXdhaXQgc3RlcEZpbmlzaC5wcm9taXNlO1xuXG4gICAgICAgICAgICAgICAgICBjb25zdCBjbGllbnRUb29sQ2FsbHMgPSBzdGVwVG9vbENhbGxzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgdG9vbENhbGwgPT4gdG9vbENhbGwucHJvdmlkZXJFeGVjdXRlZCAhPT0gdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICBjb25zdCBjbGllbnRUb29sT3V0cHV0cyA9IHN0ZXBUb29sT3V0cHV0cy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgIHRvb2xPdXRwdXQgPT4gdG9vbE91dHB1dC5wcm92aWRlckV4ZWN1dGVkICE9PSB0cnVlLFxuICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBjbGllbnRUb29sQ2FsbHMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgICAgICAgICAgICAvLyBhbGwgY3VycmVudCB0b29sIGNhbGxzIGhhdmUgb3V0cHV0cyAoaW5jbC4gZXhlY3V0aW9uIGVycm9ycyk6XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudFRvb2xPdXRwdXRzLmxlbmd0aCA9PT0gY2xpZW50VG9vbENhbGxzLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgICAgICAvLyBjb250aW51ZSB1bnRpbCBhIHN0b3AgY29uZGl0aW9uIGlzIG1ldDpcbiAgICAgICAgICAgICAgICAgICAgIShhd2FpdCBpc1N0b3BDb25kaXRpb25NZXQoe1xuICAgICAgICAgICAgICAgICAgICAgIHN0b3BDb25kaXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgIHN0ZXBzOiByZWNvcmRlZFN0ZXBzLFxuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgdG8gbWVzc2FnZXMgZm9yIHRoZSBuZXh0IHN0ZXA6XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlTWVzc2FnZXMucHVzaChcbiAgICAgICAgICAgICAgICAgICAgICAuLi50b1Jlc3BvbnNlTWVzc2FnZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHRyYW5zZm9ybWVkIGNvbnRlbnQgdG8gY3JlYXRlIHRoZSBtZXNzYWdlcyBmb3IgdGhlIG5leHQgc3RlcDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkZWRTdGVwc1tyZWNvcmRlZFN0ZXBzLmxlbmd0aCAtIDFdLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29scyxcbiAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHN0cmVhbVN0ZXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0ZXA6IGN1cnJlbnRTdGVwICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlTWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2FnZTogY29tYmluZWRVc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbG9zZVN0cmVhbSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmaW5pc2gnLFxuICAgICAgICAgICAgICAgICAgICAgIGZpbmlzaFJlYXNvbjogc3RlcEZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgICAgICAgICAgICB0b3RhbFVzYWdlOiBjb21iaW5lZFVzYWdlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsb3NlU3RyZWFtKCk7IC8vIGNsb3NlIHRoZSBzdGl0Y2hhYmxlIHN0cmVhbVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIHRoZSBpbml0aWFsIHN0cmVhbSB0byB0aGUgc3RpdGNoYWJsZSBzdHJlYW1cbiAgICAgICAgYXdhaXQgc3RyZWFtU3RlcCh7XG4gICAgICAgICAgY3VycmVudFN0ZXA6IDAsXG4gICAgICAgICAgcmVzcG9uc2VNZXNzYWdlczogW10sXG4gICAgICAgICAgdXNhZ2U6IHtcbiAgICAgICAgICAgIGlucHV0VG9rZW5zOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvdXRwdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHRvdGFsVG9rZW5zOiB1bmRlZmluZWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIC8vIGFkZCBhbiBlcnJvciBzdHJlYW0gcGFydCBhbmQgY2xvc2UgdGhlIHN0cmVhbXM6XG4gICAgICBzZWxmLmFkZFN0cmVhbShcbiAgICAgICAgbmV3IFJlYWRhYmxlU3RyZWFtKHtcbiAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAnZXJyb3InLCBlcnJvciB9KTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICBzZWxmLmNsb3NlU3RyZWFtKCk7XG4gICAgfSk7XG4gIH1cblxuICBnZXQgc3RlcHMoKSB7XG4gICAgLy8gd2hlbiBhbnkgb2YgdGhlIHByb21pc2VzIGFyZSBhY2Nlc3NlZCwgdGhlIHN0cmVhbSBpcyBjb25zdW1lZFxuICAgIC8vIHNvIGl0IHJlc29sdmVzIHdpdGhvdXQgbmVlZGluZyB0byBjb25zdW1lIHRoZSBzdHJlYW0gc2VwYXJhdGVseVxuICAgIHRoaXMuY29uc3VtZVN0cmVhbSgpO1xuXG4gICAgcmV0dXJuIHRoaXMuX3N0ZXBzLnByb21pc2U7XG4gIH1cblxuICBwcml2YXRlIGdldCBmaW5hbFN0ZXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RlcHMudGhlbihzdGVwcyA9PiBzdGVwc1tzdGVwcy5sZW5ndGggLSAxXSk7XG4gIH1cblxuICBnZXQgY29udGVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAudGhlbihzdGVwID0+IHN0ZXAuY29udGVudCk7XG4gIH1cblxuICBnZXQgd2FybmluZ3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLndhcm5pbmdzKTtcbiAgfVxuXG4gIGdldCBwcm92aWRlck1ldGFkYXRhKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC5wcm92aWRlck1ldGFkYXRhKTtcbiAgfVxuXG4gIGdldCB0ZXh0KCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC50ZXh0KTtcbiAgfVxuXG4gIGdldCByZWFzb25pbmdUZXh0KCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC5yZWFzb25pbmdUZXh0KTtcbiAgfVxuXG4gIGdldCByZWFzb25pbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLnJlYXNvbmluZyk7XG4gIH1cblxuICBnZXQgc291cmNlcygpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAudGhlbihzdGVwID0+IHN0ZXAuc291cmNlcyk7XG4gIH1cblxuICBnZXQgZmlsZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLmZpbGVzKTtcbiAgfVxuXG4gIGdldCB0b29sQ2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLnRvb2xDYWxscyk7XG4gIH1cblxuICBnZXQgc3RhdGljVG9vbENhbGxzKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC5zdGF0aWNUb29sQ2FsbHMpO1xuICB9XG5cbiAgZ2V0IGR5bmFtaWNUb29sQ2FsbHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLmR5bmFtaWNUb29sQ2FsbHMpO1xuICB9XG5cbiAgZ2V0IHRvb2xSZXN1bHRzKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC50b29sUmVzdWx0cyk7XG4gIH1cblxuICBnZXQgc3RhdGljVG9vbFJlc3VsdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLnN0YXRpY1Rvb2xSZXN1bHRzKTtcbiAgfVxuXG4gIGdldCBkeW5hbWljVG9vbFJlc3VsdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLmR5bmFtaWNUb29sUmVzdWx0cyk7XG4gIH1cblxuICBnZXQgdXNhZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluYWxTdGVwLnRoZW4oc3RlcCA9PiBzdGVwLnVzYWdlKTtcbiAgfVxuXG4gIGdldCByZXF1ZXN0KCkge1xuICAgIHJldHVybiB0aGlzLmZpbmFsU3RlcC50aGVuKHN0ZXAgPT4gc3RlcC5yZXF1ZXN0KTtcbiAgfVxuXG4gIGdldCByZXNwb25zZSgpIHtcbiAgICByZXR1cm4gdGhpcy5maW5hbFN0ZXAudGhlbihzdGVwID0+IHN0ZXAucmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0IHRvdGFsVXNhZ2UoKSB7XG4gICAgLy8gd2hlbiBhbnkgb2YgdGhlIHByb21pc2VzIGFyZSBhY2Nlc3NlZCwgdGhlIHN0cmVhbSBpcyBjb25zdW1lZFxuICAgIC8vIHNvIGl0IHJlc29sdmVzIHdpdGhvdXQgbmVlZGluZyB0byBjb25zdW1lIHRoZSBzdHJlYW0gc2VwYXJhdGVseVxuICAgIHRoaXMuY29uc3VtZVN0cmVhbSgpO1xuXG4gICAgcmV0dXJuIHRoaXMuX3RvdGFsVXNhZ2UucHJvbWlzZTtcbiAgfVxuXG4gIGdldCBmaW5pc2hSZWFzb24oKSB7XG4gICAgLy8gd2hlbiBhbnkgb2YgdGhlIHByb21pc2VzIGFyZSBhY2Nlc3NlZCwgdGhlIHN0cmVhbSBpcyBjb25zdW1lZFxuICAgIC8vIHNvIGl0IHJlc29sdmVzIHdpdGhvdXQgbmVlZGluZyB0byBjb25zdW1lIHRoZSBzdHJlYW0gc2VwYXJhdGVseVxuICAgIHRoaXMuY29uc3VtZVN0cmVhbSgpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2ZpbmlzaFJlYXNvbi5wcm9taXNlO1xuICB9XG5cbiAgLyoqXG5TcGxpdCBvdXQgYSBuZXcgc3RyZWFtIGZyb20gdGhlIG9yaWdpbmFsIHN0cmVhbS5cblRoZSBvcmlnaW5hbCBzdHJlYW0gaXMgcmVwbGFjZWQgdG8gYWxsb3cgZm9yIGZ1cnRoZXIgc3BsaXR0aW5nLFxuc2luY2Ugd2UgZG8gbm90IGtub3cgaG93IG1hbnkgdGltZXMgdGhlIHN0cmVhbSB3aWxsIGJlIHNwbGl0LlxuXG5Ob3RlOiB0aGlzIGxlYWRzIHRvIGJ1ZmZlcmluZyB0aGUgc3RyZWFtIGNvbnRlbnQgb24gdGhlIHNlcnZlci5cbkhvd2V2ZXIsIHRoZSBMTE0gcmVzdWx0cyBhcmUgZXhwZWN0ZWQgdG8gYmUgc21hbGwgZW5vdWdoIHRvIG5vdCBjYXVzZSBpc3N1ZXMuXG4gICAqL1xuICBwcml2YXRlIHRlZVN0cmVhbSgpIHtcbiAgICBjb25zdCBbc3RyZWFtMSwgc3RyZWFtMl0gPSB0aGlzLmJhc2VTdHJlYW0udGVlKCk7XG4gICAgdGhpcy5iYXNlU3RyZWFtID0gc3RyZWFtMjtcbiAgICByZXR1cm4gc3RyZWFtMTtcbiAgfVxuXG4gIGdldCB0ZXh0U3RyZWFtKCk6IEFzeW5jSXRlcmFibGVTdHJlYW08c3RyaW5nPiB7XG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0oXG4gICAgICB0aGlzLnRlZVN0cmVhbSgpLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPEVucmljaGVkU3RyZWFtUGFydDxUT09MUywgUEFSVElBTF9PVVRQVVQ+LCBzdHJpbmc+KHtcbiAgICAgICAgICB0cmFuc2Zvcm0oeyBwYXJ0IH0sIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICd0ZXh0LWRlbHRhJykge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUocGFydC50ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICksXG4gICAgKTtcbiAgfVxuXG4gIGdldCBmdWxsU3RyZWFtKCk6IEFzeW5jSXRlcmFibGVTdHJlYW08VGV4dFN0cmVhbVBhcnQ8VE9PTFM+PiB7XG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0oXG4gICAgICB0aGlzLnRlZVN0cmVhbSgpLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgICAgIEVucmljaGVkU3RyZWFtUGFydDxUT09MUywgUEFSVElBTF9PVVRQVVQ+LFxuICAgICAgICAgIFRleHRTdHJlYW1QYXJ0PFRPT0xTPlxuICAgICAgICA+KHtcbiAgICAgICAgICB0cmFuc2Zvcm0oeyBwYXJ0IH0sIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShwYXJ0KTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgICksXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGNvbnN1bWVTdHJlYW0ob3B0aW9ucz86IENvbnN1bWVTdHJlYW1PcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGNvbnN1bWVTdHJlYW0oe1xuICAgICAgICBzdHJlYW06IHRoaXMuZnVsbFN0cmVhbSxcbiAgICAgICAgb25FcnJvcjogb3B0aW9ucz8ub25FcnJvcixcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBvcHRpb25zPy5vbkVycm9yPy4oZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIGdldCBleHBlcmltZW50YWxfcGFydGlhbE91dHB1dFN0cmVhbSgpOiBBc3luY0l0ZXJhYmxlU3RyZWFtPFBBUlRJQUxfT1VUUFVUPiB7XG4gICAgaWYgKHRoaXMub3V0cHV0ID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBOb091dHB1dFNwZWNpZmllZEVycm9yKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0oXG4gICAgICB0aGlzLnRlZVN0cmVhbSgpLnBpcGVUaHJvdWdoKFxuICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgICAgIEVucmljaGVkU3RyZWFtUGFydDxUT09MUywgUEFSVElBTF9PVVRQVVQ+LFxuICAgICAgICAgIFBBUlRJQUxfT1VUUFVUXG4gICAgICAgID4oe1xuICAgICAgICAgIHRyYW5zZm9ybSh7IHBhcnRpYWxPdXRwdXQgfSwgY29udHJvbGxlcikge1xuICAgICAgICAgICAgaWYgKHBhcnRpYWxPdXRwdXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUocGFydGlhbE91dHB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICApLFxuICAgICk7XG4gIH1cblxuICB0b1VJTWVzc2FnZVN0cmVhbTxVSV9NRVNTQUdFIGV4dGVuZHMgVUlNZXNzYWdlPih7XG4gICAgb3JpZ2luYWxNZXNzYWdlcyxcbiAgICBnZW5lcmF0ZU1lc3NhZ2VJZCxcbiAgICBvbkZpbmlzaCxcbiAgICBtZXNzYWdlTWV0YWRhdGEsXG4gICAgc2VuZFJlYXNvbmluZyA9IHRydWUsXG4gICAgc2VuZFNvdXJjZXMgPSBmYWxzZSxcbiAgICBzZW5kU3RhcnQgPSB0cnVlLFxuICAgIHNlbmRGaW5pc2ggPSB0cnVlLFxuICAgIG9uRXJyb3IgPSBnZXRFcnJvck1lc3NhZ2UsXG4gIH06IFVJTWVzc2FnZVN0cmVhbU9wdGlvbnM8VUlfTUVTU0FHRT4gPSB7fSk6IEFzeW5jSXRlcmFibGVTdHJlYW08XG4gICAgSW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPlxuICA+IHtcbiAgICBjb25zdCByZXNwb25zZU1lc3NhZ2VJZCA9XG4gICAgICBnZW5lcmF0ZU1lc3NhZ2VJZCAhPSBudWxsXG4gICAgICAgID8gZ2V0UmVzcG9uc2VVSU1lc3NhZ2VJZCh7XG4gICAgICAgICAgICBvcmlnaW5hbE1lc3NhZ2VzLFxuICAgICAgICAgICAgcmVzcG9uc2VNZXNzYWdlSWQ6IGdlbmVyYXRlTWVzc2FnZUlkLFxuICAgICAgICAgIH0pXG4gICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgY29uc3QgdG9vbE5hbWVzQnlDYWxsSWQ6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcblxuICAgIGNvbnN0IGlzRHluYW1pYyA9ICh0b29sQ2FsbElkOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHRvb2xOYW1lID0gdG9vbE5hbWVzQnlDYWxsSWRbdG9vbENhbGxJZF07XG4gICAgICBjb25zdCBkeW5hbWljID0gdGhpcy50b29scz8uW3Rvb2xOYW1lXT8udHlwZSA9PT0gJ2R5bmFtaWMnO1xuICAgICAgcmV0dXJuIGR5bmFtaWMgPyB0cnVlIDogdW5kZWZpbmVkOyAvLyBvbmx5IHNlbmQgd2hlbiBkeW5hbWljIHRvIHJlZHVjZSBkYXRhIHRyYW5zZmVyXG4gICAgfTtcblxuICAgIGNvbnN0IGJhc2VTdHJlYW0gPSB0aGlzLmZ1bGxTdHJlYW0ucGlwZVRocm91Z2goXG4gICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgICBUZXh0U3RyZWFtUGFydDxUT09MUz4sXG4gICAgICAgIFVJTWVzc2FnZUNodW5rPFxuICAgICAgICAgIEluZmVyVUlNZXNzYWdlTWV0YWRhdGE8VUlfTUVTU0FHRT4sXG4gICAgICAgICAgSW5mZXJVSU1lc3NhZ2VEYXRhPFVJX01FU1NBR0U+XG4gICAgICAgID5cbiAgICAgID4oe1xuICAgICAgICB0cmFuc2Zvcm06IGFzeW5jIChwYXJ0LCBjb250cm9sbGVyKSA9PiB7XG4gICAgICAgICAgY29uc3QgbWVzc2FnZU1ldGFkYXRhVmFsdWUgPSBtZXNzYWdlTWV0YWRhdGE/Lih7IHBhcnQgfSk7XG5cbiAgICAgICAgICBjb25zdCBwYXJ0VHlwZSA9IHBhcnQudHlwZTtcbiAgICAgICAgICBzd2l0Y2ggKHBhcnRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICd0ZXh0LXN0YXJ0Jzoge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0LXN0YXJ0JyxcbiAgICAgICAgICAgICAgICBpZDogcGFydC5pZCxcbiAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndGV4dC1kZWx0YSc6IHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dC1kZWx0YScsXG4gICAgICAgICAgICAgICAgaWQ6IHBhcnQuaWQsXG4gICAgICAgICAgICAgICAgZGVsdGE6IHBhcnQudGV4dCxcbiAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndGV4dC1lbmQnOiB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQtZW5kJyxcbiAgICAgICAgICAgICAgICBpZDogcGFydC5pZCxcbiAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAncmVhc29uaW5nLXN0YXJ0Jzoge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmctc3RhcnQnLFxuICAgICAgICAgICAgICAgIGlkOiBwYXJ0LmlkLFxuICAgICAgICAgICAgICAgIC4uLihwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdyZWFzb25pbmctZGVsdGEnOiB7XG4gICAgICAgICAgICAgIGlmIChzZW5kUmVhc29uaW5nKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmctZGVsdGEnLFxuICAgICAgICAgICAgICAgICAgaWQ6IHBhcnQuaWQsXG4gICAgICAgICAgICAgICAgICBkZWx0YTogcGFydC50ZXh0LFxuICAgICAgICAgICAgICAgICAgLi4uKHBhcnQucHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAncmVhc29uaW5nLWVuZCc6IHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAncmVhc29uaW5nLWVuZCcsXG4gICAgICAgICAgICAgICAgaWQ6IHBhcnQuaWQsXG4gICAgICAgICAgICAgICAgLi4uKHBhcnQucHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJNZXRhZGF0YTogcGFydC5wcm92aWRlck1ldGFkYXRhIH1cbiAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2ZpbGUnOiB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2ZpbGUnLFxuICAgICAgICAgICAgICAgIG1lZGlhVHlwZTogcGFydC5maWxlLm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICB1cmw6IGBkYXRhOiR7cGFydC5maWxlLm1lZGlhVHlwZX07YmFzZTY0LCR7cGFydC5maWxlLmJhc2U2NH1gLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3NvdXJjZSc6IHtcbiAgICAgICAgICAgICAgaWYgKHNlbmRTb3VyY2VzICYmIHBhcnQuc291cmNlVHlwZSA9PT0gJ3VybCcpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ3NvdXJjZS11cmwnLFxuICAgICAgICAgICAgICAgICAgc291cmNlSWQ6IHBhcnQuaWQsXG4gICAgICAgICAgICAgICAgICB1cmw6IHBhcnQudXJsLFxuICAgICAgICAgICAgICAgICAgdGl0bGU6IHBhcnQudGl0bGUsXG4gICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKHNlbmRTb3VyY2VzICYmIHBhcnQuc291cmNlVHlwZSA9PT0gJ2RvY3VtZW50Jykge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAnc291cmNlLWRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBwYXJ0LmlkLFxuICAgICAgICAgICAgICAgICAgbWVkaWFUeXBlOiBwYXJ0Lm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICAgIHRpdGxlOiBwYXJ0LnRpdGxlLFxuICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHBhcnQuZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICd0b29sLWlucHV0LXN0YXJ0Jzoge1xuICAgICAgICAgICAgICB0b29sTmFtZXNCeUNhbGxJZFtwYXJ0LmlkXSA9IHBhcnQudG9vbE5hbWU7XG4gICAgICAgICAgICAgIGNvbnN0IGR5bmFtaWMgPSBpc0R5bmFtaWMocGFydC5pZCk7XG5cbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1pbnB1dC1zdGFydCcsXG4gICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC5pZCxcbiAgICAgICAgICAgICAgICB0b29sTmFtZTogcGFydC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlckV4ZWN1dGVkICE9IG51bGxcbiAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlckV4ZWN1dGVkOiBwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQgfVxuICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgLi4uKGR5bmFtaWMgIT0gbnVsbCA/IHsgZHluYW1pYyB9IDoge30pLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3Rvb2wtaW5wdXQtZGVsdGEnOiB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtZGVsdGEnLFxuICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHBhcnQuaWQsXG4gICAgICAgICAgICAgICAgaW5wdXRUZXh0RGVsdGE6IHBhcnQuZGVsdGEsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1jYWxsJzoge1xuICAgICAgICAgICAgICB0b29sTmFtZXNCeUNhbGxJZFtwYXJ0LnRvb2xDYWxsSWRdID0gcGFydC50b29sTmFtZTtcbiAgICAgICAgICAgICAgY29uc3QgZHluYW1pYyA9IGlzRHluYW1pYyhwYXJ0LnRvb2xDYWxsSWQpO1xuXG4gICAgICAgICAgICAgIGlmIChwYXJ0LmludmFsaWQpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtZXJyb3InLFxuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogcGFydC5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIC4uLihwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJFeGVjdXRlZDogcGFydC5wcm92aWRlckV4ZWN1dGVkIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgICAgLi4uKGR5bmFtaWMgIT0gbnVsbCA/IHsgZHluYW1pYyB9IDoge30pLFxuICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBvbkVycm9yKHBhcnQuZXJyb3IpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1pbnB1dC1hdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHBhcnQudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogcGFydC5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIC4uLihwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJFeGVjdXRlZDogcGFydC5wcm92aWRlckV4ZWN1dGVkIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyTWV0YWRhdGE6IHBhcnQucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgICAgLi4uKGR5bmFtaWMgIT0gbnVsbCA/IHsgZHluYW1pYyB9IDoge30pLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3Rvb2wtcmVzdWx0Jzoge1xuICAgICAgICAgICAgICBjb25zdCBkeW5hbWljID0gaXNEeW5hbWljKHBhcnQudG9vbENhbGxJZCk7XG5cbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1vdXRwdXQtYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgb3V0cHV0OiBwYXJ0Lm91dHB1dCxcbiAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlckV4ZWN1dGVkICE9IG51bGxcbiAgICAgICAgICAgICAgICAgID8geyBwcm92aWRlckV4ZWN1dGVkOiBwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQgfVxuICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgLi4uKHBhcnQucHJlbGltaW5hcnkgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgPyB7IHByZWxpbWluYXJ5OiBwYXJ0LnByZWxpbWluYXJ5IH1cbiAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgIC4uLihkeW5hbWljICE9IG51bGwgPyB7IGR5bmFtaWMgfSA6IHt9KSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICd0b29sLWVycm9yJzoge1xuICAgICAgICAgICAgICBjb25zdCBkeW5hbWljID0gaXNEeW5hbWljKHBhcnQudG9vbENhbGxJZCk7XG5cbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1vdXRwdXQtZXJyb3InLFxuICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHBhcnQudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICBlcnJvclRleHQ6IG9uRXJyb3IocGFydC5lcnJvciksXG4gICAgICAgICAgICAgICAgLi4uKHBhcnQucHJvdmlkZXJFeGVjdXRlZCAhPSBudWxsXG4gICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJFeGVjdXRlZDogcGFydC5wcm92aWRlckV4ZWN1dGVkIH1cbiAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgIC4uLihkeW5hbWljICE9IG51bGwgPyB7IGR5bmFtaWMgfSA6IHt9KSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdlcnJvcic6IHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgIGVycm9yVGV4dDogb25FcnJvcihwYXJ0LmVycm9yKSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzdGFydC1zdGVwJzoge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAnc3RhcnQtc3RlcCcgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdmaW5pc2gtc3RlcCc6IHtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ2ZpbmlzaC1zdGVwJyB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3N0YXJ0Jzoge1xuICAgICAgICAgICAgICBpZiAoc2VuZFN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdGFydCcsXG4gICAgICAgICAgICAgICAgICAuLi4obWVzc2FnZU1ldGFkYXRhVmFsdWUgIT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICA/IHsgbWVzc2FnZU1ldGFkYXRhOiBtZXNzYWdlTWV0YWRhdGFWYWx1ZSB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgICAgLi4uKHJlc3BvbnNlTWVzc2FnZUlkICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IG1lc3NhZ2VJZDogcmVzcG9uc2VNZXNzYWdlSWQgfVxuICAgICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnZmluaXNoJzoge1xuICAgICAgICAgICAgICBpZiAoc2VuZEZpbmlzaCkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAnZmluaXNoJyxcbiAgICAgICAgICAgICAgICAgIC4uLihtZXNzYWdlTWV0YWRhdGFWYWx1ZSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8geyBtZXNzYWdlTWV0YWRhdGE6IG1lc3NhZ2VNZXRhZGF0YVZhbHVlIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2Fib3J0Jzoge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUocGFydCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICd0b29sLWlucHV0LWVuZCc6IHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3Jhdyc6IHtcbiAgICAgICAgICAgICAgLy8gUmF3IGNodW5rcyBhcmUgbm90IGluY2x1ZGVkIGluIFVJIG1lc3NhZ2Ugc3RyZWFtc1xuICAgICAgICAgICAgICAvLyBhcyB0aGV5IGNvbnRhaW4gcHJvdmlkZXItc3BlY2lmaWMgZGF0YSBmb3IgZGV2ZWxvcGVyIHVzZVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICBjb25zdCBleGhhdXN0aXZlQ2hlY2s6IG5ldmVyID0gcGFydFR5cGU7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjaHVuayB0eXBlOiAke2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBzdGFydCBhbmQgZmluaXNoIGV2ZW50cyBhbHJlYWR5IGhhdmUgbWV0YWRhdGFcbiAgICAgICAgICAvLyBzbyB3ZSBvbmx5IG5lZWQgdG8gc2VuZCBtZXRhZGF0YSBmb3Igb3RoZXIgcGFydHNcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBtZXNzYWdlTWV0YWRhdGFWYWx1ZSAhPSBudWxsICYmXG4gICAgICAgICAgICBwYXJ0VHlwZSAhPT0gJ3N0YXJ0JyAmJlxuICAgICAgICAgICAgcGFydFR5cGUgIT09ICdmaW5pc2gnXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICB0eXBlOiAnbWVzc2FnZS1tZXRhZGF0YScsXG4gICAgICAgICAgICAgIG1lc3NhZ2VNZXRhZGF0YTogbWVzc2FnZU1ldGFkYXRhVmFsdWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0oXG4gICAgICBoYW5kbGVVSU1lc3NhZ2VTdHJlYW1GaW5pc2g8VUlfTUVTU0FHRT4oe1xuICAgICAgICBzdHJlYW06IGJhc2VTdHJlYW0sXG4gICAgICAgIG1lc3NhZ2VJZDogcmVzcG9uc2VNZXNzYWdlSWQgPz8gZ2VuZXJhdGVNZXNzYWdlSWQ/LigpLFxuICAgICAgICBvcmlnaW5hbE1lc3NhZ2VzLFxuICAgICAgICBvbkZpbmlzaCxcbiAgICAgICAgb25FcnJvcixcbiAgICAgIH0pLFxuICAgICk7XG4gIH1cblxuICBwaXBlVUlNZXNzYWdlU3RyZWFtVG9SZXNwb25zZTxVSV9NRVNTQUdFIGV4dGVuZHMgVUlNZXNzYWdlPihcbiAgICByZXNwb25zZTogU2VydmVyUmVzcG9uc2UsXG4gICAge1xuICAgICAgb3JpZ2luYWxNZXNzYWdlcyxcbiAgICAgIGdlbmVyYXRlTWVzc2FnZUlkLFxuICAgICAgb25GaW5pc2gsXG4gICAgICBtZXNzYWdlTWV0YWRhdGEsXG4gICAgICBzZW5kUmVhc29uaW5nLFxuICAgICAgc2VuZFNvdXJjZXMsXG4gICAgICBzZW5kRmluaXNoLFxuICAgICAgc2VuZFN0YXJ0LFxuICAgICAgb25FcnJvcixcbiAgICAgIC4uLmluaXRcbiAgICB9OiBVSU1lc3NhZ2VTdHJlYW1SZXNwb25zZUluaXQgJiBVSU1lc3NhZ2VTdHJlYW1PcHRpb25zPFVJX01FU1NBR0U+ID0ge30sXG4gICkge1xuICAgIHBpcGVVSU1lc3NhZ2VTdHJlYW1Ub1Jlc3BvbnNlKHtcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgc3RyZWFtOiB0aGlzLnRvVUlNZXNzYWdlU3RyZWFtKHtcbiAgICAgICAgb3JpZ2luYWxNZXNzYWdlcyxcbiAgICAgICAgZ2VuZXJhdGVNZXNzYWdlSWQsXG4gICAgICAgIG9uRmluaXNoLFxuICAgICAgICBtZXNzYWdlTWV0YWRhdGEsXG4gICAgICAgIHNlbmRSZWFzb25pbmcsXG4gICAgICAgIHNlbmRTb3VyY2VzLFxuICAgICAgICBzZW5kRmluaXNoLFxuICAgICAgICBzZW5kU3RhcnQsXG4gICAgICAgIG9uRXJyb3IsXG4gICAgICB9KSxcbiAgICAgIC4uLmluaXQsXG4gICAgfSk7XG4gIH1cblxuICBwaXBlVGV4dFN0cmVhbVRvUmVzcG9uc2UocmVzcG9uc2U6IFNlcnZlclJlc3BvbnNlLCBpbml0PzogUmVzcG9uc2VJbml0KSB7XG4gICAgcGlwZVRleHRTdHJlYW1Ub1Jlc3BvbnNlKHtcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgdGV4dFN0cmVhbTogdGhpcy50ZXh0U3RyZWFtLFxuICAgICAgLi4uaW5pdCxcbiAgICB9KTtcbiAgfVxuXG4gIHRvVUlNZXNzYWdlU3RyZWFtUmVzcG9uc2U8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4oe1xuICAgIG9yaWdpbmFsTWVzc2FnZXMsXG4gICAgZ2VuZXJhdGVNZXNzYWdlSWQsXG4gICAgb25GaW5pc2gsXG4gICAgbWVzc2FnZU1ldGFkYXRhLFxuICAgIHNlbmRSZWFzb25pbmcsXG4gICAgc2VuZFNvdXJjZXMsXG4gICAgc2VuZEZpbmlzaCxcbiAgICBzZW5kU3RhcnQsXG4gICAgb25FcnJvcixcbiAgICAuLi5pbml0XG4gIH06IFVJTWVzc2FnZVN0cmVhbVJlc3BvbnNlSW5pdCAmXG4gICAgVUlNZXNzYWdlU3RyZWFtT3B0aW9uczxVSV9NRVNTQUdFPiA9IHt9KTogUmVzcG9uc2Uge1xuICAgIHJldHVybiBjcmVhdGVVSU1lc3NhZ2VTdHJlYW1SZXNwb25zZSh7XG4gICAgICBzdHJlYW06IHRoaXMudG9VSU1lc3NhZ2VTdHJlYW0oe1xuICAgICAgICBvcmlnaW5hbE1lc3NhZ2VzLFxuICAgICAgICBnZW5lcmF0ZU1lc3NhZ2VJZCxcbiAgICAgICAgb25GaW5pc2gsXG4gICAgICAgIG1lc3NhZ2VNZXRhZGF0YSxcbiAgICAgICAgc2VuZFJlYXNvbmluZyxcbiAgICAgICAgc2VuZFNvdXJjZXMsXG4gICAgICAgIHNlbmRGaW5pc2gsXG4gICAgICAgIHNlbmRTdGFydCxcbiAgICAgICAgb25FcnJvcixcbiAgICAgIH0pLFxuICAgICAgLi4uaW5pdCxcbiAgICB9KTtcbiAgfVxuXG4gIHRvVGV4dFN0cmVhbVJlc3BvbnNlKGluaXQ/OiBSZXNwb25zZUluaXQpOiBSZXNwb25zZSB7XG4gICAgcmV0dXJuIGNyZWF0ZVRleHRTdHJlYW1SZXNwb25zZSh7XG4gICAgICB0ZXh0U3RyZWFtOiB0aGlzLnRleHRTdHJlYW0sXG4gICAgICAuLi5pbml0LFxuICAgIH0pO1xuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVIZWFkZXJzKFxuICBoZWFkZXJzOiBIZWFkZXJzSW5pdCB8IHVuZGVmaW5lZCxcbiAgZGVmYXVsdEhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sXG4pOiBIZWFkZXJzIHtcbiAgY29uc3QgcmVzcG9uc2VIZWFkZXJzID0gbmV3IEhlYWRlcnMoaGVhZGVycyA/PyB7fSk7XG5cbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGVmYXVsdEhlYWRlcnMpKSB7XG4gICAgaWYgKCFyZXNwb25zZUhlYWRlcnMuaGFzKGtleSkpIHtcbiAgICAgIHJlc3BvbnNlSGVhZGVycy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3BvbnNlSGVhZGVycztcbn1cbiIsICJpbXBvcnQgeyBwcmVwYXJlSGVhZGVycyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1oZWFkZXJzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRleHRTdHJlYW1SZXNwb25zZSh7XG4gIHN0YXR1cyxcbiAgc3RhdHVzVGV4dCxcbiAgaGVhZGVycyxcbiAgdGV4dFN0cmVhbSxcbn06IFJlc3BvbnNlSW5pdCAmIHtcbiAgdGV4dFN0cmVhbTogUmVhZGFibGVTdHJlYW08c3RyaW5nPjtcbn0pOiBSZXNwb25zZSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UodGV4dFN0cmVhbS5waXBlVGhyb3VnaChuZXcgVGV4dEVuY29kZXJTdHJlYW0oKSksIHtcbiAgICBzdGF0dXM6IHN0YXR1cyA/PyAyMDAsXG4gICAgc3RhdHVzVGV4dCxcbiAgICBoZWFkZXJzOiBwcmVwYXJlSGVhZGVycyhoZWFkZXJzLCB7XG4gICAgICAnY29udGVudC10eXBlJzogJ3RleHQvcGxhaW47IGNoYXJzZXQ9dXRmLTgnLFxuICAgIH0pLFxuICB9KTtcbn1cbiIsICJpbXBvcnQgeyBTZXJ2ZXJSZXNwb25zZSB9IGZyb20gJ25vZGU6aHR0cCc7XG5cbi8qKlxuICogV3JpdGVzIHRoZSBjb250ZW50IG9mIGEgc3RyZWFtIHRvIGEgc2VydmVyIHJlc3BvbnNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gd3JpdGVUb1NlcnZlclJlc3BvbnNlKHtcbiAgcmVzcG9uc2UsXG4gIHN0YXR1cyxcbiAgc3RhdHVzVGV4dCxcbiAgaGVhZGVycyxcbiAgc3RyZWFtLFxufToge1xuICByZXNwb25zZTogU2VydmVyUmVzcG9uc2U7XG4gIHN0YXR1cz86IG51bWJlcjtcbiAgc3RhdHVzVGV4dD86IHN0cmluZztcbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlciB8IHN0cmluZ1tdPjtcbiAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5Pjtcbn0pOiB2b2lkIHtcbiAgcmVzcG9uc2Uud3JpdGVIZWFkKHN0YXR1cyA/PyAyMDAsIHN0YXR1c1RleHQsIGhlYWRlcnMpO1xuXG4gIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5nZXRSZWFkZXIoKTtcbiAgY29uc3QgcmVhZCA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgY29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcbiAgICAgICAgaWYgKGRvbmUpIGJyZWFrO1xuICAgICAgICByZXNwb25zZS53cml0ZSh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0gZmluYWxseSB7XG4gICAgICByZXNwb25zZS5lbmQoKTtcbiAgICB9XG4gIH07XG5cbiAgcmVhZCgpO1xufVxuIiwgImltcG9ydCB7IFNlcnZlclJlc3BvbnNlIH0gZnJvbSAnbm9kZTpodHRwJztcbmltcG9ydCB7IHByZXBhcmVIZWFkZXJzIH0gZnJvbSAnLi4vdXRpbC9wcmVwYXJlLWhlYWRlcnMnO1xuaW1wb3J0IHsgd3JpdGVUb1NlcnZlclJlc3BvbnNlIH0gZnJvbSAnLi4vdXRpbC93cml0ZS10by1zZXJ2ZXItcmVzcG9uc2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gcGlwZVRleHRTdHJlYW1Ub1Jlc3BvbnNlKHtcbiAgcmVzcG9uc2UsXG4gIHN0YXR1cyxcbiAgc3RhdHVzVGV4dCxcbiAgaGVhZGVycyxcbiAgdGV4dFN0cmVhbSxcbn06IHtcbiAgcmVzcG9uc2U6IFNlcnZlclJlc3BvbnNlO1xuICB0ZXh0U3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxzdHJpbmc+O1xufSAmIFJlc3BvbnNlSW5pdCk6IHZvaWQge1xuICB3cml0ZVRvU2VydmVyUmVzcG9uc2Uoe1xuICAgIHJlc3BvbnNlLFxuICAgIHN0YXR1cyxcbiAgICBzdGF0dXNUZXh0LFxuICAgIGhlYWRlcnM6IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgIHByZXBhcmVIZWFkZXJzKGhlYWRlcnMsIHtcbiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICd0ZXh0L3BsYWluOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgIH0pLmVudHJpZXMoKSxcbiAgICApLFxuICAgIHN0cmVhbTogdGV4dFN0cmVhbS5waXBlVGhyb3VnaChuZXcgVGV4dEVuY29kZXJTdHJlYW0oKSksXG4gIH0pO1xufVxuIiwgImV4cG9ydCBjbGFzcyBKc29uVG9Tc2VUcmFuc2Zvcm1TdHJlYW0gZXh0ZW5kcyBUcmFuc2Zvcm1TdHJlYW08dW5rbm93biwgc3RyaW5nPiB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHtcbiAgICAgIHRyYW5zZm9ybShwYXJ0LCBjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeShwYXJ0KX1cXG5cXG5gKTtcbiAgICAgIH0sXG4gICAgICBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSgnZGF0YTogW0RPTkVdXFxuXFxuJyk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG59XG4iLCAiZXhwb3J0IGNvbnN0IFVJX01FU1NBR0VfU1RSRUFNX0hFQURFUlMgPSB7XG4gICdjb250ZW50LXR5cGUnOiAndGV4dC9ldmVudC1zdHJlYW0nLFxuICAnY2FjaGUtY29udHJvbCc6ICduby1jYWNoZScsXG4gIGNvbm5lY3Rpb246ICdrZWVwLWFsaXZlJyxcbiAgJ3gtdmVyY2VsLWFpLXVpLW1lc3NhZ2Utc3RyZWFtJzogJ3YxJyxcbiAgJ3gtYWNjZWwtYnVmZmVyaW5nJzogJ25vJywgLy8gZGlzYWJsZSBuZ2lueCBidWZmZXJpbmdcbn07XG4iLCAiaW1wb3J0IHsgcHJlcGFyZUhlYWRlcnMgfSBmcm9tICcuLi91dGlsL3ByZXBhcmUtaGVhZGVycyc7XG5pbXBvcnQgeyBKc29uVG9Tc2VUcmFuc2Zvcm1TdHJlYW0gfSBmcm9tICcuL2pzb24tdG8tc3NlLXRyYW5zZm9ybS1zdHJlYW0nO1xuaW1wb3J0IHsgVUlfTUVTU0FHRV9TVFJFQU1fSEVBREVSUyB9IGZyb20gJy4vdWktbWVzc2FnZS1zdHJlYW0taGVhZGVycyc7XG5pbXBvcnQgeyBVSU1lc3NhZ2VDaHVuayB9IGZyb20gJy4vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHsgVUlNZXNzYWdlU3RyZWFtUmVzcG9uc2VJbml0IH0gZnJvbSAnLi91aS1tZXNzYWdlLXN0cmVhbS1yZXNwb25zZS1pbml0JztcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVJTWVzc2FnZVN0cmVhbVJlc3BvbnNlKHtcbiAgc3RhdHVzLFxuICBzdGF0dXNUZXh0LFxuICBoZWFkZXJzLFxuICBzdHJlYW0sXG4gIGNvbnN1bWVTc2VTdHJlYW0sXG59OiBVSU1lc3NhZ2VTdHJlYW1SZXNwb25zZUluaXQgJiB7XG4gIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VUlNZXNzYWdlQ2h1bms+O1xufSk6IFJlc3BvbnNlIHtcbiAgbGV0IHNzZVN0cmVhbSA9IHN0cmVhbS5waXBlVGhyb3VnaChuZXcgSnNvblRvU3NlVHJhbnNmb3JtU3RyZWFtKCkpO1xuXG4gIC8vIHdoZW4gdGhlIGNvbnN1bWVTc2VTdHJlYW0gaXMgcHJvdmlkZWQsIHdlIG5lZWQgdG8gdGVlIHRoZSBzdHJlYW1cbiAgLy8gYW5kIHNlbmQgdGhlIHNlY29uZCBwYXJ0IHRvIHRoZSBjb25zdW1lU3NlU3RyZWFtIGZ1bmN0aW9uXG4gIC8vIHNvIHRoYXQgaXQgY2FuIGJlIGNvbnN1bWVkIGJ5IHRoZSBjbGllbnQgaW5kZXBlbmRlbnRseVxuICBpZiAoY29uc3VtZVNzZVN0cmVhbSkge1xuICAgIGNvbnN0IFtzdHJlYW0xLCBzdHJlYW0yXSA9IHNzZVN0cmVhbS50ZWUoKTtcbiAgICBzc2VTdHJlYW0gPSBzdHJlYW0xO1xuICAgIGNvbnN1bWVTc2VTdHJlYW0oeyBzdHJlYW06IHN0cmVhbTIgfSk7IC8vIG5vIGF3YWl0IChkbyBub3QgYmxvY2sgdGhlIHJlc3BvbnNlKVxuICB9XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShzc2VTdHJlYW0ucGlwZVRocm91Z2gobmV3IFRleHRFbmNvZGVyU3RyZWFtKCkpLCB7XG4gICAgc3RhdHVzLFxuICAgIHN0YXR1c1RleHQsXG4gICAgaGVhZGVyczogcHJlcGFyZUhlYWRlcnMoaGVhZGVycywgVUlfTUVTU0FHRV9TVFJFQU1fSEVBREVSUyksXG4gIH0pO1xufVxuIiwgImltcG9ydCB7IElkR2VuZXJhdG9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBVSU1lc3NhZ2UgfSBmcm9tICcuLi91aS91aS1tZXNzYWdlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXNwb25zZVVJTWVzc2FnZUlkKHtcbiAgb3JpZ2luYWxNZXNzYWdlcyxcbiAgcmVzcG9uc2VNZXNzYWdlSWQsXG59OiB7XG4gIG9yaWdpbmFsTWVzc2FnZXM6IFVJTWVzc2FnZVtdIHwgdW5kZWZpbmVkO1xuICByZXNwb25zZU1lc3NhZ2VJZDogc3RyaW5nIHwgSWRHZW5lcmF0b3I7XG59KSB7XG4gIC8vIHdoZW4gdGhlcmUgYXJlIG5vIG9yaWdpbmFsIG1lc3NhZ2VzIChpLmUuIG5vIHBlcnNpc3RlbmNlKSxcbiAgLy8gdGhlIGFzc2lzdGFudCBtZXNzYWdlIGlkIGdlbmVyYXRpb24gaXMgaGFuZGxlZCBvbiB0aGUgY2xpZW50IHNpZGUuXG4gIGlmIChvcmlnaW5hbE1lc3NhZ2VzID09IG51bGwpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3QgbGFzdE1lc3NhZ2UgPSBvcmlnaW5hbE1lc3NhZ2VzW29yaWdpbmFsTWVzc2FnZXMubGVuZ3RoIC0gMV07XG5cbiAgcmV0dXJuIGxhc3RNZXNzYWdlPy5yb2xlID09PSAnYXNzaXN0YW50J1xuICAgID8gbGFzdE1lc3NhZ2UuaWRcbiAgICA6IHR5cGVvZiByZXNwb25zZU1lc3NhZ2VJZCA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgPyByZXNwb25zZU1lc3NhZ2VJZCgpXG4gICAgICA6IHJlc3BvbnNlTWVzc2FnZUlkO1xufVxuIiwgImltcG9ydCB7XG4gIFN0YW5kYXJkU2NoZW1hVjEsXG4gIHZhbGlkYXRlVHlwZXMsXG4gIFZhbGlkYXRvcixcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHtcbiAgRGF0YVVJTWVzc2FnZUNodW5rLFxuICBJbmZlclVJTWVzc2FnZUNodW5rLFxuICBpc0RhdGFVSU1lc3NhZ2VDaHVuayxcbiAgVUlNZXNzYWdlQ2h1bmssXG59IGZyb20gJy4uL3VpLW1lc3NhZ2Utc3RyZWFtL3VpLW1lc3NhZ2UtY2h1bmtzJztcbmltcG9ydCB7IEVycm9ySGFuZGxlciB9IGZyb20gJy4uL3V0aWwvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBtZXJnZU9iamVjdHMgfSBmcm9tICcuLi91dGlsL21lcmdlLW9iamVjdHMnO1xuaW1wb3J0IHsgcGFyc2VQYXJ0aWFsSnNvbiB9IGZyb20gJy4uL3V0aWwvcGFyc2UtcGFydGlhbC1qc29uJztcbmltcG9ydCB7IFVJRGF0YVR5cGVzVG9TY2hlbWFzIH0gZnJvbSAnLi9jaGF0JztcbmltcG9ydCB7XG4gIERhdGFVSVBhcnQsXG4gIER5bmFtaWNUb29sVUlQYXJ0LFxuICBnZXRUb29sTmFtZSxcbiAgSW5mZXJVSU1lc3NhZ2VEYXRhLFxuICBJbmZlclVJTWVzc2FnZU1ldGFkYXRhLFxuICBJbmZlclVJTWVzc2FnZVRvb2xDYWxsLFxuICBJbmZlclVJTWVzc2FnZVRvb2xzLFxuICBpc1Rvb2xVSVBhcnQsXG4gIFJlYXNvbmluZ1VJUGFydCxcbiAgVGV4dFVJUGFydCxcbiAgVG9vbFVJUGFydCxcbiAgVUlNZXNzYWdlLFxuICBVSU1lc3NhZ2VQYXJ0LFxufSBmcm9tICcuL3VpLW1lc3NhZ2VzJztcblxuZXhwb3J0IHR5cGUgU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGU8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4gPSB7XG4gIG1lc3NhZ2U6IFVJX01FU1NBR0U7XG4gIGFjdGl2ZVRleHRQYXJ0czogUmVjb3JkPHN0cmluZywgVGV4dFVJUGFydD47XG4gIGFjdGl2ZVJlYXNvbmluZ1BhcnRzOiBSZWNvcmQ8c3RyaW5nLCBSZWFzb25pbmdVSVBhcnQ+O1xuICBwYXJ0aWFsVG9vbENhbGxzOiBSZWNvcmQ8XG4gICAgc3RyaW5nLFxuICAgIHsgdGV4dDogc3RyaW5nOyBpbmRleDogbnVtYmVyOyB0b29sTmFtZTogc3RyaW5nOyBkeW5hbWljPzogYm9vbGVhbiB9XG4gID47XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGU8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4oe1xuICBsYXN0TWVzc2FnZSxcbiAgbWVzc2FnZUlkLFxufToge1xuICBsYXN0TWVzc2FnZTogVUlfTUVTU0FHRSB8IHVuZGVmaW5lZDtcbiAgbWVzc2FnZUlkOiBzdHJpbmc7XG59KTogU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGU8VUlfTUVTU0FHRT4ge1xuICByZXR1cm4ge1xuICAgIG1lc3NhZ2U6XG4gICAgICBsYXN0TWVzc2FnZT8ucm9sZSA9PT0gJ2Fzc2lzdGFudCdcbiAgICAgICAgPyBsYXN0TWVzc2FnZVxuICAgICAgICA6ICh7XG4gICAgICAgICAgICBpZDogbWVzc2FnZUlkLFxuICAgICAgICAgICAgbWV0YWRhdGE6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgcGFydHM6IFtdIGFzIFVJTWVzc2FnZVBhcnQ8XG4gICAgICAgICAgICAgIEluZmVyVUlNZXNzYWdlRGF0YTxVSV9NRVNTQUdFPixcbiAgICAgICAgICAgICAgSW5mZXJVSU1lc3NhZ2VUb29sczxVSV9NRVNTQUdFPlxuICAgICAgICAgICAgPltdLFxuICAgICAgICAgIH0gYXMgVUlfTUVTU0FHRSksXG4gICAgYWN0aXZlVGV4dFBhcnRzOiB7fSxcbiAgICBhY3RpdmVSZWFzb25pbmdQYXJ0czoge30sXG4gICAgcGFydGlhbFRvb2xDYWxsczoge30sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzVUlNZXNzYWdlU3RyZWFtPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+KHtcbiAgc3RyZWFtLFxuICBtZXNzYWdlTWV0YWRhdGFTY2hlbWEsXG4gIGRhdGFQYXJ0U2NoZW1hcyxcbiAgcnVuVXBkYXRlTWVzc2FnZUpvYixcbiAgb25FcnJvcixcbiAgb25Ub29sQ2FsbCxcbiAgb25EYXRhLFxufToge1xuICAvLyBpbnB1dCBzdHJlYW0gaXMgbm90IGZ1bGx5IHR5cGVkIHlldDpcbiAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVSU1lc3NhZ2VDaHVuaz47XG4gIG1lc3NhZ2VNZXRhZGF0YVNjaGVtYT86XG4gICAgfCBWYWxpZGF0b3I8SW5mZXJVSU1lc3NhZ2VNZXRhZGF0YTxVSV9NRVNTQUdFPj5cbiAgICB8IFN0YW5kYXJkU2NoZW1hVjE8SW5mZXJVSU1lc3NhZ2VNZXRhZGF0YTxVSV9NRVNTQUdFPj47XG4gIGRhdGFQYXJ0U2NoZW1hcz86IFVJRGF0YVR5cGVzVG9TY2hlbWFzPEluZmVyVUlNZXNzYWdlRGF0YTxVSV9NRVNTQUdFPj47XG4gIG9uVG9vbENhbGw/OiAob3B0aW9uczoge1xuICAgIHRvb2xDYWxsOiBJbmZlclVJTWVzc2FnZVRvb2xDYWxsPFVJX01FU1NBR0U+O1xuICB9KSA9PiB2b2lkIHwgUHJvbWlzZUxpa2U8dm9pZD47XG4gIG9uRGF0YT86IChkYXRhUGFydDogRGF0YVVJUGFydDxJbmZlclVJTWVzc2FnZURhdGE8VUlfTUVTU0FHRT4+KSA9PiB2b2lkO1xuICBydW5VcGRhdGVNZXNzYWdlSm9iOiAoXG4gICAgam9iOiAob3B0aW9uczoge1xuICAgICAgc3RhdGU6IFN0cmVhbWluZ1VJTWVzc2FnZVN0YXRlPFVJX01FU1NBR0U+O1xuICAgICAgd3JpdGU6ICgpID0+IHZvaWQ7XG4gICAgfSkgPT4gUHJvbWlzZTx2b2lkPixcbiAgKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBvbkVycm9yOiBFcnJvckhhbmRsZXI7XG59KTogUmVhZGFibGVTdHJlYW08SW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPj4ge1xuICByZXR1cm4gc3RyZWFtLnBpcGVUaHJvdWdoKFxuICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08VUlNZXNzYWdlQ2h1bmssIEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4+KHtcbiAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICBhd2FpdCBydW5VcGRhdGVNZXNzYWdlSm9iKGFzeW5jICh7IHN0YXRlLCB3cml0ZSB9KSA9PiB7XG4gICAgICAgICAgZnVuY3Rpb24gZ2V0VG9vbEludm9jYXRpb24odG9vbENhbGxJZDogc3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB0b29sSW52b2NhdGlvbnMgPSBzdGF0ZS5tZXNzYWdlLnBhcnRzLmZpbHRlcihpc1Rvb2xVSVBhcnQpO1xuXG4gICAgICAgICAgICBjb25zdCB0b29sSW52b2NhdGlvbiA9IHRvb2xJbnZvY2F0aW9ucy5maW5kKFxuICAgICAgICAgICAgICBpbnZvY2F0aW9uID0+IGludm9jYXRpb24udG9vbENhbGxJZCA9PT0gdG9vbENhbGxJZCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmICh0b29sSW52b2NhdGlvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAndG9vbC1vdXRwdXQtZXJyb3IgbXVzdCBiZSBwcmVjZWRlZCBieSBhIHRvb2wtaW5wdXQtYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRvb2xJbnZvY2F0aW9uO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZ1bmN0aW9uIGdldER5bmFtaWNUb29sSW52b2NhdGlvbih0b29sQ2FsbElkOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHRvb2xJbnZvY2F0aW9ucyA9IHN0YXRlLm1lc3NhZ2UucGFydHMuZmlsdGVyKFxuICAgICAgICAgICAgICBwYXJ0ID0+IHBhcnQudHlwZSA9PT0gJ2R5bmFtaWMtdG9vbCcsXG4gICAgICAgICAgICApIGFzIER5bmFtaWNUb29sVUlQYXJ0W107XG5cbiAgICAgICAgICAgIGNvbnN0IHRvb2xJbnZvY2F0aW9uID0gdG9vbEludm9jYXRpb25zLmZpbmQoXG4gICAgICAgICAgICAgIGludm9jYXRpb24gPT4gaW52b2NhdGlvbi50b29sQ2FsbElkID09PSB0b29sQ2FsbElkLFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKHRvb2xJbnZvY2F0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgICd0b29sLW91dHB1dC1lcnJvciBtdXN0IGJlIHByZWNlZGVkIGJ5IGEgdG9vbC1pbnB1dC1hdmFpbGFibGUnLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdG9vbEludm9jYXRpb247XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gdXBkYXRlVG9vbFBhcnQoXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIHRvb2xOYW1lOiBrZXlvZiBJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+ICYgc3RyaW5nO1xuICAgICAgICAgICAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgfSAmIChcbiAgICAgICAgICAgICAgfCB7XG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LXN0cmVhbWluZyc7XG4gICAgICAgICAgICAgICAgICBpbnB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfCB7XG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LWF2YWlsYWJsZSc7XG4gICAgICAgICAgICAgICAgICBpbnB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB8IHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlOiAnb3V0cHV0LWF2YWlsYWJsZSc7XG4gICAgICAgICAgICAgICAgICBpbnB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIG91dHB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgICAgICAgcHJlbGltaW5hcnk/OiBib29sZWFuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfCB7XG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ291dHB1dC1lcnJvcic7XG4gICAgICAgICAgICAgICAgICBpbnB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIHJhd0lucHV0PzogdW5rbm93bjtcbiAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogc3RyaW5nO1xuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZD86IGJvb2xlYW47XG4gICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApLFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgcGFydCA9IHN0YXRlLm1lc3NhZ2UucGFydHMuZmluZChcbiAgICAgICAgICAgICAgcGFydCA9PlxuICAgICAgICAgICAgICAgIGlzVG9vbFVJUGFydChwYXJ0KSAmJiBwYXJ0LnRvb2xDYWxsSWQgPT09IG9wdGlvbnMudG9vbENhbGxJZCxcbiAgICAgICAgICAgICkgYXMgVG9vbFVJUGFydDxJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+PiB8IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgY29uc3QgYW55T3B0aW9ucyA9IG9wdGlvbnMgYXMgYW55O1xuICAgICAgICAgICAgY29uc3QgYW55UGFydCA9IHBhcnQgYXMgYW55O1xuXG4gICAgICAgICAgICBpZiAocGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHBhcnQuc3RhdGUgPSBvcHRpb25zLnN0YXRlO1xuICAgICAgICAgICAgICBhbnlQYXJ0LmlucHV0ID0gYW55T3B0aW9ucy5pbnB1dDtcbiAgICAgICAgICAgICAgYW55UGFydC5vdXRwdXQgPSBhbnlPcHRpb25zLm91dHB1dDtcbiAgICAgICAgICAgICAgYW55UGFydC5lcnJvclRleHQgPSBhbnlPcHRpb25zLmVycm9yVGV4dDtcbiAgICAgICAgICAgICAgYW55UGFydC5yYXdJbnB1dCA9IGFueU9wdGlvbnMucmF3SW5wdXQ7XG4gICAgICAgICAgICAgIGFueVBhcnQucHJlbGltaW5hcnkgPSBhbnlPcHRpb25zLnByZWxpbWluYXJ5O1xuXG4gICAgICAgICAgICAgIC8vIG9uY2UgcHJvdmlkZXJFeGVjdXRlZCBpcyBzZXQsIGl0IHN0YXlzIGZvciBzdHJlYW1pbmdcbiAgICAgICAgICAgICAgYW55UGFydC5wcm92aWRlckV4ZWN1dGVkID1cbiAgICAgICAgICAgICAgICBhbnlPcHRpb25zLnByb3ZpZGVyRXhlY3V0ZWQgPz8gcGFydC5wcm92aWRlckV4ZWN1dGVkO1xuXG4gICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBhbnlPcHRpb25zLnByb3ZpZGVyTWV0YWRhdGEgIT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgIHBhcnQuc3RhdGUgPT09ICdpbnB1dC1hdmFpbGFibGUnXG4gICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHBhcnQuY2FsbFByb3ZpZGVyTWV0YWRhdGEgPSBhbnlPcHRpb25zLnByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UucGFydHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogYHRvb2wtJHtvcHRpb25zLnRvb2xOYW1lfWAsXG4gICAgICAgICAgICAgICAgdG9vbENhbGxJZDogb3B0aW9ucy50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBvcHRpb25zLnN0YXRlLFxuICAgICAgICAgICAgICAgIGlucHV0OiBhbnlPcHRpb25zLmlucHV0LFxuICAgICAgICAgICAgICAgIG91dHB1dDogYW55T3B0aW9ucy5vdXRwdXQsXG4gICAgICAgICAgICAgICAgcmF3SW5wdXQ6IGFueU9wdGlvbnMucmF3SW5wdXQsXG4gICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBhbnlPcHRpb25zLmVycm9yVGV4dCxcbiAgICAgICAgICAgICAgICBwcm92aWRlckV4ZWN1dGVkOiBhbnlPcHRpb25zLnByb3ZpZGVyRXhlY3V0ZWQsXG4gICAgICAgICAgICAgICAgcHJlbGltaW5hcnk6IGFueU9wdGlvbnMucHJlbGltaW5hcnksXG4gICAgICAgICAgICAgICAgLi4uKGFueU9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICA/IHsgY2FsbFByb3ZpZGVyTWV0YWRhdGE6IGFueU9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgICAgfSBhcyBUb29sVUlQYXJ0PEluZmVyVUlNZXNzYWdlVG9vbHM8VUlfTUVTU0FHRT4+KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVEeW5hbWljVG9vbFBhcnQoXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIHRvb2xOYW1lOiBrZXlvZiBJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+ICYgc3RyaW5nO1xuICAgICAgICAgICAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICAgICAgfSAmIChcbiAgICAgICAgICAgICAgfCB7XG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LXN0cmVhbWluZyc7XG4gICAgICAgICAgICAgICAgICBpbnB1dDogdW5rbm93bjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHwge1xuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdpbnB1dC1hdmFpbGFibGUnO1xuICAgICAgICAgICAgICAgICAgaW5wdXQ6IHVua25vd247XG4gICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHwge1xuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtYXZhaWxhYmxlJztcbiAgICAgICAgICAgICAgICAgIGlucHV0OiB1bmtub3duO1xuICAgICAgICAgICAgICAgICAgb3V0cHV0OiB1bmtub3duO1xuICAgICAgICAgICAgICAgICAgcHJlbGltaW5hcnk6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB8IHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlOiAnb3V0cHV0LWVycm9yJztcbiAgICAgICAgICAgICAgICAgIGlucHV0OiB1bmtub3duO1xuICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApLFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgcGFydCA9IHN0YXRlLm1lc3NhZ2UucGFydHMuZmluZChcbiAgICAgICAgICAgICAgcGFydCA9PlxuICAgICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ2R5bmFtaWMtdG9vbCcgJiZcbiAgICAgICAgICAgICAgICBwYXJ0LnRvb2xDYWxsSWQgPT09IG9wdGlvbnMudG9vbENhbGxJZCxcbiAgICAgICAgICAgICkgYXMgRHluYW1pY1Rvb2xVSVBhcnQgfCB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIGNvbnN0IGFueU9wdGlvbnMgPSBvcHRpb25zIGFzIGFueTtcbiAgICAgICAgICAgIGNvbnN0IGFueVBhcnQgPSBwYXJ0IGFzIGFueTtcblxuICAgICAgICAgICAgaWYgKHBhcnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICBwYXJ0LnN0YXRlID0gb3B0aW9ucy5zdGF0ZTtcbiAgICAgICAgICAgICAgYW55UGFydC50b29sTmFtZSA9IG9wdGlvbnMudG9vbE5hbWU7XG4gICAgICAgICAgICAgIGFueVBhcnQuaW5wdXQgPSBhbnlPcHRpb25zLmlucHV0O1xuICAgICAgICAgICAgICBhbnlQYXJ0Lm91dHB1dCA9IGFueU9wdGlvbnMub3V0cHV0O1xuICAgICAgICAgICAgICBhbnlQYXJ0LmVycm9yVGV4dCA9IGFueU9wdGlvbnMuZXJyb3JUZXh0O1xuICAgICAgICAgICAgICBhbnlQYXJ0LnJhd0lucHV0ID0gYW55T3B0aW9ucy5yYXdJbnB1dCA/PyBhbnlQYXJ0LnJhd0lucHV0O1xuICAgICAgICAgICAgICBhbnlQYXJ0LnByZWxpbWluYXJ5ID0gYW55T3B0aW9ucy5wcmVsaW1pbmFyeTtcblxuICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgYW55T3B0aW9ucy5wcm92aWRlck1ldGFkYXRhICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICBwYXJ0LnN0YXRlID09PSAnaW5wdXQtYXZhaWxhYmxlJ1xuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBwYXJ0LmNhbGxQcm92aWRlck1ldGFkYXRhID0gYW55T3B0aW9ucy5wcm92aWRlck1ldGFkYXRhO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdGF0ZS5tZXNzYWdlLnBhcnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdkeW5hbWljLXRvb2wnLFxuICAgICAgICAgICAgICAgIHRvb2xOYW1lOiBvcHRpb25zLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IG9wdGlvbnMudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICBzdGF0ZTogb3B0aW9ucy5zdGF0ZSxcbiAgICAgICAgICAgICAgICBpbnB1dDogYW55T3B0aW9ucy5pbnB1dCxcbiAgICAgICAgICAgICAgICBvdXRwdXQ6IGFueU9wdGlvbnMub3V0cHV0LFxuICAgICAgICAgICAgICAgIGVycm9yVGV4dDogYW55T3B0aW9ucy5lcnJvclRleHQsXG4gICAgICAgICAgICAgICAgcHJlbGltaW5hcnk6IGFueU9wdGlvbnMucHJlbGltaW5hcnksXG4gICAgICAgICAgICAgICAgLi4uKGFueU9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICA/IHsgY2FsbFByb3ZpZGVyTWV0YWRhdGE6IGFueU9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgICAgfSBhcyBEeW5hbWljVG9vbFVJUGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWVzc2FnZU1ldGFkYXRhKG1ldGFkYXRhOiB1bmtub3duKSB7XG4gICAgICAgICAgICBpZiAobWV0YWRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICBjb25zdCBtZXJnZWRNZXRhZGF0YSA9XG4gICAgICAgICAgICAgICAgc3RhdGUubWVzc2FnZS5tZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICA/IG1lcmdlT2JqZWN0cyhzdGF0ZS5tZXNzYWdlLm1ldGFkYXRhLCBtZXRhZGF0YSlcbiAgICAgICAgICAgICAgICAgIDogbWV0YWRhdGE7XG5cbiAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VNZXRhZGF0YVNjaGVtYSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdmFsaWRhdGVUeXBlcyh7XG4gICAgICAgICAgICAgICAgICB2YWx1ZTogbWVyZ2VkTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICBzY2hlbWE6IG1lc3NhZ2VNZXRhZGF0YVNjaGVtYSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UubWV0YWRhdGEgPVxuICAgICAgICAgICAgICAgIG1lcmdlZE1ldGFkYXRhIGFzIEluZmVyVUlNZXNzYWdlTWV0YWRhdGE8VUlfTUVTU0FHRT47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3dpdGNoIChjaHVuay50eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd0ZXh0LXN0YXJ0Jzoge1xuICAgICAgICAgICAgICBjb25zdCB0ZXh0UGFydDogVGV4dFVJUGFydCA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgdGV4dDogJycsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogY2h1bmsucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ3N0cmVhbWluZycsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZVRleHRQYXJ0c1tjaHVuay5pZF0gPSB0ZXh0UGFydDtcbiAgICAgICAgICAgICAgc3RhdGUubWVzc2FnZS5wYXJ0cy5wdXNoKHRleHRQYXJ0KTtcbiAgICAgICAgICAgICAgd3JpdGUoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3RleHQtZGVsdGEnOiB7XG4gICAgICAgICAgICAgIGNvbnN0IHRleHRQYXJ0ID0gc3RhdGUuYWN0aXZlVGV4dFBhcnRzW2NodW5rLmlkXTtcbiAgICAgICAgICAgICAgdGV4dFBhcnQudGV4dCArPSBjaHVuay5kZWx0YTtcbiAgICAgICAgICAgICAgdGV4dFBhcnQucHJvdmlkZXJNZXRhZGF0YSA9XG4gICAgICAgICAgICAgICAgY2h1bmsucHJvdmlkZXJNZXRhZGF0YSA/PyB0ZXh0UGFydC5wcm92aWRlck1ldGFkYXRhO1xuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndGV4dC1lbmQnOiB7XG4gICAgICAgICAgICAgIGNvbnN0IHRleHRQYXJ0ID0gc3RhdGUuYWN0aXZlVGV4dFBhcnRzW2NodW5rLmlkXTtcbiAgICAgICAgICAgICAgdGV4dFBhcnQuc3RhdGUgPSAnZG9uZSc7XG4gICAgICAgICAgICAgIHRleHRQYXJ0LnByb3ZpZGVyTWV0YWRhdGEgPVxuICAgICAgICAgICAgICAgIGNodW5rLnByb3ZpZGVyTWV0YWRhdGEgPz8gdGV4dFBhcnQucHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgICAgICAgICAgZGVsZXRlIHN0YXRlLmFjdGl2ZVRleHRQYXJ0c1tjaHVuay5pZF07XG4gICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdyZWFzb25pbmctc3RhcnQnOiB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlYXNvbmluZ1BhcnQ6IFJlYXNvbmluZ1VJUGFydCA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAncmVhc29uaW5nJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnJyxcbiAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBjaHVuay5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIHN0YXRlOiAnc3RyZWFtaW5nJyxcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlUmVhc29uaW5nUGFydHNbY2h1bmsuaWRdID0gcmVhc29uaW5nUGFydDtcbiAgICAgICAgICAgICAgc3RhdGUubWVzc2FnZS5wYXJ0cy5wdXNoKHJlYXNvbmluZ1BhcnQpO1xuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAncmVhc29uaW5nLWRlbHRhJzoge1xuICAgICAgICAgICAgICBjb25zdCByZWFzb25pbmdQYXJ0ID0gc3RhdGUuYWN0aXZlUmVhc29uaW5nUGFydHNbY2h1bmsuaWRdO1xuICAgICAgICAgICAgICByZWFzb25pbmdQYXJ0LnRleHQgKz0gY2h1bmsuZGVsdGE7XG4gICAgICAgICAgICAgIHJlYXNvbmluZ1BhcnQucHJvdmlkZXJNZXRhZGF0YSA9XG4gICAgICAgICAgICAgICAgY2h1bmsucHJvdmlkZXJNZXRhZGF0YSA/PyByZWFzb25pbmdQYXJ0LnByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdyZWFzb25pbmctZW5kJzoge1xuICAgICAgICAgICAgICBjb25zdCByZWFzb25pbmdQYXJ0ID0gc3RhdGUuYWN0aXZlUmVhc29uaW5nUGFydHNbY2h1bmsuaWRdO1xuICAgICAgICAgICAgICByZWFzb25pbmdQYXJ0LnByb3ZpZGVyTWV0YWRhdGEgPVxuICAgICAgICAgICAgICAgIGNodW5rLnByb3ZpZGVyTWV0YWRhdGEgPz8gcmVhc29uaW5nUGFydC5wcm92aWRlck1ldGFkYXRhO1xuICAgICAgICAgICAgICByZWFzb25pbmdQYXJ0LnN0YXRlID0gJ2RvbmUnO1xuICAgICAgICAgICAgICBkZWxldGUgc3RhdGUuYWN0aXZlUmVhc29uaW5nUGFydHNbY2h1bmsuaWRdO1xuXG4gICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdmaWxlJzoge1xuICAgICAgICAgICAgICBzdGF0ZS5tZXNzYWdlLnBhcnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdmaWxlJyxcbiAgICAgICAgICAgICAgICBtZWRpYVR5cGU6IGNodW5rLm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICB1cmw6IGNodW5rLnVybCxcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgd3JpdGUoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3NvdXJjZS11cmwnOiB7XG4gICAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UucGFydHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NvdXJjZS11cmwnLFxuICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBjaHVuay5zb3VyY2VJZCxcbiAgICAgICAgICAgICAgICB1cmw6IGNodW5rLnVybCxcbiAgICAgICAgICAgICAgICB0aXRsZTogY2h1bmsudGl0bGUsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogY2h1bmsucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgd3JpdGUoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ3NvdXJjZS1kb2N1bWVudCc6IHtcbiAgICAgICAgICAgICAgc3RhdGUubWVzc2FnZS5wYXJ0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnc291cmNlLWRvY3VtZW50JyxcbiAgICAgICAgICAgICAgICBzb3VyY2VJZDogY2h1bmsuc291cmNlSWQsXG4gICAgICAgICAgICAgICAgbWVkaWFUeXBlOiBjaHVuay5tZWRpYVR5cGUsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGNodW5rLnRpdGxlLFxuICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBjaHVuay5maWxlbmFtZSxcbiAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBjaHVuay5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1zdGFydCc6IHtcbiAgICAgICAgICAgICAgY29uc3QgdG9vbEludm9jYXRpb25zID0gc3RhdGUubWVzc2FnZS5wYXJ0cy5maWx0ZXIoaXNUb29sVUlQYXJ0KTtcblxuICAgICAgICAgICAgICAvLyBhZGQgdGhlIHBhcnRpYWwgdG9vbCBjYWxsIHRvIHRoZSBtYXBcbiAgICAgICAgICAgICAgc3RhdGUucGFydGlhbFRvb2xDYWxsc1tjaHVuay50b29sQ2FsbElkXSA9IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiAnJyxcbiAgICAgICAgICAgICAgICB0b29sTmFtZTogY2h1bmsudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgaW5kZXg6IHRvb2xJbnZvY2F0aW9ucy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgZHluYW1pYzogY2h1bmsuZHluYW1pYyxcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICBpZiAoY2h1bmsuZHluYW1pYykge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUR5bmFtaWNUb29sUGFydCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBjaHVuay50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IGNodW5rLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdpbnB1dC1zdHJlYW1pbmcnLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVUb29sUGFydCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBjaHVuay50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IGNodW5rLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdpbnB1dC1zdHJlYW1pbmcnLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IGNodW5rLnByb3ZpZGVyRXhlY3V0ZWQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1kZWx0YSc6IHtcbiAgICAgICAgICAgICAgY29uc3QgcGFydGlhbFRvb2xDYWxsID0gc3RhdGUucGFydGlhbFRvb2xDYWxsc1tjaHVuay50b29sQ2FsbElkXTtcblxuICAgICAgICAgICAgICBwYXJ0aWFsVG9vbENhbGwudGV4dCArPSBjaHVuay5pbnB1dFRleHREZWx0YTtcblxuICAgICAgICAgICAgICBjb25zdCB7IHZhbHVlOiBwYXJ0aWFsQXJncyB9ID0gYXdhaXQgcGFyc2VQYXJ0aWFsSnNvbihcbiAgICAgICAgICAgICAgICBwYXJ0aWFsVG9vbENhbGwudGV4dCxcbiAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICBpZiAocGFydGlhbFRvb2xDYWxsLmR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVEeW5hbWljVG9vbFBhcnQoe1xuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiBwYXJ0aWFsVG9vbENhbGwudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LXN0cmVhbWluZycsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogcGFydGlhbEFyZ3MsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlVG9vbFBhcnQoe1xuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiBwYXJ0aWFsVG9vbENhbGwudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LXN0cmVhbWluZycsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogcGFydGlhbEFyZ3MsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1hdmFpbGFibGUnOiB7XG4gICAgICAgICAgICAgIGlmIChjaHVuay5keW5hbWljKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlRHluYW1pY1Rvb2xQYXJ0KHtcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICB0b29sTmFtZTogY2h1bmsudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LWF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogY2h1bmsuaW5wdXQsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBjaHVuay5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVRvb2xQYXJ0KHtcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICB0b29sTmFtZTogY2h1bmsudG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ2lucHV0LWF2YWlsYWJsZScsXG4gICAgICAgICAgICAgICAgICBpbnB1dDogY2h1bmsuaW5wdXQsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlckV4ZWN1dGVkOiBjaHVuay5wcm92aWRlckV4ZWN1dGVkLFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogY2h1bmsucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHdyaXRlKCk7XG5cbiAgICAgICAgICAgICAgLy8gaW52b2tlIHRoZSBvblRvb2xDYWxsIGNhbGxiYWNrIGlmIGl0IGV4aXN0cy4gVGhpcyBpcyBibG9ja2luZy5cbiAgICAgICAgICAgICAgLy8gSW4gdGhlIGZ1dHVyZSB3ZSBzaG91bGQgbWFrZSB0aGlzIG5vbi1ibG9ja2luZywgd2hpY2hcbiAgICAgICAgICAgICAgLy8gcmVxdWlyZXMgYWRkaXRpb25hbCBzdGF0ZSBtYW5hZ2VtZW50IGZvciBlcnJvciBoYW5kbGluZyBldGMuXG4gICAgICAgICAgICAgIC8vIFNraXAgY2FsbGluZyBvblRvb2xDYWxsIGZvciBwcm92aWRlci1leGVjdXRlZCB0b29scyBzaW5jZSB0aGV5IGFyZSBhbHJlYWR5IGV4ZWN1dGVkXG4gICAgICAgICAgICAgIGlmIChvblRvb2xDYWxsICYmICFjaHVuay5wcm92aWRlckV4ZWN1dGVkKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgb25Ub29sQ2FsbCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbDogY2h1bmsgYXMgSW5mZXJVSU1lc3NhZ2VUb29sQ2FsbDxVSV9NRVNTQUdFPixcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1lcnJvcic6IHtcbiAgICAgICAgICAgICAgaWYgKGNodW5rLmR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVEeW5hbWljVG9vbFBhcnQoe1xuICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgIHRvb2xOYW1lOiBjaHVuay50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgIHN0YXRlOiAnb3V0cHV0LWVycm9yJyxcbiAgICAgICAgICAgICAgICAgIGlucHV0OiBjaHVuay5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogY2h1bmsuZXJyb3JUZXh0LFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogY2h1bmsucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cGRhdGVUb29sUGFydCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBjaHVuay50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IGNodW5rLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtZXJyb3InLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgIHJhd0lucHV0OiBjaHVuay5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogY2h1bmsuZXJyb3JUZXh0LFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogY2h1bmsucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IGNodW5rLnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAndG9vbC1vdXRwdXQtYXZhaWxhYmxlJzoge1xuICAgICAgICAgICAgICBpZiAoY2h1bmsuZHluYW1pYykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvb2xJbnZvY2F0aW9uID0gZ2V0RHluYW1pY1Rvb2xJbnZvY2F0aW9uKFxuICAgICAgICAgICAgICAgICAgY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgdXBkYXRlRHluYW1pY1Rvb2xQYXJ0KHtcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICB0b29sTmFtZTogdG9vbEludm9jYXRpb24udG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICBzdGF0ZTogJ291dHB1dC1hdmFpbGFibGUnLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6ICh0b29sSW52b2NhdGlvbiBhcyBhbnkpLmlucHV0LFxuICAgICAgICAgICAgICAgICAgb3V0cHV0OiBjaHVuay5vdXRwdXQsXG4gICAgICAgICAgICAgICAgICBwcmVsaW1pbmFyeTogY2h1bmsucHJlbGltaW5hcnksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9vbEludm9jYXRpb24gPSBnZXRUb29sSW52b2NhdGlvbihjaHVuay50b29sQ2FsbElkKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZVRvb2xQYXJ0KHtcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICB0b29sTmFtZTogZ2V0VG9vbE5hbWUodG9vbEludm9jYXRpb24pLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICAgIGlucHV0OiAodG9vbEludm9jYXRpb24gYXMgYW55KS5pbnB1dCxcbiAgICAgICAgICAgICAgICAgIG91dHB1dDogY2h1bmsub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogY2h1bmsucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgICAgICAgICAgIHByZWxpbWluYXJ5OiBjaHVuay5wcmVsaW1pbmFyeSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICd0b29sLW91dHB1dC1lcnJvcic6IHtcbiAgICAgICAgICAgICAgaWYgKGNodW5rLmR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0b29sSW52b2NhdGlvbiA9IGdldER5bmFtaWNUb29sSW52b2NhdGlvbihcbiAgICAgICAgICAgICAgICAgIGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZUR5bmFtaWNUb29sUGFydCh7XG4gICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBjaHVuay50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgdG9vbE5hbWU6IHRvb2xJbnZvY2F0aW9uLnRvb2xOYW1lLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtZXJyb3InLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6ICh0b29sSW52b2NhdGlvbiBhcyBhbnkpLmlucHV0LFxuICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBjaHVuay5lcnJvclRleHQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9vbEludm9jYXRpb24gPSBnZXRUb29sSW52b2NhdGlvbihjaHVuay50b29sQ2FsbElkKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZVRvb2xQYXJ0KHtcbiAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IGNodW5rLnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICB0b29sTmFtZTogZ2V0VG9vbE5hbWUodG9vbEludm9jYXRpb24pLFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtZXJyb3InLFxuICAgICAgICAgICAgICAgICAgaW5wdXQ6ICh0b29sSW52b2NhdGlvbiBhcyBhbnkpLmlucHV0LFxuICAgICAgICAgICAgICAgICAgcmF3SW5wdXQ6ICh0b29sSW52b2NhdGlvbiBhcyBhbnkpLnJhd0lucHV0LFxuICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBjaHVuay5lcnJvclRleHQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAnc3RhcnQtc3RlcCc6IHtcbiAgICAgICAgICAgICAgLy8gYWRkIGEgc3RlcCBib3VuZGFyeSBwYXJ0IHRvIHRoZSBtZXNzYWdlXG4gICAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UucGFydHMucHVzaCh7IHR5cGU6ICdzdGVwLXN0YXJ0JyB9KTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2ZpbmlzaC1zdGVwJzoge1xuICAgICAgICAgICAgICAvLyByZXNldCB0aGUgY3VycmVudCB0ZXh0IGFuZCByZWFzb25pbmcgcGFydHNcbiAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlVGV4dFBhcnRzID0ge307XG4gICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZVJlYXNvbmluZ1BhcnRzID0ge307XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdzdGFydCc6IHtcbiAgICAgICAgICAgICAgaWYgKGNodW5rLm1lc3NhZ2VJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUubWVzc2FnZS5pZCA9IGNodW5rLm1lc3NhZ2VJZDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZU1lc3NhZ2VNZXRhZGF0YShjaHVuay5tZXNzYWdlTWV0YWRhdGEpO1xuXG4gICAgICAgICAgICAgIGlmIChjaHVuay5tZXNzYWdlSWQgIT0gbnVsbCB8fCBjaHVuay5tZXNzYWdlTWV0YWRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ2ZpbmlzaCc6IHtcbiAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlTWVzc2FnZU1ldGFkYXRhKGNodW5rLm1lc3NhZ2VNZXRhZGF0YSk7XG4gICAgICAgICAgICAgIGlmIChjaHVuay5tZXNzYWdlTWV0YWRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdyaXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgJ21lc3NhZ2UtbWV0YWRhdGEnOiB7XG4gICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZU1lc3NhZ2VNZXRhZGF0YShjaHVuay5tZXNzYWdlTWV0YWRhdGEpO1xuICAgICAgICAgICAgICBpZiAoY2h1bmsubWVzc2FnZU1ldGFkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlICdlcnJvcic6IHtcbiAgICAgICAgICAgICAgb25FcnJvcj8uKG5ldyBFcnJvcihjaHVuay5lcnJvclRleHQpKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgaWYgKGlzRGF0YVVJTWVzc2FnZUNodW5rKGNodW5rKSkge1xuICAgICAgICAgICAgICAgIC8vIHZhbGlkYXRlIGRhdGEgY2h1bmsgaWYgZGF0YVBhcnRTY2hlbWFzIGlzIHByb3ZpZGVkXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFQYXJ0U2NoZW1hcz8uW2NodW5rLnR5cGVdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIGF3YWl0IHZhbGlkYXRlVHlwZXMoe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY2h1bmsuZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiBkYXRhUGFydFNjaGVtYXNbY2h1bmsudHlwZV0sXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBjYXN0LCB2YWxpZGF0aW9uIGlzIGRvbmUgYWJvdmVcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhQ2h1bmsgPSBjaHVuayBhcyBEYXRhVUlNZXNzYWdlQ2h1bms8XG4gICAgICAgICAgICAgICAgICBJbmZlclVJTWVzc2FnZURhdGE8VUlfTUVTU0FHRT5cbiAgICAgICAgICAgICAgICA+O1xuXG4gICAgICAgICAgICAgICAgLy8gdHJhbnNpZW50IHBhcnRzIGFyZSBub3QgYWRkZWQgdG8gdGhlIG1lc3NhZ2Ugc3RhdGVcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUNodW5rLnRyYW5zaWVudCkge1xuICAgICAgICAgICAgICAgICAgb25EYXRhPy4oZGF0YUNodW5rKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nVUlQYXJ0ID1cbiAgICAgICAgICAgICAgICAgIGRhdGFDaHVuay5pZCAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8gKHN0YXRlLm1lc3NhZ2UucGFydHMuZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rQXJnID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFDaHVuay50eXBlID09PSBjaHVua0FyZy50eXBlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFDaHVuay5pZCA9PT0gY2h1bmtBcmcuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgKSBhc1xuICAgICAgICAgICAgICAgICAgICAgICAgfCBEYXRhVUlQYXJ0PEluZmVyVUlNZXNzYWdlRGF0YTxVSV9NRVNTQUdFPj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHwgdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1VJUGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICBleGlzdGluZ1VJUGFydC5kYXRhID0gZGF0YUNodW5rLmRhdGE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UucGFydHMucHVzaChkYXRhQ2h1bmspO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG9uRGF0YT8uKGRhdGFDaHVuayk7XG5cbiAgICAgICAgICAgICAgICB3cml0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rIGFzIEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4pO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSksXG4gICk7XG59XG4iLCAiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQge1xuICBQcm92aWRlck1ldGFkYXRhLFxuICBwcm92aWRlck1ldGFkYXRhU2NoZW1hLFxufSBmcm9tICcuLi90eXBlcy9wcm92aWRlci1tZXRhZGF0YSc7XG5pbXBvcnQge1xuICBJbmZlclVJTWVzc2FnZURhdGEsXG4gIEluZmVyVUlNZXNzYWdlTWV0YWRhdGEsXG4gIFVJRGF0YVR5cGVzLFxuICBVSU1lc3NhZ2UsXG59IGZyb20gJy4uL3VpL3VpLW1lc3NhZ2VzJztcbmltcG9ydCB7IFZhbHVlT2YgfSBmcm9tICcuLi91dGlsL3ZhbHVlLW9mJztcblxuZXhwb3J0IGNvbnN0IHVpTWVzc2FnZUNodW5rU2NoZW1hID0gei51bmlvbihbXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ3RleHQtc3RhcnQnKSxcbiAgICBpZDogei5zdHJpbmcoKSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCd0ZXh0LWRlbHRhJyksXG4gICAgaWQ6IHouc3RyaW5nKCksXG4gICAgZGVsdGE6IHouc3RyaW5nKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgndGV4dC1lbmQnKSxcbiAgICBpZDogei5zdHJpbmcoKSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdlcnJvcicpLFxuICAgIGVycm9yVGV4dDogei5zdHJpbmcoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ3Rvb2wtaW5wdXQtc3RhcnQnKSxcbiAgICB0b29sQ2FsbElkOiB6LnN0cmluZygpLFxuICAgIHRvb2xOYW1lOiB6LnN0cmluZygpLFxuICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgZHluYW1pYzogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ3Rvb2wtaW5wdXQtZGVsdGEnKSxcbiAgICB0b29sQ2FsbElkOiB6LnN0cmluZygpLFxuICAgIGlucHV0VGV4dERlbHRhOiB6LnN0cmluZygpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgndG9vbC1pbnB1dC1hdmFpbGFibGUnKSxcbiAgICB0b29sQ2FsbElkOiB6LnN0cmluZygpLFxuICAgIHRvb2xOYW1lOiB6LnN0cmluZygpLFxuICAgIGlucHV0OiB6LnVua25vd24oKSxcbiAgICBwcm92aWRlckV4ZWN1dGVkOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICAgIHByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbiAgICBkeW5hbWljOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgndG9vbC1pbnB1dC1lcnJvcicpLFxuICAgIHRvb2xDYWxsSWQ6IHouc3RyaW5nKCksXG4gICAgdG9vbE5hbWU6IHouc3RyaW5nKCksXG4gICAgaW5wdXQ6IHoudW5rbm93bigpLFxuICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICAgIGR5bmFtaWM6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgZXJyb3JUZXh0OiB6LnN0cmluZygpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgndG9vbC1vdXRwdXQtYXZhaWxhYmxlJyksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBvdXRwdXQ6IHoudW5rbm93bigpLFxuICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgZHluYW1pYzogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgICBwcmVsaW1pbmFyeTogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ3Rvb2wtb3V0cHV0LWVycm9yJyksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBlcnJvclRleHQ6IHouc3RyaW5nKCksXG4gICAgcHJvdmlkZXJFeGVjdXRlZDogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgICBkeW5hbWljOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgncmVhc29uaW5nJyksXG4gICAgdGV4dDogei5zdHJpbmcoKSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdyZWFzb25pbmctc3RhcnQnKSxcbiAgICBpZDogei5zdHJpbmcoKSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdyZWFzb25pbmctZGVsdGEnKSxcbiAgICBpZDogei5zdHJpbmcoKSxcbiAgICBkZWx0YTogei5zdHJpbmcoKSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdyZWFzb25pbmctZW5kJyksXG4gICAgaWQ6IHouc3RyaW5nKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgncmVhc29uaW5nLXBhcnQtZmluaXNoJyksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdzb3VyY2UtdXJsJyksXG4gICAgc291cmNlSWQ6IHouc3RyaW5nKCksXG4gICAgdXJsOiB6LnN0cmluZygpLFxuICAgIHRpdGxlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgnc291cmNlLWRvY3VtZW50JyksXG4gICAgc291cmNlSWQ6IHouc3RyaW5nKCksXG4gICAgbWVkaWFUeXBlOiB6LnN0cmluZygpLFxuICAgIHRpdGxlOiB6LnN0cmluZygpLFxuICAgIGZpbGVuYW1lOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgnZmlsZScpLFxuICAgIHVybDogei5zdHJpbmcoKSxcbiAgICBtZWRpYVR5cGU6IHouc3RyaW5nKCksXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5zdHJpY3RPYmplY3Qoe1xuICAgIHR5cGU6IHouc3RyaW5nKCkuc3RhcnRzV2l0aCgnZGF0YS0nKSxcbiAgICBpZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGRhdGE6IHoudW5rbm93bigpLFxuICAgIHRyYW5zaWVudDogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ3N0YXJ0LXN0ZXAnKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ2ZpbmlzaC1zdGVwJyksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdzdGFydCcpLFxuICAgIG1lc3NhZ2VJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIG1lc3NhZ2VNZXRhZGF0YTogei51bmtub3duKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ2ZpbmlzaCcpLFxuICAgIG1lc3NhZ2VNZXRhZGF0YTogei51bmtub3duKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHouc3RyaWN0T2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ2Fib3J0JyksXG4gIH0pLFxuICB6LnN0cmljdE9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdtZXNzYWdlLW1ldGFkYXRhJyksXG4gICAgbWVzc2FnZU1ldGFkYXRhOiB6LnVua25vd24oKSxcbiAgfSksXG5dKTtcblxuZXhwb3J0IHR5cGUgRGF0YVVJTWVzc2FnZUNodW5rPERBVEFfVFlQRVMgZXh0ZW5kcyBVSURhdGFUeXBlcz4gPSBWYWx1ZU9mPHtcbiAgW05BTUUgaW4ga2V5b2YgREFUQV9UWVBFUyAmIHN0cmluZ106IHtcbiAgICB0eXBlOiBgZGF0YS0ke05BTUV9YDtcbiAgICBpZD86IHN0cmluZztcbiAgICBkYXRhOiBEQVRBX1RZUEVTW05BTUVdO1xuICAgIHRyYW5zaWVudD86IGJvb2xlYW47XG4gIH07XG59PjtcblxuZXhwb3J0IHR5cGUgVUlNZXNzYWdlQ2h1bms8XG4gIE1FVEFEQVRBID0gdW5rbm93bixcbiAgREFUQV9UWVBFUyBleHRlbmRzIFVJRGF0YVR5cGVzID0gVUlEYXRhVHlwZXMsXG4+ID1cbiAgfCB7XG4gICAgICB0eXBlOiAndGV4dC1zdGFydCc7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICd0ZXh0LWRlbHRhJztcbiAgICAgIGRlbHRhOiBzdHJpbmc7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICd0ZXh0LWVuZCc7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdyZWFzb25pbmctc3RhcnQnO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAncmVhc29uaW5nLWRlbHRhJztcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBkZWx0YTogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdyZWFzb25pbmctZW5kJztcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ2Vycm9yJztcbiAgICAgIGVycm9yVGV4dDogc3RyaW5nO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAndG9vbC1pbnB1dC1hdmFpbGFibGUnO1xuICAgICAgdG9vbENhbGxJZDogc3RyaW5nO1xuICAgICAgdG9vbE5hbWU6IHN0cmluZztcbiAgICAgIGlucHV0OiB1bmtub3duO1xuICAgICAgcHJvdmlkZXJFeGVjdXRlZD86IGJvb2xlYW47XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgIGR5bmFtaWM/OiBib29sZWFuO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAndG9vbC1pbnB1dC1lcnJvcic7XG4gICAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgICB0b29sTmFtZTogc3RyaW5nO1xuICAgICAgaW5wdXQ6IHVua25vd247XG4gICAgICBwcm92aWRlckV4ZWN1dGVkPzogYm9vbGVhbjtcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgZHluYW1pYz86IGJvb2xlYW47XG4gICAgICBlcnJvclRleHQ6IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3Rvb2wtb3V0cHV0LWF2YWlsYWJsZSc7XG4gICAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgICBvdXRwdXQ6IHVua25vd247XG4gICAgICBwcm92aWRlckV4ZWN1dGVkPzogYm9vbGVhbjtcbiAgICAgIGR5bmFtaWM/OiBib29sZWFuO1xuICAgICAgcHJlbGltaW5hcnk/OiBib29sZWFuO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAndG9vbC1vdXRwdXQtZXJyb3InO1xuICAgICAgdG9vbENhbGxJZDogc3RyaW5nO1xuICAgICAgZXJyb3JUZXh0OiBzdHJpbmc7XG4gICAgICBwcm92aWRlckV4ZWN1dGVkPzogYm9vbGVhbjtcbiAgICAgIGR5bmFtaWM/OiBib29sZWFuO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAndG9vbC1pbnB1dC1zdGFydCc7XG4gICAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgICB0b29sTmFtZTogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJFeGVjdXRlZD86IGJvb2xlYW47XG4gICAgICBkeW5hbWljPzogYm9vbGVhbjtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtZGVsdGEnO1xuICAgICAgdG9vbENhbGxJZDogc3RyaW5nO1xuICAgICAgaW5wdXRUZXh0RGVsdGE6IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3NvdXJjZS11cmwnO1xuICAgICAgc291cmNlSWQ6IHN0cmluZztcbiAgICAgIHVybDogc3RyaW5nO1xuICAgICAgdGl0bGU/OiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3NvdXJjZS1kb2N1bWVudCc7XG4gICAgICBzb3VyY2VJZDogc3RyaW5nO1xuICAgICAgbWVkaWFUeXBlOiBzdHJpbmc7XG4gICAgICB0aXRsZTogc3RyaW5nO1xuICAgICAgZmlsZW5hbWU/OiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ2ZpbGUnO1xuICAgICAgdXJsOiBzdHJpbmc7XG4gICAgICBtZWRpYVR5cGU6IHN0cmluZztcbiAgICB9XG4gIHwgRGF0YVVJTWVzc2FnZUNodW5rPERBVEFfVFlQRVM+XG4gIHwge1xuICAgICAgdHlwZTogJ3N0YXJ0LXN0ZXAnO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAnZmluaXNoLXN0ZXAnO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAnc3RhcnQnO1xuICAgICAgbWVzc2FnZUlkPzogc3RyaW5nO1xuICAgICAgbWVzc2FnZU1ldGFkYXRhPzogTUVUQURBVEE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdmaW5pc2gnO1xuICAgICAgbWVzc2FnZU1ldGFkYXRhPzogTUVUQURBVEE7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdhYm9ydCc7XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdtZXNzYWdlLW1ldGFkYXRhJztcbiAgICAgIG1lc3NhZ2VNZXRhZGF0YTogTUVUQURBVEE7XG4gICAgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzRGF0YVVJTWVzc2FnZUNodW5rKFxuICBjaHVuazogVUlNZXNzYWdlQ2h1bmssXG4pOiBjaHVuayBpcyBEYXRhVUlNZXNzYWdlQ2h1bms8VUlEYXRhVHlwZXM+IHtcbiAgcmV0dXJuIGNodW5rLnR5cGUuc3RhcnRzV2l0aCgnZGF0YS0nKTtcbn1cblxuZXhwb3J0IHR5cGUgSW5mZXJVSU1lc3NhZ2VDaHVuazxUIGV4dGVuZHMgVUlNZXNzYWdlPiA9IFVJTWVzc2FnZUNodW5rPFxuICBJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFQ+LFxuICBJbmZlclVJTWVzc2FnZURhdGE8VD5cbj47XG4iLCAiLyoqXG4gKiBEZWVwbHkgbWVyZ2VzIHR3byBvYmplY3RzIHRvZ2V0aGVyLlxuICogLSBQcm9wZXJ0aWVzIGZyb20gdGhlIGBvdmVycmlkZXNgIG9iamVjdCBvdmVycmlkZSB0aG9zZSBpbiB0aGUgYGJhc2VgIG9iamVjdCB3aXRoIHRoZSBzYW1lIGtleS5cbiAqIC0gRm9yIG5lc3RlZCBvYmplY3RzLCB0aGUgbWVyZ2UgaXMgcGVyZm9ybWVkIHJlY3Vyc2l2ZWx5IChkZWVwIG1lcmdlKS5cbiAqIC0gQXJyYXlzIGFyZSByZXBsYWNlZCwgbm90IG1lcmdlZC5cbiAqIC0gUHJpbWl0aXZlIHZhbHVlcyBhcmUgcmVwbGFjZWQuXG4gKiAtIElmIGJvdGggYGJhc2VgIGFuZCBgb3ZlcnJpZGVzYCBhcmUgdW5kZWZpbmVkLCByZXR1cm5zIHVuZGVmaW5lZC5cbiAqIC0gSWYgb25lIG9mIGBiYXNlYCBvciBgb3ZlcnJpZGVzYCBpcyB1bmRlZmluZWQsIHJldHVybnMgdGhlIG90aGVyLlxuICpcbiAqIEBwYXJhbSBiYXNlIFRoZSB0YXJnZXQgb2JqZWN0IHRvIG1lcmdlIGludG9cbiAqIEBwYXJhbSBvdmVycmlkZXMgVGhlIHNvdXJjZSBvYmplY3QgdG8gbWVyZ2UgZnJvbVxuICogQHJldHVybnMgQSBuZXcgb2JqZWN0IHdpdGggdGhlIG1lcmdlZCBwcm9wZXJ0aWVzLCBvciB1bmRlZmluZWQgaWYgYm90aCBpbnB1dHMgYXJlIHVuZGVmaW5lZFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VPYmplY3RzPFQgZXh0ZW5kcyBvYmplY3QsIFUgZXh0ZW5kcyBvYmplY3Q+KFxuICBiYXNlOiBUIHwgdW5kZWZpbmVkLFxuICBvdmVycmlkZXM6IFUgfCB1bmRlZmluZWQsXG4pOiAoVCAmIFUpIHwgVCB8IFUgfCB1bmRlZmluZWQge1xuICAvLyBJZiBib3RoIGlucHV0cyBhcmUgdW5kZWZpbmVkLCByZXR1cm4gdW5kZWZpbmVkXG4gIGlmIChiYXNlID09PSB1bmRlZmluZWQgJiYgb3ZlcnJpZGVzID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gSWYgdGFyZ2V0IGlzIHVuZGVmaW5lZCwgcmV0dXJuIHNvdXJjZVxuICBpZiAoYmFzZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIG92ZXJyaWRlcztcbiAgfVxuXG4gIC8vIElmIHNvdXJjZSBpcyB1bmRlZmluZWQsIHJldHVybiB0YXJnZXRcbiAgaWYgKG92ZXJyaWRlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGJhc2U7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBuZXcgb2JqZWN0IHRvIGF2b2lkIG11dGF0aW5nIHRoZSBpbnB1dHNcbiAgY29uc3QgcmVzdWx0ID0geyAuLi5iYXNlIH0gYXMgVCAmIFU7XG5cbiAgLy8gSXRlcmF0ZSB0aHJvdWdoIGFsbCBrZXlzIGluIHRoZSBzb3VyY2Ugb2JqZWN0XG4gIGZvciAoY29uc3Qga2V5IGluIG92ZXJyaWRlcykge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3ZlcnJpZGVzLCBrZXkpKSB7XG4gICAgICBjb25zdCBvdmVycmlkZXNWYWx1ZSA9IG92ZXJyaWRlc1trZXldO1xuXG4gICAgICAvLyBTa2lwIGlmIHRoZSBvdmVycmlkZXMgdmFsdWUgaXMgdW5kZWZpbmVkXG4gICAgICBpZiAob3ZlcnJpZGVzVmFsdWUgPT09IHVuZGVmaW5lZCkgY29udGludWU7XG5cbiAgICAgIC8vIEdldCB0aGUgYmFzZSB2YWx1ZSBpZiBpdCBleGlzdHNcbiAgICAgIGNvbnN0IGJhc2VWYWx1ZSA9XG4gICAgICAgIGtleSBpbiBiYXNlID8gYmFzZVtrZXkgYXMgdW5rbm93biBhcyBrZXlvZiBUXSA6IHVuZGVmaW5lZDtcblxuICAgICAgLy8gQ2hlY2sgaWYgYm90aCB2YWx1ZXMgYXJlIG9iamVjdHMgdGhhdCBjYW4gYmUgZGVlcGx5IG1lcmdlZFxuICAgICAgY29uc3QgaXNTb3VyY2VPYmplY3QgPVxuICAgICAgICBvdmVycmlkZXNWYWx1ZSAhPT0gbnVsbCAmJlxuICAgICAgICB0eXBlb2Ygb3ZlcnJpZGVzVmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgICAgICFBcnJheS5pc0FycmF5KG92ZXJyaWRlc1ZhbHVlKSAmJlxuICAgICAgICAhKG92ZXJyaWRlc1ZhbHVlIGluc3RhbmNlb2YgRGF0ZSkgJiZcbiAgICAgICAgIShvdmVycmlkZXNWYWx1ZSBpbnN0YW5jZW9mIFJlZ0V4cCk7XG5cbiAgICAgIGNvbnN0IGlzVGFyZ2V0T2JqZWN0ID1cbiAgICAgICAgYmFzZVZhbHVlICE9PSBudWxsICYmXG4gICAgICAgIGJhc2VWYWx1ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIHR5cGVvZiBiYXNlVmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgICAgICFBcnJheS5pc0FycmF5KGJhc2VWYWx1ZSkgJiZcbiAgICAgICAgIShiYXNlVmFsdWUgaW5zdGFuY2VvZiBEYXRlKSAmJlxuICAgICAgICAhKGJhc2VWYWx1ZSBpbnN0YW5jZW9mIFJlZ0V4cCk7XG5cbiAgICAgIC8vIElmIGJvdGggdmFsdWVzIGFyZSBtZXJnZWFibGUgb2JqZWN0cywgbWVyZ2UgdGhlbSByZWN1cnNpdmVseVxuICAgICAgaWYgKGlzU291cmNlT2JqZWN0ICYmIGlzVGFyZ2V0T2JqZWN0KSB7XG4gICAgICAgIHJlc3VsdFtrZXkgYXMga2V5b2YgKFQgJiBVKV0gPSBtZXJnZU9iamVjdHMoXG4gICAgICAgICAgYmFzZVZhbHVlIGFzIG9iamVjdCxcbiAgICAgICAgICBvdmVycmlkZXNWYWx1ZSBhcyBvYmplY3QsXG4gICAgICAgICkgYXMgYW55O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIHByaW1pdGl2ZXMsIGFycmF5cywgb3Igd2hlbiBvbmUgdmFsdWUgaXMgbm90IGEgbWVyZ2VhYmxlIG9iamVjdCxcbiAgICAgICAgLy8gc2ltcGx5IG92ZXJyaWRlIHdpdGggdGhlIHNvdXJjZSB2YWx1ZVxuICAgICAgICByZXN1bHRba2V5IGFzIGtleW9mIChUICYgVSldID0gb3ZlcnJpZGVzVmFsdWUgYXMgYW55O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG4iLCAiaW1wb3J0IHsgSlNPTlZhbHVlIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBzYWZlUGFyc2VKU09OIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBmaXhKc29uIH0gZnJvbSAnLi9maXgtanNvbic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVBhcnRpYWxKc29uKGpzb25UZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQpOiBQcm9taXNlPHtcbiAgdmFsdWU6IEpTT05WYWx1ZSB8IHVuZGVmaW5lZDtcbiAgc3RhdGU6XG4gICAgfCAndW5kZWZpbmVkLWlucHV0J1xuICAgIHwgJ3N1Y2Nlc3NmdWwtcGFyc2UnXG4gICAgfCAncmVwYWlyZWQtcGFyc2UnXG4gICAgfCAnZmFpbGVkLXBhcnNlJztcbn0+IHtcbiAgaWYgKGpzb25UZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBzdGF0ZTogJ3VuZGVmaW5lZC1pbnB1dCcgfTtcbiAgfVxuXG4gIGxldCByZXN1bHQgPSBhd2FpdCBzYWZlUGFyc2VKU09OKHsgdGV4dDoganNvblRleHQgfSk7XG5cbiAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHJlc3VsdC52YWx1ZSwgc3RhdGU6ICdzdWNjZXNzZnVsLXBhcnNlJyB9O1xuICB9XG5cbiAgcmVzdWx0ID0gYXdhaXQgc2FmZVBhcnNlSlNPTih7IHRleHQ6IGZpeEpzb24oanNvblRleHQpIH0pO1xuXG4gIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHQudmFsdWUsIHN0YXRlOiAncmVwYWlyZWQtcGFyc2UnIH07XG4gIH1cblxuICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBzdGF0ZTogJ2ZhaWxlZC1wYXJzZScgfTtcbn1cbiIsICJ0eXBlIFN0YXRlID1cbiAgfCAnUk9PVCdcbiAgfCAnRklOSVNIJ1xuICB8ICdJTlNJREVfU1RSSU5HJ1xuICB8ICdJTlNJREVfU1RSSU5HX0VTQ0FQRSdcbiAgfCAnSU5TSURFX0xJVEVSQUwnXG4gIHwgJ0lOU0lERV9OVU1CRVInXG4gIHwgJ0lOU0lERV9PQkpFQ1RfU1RBUlQnXG4gIHwgJ0lOU0lERV9PQkpFQ1RfS0VZJ1xuICB8ICdJTlNJREVfT0JKRUNUX0FGVEVSX0tFWSdcbiAgfCAnSU5TSURFX09CSkVDVF9CRUZPUkVfVkFMVUUnXG4gIHwgJ0lOU0lERV9PQkpFQ1RfQUZURVJfVkFMVUUnXG4gIHwgJ0lOU0lERV9PQkpFQ1RfQUZURVJfQ09NTUEnXG4gIHwgJ0lOU0lERV9BUlJBWV9TVEFSVCdcbiAgfCAnSU5TSURFX0FSUkFZX0FGVEVSX1ZBTFVFJ1xuICB8ICdJTlNJREVfQVJSQVlfQUZURVJfQ09NTUEnO1xuXG4vLyBJbXBsZW1lbnRlZCBhcyBhIHNjYW5uZXIgd2l0aCBhZGRpdGlvbmFsIGZpeGluZ1xuLy8gdGhhdCBwZXJmb3JtcyBhIHNpbmdsZSBsaW5lYXIgdGltZSBzY2FuIHBhc3Mgb3ZlciB0aGUgcGFydGlhbCBKU09OLlxuLy9cbi8vIFRoZSBzdGF0ZXMgc2hvdWxkIGlkZWFsbHkgbWF0Y2ggcmVsZXZhbnQgc3RhdGVzIGZyb20gdGhlIEpTT04gc3BlYzpcbi8vIGh0dHBzOi8vd3d3Lmpzb24ub3JnL2pzb24tZW4uaHRtbFxuLy9cbi8vIFBsZWFzZSBub3RlIHRoYXQgaW52YWxpZCBKU09OIGlzIG5vdCBjb25zaWRlcmVkL2NvdmVyZWQsIGJlY2F1c2UgaXRcbi8vIGlzIGFzc3VtZWQgdGhhdCB0aGUgcmVzdWx0aW5nIEpTT04gd2lsbCBiZSBwcm9jZXNzZWQgYnkgYSBzdGFuZGFyZFxuLy8gSlNPTiBwYXJzZXIgdGhhdCB3aWxsIGRldGVjdCBhbnkgaW52YWxpZCBKU09OLlxuZXhwb3J0IGZ1bmN0aW9uIGZpeEpzb24oaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHN0YWNrOiBTdGF0ZVtdID0gWydST09UJ107XG4gIGxldCBsYXN0VmFsaWRJbmRleCA9IC0xO1xuICBsZXQgbGl0ZXJhbFN0YXJ0OiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICBmdW5jdGlvbiBwcm9jZXNzVmFsdWVTdGFydChjaGFyOiBzdHJpbmcsIGk6IG51bWJlciwgc3dhcFN0YXRlOiBTdGF0ZSkge1xuICAgIHtcbiAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICBjYXNlICdcIic6IHtcbiAgICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgc3RhY2sucHVzaChzd2FwU3RhdGUpO1xuICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9TVFJJTkcnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgJ2YnOlxuICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgY2FzZSAnbic6IHtcbiAgICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgICAgbGl0ZXJhbFN0YXJ0ID0gaTtcbiAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICBzdGFjay5wdXNoKHN3YXBTdGF0ZSk7XG4gICAgICAgICAgc3RhY2sucHVzaCgnSU5TSURFX0xJVEVSQUwnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgJy0nOiB7XG4gICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgc3RhY2sucHVzaChzd2FwU3RhdGUpO1xuICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9OVU1CRVInKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICcwJzpcbiAgICAgICAgY2FzZSAnMSc6XG4gICAgICAgIGNhc2UgJzInOlxuICAgICAgICBjYXNlICczJzpcbiAgICAgICAgY2FzZSAnNCc6XG4gICAgICAgIGNhc2UgJzUnOlxuICAgICAgICBjYXNlICc2JzpcbiAgICAgICAgY2FzZSAnNyc6XG4gICAgICAgIGNhc2UgJzgnOlxuICAgICAgICBjYXNlICc5Jzoge1xuICAgICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTtcbiAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICBzdGFjay5wdXNoKHN3YXBTdGF0ZSk7XG4gICAgICAgICAgc3RhY2sucHVzaCgnSU5TSURFX05VTUJFUicpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSAneyc6IHtcbiAgICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgc3RhY2sucHVzaChzd2FwU3RhdGUpO1xuICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9PQkpFQ1RfU1RBUlQnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgJ1snOiB7XG4gICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgIHN0YWNrLnB1c2goc3dhcFN0YXRlKTtcbiAgICAgICAgICBzdGFjay5wdXNoKCdJTlNJREVfQVJSQVlfU1RBUlQnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHByb2Nlc3NBZnRlck9iamVjdFZhbHVlKGNoYXI6IHN0cmluZywgaTogbnVtYmVyKSB7XG4gICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICBjYXNlICcsJzoge1xuICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgc3RhY2sucHVzaCgnSU5TSURFX09CSkVDVF9BRlRFUl9DT01NQScpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ30nOiB7XG4gICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTtcbiAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHByb2Nlc3NBZnRlckFycmF5VmFsdWUoY2hhcjogc3RyaW5nLCBpOiBudW1iZXIpIHtcbiAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgIGNhc2UgJywnOiB7XG4gICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICBzdGFjay5wdXNoKCdJTlNJREVfQVJSQVlfQUZURVJfQ09NTUEnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICddJzoge1xuICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY2hhciA9IGlucHV0W2ldO1xuICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdO1xuXG4gICAgc3dpdGNoIChjdXJyZW50U3RhdGUpIHtcbiAgICAgIGNhc2UgJ1JPT1QnOlxuICAgICAgICBwcm9jZXNzVmFsdWVTdGFydChjaGFyLCBpLCAnRklOSVNIJyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdJTlNJREVfT0JKRUNUX1NUQVJUJzoge1xuICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICBjYXNlICdcIic6IHtcbiAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgc3RhY2sucHVzaCgnSU5TSURFX09CSkVDVF9LRVknKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICd9Jzoge1xuICAgICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9PQkpFQ1RfQUZURVJfQ09NTUEnOiB7XG4gICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgIGNhc2UgJ1wiJzoge1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBzdGFjay5wdXNoKCdJTlNJREVfT0JKRUNUX0tFWScpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdJTlNJREVfT0JKRUNUX0tFWSc6IHtcbiAgICAgICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICAgICAgY2FzZSAnXCInOiB7XG4gICAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9PQkpFQ1RfQUZURVJfS0VZJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9PQkpFQ1RfQUZURVJfS0VZJzoge1xuICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICBjYXNlICc6Jzoge1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBzdGFjay5wdXNoKCdJTlNJREVfT0JKRUNUX0JFRk9SRV9WQUxVRScpO1xuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9PQkpFQ1RfQkVGT1JFX1ZBTFVFJzoge1xuICAgICAgICBwcm9jZXNzVmFsdWVTdGFydChjaGFyLCBpLCAnSU5TSURFX09CSkVDVF9BRlRFUl9WQUxVRScpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAnSU5TSURFX09CSkVDVF9BRlRFUl9WQUxVRSc6IHtcbiAgICAgICAgcHJvY2Vzc0FmdGVyT2JqZWN0VmFsdWUoY2hhciwgaSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdJTlNJREVfU1RSSU5HJzoge1xuICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICBjYXNlICdcIic6IHtcbiAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2FzZSAnXFxcXCc6IHtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9TVFJJTkdfRVNDQVBFJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9BUlJBWV9TVEFSVCc6IHtcbiAgICAgICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICAgICAgY2FzZSAnXSc6IHtcbiAgICAgICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTtcbiAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICAgICAgcHJvY2Vzc1ZhbHVlU3RhcnQoY2hhciwgaSwgJ0lOU0lERV9BUlJBWV9BRlRFUl9WQUxVRScpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdJTlNJREVfQVJSQVlfQUZURVJfVkFMVUUnOiB7XG4gICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgIGNhc2UgJywnOiB7XG4gICAgICAgICAgICBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goJ0lOU0lERV9BUlJBWV9BRlRFUl9DT01NQScpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2FzZSAnXSc6IHtcbiAgICAgICAgICAgIGxhc3RWYWxpZEluZGV4ID0gaTtcbiAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9BUlJBWV9BRlRFUl9DT01NQSc6IHtcbiAgICAgICAgcHJvY2Vzc1ZhbHVlU3RhcnQoY2hhciwgaSwgJ0lOU0lERV9BUlJBWV9BRlRFUl9WQUxVRScpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAnSU5TSURFX1NUUklOR19FU0NBUEUnOiB7XG4gICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9OVU1CRVInOiB7XG4gICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgIGNhc2UgJzAnOlxuICAgICAgICAgIGNhc2UgJzEnOlxuICAgICAgICAgIGNhc2UgJzInOlxuICAgICAgICAgIGNhc2UgJzMnOlxuICAgICAgICAgIGNhc2UgJzQnOlxuICAgICAgICAgIGNhc2UgJzUnOlxuICAgICAgICAgIGNhc2UgJzYnOlxuICAgICAgICAgIGNhc2UgJzcnOlxuICAgICAgICAgIGNhc2UgJzgnOlxuICAgICAgICAgIGNhc2UgJzknOiB7XG4gICAgICAgICAgICBsYXN0VmFsaWRJbmRleCA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXNlICdlJzpcbiAgICAgICAgICBjYXNlICdFJzpcbiAgICAgICAgICBjYXNlICctJzpcbiAgICAgICAgICBjYXNlICcuJzoge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2FzZSAnLCc6IHtcbiAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuXG4gICAgICAgICAgICBpZiAoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gPT09ICdJTlNJREVfQVJSQVlfQUZURVJfVkFMVUUnKSB7XG4gICAgICAgICAgICAgIHByb2Nlc3NBZnRlckFycmF5VmFsdWUoY2hhciwgaSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9PT0gJ0lOU0lERV9PQkpFQ1RfQUZURVJfVkFMVUUnKSB7XG4gICAgICAgICAgICAgIHByb2Nlc3NBZnRlck9iamVjdFZhbHVlKGNoYXIsIGkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXNlICd9Jzoge1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG5cbiAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9PT0gJ0lOU0lERV9PQkpFQ1RfQUZURVJfVkFMVUUnKSB7XG4gICAgICAgICAgICAgIHByb2Nlc3NBZnRlck9iamVjdFZhbHVlKGNoYXIsIGkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXNlICddJzoge1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG5cbiAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9PT0gJ0lOU0lERV9BUlJBWV9BRlRFUl9WQUxVRScpIHtcbiAgICAgICAgICAgICAgcHJvY2Vzc0FmdGVyQXJyYXlWYWx1ZShjaGFyLCBpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAnSU5TSURFX0xJVEVSQUwnOiB7XG4gICAgICAgIGNvbnN0IHBhcnRpYWxMaXRlcmFsID0gaW5wdXQuc3Vic3RyaW5nKGxpdGVyYWxTdGFydCEsIGkgKyAxKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgISdmYWxzZScuc3RhcnRzV2l0aChwYXJ0aWFsTGl0ZXJhbCkgJiZcbiAgICAgICAgICAhJ3RydWUnLnN0YXJ0c1dpdGgocGFydGlhbExpdGVyYWwpICYmXG4gICAgICAgICAgISdudWxsJy5zdGFydHNXaXRoKHBhcnRpYWxMaXRlcmFsKVxuICAgICAgICApIHtcbiAgICAgICAgICBzdGFjay5wb3AoKTtcblxuICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSA9PT0gJ0lOU0lERV9PQkpFQ1RfQUZURVJfVkFMVUUnKSB7XG4gICAgICAgICAgICBwcm9jZXNzQWZ0ZXJPYmplY3RWYWx1ZShjaGFyLCBpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID09PSAnSU5TSURFX0FSUkFZX0FGVEVSX1ZBTFVFJykge1xuICAgICAgICAgICAgcHJvY2Vzc0FmdGVyQXJyYXlWYWx1ZShjaGFyLCBpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGFzdFZhbGlkSW5kZXggPSBpO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbGV0IHJlc3VsdCA9IGlucHV0LnNsaWNlKDAsIGxhc3RWYWxpZEluZGV4ICsgMSk7XG5cbiAgZm9yIChsZXQgaSA9IHN0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBzdGFja1tpXTtcblxuICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgIGNhc2UgJ0lOU0lERV9TVFJJTkcnOiB7XG4gICAgICAgIHJlc3VsdCArPSAnXCInO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAnSU5TSURFX09CSkVDVF9LRVknOlxuICAgICAgY2FzZSAnSU5TSURFX09CSkVDVF9BRlRFUl9LRVknOlxuICAgICAgY2FzZSAnSU5TSURFX09CSkVDVF9BRlRFUl9DT01NQSc6XG4gICAgICBjYXNlICdJTlNJREVfT0JKRUNUX1NUQVJUJzpcbiAgICAgIGNhc2UgJ0lOU0lERV9PQkpFQ1RfQkVGT1JFX1ZBTFVFJzpcbiAgICAgIGNhc2UgJ0lOU0lERV9PQkpFQ1RfQUZURVJfVkFMVUUnOiB7XG4gICAgICAgIHJlc3VsdCArPSAnfSc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdJTlNJREVfQVJSQVlfU1RBUlQnOlxuICAgICAgY2FzZSAnSU5TSURFX0FSUkFZX0FGVEVSX0NPTU1BJzpcbiAgICAgIGNhc2UgJ0lOU0lERV9BUlJBWV9BRlRFUl9WQUxVRSc6IHtcbiAgICAgICAgcmVzdWx0ICs9ICddJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ0lOU0lERV9MSVRFUkFMJzoge1xuICAgICAgICBjb25zdCBwYXJ0aWFsTGl0ZXJhbCA9IGlucHV0LnN1YnN0cmluZyhsaXRlcmFsU3RhcnQhLCBpbnB1dC5sZW5ndGgpO1xuXG4gICAgICAgIGlmICgndHJ1ZScuc3RhcnRzV2l0aChwYXJ0aWFsTGl0ZXJhbCkpIHtcbiAgICAgICAgICByZXN1bHQgKz0gJ3RydWUnLnNsaWNlKHBhcnRpYWxMaXRlcmFsLmxlbmd0aCk7XG4gICAgICAgIH0gZWxzZSBpZiAoJ2ZhbHNlJy5zdGFydHNXaXRoKHBhcnRpYWxMaXRlcmFsKSkge1xuICAgICAgICAgIHJlc3VsdCArPSAnZmFsc2UnLnNsaWNlKHBhcnRpYWxMaXRlcmFsLmxlbmd0aCk7XG4gICAgICAgIH0gZWxzZSBpZiAoJ251bGwnLnN0YXJ0c1dpdGgocGFydGlhbExpdGVyYWwpKSB7XG4gICAgICAgICAgcmVzdWx0ICs9ICdudWxsJy5zbGljZShwYXJ0aWFsTGl0ZXJhbC5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsICJpbXBvcnQge1xuICBJbmZlclRvb2xJbnB1dCxcbiAgSW5mZXJUb29sT3V0cHV0LFxuICBUb29sLFxuICBUb29sQ2FsbCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBUb29sU2V0IH0gZnJvbSAnLi4vZ2VuZXJhdGUtdGV4dCc7XG5pbXBvcnQgeyBQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvcHJvdmlkZXItbWV0YWRhdGEnO1xuaW1wb3J0IHsgRGVlcFBhcnRpYWwgfSBmcm9tICcuLi91dGlsL2RlZXAtcGFydGlhbCc7XG5pbXBvcnQgeyBWYWx1ZU9mIH0gZnJvbSAnLi4vdXRpbC92YWx1ZS1vZic7XG5cbi8qKlxuVGhlIGRhdGEgdHlwZXMgdGhhdCBjYW4gYmUgdXNlZCBpbiB0aGUgVUkgbWVzc2FnZSBmb3IgdGhlIFVJIG1lc3NhZ2UgZGF0YSBwYXJ0cy5cbiAqL1xuZXhwb3J0IHR5cGUgVUlEYXRhVHlwZXMgPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcblxuZXhwb3J0IHR5cGUgVUlUb29sID0ge1xuICBpbnB1dDogdW5rbm93bjtcbiAgb3V0cHV0OiB1bmtub3duIHwgdW5kZWZpbmVkO1xufTtcblxuLyoqXG4gKiBJbmZlciB0aGUgaW5wdXQgYW5kIG91dHB1dCB0eXBlcyBvZiBhIHRvb2wgc28gaXQgY2FuIGJlIHVzZWQgYXMgYSBVSSB0b29sLlxuICovXG5leHBvcnQgdHlwZSBJbmZlclVJVG9vbDxUT09MIGV4dGVuZHMgVG9vbD4gPSB7XG4gIGlucHV0OiBJbmZlclRvb2xJbnB1dDxUT09MPjtcbiAgb3V0cHV0OiBJbmZlclRvb2xPdXRwdXQ8VE9PTD47XG59O1xuXG4vKipcbiAqIEluZmVyIHRoZSBpbnB1dCBhbmQgb3V0cHV0IHR5cGVzIG9mIGEgdG9vbCBzZXQgc28gaXQgY2FuIGJlIHVzZWQgYXMgYSBVSSB0b29sIHNldC5cbiAqL1xuZXhwb3J0IHR5cGUgSW5mZXJVSVRvb2xzPFRPT0xTIGV4dGVuZHMgVG9vbFNldD4gPSB7XG4gIFtOQU1FIGluIGtleW9mIFRPT0xTICYgc3RyaW5nXTogSW5mZXJVSVRvb2w8VE9PTFNbTkFNRV0+O1xufTtcblxuZXhwb3J0IHR5cGUgVUlUb29scyA9IFJlY29yZDxzdHJpbmcsIFVJVG9vbD47XG5cbi8qKlxuQUkgU0RLIFVJIE1lc3NhZ2VzLiBUaGV5IGFyZSB1c2VkIGluIHRoZSBjbGllbnQgYW5kIHRvIGNvbW11bmljYXRlIGJldHdlZW4gdGhlIGZyb250ZW5kIGFuZCB0aGUgQVBJIHJvdXRlcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBVSU1lc3NhZ2U8XG4gIE1FVEFEQVRBID0gdW5rbm93bixcbiAgREFUQV9QQVJUUyBleHRlbmRzIFVJRGF0YVR5cGVzID0gVUlEYXRhVHlwZXMsXG4gIFRPT0xTIGV4dGVuZHMgVUlUb29scyA9IFVJVG9vbHMsXG4+IHtcbiAgLyoqXG5BIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgbWVzc2FnZS5cbiAgICovXG4gIGlkOiBzdHJpbmc7XG5cbiAgLyoqXG5UaGUgcm9sZSBvZiB0aGUgbWVzc2FnZS5cbiAgICovXG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ3VzZXInIHwgJ2Fzc2lzdGFudCc7XG5cbiAgLyoqXG5UaGUgbWV0YWRhdGEgb2YgdGhlIG1lc3NhZ2UuXG4gICAqL1xuICBtZXRhZGF0YT86IE1FVEFEQVRBO1xuXG4gIC8qKlxuVGhlIHBhcnRzIG9mIHRoZSBtZXNzYWdlLiBVc2UgdGhpcyBmb3IgcmVuZGVyaW5nIHRoZSBtZXNzYWdlIGluIHRoZSBVSS5cblxuU3lzdGVtIG1lc3NhZ2VzIHNob3VsZCBiZSBhdm9pZGVkIChzZXQgdGhlIHN5c3RlbSBwcm9tcHQgb24gdGhlIHNlcnZlciBpbnN0ZWFkKS5cblRoZXkgY2FuIGhhdmUgdGV4dCBwYXJ0cy5cblxuVXNlciBtZXNzYWdlcyBjYW4gaGF2ZSB0ZXh0IHBhcnRzIGFuZCBmaWxlIHBhcnRzLlxuXG5Bc3Npc3RhbnQgbWVzc2FnZXMgY2FuIGhhdmUgdGV4dCwgcmVhc29uaW5nLCB0b29sIGludm9jYXRpb24sIGFuZCBmaWxlIHBhcnRzLlxuICAgKi9cbiAgcGFydHM6IEFycmF5PFVJTWVzc2FnZVBhcnQ8REFUQV9QQVJUUywgVE9PTFM+Pjtcbn1cblxuZXhwb3J0IHR5cGUgVUlNZXNzYWdlUGFydDxcbiAgREFUQV9UWVBFUyBleHRlbmRzIFVJRGF0YVR5cGVzLFxuICBUT09MUyBleHRlbmRzIFVJVG9vbHMsXG4+ID1cbiAgfCBUZXh0VUlQYXJ0XG4gIHwgUmVhc29uaW5nVUlQYXJ0XG4gIHwgVG9vbFVJUGFydDxUT09MUz5cbiAgfCBEeW5hbWljVG9vbFVJUGFydFxuICB8IFNvdXJjZVVybFVJUGFydFxuICB8IFNvdXJjZURvY3VtZW50VUlQYXJ0XG4gIHwgRmlsZVVJUGFydFxuICB8IERhdGFVSVBhcnQ8REFUQV9UWVBFUz5cbiAgfCBTdGVwU3RhcnRVSVBhcnQ7XG5cbi8qKlxuICogQSB0ZXh0IHBhcnQgb2YgYSBtZXNzYWdlLlxuICovXG5leHBvcnQgdHlwZSBUZXh0VUlQYXJ0ID0ge1xuICB0eXBlOiAndGV4dCc7XG5cbiAgLyoqXG4gICAqIFRoZSB0ZXh0IGNvbnRlbnQuXG4gICAqL1xuICB0ZXh0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBzdGF0ZSBvZiB0aGUgdGV4dCBwYXJ0LlxuICAgKi9cbiAgc3RhdGU/OiAnc3RyZWFtaW5nJyB8ICdkb25lJztcblxuICAvKipcbiAgICogVGhlIHByb3ZpZGVyIG1ldGFkYXRhLlxuICAgKi9cbiAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG59O1xuXG4vKipcbiAqIEEgcmVhc29uaW5nIHBhcnQgb2YgYSBtZXNzYWdlLlxuICovXG5leHBvcnQgdHlwZSBSZWFzb25pbmdVSVBhcnQgPSB7XG4gIHR5cGU6ICdyZWFzb25pbmcnO1xuXG4gIC8qKlxuICAgKiBUaGUgcmVhc29uaW5nIHRleHQuXG4gICAqL1xuICB0ZXh0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBzdGF0ZSBvZiB0aGUgcmVhc29uaW5nIHBhcnQuXG4gICAqL1xuICBzdGF0ZT86ICdzdHJlYW1pbmcnIHwgJ2RvbmUnO1xuXG4gIC8qKlxuICAgKiBUaGUgcHJvdmlkZXIgbWV0YWRhdGEuXG4gICAqL1xuICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbn07XG5cbi8qKlxuICogQSBzb3VyY2UgcGFydCBvZiBhIG1lc3NhZ2UuXG4gKi9cbmV4cG9ydCB0eXBlIFNvdXJjZVVybFVJUGFydCA9IHtcbiAgdHlwZTogJ3NvdXJjZS11cmwnO1xuICBzb3VyY2VJZDogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xufTtcblxuLyoqXG4gKiBBIGRvY3VtZW50IHNvdXJjZSBwYXJ0IG9mIGEgbWVzc2FnZS5cbiAqL1xuZXhwb3J0IHR5cGUgU291cmNlRG9jdW1lbnRVSVBhcnQgPSB7XG4gIHR5cGU6ICdzb3VyY2UtZG9jdW1lbnQnO1xuICBzb3VyY2VJZDogc3RyaW5nO1xuICBtZWRpYVR5cGU6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgZmlsZW5hbWU/OiBzdHJpbmc7XG4gIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xufTtcblxuLyoqXG4gKiBBIGZpbGUgcGFydCBvZiBhIG1lc3NhZ2UuXG4gKi9cbmV4cG9ydCB0eXBlIEZpbGVVSVBhcnQgPSB7XG4gIHR5cGU6ICdmaWxlJztcblxuICAvKipcbiAgICogSUFOQSBtZWRpYSB0eXBlIG9mIHRoZSBmaWxlLlxuICAgKlxuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL21lZGlhLXR5cGVzL21lZGlhLXR5cGVzLnhodG1sXG4gICAqL1xuICBtZWRpYVR5cGU6IHN0cmluZztcblxuICAvKipcbiAgICogT3B0aW9uYWwgZmlsZW5hbWUgb2YgdGhlIGZpbGUuXG4gICAqL1xuICBmaWxlbmFtZT86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIFVSTCBvZiB0aGUgZmlsZS5cbiAgICogSXQgY2FuIGVpdGhlciBiZSBhIFVSTCB0byBhIGhvc3RlZCBmaWxlIG9yIGEgW0RhdGEgVVJMXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVFRQL0Jhc2ljc19vZl9IVFRQL0RhdGFfVVJMcykuXG4gICAqL1xuICB1cmw6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHByb3ZpZGVyIG1ldGFkYXRhLlxuICAgKi9cbiAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG59O1xuXG4vKipcbiAqIEEgc3RlcCBib3VuZGFyeSBwYXJ0IG9mIGEgbWVzc2FnZS5cbiAqL1xuZXhwb3J0IHR5cGUgU3RlcFN0YXJ0VUlQYXJ0ID0ge1xuICB0eXBlOiAnc3RlcC1zdGFydCc7XG59O1xuXG5leHBvcnQgdHlwZSBEYXRhVUlQYXJ0PERBVEFfVFlQRVMgZXh0ZW5kcyBVSURhdGFUeXBlcz4gPSBWYWx1ZU9mPHtcbiAgW05BTUUgaW4ga2V5b2YgREFUQV9UWVBFUyAmIHN0cmluZ106IHtcbiAgICB0eXBlOiBgZGF0YS0ke05BTUV9YDtcbiAgICBpZD86IHN0cmluZztcbiAgICBkYXRhOiBEQVRBX1RZUEVTW05BTUVdO1xuICB9O1xufT47XG5cbmV4cG9ydCB0eXBlIFRvb2xVSVBhcnQ8VE9PTFMgZXh0ZW5kcyBVSVRvb2xzID0gVUlUb29scz4gPSBWYWx1ZU9mPHtcbiAgW05BTUUgaW4ga2V5b2YgVE9PTFMgJiBzdHJpbmddOiB7XG4gICAgdHlwZTogYHRvb2wtJHtOQU1FfWA7XG4gICAgdG9vbENhbGxJZDogc3RyaW5nO1xuICB9ICYgKFxuICAgIHwge1xuICAgICAgICBzdGF0ZTogJ2lucHV0LXN0cmVhbWluZyc7XG4gICAgICAgIGlucHV0OiBEZWVwUGFydGlhbDxUT09MU1tOQU1FXVsnaW5wdXQnXT4gfCB1bmRlZmluZWQ7XG4gICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICBvdXRwdXQ/OiBuZXZlcjtcbiAgICAgICAgZXJyb3JUZXh0PzogbmV2ZXI7XG4gICAgICB9XG4gICAgfCB7XG4gICAgICAgIHN0YXRlOiAnaW5wdXQtYXZhaWxhYmxlJztcbiAgICAgICAgaW5wdXQ6IFRPT0xTW05BTUVdWydpbnB1dCddO1xuICAgICAgICBwcm92aWRlckV4ZWN1dGVkPzogYm9vbGVhbjtcbiAgICAgICAgb3V0cHV0PzogbmV2ZXI7XG4gICAgICAgIGVycm9yVGV4dD86IG5ldmVyO1xuICAgICAgICBjYWxsUHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICB9XG4gICAgfCB7XG4gICAgICAgIHN0YXRlOiAnb3V0cHV0LWF2YWlsYWJsZSc7XG4gICAgICAgIGlucHV0OiBUT09MU1tOQU1FXVsnaW5wdXQnXTtcbiAgICAgICAgb3V0cHV0OiBUT09MU1tOQU1FXVsnb3V0cHV0J107XG4gICAgICAgIGVycm9yVGV4dD86IG5ldmVyO1xuICAgICAgICBwcm92aWRlckV4ZWN1dGVkPzogYm9vbGVhbjtcbiAgICAgICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgICBwcmVsaW1pbmFyeT86IGJvb2xlYW47XG4gICAgICB9XG4gICAgfCB7XG4gICAgICAgIHN0YXRlOiAnb3V0cHV0LWVycm9yJzsgLy8gVE9ETyBBSSBTREsgNjogY2hhbmdlIHRvICdlcnJvcicgc3RhdGVcbiAgICAgICAgaW5wdXQ6IFRPT0xTW05BTUVdWydpbnB1dCddIHwgdW5kZWZpbmVkO1xuICAgICAgICByYXdJbnB1dD86IHVua25vd247IC8vIFRPRE8gQUkgU0RLIDY6IHJlbW92ZSB0aGlzIGZpZWxkLCBpbnB1dCBzaG91bGQgYmUgdW5rbm93blxuICAgICAgICBvdXRwdXQ/OiBuZXZlcjtcbiAgICAgICAgZXJyb3JUZXh0OiBzdHJpbmc7XG4gICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ/OiBib29sZWFuO1xuICAgICAgICBjYWxsUHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICB9XG4gICk7XG59PjtcblxuZXhwb3J0IHR5cGUgRHluYW1pY1Rvb2xVSVBhcnQgPSB7XG4gIHR5cGU6ICdkeW5hbWljLXRvb2wnO1xuICB0b29sTmFtZTogc3RyaW5nO1xuICB0b29sQ2FsbElkOiBzdHJpbmc7XG59ICYgKFxuICB8IHtcbiAgICAgIHN0YXRlOiAnaW5wdXQtc3RyZWFtaW5nJztcbiAgICAgIGlucHV0OiB1bmtub3duIHwgdW5kZWZpbmVkO1xuICAgICAgb3V0cHV0PzogbmV2ZXI7XG4gICAgICBlcnJvclRleHQ/OiBuZXZlcjtcbiAgICB9XG4gIHwge1xuICAgICAgc3RhdGU6ICdpbnB1dC1hdmFpbGFibGUnO1xuICAgICAgaW5wdXQ6IHVua25vd247XG4gICAgICBvdXRwdXQ/OiBuZXZlcjtcbiAgICAgIGVycm9yVGV4dD86IG5ldmVyO1xuICAgICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgIH1cbiAgfCB7XG4gICAgICBzdGF0ZTogJ291dHB1dC1hdmFpbGFibGUnO1xuICAgICAgaW5wdXQ6IHVua25vd247XG4gICAgICBvdXRwdXQ6IHVua25vd247XG4gICAgICBlcnJvclRleHQ/OiBuZXZlcjtcbiAgICAgIGNhbGxQcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgIHByZWxpbWluYXJ5PzogYm9vbGVhbjtcbiAgICB9XG4gIHwge1xuICAgICAgc3RhdGU6ICdvdXRwdXQtZXJyb3InOyAvLyBUT0RPIEFJIFNESyA2OiBjaGFuZ2UgdG8gJ2Vycm9yJyBzdGF0ZVxuICAgICAgaW5wdXQ6IHVua25vd247XG4gICAgICBvdXRwdXQ/OiBuZXZlcjtcbiAgICAgIGVycm9yVGV4dDogc3RyaW5nO1xuICAgICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgIH1cbik7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Rvb2xVSVBhcnQ8VE9PTFMgZXh0ZW5kcyBVSVRvb2xzPihcbiAgcGFydDogVUlNZXNzYWdlUGFydDxVSURhdGFUeXBlcywgVE9PTFM+LFxuKTogcGFydCBpcyBUb29sVUlQYXJ0PFRPT0xTPiB7XG4gIHJldHVybiBwYXJ0LnR5cGUuc3RhcnRzV2l0aCgndG9vbC0nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRvb2xOYW1lPFRPT0xTIGV4dGVuZHMgVUlUb29scz4oXG4gIHBhcnQ6IFRvb2xVSVBhcnQ8VE9PTFM+LFxuKToga2V5b2YgVE9PTFMge1xuICByZXR1cm4gcGFydC50eXBlLnNwbGl0KCctJykuc2xpY2UoMSkuam9pbignLScpIGFzIGtleW9mIFRPT0xTO1xufVxuXG5leHBvcnQgdHlwZSBJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFQgZXh0ZW5kcyBVSU1lc3NhZ2U+ID1cbiAgVCBleHRlbmRzIFVJTWVzc2FnZTxpbmZlciBNRVRBREFUQT4gPyBNRVRBREFUQSA6IHVua25vd247XG5cbmV4cG9ydCB0eXBlIEluZmVyVUlNZXNzYWdlRGF0YTxUIGV4dGVuZHMgVUlNZXNzYWdlPiA9XG4gIFQgZXh0ZW5kcyBVSU1lc3NhZ2U8dW5rbm93biwgaW5mZXIgREFUQV9UWVBFUz4gPyBEQVRBX1RZUEVTIDogVUlEYXRhVHlwZXM7XG5cbmV4cG9ydCB0eXBlIEluZmVyVUlNZXNzYWdlVG9vbHM8VCBleHRlbmRzIFVJTWVzc2FnZT4gPVxuICBUIGV4dGVuZHMgVUlNZXNzYWdlPHVua25vd24sIFVJRGF0YVR5cGVzLCBpbmZlciBUT09MUz4gPyBUT09MUyA6IFVJVG9vbHM7XG5cbmV4cG9ydCB0eXBlIEluZmVyVUlNZXNzYWdlVG9vbE91dHB1dHM8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4gPVxuICBJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+W2tleW9mIEluZmVyVUlNZXNzYWdlVG9vbHM8VUlfTUVTU0FHRT5dWydvdXRwdXQnXTtcblxuZXhwb3J0IHR5cGUgSW5mZXJVSU1lc3NhZ2VUb29sQ2FsbDxVSV9NRVNTQUdFIGV4dGVuZHMgVUlNZXNzYWdlPiA9XG4gIHwgVmFsdWVPZjx7XG4gICAgICBbTkFNRSBpbiBrZXlvZiBJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+XTogVG9vbENhbGw8XG4gICAgICAgIE5BTUUgJiBzdHJpbmcsXG4gICAgICAgIEluZmVyVUlNZXNzYWdlVG9vbHM8VUlfTUVTU0FHRT5bTkFNRV0gZXh0ZW5kcyB7IGlucHV0OiBpbmZlciBJTlBVVCB9XG4gICAgICAgICAgPyBJTlBVVFxuICAgICAgICAgIDogbmV2ZXJcbiAgICAgID4gJiB7IGR5bmFtaWM/OiBmYWxzZSB9O1xuICAgIH0+XG4gIHwgKFRvb2xDYWxsPHN0cmluZywgdW5rbm93bj4gJiB7IGR5bmFtaWM6IHRydWUgfSk7XG4iLCAiaW1wb3J0IHtcbiAgY3JlYXRlU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGUsXG4gIHByb2Nlc3NVSU1lc3NhZ2VTdHJlYW0sXG4gIFN0cmVhbWluZ1VJTWVzc2FnZVN0YXRlLFxufSBmcm9tICcuLi91aS9wcm9jZXNzLXVpLW1lc3NhZ2Utc3RyZWFtJztcbmltcG9ydCB7IFVJTWVzc2FnZSB9IGZyb20gJy4uL3VpL3VpLW1lc3NhZ2VzJztcbmltcG9ydCB7IEVycm9ySGFuZGxlciB9IGZyb20gJy4uL3V0aWwvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBJbmZlclVJTWVzc2FnZUNodW5rLCBVSU1lc3NhZ2VDaHVuayB9IGZyb20gJy4vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHsgVUlNZXNzYWdlU3RyZWFtT25GaW5pc2hDYWxsYmFjayB9IGZyb20gJy4vdWktbWVzc2FnZS1zdHJlYW0tb24tZmluaXNoLWNhbGxiYWNrJztcblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVVJTWVzc2FnZVN0cmVhbUZpbmlzaDxVSV9NRVNTQUdFIGV4dGVuZHMgVUlNZXNzYWdlPih7XG4gIG1lc3NhZ2VJZCxcbiAgb3JpZ2luYWxNZXNzYWdlcyA9IFtdLFxuICBvbkZpbmlzaCxcbiAgb25FcnJvcixcbiAgc3RyZWFtLFxufToge1xuICBzdHJlYW06IFJlYWRhYmxlU3RyZWFtPEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4+O1xuXG4gIC8qKlxuICAgKiBUaGUgbWVzc2FnZSBJRCB0byB1c2UgZm9yIHRoZSByZXNwb25zZSBtZXNzYWdlLlxuICAgKiBJZiBub3QgcHJvdmlkZWQsIG5vIGlkIHdpbGwgYmUgc2V0IGZvciB0aGUgcmVzcG9uc2UgbWVzc2FnZS5cbiAgICovXG4gIG1lc3NhZ2VJZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9yaWdpbmFsIG1lc3NhZ2VzLlxuICAgKi9cbiAgb3JpZ2luYWxNZXNzYWdlcz86IFVJX01FU1NBR0VbXTtcblxuICBvbkVycm9yOiBFcnJvckhhbmRsZXI7XG5cbiAgb25GaW5pc2g/OiBVSU1lc3NhZ2VTdHJlYW1PbkZpbmlzaENhbGxiYWNrPFVJX01FU1NBR0U+O1xufSk6IFJlYWRhYmxlU3RyZWFtPEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4+IHtcbiAgLy8gbGFzdCBtZXNzYWdlIGlzIG9ubHkgcmVsZXZhbnQgZm9yIGFzc2lzdGFudCBtZXNzYWdlc1xuICBsZXQgbGFzdE1lc3NhZ2U6IFVJX01FU1NBR0UgfCB1bmRlZmluZWQgPVxuICAgIG9yaWdpbmFsTWVzc2FnZXM/LltvcmlnaW5hbE1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICBpZiAobGFzdE1lc3NhZ2U/LnJvbGUgIT09ICdhc3Npc3RhbnQnKSB7XG4gICAgbGFzdE1lc3NhZ2UgPSB1bmRlZmluZWQ7XG4gIH0gZWxzZSB7XG4gICAgLy8gYXBwZW5kaW5nIHRvIHRoZSBsYXN0IG1lc3NhZ2UsIHNvIHdlIG5lZWQgdG8gdXNlIHRoZSBzYW1lIGlkXG4gICAgbWVzc2FnZUlkID0gbGFzdE1lc3NhZ2UuaWQ7XG4gIH1cblxuICBsZXQgaXNBYm9ydGVkID0gZmFsc2U7XG5cbiAgY29uc3QgaWRJbmplY3RlZFN0cmVhbSA9IHN0cmVhbS5waXBlVGhyb3VnaChcbiAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgSW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPixcbiAgICAgIEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT5cbiAgICA+KHtcbiAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAvLyB3aGVuIHRoZXJlIGlzIG5vIG1lc3NhZ2VJZCBpbiB0aGUgc3RhcnQgY2h1bmssXG4gICAgICAgIC8vIGJ1dCB0aGUgdXNlciBjaGVja2VkIGZvciBwZXJzaXN0ZW5jZSxcbiAgICAgICAgLy8gaW5qZWN0IHRoZSBtZXNzYWdlSWQgaW50byB0aGUgY2h1bmtcbiAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdzdGFydCcpIHtcbiAgICAgICAgICBjb25zdCBzdGFydENodW5rID0gY2h1bmsgYXMgVUlNZXNzYWdlQ2h1bmsgJiB7IHR5cGU6ICdzdGFydCcgfTtcbiAgICAgICAgICBpZiAoc3RhcnRDaHVuay5tZXNzYWdlSWQgPT0gbnVsbCAmJiBtZXNzYWdlSWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RhcnRDaHVuay5tZXNzYWdlSWQgPSBtZXNzYWdlSWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNodW5rLnR5cGUgPT09ICdhYm9ydCcpIHtcbiAgICAgICAgICBpc0Fib3J0ZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgIH0sXG4gICAgfSksXG4gICk7XG5cbiAgaWYgKG9uRmluaXNoID09IG51bGwpIHtcbiAgICByZXR1cm4gaWRJbmplY3RlZFN0cmVhbTtcbiAgfVxuXG4gIGNvbnN0IHN0YXRlID0gY3JlYXRlU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGU8VUlfTUVTU0FHRT4oe1xuICAgIGxhc3RNZXNzYWdlOiBsYXN0TWVzc2FnZVxuICAgICAgPyAoc3RydWN0dXJlZENsb25lKGxhc3RNZXNzYWdlKSBhcyBVSV9NRVNTQUdFKVxuICAgICAgOiB1bmRlZmluZWQsXG4gICAgbWVzc2FnZUlkOiBtZXNzYWdlSWQgPz8gJycsIC8vIHdpbGwgYmUgb3ZlcnJpZGRlbiBieSB0aGUgc3RyZWFtXG4gIH0pO1xuXG4gIGNvbnN0IHJ1blVwZGF0ZU1lc3NhZ2VKb2IgPSBhc3luYyAoXG4gICAgam9iOiAob3B0aW9uczoge1xuICAgICAgc3RhdGU6IFN0cmVhbWluZ1VJTWVzc2FnZVN0YXRlPFVJX01FU1NBR0U+O1xuICAgICAgd3JpdGU6ICgpID0+IHZvaWQ7XG4gICAgfSkgPT4gUHJvbWlzZTx2b2lkPixcbiAgKSA9PiB7XG4gICAgYXdhaXQgam9iKHsgc3RhdGUsIHdyaXRlOiAoKSA9PiB7fSB9KTtcbiAgfTtcblxuICByZXR1cm4gcHJvY2Vzc1VJTWVzc2FnZVN0cmVhbTxVSV9NRVNTQUdFPih7XG4gICAgc3RyZWFtOiBpZEluamVjdGVkU3RyZWFtLFxuICAgIHJ1blVwZGF0ZU1lc3NhZ2VKb2IsXG4gICAgb25FcnJvcixcbiAgfSkucGlwZVRocm91Z2goXG4gICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxcbiAgICAgIEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4sXG4gICAgICBJbmZlclVJTWVzc2FnZUNodW5rPFVJX01FU1NBR0U+XG4gICAgPih7XG4gICAgICB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcbiAgICAgIH0sXG5cbiAgICAgIGFzeW5jIGZsdXNoKCkge1xuICAgICAgICBjb25zdCBpc0NvbnRpbnVhdGlvbiA9IHN0YXRlLm1lc3NhZ2UuaWQgPT09IGxhc3RNZXNzYWdlPy5pZDtcbiAgICAgICAgYXdhaXQgb25GaW5pc2goe1xuICAgICAgICAgIGlzQWJvcnRlZCxcbiAgICAgICAgICBpc0NvbnRpbnVhdGlvbixcbiAgICAgICAgICByZXNwb25zZU1lc3NhZ2U6IHN0YXRlLm1lc3NhZ2UgYXMgVUlfTUVTU0FHRSxcbiAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgLi4uKGlzQ29udGludWF0aW9uXG4gICAgICAgICAgICAgID8gb3JpZ2luYWxNZXNzYWdlcy5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgICAgOiBvcmlnaW5hbE1lc3NhZ2VzKSxcbiAgICAgICAgICAgIHN0YXRlLm1lc3NhZ2UsXG4gICAgICAgICAgXSBhcyBVSV9NRVNTQUdFW10sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KSxcbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBTZXJ2ZXJSZXNwb25zZSB9IGZyb20gJ25vZGU6aHR0cCc7XG5pbXBvcnQgeyBwcmVwYXJlSGVhZGVycyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1oZWFkZXJzJztcbmltcG9ydCB7IHdyaXRlVG9TZXJ2ZXJSZXNwb25zZSB9IGZyb20gJy4uL3V0aWwvd3JpdGUtdG8tc2VydmVyLXJlc3BvbnNlJztcbmltcG9ydCB7IEpzb25Ub1NzZVRyYW5zZm9ybVN0cmVhbSB9IGZyb20gJy4vanNvbi10by1zc2UtdHJhbnNmb3JtLXN0cmVhbSc7XG5pbXBvcnQgeyBVSV9NRVNTQUdFX1NUUkVBTV9IRUFERVJTIH0gZnJvbSAnLi91aS1tZXNzYWdlLXN0cmVhbS1oZWFkZXJzJztcbmltcG9ydCB7IFVJTWVzc2FnZUNodW5rIH0gZnJvbSAnLi91aS1tZXNzYWdlLWNodW5rcyc7XG5pbXBvcnQgeyBVSU1lc3NhZ2VTdHJlYW1SZXNwb25zZUluaXQgfSBmcm9tICcuL3VpLW1lc3NhZ2Utc3RyZWFtLXJlc3BvbnNlLWluaXQnO1xuXG5leHBvcnQgZnVuY3Rpb24gcGlwZVVJTWVzc2FnZVN0cmVhbVRvUmVzcG9uc2Uoe1xuICByZXNwb25zZSxcbiAgc3RhdHVzLFxuICBzdGF0dXNUZXh0LFxuICBoZWFkZXJzLFxuICBzdHJlYW0sXG4gIGNvbnN1bWVTc2VTdHJlYW0sXG59OiB7XG4gIHJlc3BvbnNlOiBTZXJ2ZXJSZXNwb25zZTtcbiAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVSU1lc3NhZ2VDaHVuaz47XG59ICYgVUlNZXNzYWdlU3RyZWFtUmVzcG9uc2VJbml0KTogdm9pZCB7XG4gIGxldCBzc2VTdHJlYW0gPSBzdHJlYW0ucGlwZVRocm91Z2gobmV3IEpzb25Ub1NzZVRyYW5zZm9ybVN0cmVhbSgpKTtcblxuICAvLyB3aGVuIHRoZSBjb25zdW1lU3NlU3RyZWFtIGlzIHByb3ZpZGVkLCB3ZSBuZWVkIHRvIHRlZSB0aGUgc3RyZWFtXG4gIC8vIGFuZCBzZW5kIHRoZSBzZWNvbmQgcGFydCB0byB0aGUgY29uc3VtZVNzZVN0cmVhbSBmdW5jdGlvblxuICAvLyBzbyB0aGF0IGl0IGNhbiBiZSBjb25zdW1lZCBieSB0aGUgY2xpZW50IGluZGVwZW5kZW50bHlcbiAgaWYgKGNvbnN1bWVTc2VTdHJlYW0pIHtcbiAgICBjb25zdCBbc3RyZWFtMSwgc3RyZWFtMl0gPSBzc2VTdHJlYW0udGVlKCk7XG4gICAgc3NlU3RyZWFtID0gc3RyZWFtMTtcbiAgICBjb25zdW1lU3NlU3RyZWFtKHsgc3RyZWFtOiBzdHJlYW0yIH0pOyAvLyBubyBhd2FpdCAoZG8gbm90IGJsb2NrIHRoZSByZXNwb25zZSlcbiAgfVxuXG4gIHdyaXRlVG9TZXJ2ZXJSZXNwb25zZSh7XG4gICAgcmVzcG9uc2UsXG4gICAgc3RhdHVzLFxuICAgIHN0YXR1c1RleHQsXG4gICAgaGVhZGVyczogT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgcHJlcGFyZUhlYWRlcnMoaGVhZGVycywgVUlfTUVTU0FHRV9TVFJFQU1fSEVBREVSUykuZW50cmllcygpLFxuICAgICksXG4gICAgc3RyZWFtOiBzc2VTdHJlYW0ucGlwZVRocm91Z2gobmV3IFRleHRFbmNvZGVyU3RyZWFtKCkpLFxuICB9KTtcbn1cbiIsICJleHBvcnQgdHlwZSBBc3luY0l0ZXJhYmxlU3RyZWFtPFQ+ID0gQXN5bmNJdGVyYWJsZTxUPiAmIFJlYWRhYmxlU3RyZWFtPFQ+O1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXN5bmNJdGVyYWJsZVN0cmVhbTxUPihcbiAgc291cmNlOiBSZWFkYWJsZVN0cmVhbTxUPixcbik6IEFzeW5jSXRlcmFibGVTdHJlYW08VD4ge1xuICBjb25zdCBzdHJlYW0gPSBzb3VyY2UucGlwZVRocm91Z2gobmV3IFRyYW5zZm9ybVN0cmVhbTxULCBUPigpKTtcblxuICAoc3RyZWFtIGFzIEFzeW5jSXRlcmFibGVTdHJlYW08VD4pW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9ICgpID0+IHtcbiAgICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIG5leHQoKTogUHJvbWlzZTxJdGVyYXRvclJlc3VsdDxUPj4ge1xuICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgICByZXR1cm4gZG9uZSA/IHsgZG9uZTogdHJ1ZSwgdmFsdWU6IHVuZGVmaW5lZCB9IDogeyBkb25lOiBmYWxzZSwgdmFsdWUgfTtcbiAgICAgIH0sXG4gICAgfTtcbiAgfTtcblxuICByZXR1cm4gc3RyZWFtIGFzIEFzeW5jSXRlcmFibGVTdHJlYW08VD47XG59XG4iLCAiLyoqXG4gKiBDb25zdW1lcyBhIFJlYWRhYmxlU3RyZWFtIHVudGlsIGl0J3MgZnVsbHkgcmVhZC5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIHJlYWRzIHRoZSBzdHJlYW0gY2h1bmsgYnkgY2h1bmsgdW50aWwgdGhlIHN0cmVhbSBpcyBleGhhdXN0ZWQuXG4gKiBJdCBkb2Vzbid0IHByb2Nlc3Mgb3IgcmV0dXJuIHRoZSBkYXRhIGZyb20gdGhlIHN0cmVhbTsgaXQgc2ltcGx5IGVuc3VyZXNcbiAqIHRoYXQgdGhlIGVudGlyZSBzdHJlYW0gaXMgcmVhZC5cbiAqXG4gKiBAcGFyYW0ge1JlYWRhYmxlU3RyZWFtfSBzdHJlYW0gLSBUaGUgUmVhZGFibGVTdHJlYW0gdG8gYmUgY29uc3VtZWQuXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgc3RyZWFtIGlzIGZ1bGx5IGNvbnN1bWVkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29uc3VtZVN0cmVhbSh7XG4gIHN0cmVhbSxcbiAgb25FcnJvcixcbn06IHtcbiAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTtcbiAgb25FcnJvcj86IChlcnJvcjogdW5rbm93bikgPT4gdm9pZDtcbn0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgcmVhZGVyID0gc3RyZWFtLmdldFJlYWRlcigpO1xuICB0cnkge1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBjb25zdCB7IGRvbmUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICBpZiAoZG9uZSkgYnJlYWs7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIG9uRXJyb3I/LihlcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgcmVhZGVyLnJlbGVhc2VMb2NrKCk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuL2Vycm9yLWhhbmRsZXInO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBQcm9taXNlIHdpdGggZXh0ZXJuYWxseSBhY2Nlc3NpYmxlIHJlc29sdmUgYW5kIHJlamVjdCBmdW5jdGlvbnMuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB0aGUgdmFsdWUgdGhhdCB0aGUgUHJvbWlzZSB3aWxsIHJlc29sdmUgdG8uXG4gKiBAcmV0dXJucyBBbiBvYmplY3QgY29udGFpbmluZzpcbiAqICAgLSBwcm9taXNlOiBBIFByb21pc2UgdGhhdCBjYW4gYmUgcmVzb2x2ZWQgb3IgcmVqZWN0ZWQgZXh0ZXJuYWxseS5cbiAqICAgLSByZXNvbHZlOiBBIGZ1bmN0aW9uIHRvIHJlc29sdmUgdGhlIFByb21pc2Ugd2l0aCBhIHZhbHVlIG9mIHR5cGUgVC5cbiAqICAgLSByZWplY3Q6IEEgZnVuY3Rpb24gdG8gcmVqZWN0IHRoZSBQcm9taXNlIHdpdGggYW4gZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNvbHZhYmxlUHJvbWlzZTxUID0gYW55PigpOiB7XG4gIHByb21pc2U6IFByb21pc2U8VD47XG4gIHJlc29sdmU6ICh2YWx1ZTogVCkgPT4gdm9pZDtcbiAgcmVqZWN0OiBFcnJvckhhbmRsZXI7XG59IHtcbiAgbGV0IHJlc29sdmU6ICh2YWx1ZTogVCkgPT4gdm9pZDtcbiAgbGV0IHJlamVjdDogRXJyb3JIYW5kbGVyO1xuXG4gIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZTxUPigocmVzLCByZWopID0+IHtcbiAgICByZXNvbHZlID0gcmVzO1xuICAgIHJlamVjdCA9IHJlajtcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBwcm9taXNlLFxuICAgIHJlc29sdmU6IHJlc29sdmUhLFxuICAgIHJlamVjdDogcmVqZWN0ISxcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyBjcmVhdGVSZXNvbHZhYmxlUHJvbWlzZSB9IGZyb20gJy4vY3JlYXRlLXJlc29sdmFibGUtcHJvbWlzZSc7XG5cbi8qKlxuICogQ3JlYXRlcyBhIHN0aXRjaGFibGUgc3RyZWFtIHRoYXQgY2FuIHBpcGUgb25lIHN0cmVhbSBhdCBhIHRpbWUuXG4gKlxuICogQHRlbXBsYXRlIFQgLSBUaGUgdHlwZSBvZiB2YWx1ZXMgZW1pdHRlZCBieSB0aGUgc3RyZWFtcy5cbiAqIEByZXR1cm5zIHtPYmplY3R9IEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBzdGl0Y2hhYmxlIHN0cmVhbSBhbmQgY29udHJvbCBtZXRob2RzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RpdGNoYWJsZVN0cmVhbTxUPigpOiB7XG4gIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VD47XG4gIGFkZFN0cmVhbTogKGlubmVyU3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxUPikgPT4gdm9pZDtcbiAgY2xvc2U6ICgpID0+IHZvaWQ7XG4gIHRlcm1pbmF0ZTogKCkgPT4gdm9pZDtcbn0ge1xuICBsZXQgaW5uZXJTdHJlYW1SZWFkZXJzOiBSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXI8VD5bXSA9IFtdO1xuICBsZXQgY29udHJvbGxlcjogUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcjxUPiB8IG51bGwgPSBudWxsO1xuICBsZXQgaXNDbG9zZWQgPSBmYWxzZTtcbiAgbGV0IHdhaXRGb3JOZXdTdHJlYW0gPSBjcmVhdGVSZXNvbHZhYmxlUHJvbWlzZTx2b2lkPigpO1xuXG4gIGNvbnN0IHRlcm1pbmF0ZSA9ICgpID0+IHtcbiAgICBpc0Nsb3NlZCA9IHRydWU7XG4gICAgd2FpdEZvck5ld1N0cmVhbS5yZXNvbHZlKCk7XG5cbiAgICBpbm5lclN0cmVhbVJlYWRlcnMuZm9yRWFjaChyZWFkZXIgPT4gcmVhZGVyLmNhbmNlbCgpKTtcbiAgICBpbm5lclN0cmVhbVJlYWRlcnMgPSBbXTtcbiAgICBjb250cm9sbGVyPy5jbG9zZSgpO1xuICB9O1xuXG4gIGNvbnN0IHByb2Nlc3NQdWxsID0gYXN5bmMgKCkgPT4ge1xuICAgIC8vIENhc2UgMTogT3V0ZXIgc3RyZWFtIGlzIGNsb3NlZCBhbmQgbm8gbW9yZSBpbm5lciBzdHJlYW1zXG4gICAgaWYgKGlzQ2xvc2VkICYmIGlubmVyU3RyZWFtUmVhZGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnRyb2xsZXI/LmNsb3NlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2FzZSAyOiBObyBpbm5lciBzdHJlYW1zIGF2YWlsYWJsZSwgYnV0IG91dGVyIHN0cmVhbSBpcyBvcGVuXG4gICAgLy8gd2FpdCBmb3IgYSBuZXcgaW5uZXIgc3RyZWFtIHRvIGJlIGFkZGVkIG9yIHRoZSBvdXRlciBzdHJlYW0gdG8gY2xvc2VcbiAgICBpZiAoaW5uZXJTdHJlYW1SZWFkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgd2FpdEZvck5ld1N0cmVhbSA9IGNyZWF0ZVJlc29sdmFibGVQcm9taXNlPHZvaWQ+KCk7XG4gICAgICBhd2FpdCB3YWl0Rm9yTmV3U3RyZWFtLnByb21pc2U7XG4gICAgICByZXR1cm4gcHJvY2Vzc1B1bGwoKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB2YWx1ZSwgZG9uZSB9ID0gYXdhaXQgaW5uZXJTdHJlYW1SZWFkZXJzWzBdLnJlYWQoKTtcblxuICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgLy8gQ2FzZSAzOiBDdXJyZW50IGlubmVyIHN0cmVhbSBpcyBkb25lXG4gICAgICAgIGlubmVyU3RyZWFtUmVhZGVycy5zaGlmdCgpOyAvLyBSZW1vdmUgdGhlIGZpbmlzaGVkIHN0cmVhbVxuXG4gICAgICAgIC8vIENvbnRpbnVlIHB1bGxpbmcgZnJvbSB0aGUgbmV4dCBzdHJlYW0gaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChpbm5lclN0cmVhbVJlYWRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGF3YWl0IHByb2Nlc3NQdWxsKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNDbG9zZWQpIHtcbiAgICAgICAgICBjb250cm9sbGVyPy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDYXNlIDQ6IEN1cnJlbnQgaW5uZXIgc3RyZWFtIHJldHVybnMgYW4gaXRlbVxuICAgICAgICBjb250cm9sbGVyPy5lbnF1ZXVlKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gQ2FzZSA1OiBDdXJyZW50IGlubmVyIHN0cmVhbSB0aHJvd3MgYW4gZXJyb3JcbiAgICAgIGNvbnRyb2xsZXI/LmVycm9yKGVycm9yKTtcbiAgICAgIGlubmVyU3RyZWFtUmVhZGVycy5zaGlmdCgpOyAvLyBSZW1vdmUgdGhlIGVycm9yZWQgc3RyZWFtXG4gICAgICB0ZXJtaW5hdGUoKTsgLy8gd2UgaGF2ZSBlcnJvcmVkLCB0ZXJtaW5hdGUgYWxsIHN0cmVhbXNcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBzdHJlYW06IG5ldyBSZWFkYWJsZVN0cmVhbTxUPih7XG4gICAgICBzdGFydChjb250cm9sbGVyUGFyYW0pIHtcbiAgICAgICAgY29udHJvbGxlciA9IGNvbnRyb2xsZXJQYXJhbTtcbiAgICAgIH0sXG4gICAgICBwdWxsOiBwcm9jZXNzUHVsbCxcbiAgICAgIGFzeW5jIGNhbmNlbCgpIHtcbiAgICAgICAgZm9yIChjb25zdCByZWFkZXIgb2YgaW5uZXJTdHJlYW1SZWFkZXJzKSB7XG4gICAgICAgICAgYXdhaXQgcmVhZGVyLmNhbmNlbCgpO1xuICAgICAgICB9XG4gICAgICAgIGlubmVyU3RyZWFtUmVhZGVycyA9IFtdO1xuICAgICAgICBpc0Nsb3NlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH0pLFxuICAgIGFkZFN0cmVhbTogKGlubmVyU3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxUPikgPT4ge1xuICAgICAgaWYgKGlzQ2xvc2VkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGFkZCBpbm5lciBzdHJlYW06IG91dGVyIHN0cmVhbSBpcyBjbG9zZWQnKTtcbiAgICAgIH1cblxuICAgICAgaW5uZXJTdHJlYW1SZWFkZXJzLnB1c2goaW5uZXJTdHJlYW0uZ2V0UmVhZGVyKCkpO1xuICAgICAgd2FpdEZvck5ld1N0cmVhbS5yZXNvbHZlKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdyYWNlZnVsbHkgY2xvc2UgdGhlIG91dGVyIHN0cmVhbS4gVGhpcyB3aWxsIGxldCB0aGUgaW5uZXIgc3RyZWFtc1xuICAgICAqIGZpbmlzaCBwcm9jZXNzaW5nIGFuZCB0aGVuIGNsb3NlIHRoZSBvdXRlciBzdHJlYW0uXG4gICAgICovXG4gICAgY2xvc2U6ICgpID0+IHtcbiAgICAgIGlzQ2xvc2VkID0gdHJ1ZTtcbiAgICAgIHdhaXRGb3JOZXdTdHJlYW0ucmVzb2x2ZSgpO1xuXG4gICAgICBpZiAoaW5uZXJTdHJlYW1SZWFkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb250cm9sbGVyPy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbW1lZGlhdGVseSBjbG9zZSB0aGUgb3V0ZXIgc3RyZWFtLiBUaGlzIHdpbGwgY2FuY2VsIGFsbCBpbm5lciBzdHJlYW1zXG4gICAgICogYW5kIGNsb3NlIHRoZSBvdXRlciBzdHJlYW0uXG4gICAgICovXG4gICAgdGVybWluYXRlLFxuICB9O1xufVxuIiwgIi8qKlxuICogRGVsYXllZCBwcm9taXNlLiBJdCBpcyBvbmx5IGNvbnN0cnVjdGVkIG9uY2UgdGhlIHZhbHVlIGlzIGFjY2Vzc2VkLlxuICogVGhpcyBpcyB1c2VmdWwgdG8gYXZvaWQgdW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9ucyB3aGVuIHRoZSBwcm9taXNlIGlzIGNyZWF0ZWRcbiAqIGJ1dCBub3QgYWNjZXNzZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBEZWxheWVkUHJvbWlzZTxUPiB7XG4gIHByaXZhdGUgc3RhdHVzOlxuICAgIHwgeyB0eXBlOiAncGVuZGluZycgfVxuICAgIHwgeyB0eXBlOiAncmVzb2x2ZWQnOyB2YWx1ZTogVCB9XG4gICAgfCB7IHR5cGU6ICdyZWplY3RlZCc7IGVycm9yOiB1bmtub3duIH0gPSB7IHR5cGU6ICdwZW5kaW5nJyB9O1xuICBwcml2YXRlIF9wcm9taXNlOiBQcm9taXNlPFQ+IHwgdW5kZWZpbmVkO1xuICBwcml2YXRlIF9yZXNvbHZlOiB1bmRlZmluZWQgfCAoKHZhbHVlOiBUKSA9PiB2b2lkKSA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBfcmVqZWN0OiB1bmRlZmluZWQgfCAoKGVycm9yOiB1bmtub3duKSA9PiB2b2lkKSA9IHVuZGVmaW5lZDtcblxuICBnZXQgcHJvbWlzZSgpOiBQcm9taXNlPFQ+IHtcbiAgICBpZiAodGhpcy5fcHJvbWlzZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG4gICAgfVxuXG4gICAgdGhpcy5fcHJvbWlzZSA9IG5ldyBQcm9taXNlPFQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmICh0aGlzLnN0YXR1cy50eXBlID09PSAncmVzb2x2ZWQnKSB7XG4gICAgICAgIHJlc29sdmUodGhpcy5zdGF0dXMudmFsdWUpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cy50eXBlID09PSAncmVqZWN0ZWQnKSB7XG4gICAgICAgIHJlamVjdCh0aGlzLnN0YXR1cy5lcnJvcik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3Jlc29sdmUgPSByZXNvbHZlO1xuICAgICAgdGhpcy5fcmVqZWN0ID0gcmVqZWN0O1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG4gIH1cblxuICByZXNvbHZlKHZhbHVlOiBUKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0dXMgPSB7IHR5cGU6ICdyZXNvbHZlZCcsIHZhbHVlIH07XG5cbiAgICBpZiAodGhpcy5fcHJvbWlzZSkge1xuICAgICAgdGhpcy5fcmVzb2x2ZT8uKHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICByZWplY3QoZXJyb3I6IHVua25vd24pOiB2b2lkIHtcbiAgICB0aGlzLnN0YXR1cyA9IHsgdHlwZTogJ3JlamVjdGVkJywgZXJyb3IgfTtcblxuICAgIGlmICh0aGlzLl9wcm9taXNlKSB7XG4gICAgICB0aGlzLl9yZWplY3Q/LihlcnJvcik7XG4gICAgfVxuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclN0cmVhbUVycm9yczxUPihcbiAgcmVhZGFibGU6IFJlYWRhYmxlU3RyZWFtPFQ+LFxuICBvbkVycm9yOiAoe1xuICAgIGVycm9yLFxuICAgIGNvbnRyb2xsZXIsXG4gIH06IHtcbiAgICBlcnJvcjogdW5rbm93bjtcbiAgICBjb250cm9sbGVyOiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyPFQ+O1xuICB9KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCxcbik6IFJlYWRhYmxlU3RyZWFtPFQ+IHtcbiAgcmV0dXJuIG5ldyBSZWFkYWJsZVN0cmVhbTxUPih7XG4gICAgYXN5bmMgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgY29uc3QgcmVhZGVyID0gcmVhZGFibGUuZ2V0UmVhZGVyKCk7XG4gICAgICB0cnkge1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBhd2FpdCBvbkVycm9yKHsgZXJyb3IsIGNvbnRyb2xsZXIgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBjYW5jZWwocmVhc29uKSB7XG4gICAgICByZXR1cm4gcmVhZGFibGUuY2FuY2VsKHJlYXNvbik7XG4gICAgfSxcbiAgfSk7XG59XG4iLCAiLy8gU2hpbSBmb3IgcGVyZm9ybWFuY2Uubm93KCkgdG8gc3VwcG9ydCBlbnZpcm9ubWVudHMgdGhhdCBkb24ndCBoYXZlIGl0OlxuZXhwb3J0IGZ1bmN0aW9uIG5vdygpOiBudW1iZXIge1xuICByZXR1cm4gZ2xvYmFsVGhpcz8ucGVyZm9ybWFuY2U/Lm5vdygpID8/IERhdGUubm93KCk7XG59XG4iLCAiaW1wb3J0IHtcbiAgTGFuZ3VhZ2VNb2RlbFYyQ2FsbFdhcm5pbmcsXG4gIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgZXhlY3V0ZVRvb2wsXG4gIGdlbmVyYXRlSWQsXG4gIGdldEVycm9yTWVzc2FnZSxcbiAgTW9kZWxNZXNzYWdlLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IFRyYWNlciB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2FwaSc7XG5pbXBvcnQgeyBhc3NlbWJsZU9wZXJhdGlvbk5hbWUgfSBmcm9tICcuLi90ZWxlbWV0cnkvYXNzZW1ibGUtb3BlcmF0aW9uLW5hbWUnO1xuaW1wb3J0IHsgcmVjb3JkRXJyb3JPblNwYW4sIHJlY29yZFNwYW4gfSBmcm9tICcuLi90ZWxlbWV0cnkvcmVjb3JkLXNwYW4nO1xuaW1wb3J0IHsgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9zZWxlY3QtdGVsZW1ldHJ5LWF0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgVGVsZW1ldHJ5U2V0dGluZ3MgfSBmcm9tICcuLi90ZWxlbWV0cnkvdGVsZW1ldHJ5LXNldHRpbmdzJztcbmltcG9ydCB7IEZpbmlzaFJlYXNvbiwgTGFuZ3VhZ2VNb2RlbFVzYWdlLCBQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgU291cmNlIH0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwnO1xuaW1wb3J0IHsgRGVmYXVsdEdlbmVyYXRlZEZpbGVXaXRoVHlwZSwgR2VuZXJhdGVkRmlsZSB9IGZyb20gJy4vZ2VuZXJhdGVkLWZpbGUnO1xuaW1wb3J0IHsgcGFyc2VUb29sQ2FsbCB9IGZyb20gJy4vcGFyc2UtdG9vbC1jYWxsJztcbmltcG9ydCB7IFR5cGVkVG9vbENhbGwgfSBmcm9tICcuL3Rvb2wtY2FsbCc7XG5pbXBvcnQgeyBUb29sQ2FsbFJlcGFpckZ1bmN0aW9uIH0gZnJvbSAnLi90b29sLWNhbGwtcmVwYWlyLWZ1bmN0aW9uJztcbmltcG9ydCB7IFR5cGVkVG9vbEVycm9yIH0gZnJvbSAnLi90b29sLWVycm9yJztcbmltcG9ydCB7IFR5cGVkVG9vbFJlc3VsdCB9IGZyb20gJy4vdG9vbC1yZXN1bHQnO1xuaW1wb3J0IHsgVG9vbFNldCB9IGZyb20gJy4vdG9vbC1zZXQnO1xuXG5leHBvcnQgdHlwZSBTaW5nbGVSZXF1ZXN0VGV4dFN0cmVhbVBhcnQ8VE9PTFMgZXh0ZW5kcyBUb29sU2V0PiA9XG4gIC8vIFRleHQgYmxvY2tzOlxuICB8IHtcbiAgICAgIHR5cGU6ICd0ZXh0LXN0YXJ0JztcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3RleHQtZGVsdGEnO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgZGVsdGE6IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3RleHQtZW5kJztcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICB9XG5cbiAgLy8gUmVhc29uaW5nIGJsb2NrczpcbiAgfCB7XG4gICAgICB0eXBlOiAncmVhc29uaW5nLXN0YXJ0JztcbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3JlYXNvbmluZy1kZWx0YSc7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgICBkZWx0YTogc3RyaW5nO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAncmVhc29uaW5nLWVuZCc7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFByb3ZpZGVyTWV0YWRhdGE7XG4gICAgfVxuXG4gIC8vIFRvb2wgY2FsbHM6XG4gIHwge1xuICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtc3RhcnQnO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHRvb2xOYW1lOiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtZGVsdGEnO1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIGRlbHRhOiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ3Rvb2wtaW5wdXQtZW5kJztcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwgKHsgdHlwZTogJ3NvdXJjZScgfSAmIFNvdXJjZSlcbiAgfCB7IHR5cGU6ICdmaWxlJzsgZmlsZTogR2VuZXJhdGVkRmlsZSB9IC8vIGRpZmZlcmVudCBiZWNhdXNlIG9mIEdlbmVyYXRlZEZpbGUgb2JqZWN0XG4gIHwgKHsgdHlwZTogJ3Rvb2wtY2FsbCcgfSAmIFR5cGVkVG9vbENhbGw8VE9PTFM+KVxuICB8ICh7IHR5cGU6ICd0b29sLXJlc3VsdCcgfSAmIFR5cGVkVG9vbFJlc3VsdDxUT09MUz4pXG4gIHwgKHsgdHlwZTogJ3Rvb2wtZXJyb3InIH0gJiBUeXBlZFRvb2xFcnJvcjxUT09MUz4pXG4gIHwgeyB0eXBlOiAnZmlsZSc7IGZpbGU6IEdlbmVyYXRlZEZpbGUgfSAvLyBkaWZmZXJlbnQgYmVjYXVzZSBvZiBHZW5lcmF0ZWRGaWxlIG9iamVjdFxuICB8IHsgdHlwZTogJ3N0cmVhbS1zdGFydCc7IHdhcm5pbmdzOiBMYW5ndWFnZU1vZGVsVjJDYWxsV2FybmluZ1tdIH1cbiAgfCB7XG4gICAgICB0eXBlOiAncmVzcG9uc2UtbWV0YWRhdGEnO1xuICAgICAgaWQ/OiBzdHJpbmc7XG4gICAgICB0aW1lc3RhbXA/OiBEYXRlO1xuICAgICAgbW9kZWxJZD86IHN0cmluZztcbiAgICB9XG4gIHwge1xuICAgICAgdHlwZTogJ2ZpbmlzaCc7XG4gICAgICBmaW5pc2hSZWFzb246IEZpbmlzaFJlYXNvbjtcbiAgICAgIHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9XG4gIHwgeyB0eXBlOiAnZXJyb3InOyBlcnJvcjogdW5rbm93biB9XG4gIHwgeyB0eXBlOiAncmF3JzsgcmF3VmFsdWU6IHVua25vd24gfTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJ1blRvb2xzVHJhbnNmb3JtYXRpb248VE9PTFMgZXh0ZW5kcyBUb29sU2V0Pih7XG4gIHRvb2xzLFxuICBnZW5lcmF0b3JTdHJlYW0sXG4gIHRyYWNlcixcbiAgdGVsZW1ldHJ5LFxuICBzeXN0ZW0sXG4gIG1lc3NhZ2VzLFxuICBhYm9ydFNpZ25hbCxcbiAgcmVwYWlyVG9vbENhbGwsXG4gIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxufToge1xuICB0b29sczogVE9PTFMgfCB1bmRlZmluZWQ7XG4gIGdlbmVyYXRvclN0cmVhbTogUmVhZGFibGVTdHJlYW08TGFuZ3VhZ2VNb2RlbFYyU3RyZWFtUGFydD47XG4gIHRyYWNlcjogVHJhY2VyO1xuICB0ZWxlbWV0cnk6IFRlbGVtZXRyeVNldHRpbmdzIHwgdW5kZWZpbmVkO1xuICBzeXN0ZW06IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgbWVzc2FnZXM6IE1vZGVsTWVzc2FnZVtdO1xuICBhYm9ydFNpZ25hbDogQWJvcnRTaWduYWwgfCB1bmRlZmluZWQ7XG4gIHJlcGFpclRvb2xDYWxsOiBUb29sQ2FsbFJlcGFpckZ1bmN0aW9uPFRPT0xTPiB8IHVuZGVmaW5lZDtcbiAgZXhwZXJpbWVudGFsX2NvbnRleHQ6IHVua25vd247XG59KTogUmVhZGFibGVTdHJlYW08U2luZ2xlUmVxdWVzdFRleHRTdHJlYW1QYXJ0PFRPT0xTPj4ge1xuICAvLyB0b29sIHJlc3VsdHMgc3RyZWFtXG4gIGxldCB0b29sUmVzdWx0c1N0cmVhbUNvbnRyb2xsZXI6IFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXI8XG4gICAgU2luZ2xlUmVxdWVzdFRleHRTdHJlYW1QYXJ0PFRPT0xTPlxuICA+IHwgbnVsbCA9IG51bGw7XG4gIGNvbnN0IHRvb2xSZXN1bHRzU3RyZWFtID0gbmV3IFJlYWRhYmxlU3RyZWFtPFxuICAgIFNpbmdsZVJlcXVlc3RUZXh0U3RyZWFtUGFydDxUT09MUz5cbiAgPih7XG4gICAgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgdG9vbFJlc3VsdHNTdHJlYW1Db250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgICB9LFxuICB9KTtcblxuICAvLyBrZWVwIHRyYWNrIG9mIG91dHN0YW5kaW5nIHRvb2wgcmVzdWx0cyBmb3Igc3RyZWFtIGNsb3Npbmc6XG4gIGNvbnN0IG91dHN0YW5kaW5nVG9vbFJlc3VsdHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAvLyBrZWVwIHRyYWNrIG9mIHRvb2wgaW5wdXRzIGZvciBwcm92aWRlci1zaWRlIHRvb2wgcmVzdWx0c1xuICBjb25zdCB0b29sSW5wdXRzID0gbmV3IE1hcDxzdHJpbmcsIHVua25vd24+KCk7XG5cbiAgbGV0IGNhbkNsb3NlID0gZmFsc2U7XG4gIGxldCBmaW5pc2hDaHVuazpcbiAgICB8IChTaW5nbGVSZXF1ZXN0VGV4dFN0cmVhbVBhcnQ8VE9PTFM+ICYgeyB0eXBlOiAnZmluaXNoJyB9KVxuICAgIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gIGZ1bmN0aW9uIGF0dGVtcHRDbG9zZSgpIHtcbiAgICAvLyBjbG9zZSB0aGUgdG9vbCByZXN1bHRzIGNvbnRyb2xsZXIgaWYgbm8gbW9yZSBvdXRzdGFuZGluZyB0b29sIGNhbGxzXG4gICAgaWYgKGNhbkNsb3NlICYmIG91dHN0YW5kaW5nVG9vbFJlc3VsdHMuc2l6ZSA9PT0gMCkge1xuICAgICAgLy8gd2UgZGVsYXkgc2VuZGluZyB0aGUgZmluaXNoIGNodW5rIHVudGlsIGFsbCB0b29sIHJlc3VsdHMgKGluY2wuIGRlbGF5ZWQgb25lcylcbiAgICAgIC8vIGFyZSByZWNlaXZlZCB0byBlbnN1cmUgdGhhdCB0aGUgZnJvbnRlbmQgcmVjZWl2ZXMgdG9vbCByZXN1bHRzIGJlZm9yZSBhIG1lc3NhZ2VcbiAgICAgIC8vIGZpbmlzaCBldmVudCBhcnJpdmVzLlxuICAgICAgaWYgKGZpbmlzaENodW5rICE9IG51bGwpIHtcbiAgICAgICAgdG9vbFJlc3VsdHNTdHJlYW1Db250cm9sbGVyIS5lbnF1ZXVlKGZpbmlzaENodW5rKTtcbiAgICAgIH1cblxuICAgICAgdG9vbFJlc3VsdHNTdHJlYW1Db250cm9sbGVyIS5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGZvcndhcmQgc3RyZWFtXG4gIGNvbnN0IGZvcndhcmRTdHJlYW0gPSBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQsXG4gICAgU2luZ2xlUmVxdWVzdFRleHRTdHJlYW1QYXJ0PFRPT0xTPlxuICA+KHtcbiAgICBhc3luYyB0cmFuc2Zvcm0oXG4gICAgICBjaHVuazogTGFuZ3VhZ2VNb2RlbFYyU3RyZWFtUGFydCxcbiAgICAgIGNvbnRyb2xsZXI6IFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyPFxuICAgICAgICBTaW5nbGVSZXF1ZXN0VGV4dFN0cmVhbVBhcnQ8VE9PTFM+XG4gICAgICA+LFxuICAgICkge1xuICAgICAgY29uc3QgY2h1bmtUeXBlID0gY2h1bmsudHlwZTtcblxuICAgICAgc3dpdGNoIChjaHVua1R5cGUpIHtcbiAgICAgICAgLy8gZm9yd2FyZDpcbiAgICAgICAgY2FzZSAnc3RyZWFtLXN0YXJ0JzpcbiAgICAgICAgY2FzZSAndGV4dC1zdGFydCc6XG4gICAgICAgIGNhc2UgJ3RleHQtZGVsdGEnOlxuICAgICAgICBjYXNlICd0ZXh0LWVuZCc6XG4gICAgICAgIGNhc2UgJ3JlYXNvbmluZy1zdGFydCc6XG4gICAgICAgIGNhc2UgJ3JlYXNvbmluZy1kZWx0YSc6XG4gICAgICAgIGNhc2UgJ3JlYXNvbmluZy1lbmQnOlxuICAgICAgICBjYXNlICd0b29sLWlucHV0LXN0YXJ0JzpcbiAgICAgICAgY2FzZSAndG9vbC1pbnB1dC1kZWx0YSc6XG4gICAgICAgIGNhc2UgJ3Rvb2wtaW5wdXQtZW5kJzpcbiAgICAgICAgY2FzZSAnc291cmNlJzpcbiAgICAgICAgY2FzZSAncmVzcG9uc2UtbWV0YWRhdGEnOlxuICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgIGNhc2UgJ3Jhdyc6IHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSAnZmlsZSc6IHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgdHlwZTogJ2ZpbGUnLFxuICAgICAgICAgICAgZmlsZTogbmV3IERlZmF1bHRHZW5lcmF0ZWRGaWxlV2l0aFR5cGUoe1xuICAgICAgICAgICAgICBkYXRhOiBjaHVuay5kYXRhLFxuICAgICAgICAgICAgICBtZWRpYVR5cGU6IGNodW5rLm1lZGlhVHlwZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSAnZmluaXNoJzoge1xuICAgICAgICAgIGZpbmlzaENodW5rID0ge1xuICAgICAgICAgICAgdHlwZTogJ2ZpbmlzaCcsXG4gICAgICAgICAgICBmaW5pc2hSZWFzb246IGNodW5rLmZpbmlzaFJlYXNvbixcbiAgICAgICAgICAgIHVzYWdlOiBjaHVuay51c2FnZSxcbiAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IGNodW5rLnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgfTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb2Nlc3MgdG9vbCBjYWxsOlxuICAgICAgICBjYXNlICd0b29sLWNhbGwnOiB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRvb2xDYWxsID0gYXdhaXQgcGFyc2VUb29sQ2FsbCh7XG4gICAgICAgICAgICAgIHRvb2xDYWxsOiBjaHVuayxcbiAgICAgICAgICAgICAgdG9vbHMsXG4gICAgICAgICAgICAgIHJlcGFpclRvb2xDYWxsLFxuICAgICAgICAgICAgICBzeXN0ZW0sXG4gICAgICAgICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh0b29sQ2FsbCk7XG5cbiAgICAgICAgICAgIC8vIGhhbmRsZSBpbnZhbGlkIHRvb2wgY2FsbHM6XG4gICAgICAgICAgICBpZiAodG9vbENhbGwuaW52YWxpZCkge1xuICAgICAgICAgICAgICB0b29sUmVzdWx0c1N0cmVhbUNvbnRyb2xsZXIhLmVucXVldWUoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICd0b29sLWVycm9yJyxcbiAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiB0b29sQ2FsbC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgIHRvb2xOYW1lOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICBpbnB1dDogdG9vbENhbGwuaW5wdXQsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGdldEVycm9yTWVzc2FnZSh0b29sQ2FsbC5lcnJvciEpLFxuICAgICAgICAgICAgICAgIGR5bmFtaWM6IHRydWUsXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB0b29sID0gdG9vbHMhW3Rvb2xDYWxsLnRvb2xOYW1lXTtcblxuICAgICAgICAgICAgdG9vbElucHV0cy5zZXQodG9vbENhbGwudG9vbENhbGxJZCwgdG9vbENhbGwuaW5wdXQpO1xuXG4gICAgICAgICAgICBpZiAodG9vbC5vbklucHV0QXZhaWxhYmxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgYXdhaXQgdG9vbC5vbklucHV0QXZhaWxhYmxlKHtcbiAgICAgICAgICAgICAgICBpbnB1dDogdG9vbENhbGwuaW5wdXQsXG4gICAgICAgICAgICAgICAgdG9vbENhbGxJZDogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgICBleHBlcmltZW50YWxfY29udGV4dCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE9ubHkgZXhlY3V0ZSB0b29scyB0aGF0IGFyZSBub3QgcHJvdmlkZXItZXhlY3V0ZWQ6XG4gICAgICAgICAgICBpZiAodG9vbC5leGVjdXRlICE9IG51bGwgJiYgdG9vbENhbGwucHJvdmlkZXJFeGVjdXRlZCAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICBjb25zdCB0b29sRXhlY3V0aW9uSWQgPSBnZW5lcmF0ZUlkKCk7IC8vIHVzZSBvdXIgb3duIGlkIHRvIGd1YXJhbnRlZSB1bmlxdWVuZXNzXG4gICAgICAgICAgICAgIG91dHN0YW5kaW5nVG9vbFJlc3VsdHMuYWRkKHRvb2xFeGVjdXRpb25JZCk7XG5cbiAgICAgICAgICAgICAgLy8gTm90ZTogd2UgZG9uJ3QgYXdhaXQgdGhlIHRvb2wgZXhlY3V0aW9uIGhlcmUgKGJ5IGxlYXZpbmcgb3V0ICdhd2FpdCcgb24gcmVjb3JkU3BhbiksXG4gICAgICAgICAgICAgIC8vIGJlY2F1c2Ugd2Ugd2FudCB0byBwcm9jZXNzIHRoZSBuZXh0IGNodW5rIGFzIHNvb24gYXMgcG9zc2libGUuXG4gICAgICAgICAgICAgIC8vIFRoaXMgaXMgaW1wb3J0YW50IGZvciB0aGUgY2FzZSB3aGVyZSB0aGUgdG9vbCBleGVjdXRpb24gdGFrZXMgYSBsb25nIHRpbWUuXG4gICAgICAgICAgICAgIHJlY29yZFNwYW4oe1xuICAgICAgICAgICAgICAgIG5hbWU6ICdhaS50b29sQ2FsbCcsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7XG4gICAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uSWQ6ICdhaS50b29sQ2FsbCcsXG4gICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnRvb2xDYWxsLm5hbWUnOiB0b29sQ2FsbC50b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnRvb2xDYWxsLmlkJzogdG9vbENhbGwudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnRvb2xDYWxsLmFyZ3MnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PiBKU09OLnN0cmluZ2lmeSh0b29sQ2FsbC5pbnB1dCksXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHRyYWNlcixcbiAgICAgICAgICAgICAgICBmbjogYXN5bmMgc3BhbiA9PiB7XG4gICAgICAgICAgICAgICAgICBsZXQgb3V0cHV0OiB1bmtub3duO1xuXG4gICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJlYW0gPSBleGVjdXRlVG9vbCh7XG4gICAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZTogdG9vbC5leGVjdXRlIS5iaW5kKHRvb2wpLFxuICAgICAgICAgICAgICAgICAgICAgIGlucHV0OiB0b29sQ2FsbC5pbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiB0b29sQ2FsbC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVyaW1lbnRhbF9jb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciBhd2FpdCAoY29uc3QgcGFydCBvZiBzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICB0b29sUmVzdWx0c1N0cmVhbUNvbnRyb2xsZXIhLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4udG9vbENhbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1yZXN1bHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiBwYXJ0Lm91dHB1dCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLihwYXJ0LnR5cGUgPT09ICdwcmVsaW1pbmFyeScgJiYge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVsaW1pbmFyeTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnQudHlwZSA9PT0gJ2ZpbmFsJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gcGFydC5vdXRwdXQ7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZWNvcmRFcnJvck9uU3BhbihzcGFuLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHRvb2xSZXN1bHRzU3RyZWFtQ29udHJvbGxlciEuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgLi4udG9vbENhbGwsXG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtZXJyb3InLFxuICAgICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICB9IHNhdGlzZmllcyBUeXBlZFRvb2xFcnJvcjxUT09MUz4pO1xuXG4gICAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nVG9vbFJlc3VsdHMuZGVsZXRlKHRvb2xFeGVjdXRpb25JZCk7XG4gICAgICAgICAgICAgICAgICAgIGF0dGVtcHRDbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIG91dHN0YW5kaW5nVG9vbFJlc3VsdHMuZGVsZXRlKHRvb2xFeGVjdXRpb25JZCk7XG4gICAgICAgICAgICAgICAgICBhdHRlbXB0Q2xvc2UoKTtcblxuICAgICAgICAgICAgICAgICAgLy8gcmVjb3JkIHRlbGVtZXRyeVxuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnYWkudG9vbENhbGwucmVzdWx0Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkob3V0cHV0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICB9IGNhdGNoIChpZ25vcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEpTT04gc3RyaW5naWZ5IG1pZ2h0IGZhaWwgaWYgdGhlIHJlc3VsdCBpcyBub3Qgc2VyaWFsaXphYmxlLFxuICAgICAgICAgICAgICAgICAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGp1c3QgaWdub3JlIGl0LiBJbiB0aGUgZnV0dXJlIHdlIG1pZ2h0IHdhbnQgdG9cbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGFuIG9wdGlvbmFsIHNlcmlhbGl6ZSBtZXRob2QgdG8gdGhlIHRvb2wgaW50ZXJmYWNlIGFuZCB3YXJuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSByZXN1bHQgaXMgbm90IHNlcmlhbGl6YWJsZS5cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdG9vbFJlc3VsdHNTdHJlYW1Db250cm9sbGVyIS5lbnF1ZXVlKHsgdHlwZTogJ2Vycm9yJywgZXJyb3IgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlICd0b29sLXJlc3VsdCc6IHtcbiAgICAgICAgICBjb25zdCB0b29sTmFtZSA9IGNodW5rLnRvb2xOYW1lIGFzIGtleW9mIFRPT0xTICYgc3RyaW5nO1xuXG4gICAgICAgICAgaWYgKGNodW5rLmlzRXJyb3IpIHtcbiAgICAgICAgICAgIHRvb2xSZXN1bHRzU3RyZWFtQ29udHJvbGxlciEuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgIHR5cGU6ICd0b29sLWVycm9yJyxcbiAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgICAgICAgIGlucHV0OiB0b29sSW5wdXRzLmdldChjaHVuay50b29sQ2FsbElkKSxcbiAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogY2h1bmsucHJvdmlkZXJFeGVjdXRlZCxcbiAgICAgICAgICAgICAgZXJyb3I6IGNodW5rLnJlc3VsdCxcbiAgICAgICAgICAgIH0gYXMgVHlwZWRUb29sRXJyb3I8VE9PTFM+KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyxcbiAgICAgICAgICAgICAgdG9vbENhbGxJZDogY2h1bmsudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgICAgICAgIGlucHV0OiB0b29sSW5wdXRzLmdldChjaHVuay50b29sQ2FsbElkKSxcbiAgICAgICAgICAgICAgb3V0cHV0OiBjaHVuay5yZXN1bHQsXG4gICAgICAgICAgICAgIHByb3ZpZGVyRXhlY3V0ZWQ6IGNodW5rLnByb3ZpZGVyRXhlY3V0ZWQsXG4gICAgICAgICAgICB9IGFzIFR5cGVkVG9vbFJlc3VsdDxUT09MUz4pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IGNodW5rVHlwZTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBjaHVuayB0eXBlOiAke19leGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZmx1c2goKSB7XG4gICAgICBjYW5DbG9zZSA9IHRydWU7XG4gICAgICBhdHRlbXB0Q2xvc2UoKTtcbiAgICB9LFxuICB9KTtcblxuICAvLyBjb21iaW5lIHRoZSBnZW5lcmF0b3Igc3RyZWFtIGFuZCB0aGUgdG9vbCByZXN1bHRzIHN0cmVhbVxuICByZXR1cm4gbmV3IFJlYWRhYmxlU3RyZWFtPFNpbmdsZVJlcXVlc3RUZXh0U3RyZWFtUGFydDxUT09MUz4+KHtcbiAgICBhc3luYyBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAvLyBuZWVkIHRvIHdhaXQgZm9yIGJvdGggcGlwZXMgc28gdGhlcmUgYXJlIG5vIGRhbmdsaW5nIHByb21pc2VzIHRoYXRcbiAgICAgIC8vIGNhbiBjYXVzZSB1bmNhdWdodCBwcm9taXNlIHJlamVjdGlvbnMgd2hlbiB0aGUgc3RyZWFtIGlzIGFib3J0ZWRcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChbXG4gICAgICAgIGdlbmVyYXRvclN0cmVhbS5waXBlVGhyb3VnaChmb3J3YXJkU3RyZWFtKS5waXBlVG8oXG4gICAgICAgICAgbmV3IFdyaXRhYmxlU3RyZWFtKHtcbiAgICAgICAgICAgIHdyaXRlKGNodW5rKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xvc2UoKSB7XG4gICAgICAgICAgICAgIC8vIHRoZSBnZW5lcmF0b3Igc3RyZWFtIGNvbnRyb2xsZXIgaXMgYXV0b21hdGljYWxseSBjbG9zZWQgd2hlbiBpdCdzIGNvbnN1bWVkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICApLFxuICAgICAgICB0b29sUmVzdWx0c1N0cmVhbS5waXBlVG8oXG4gICAgICAgICAgbmV3IFdyaXRhYmxlU3RyZWFtKHtcbiAgICAgICAgICAgIHdyaXRlKGNodW5rKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVuayk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xvc2UoKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgICksXG4gICAgICBdKTtcbiAgICB9LFxuICB9KTtcbn1cbiIsICJpbXBvcnQgeyBJZEdlbmVyYXRvciwgUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQge1xuICBnZW5lcmF0ZVRleHQsXG4gIEdlbmVyYXRlVGV4dE9uU3RlcEZpbmlzaENhbGxiYWNrLFxufSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L2dlbmVyYXRlLXRleHQnO1xuaW1wb3J0IHsgR2VuZXJhdGVUZXh0UmVzdWx0IH0gZnJvbSAnLi4vZ2VuZXJhdGUtdGV4dC9nZW5lcmF0ZS10ZXh0LXJlc3VsdCc7XG5pbXBvcnQgeyBPdXRwdXQgfSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L291dHB1dCc7XG5pbXBvcnQgeyBQcmVwYXJlU3RlcEZ1bmN0aW9uIH0gZnJvbSAnLi4vZ2VuZXJhdGUtdGV4dC9wcmVwYXJlLXN0ZXAnO1xuaW1wb3J0IHsgU3RvcENvbmRpdGlvbiB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvc3RvcC1jb25kaXRpb24nO1xuaW1wb3J0IHsgc3RyZWFtVGV4dCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvc3RyZWFtLXRleHQnO1xuaW1wb3J0IHsgU3RyZWFtVGV4dFJlc3VsdCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvc3RyZWFtLXRleHQtcmVzdWx0JztcbmltcG9ydCB7IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb24gfSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L3Rvb2wtY2FsbC1yZXBhaXItZnVuY3Rpb24nO1xuaW1wb3J0IHsgVG9vbFNldCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvdG9vbC1zZXQnO1xuaW1wb3J0IHsgQ2FsbFNldHRpbmdzIH0gZnJvbSAnLi4vcHJvbXB0L2NhbGwtc2V0dGluZ3MnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0L3Byb21wdCc7XG5pbXBvcnQgeyBUZWxlbWV0cnlTZXR0aW5ncyB9IGZyb20gJy4uL3RlbGVtZXRyeS90ZWxlbWV0cnktc2V0dGluZ3MnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VNb2RlbCwgVG9vbENob2ljZSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsJztcbmltcG9ydCB7IFByb3ZpZGVyTWV0YWRhdGEgfSBmcm9tICcuLi90eXBlcy9wcm92aWRlci1tZXRhZGF0YSc7XG5cbmV4cG9ydCB0eXBlIEFnZW50U2V0dGluZ3M8XG4gIFRPT0xTIGV4dGVuZHMgVG9vbFNldCxcbiAgT1VUUFVUID0gbmV2ZXIsXG4gIE9VVFBVVF9QQVJUSUFMID0gbmV2ZXIsXG4+ID0gQ2FsbFNldHRpbmdzICYge1xuICAvKipcbiAgICogVGhlIHN5c3RlbSBwcm9tcHQgdG8gdXNlLlxuICAgKi9cbiAgc3lzdGVtPzogc3RyaW5nO1xuXG4gIC8qKlxuVGhlIGxhbmd1YWdlIG1vZGVsIHRvIHVzZS5cbiAgICovXG4gIG1vZGVsOiBMYW5ndWFnZU1vZGVsO1xuXG4gIC8qKlxuVGhlIHRvb2xzIHRoYXQgdGhlIG1vZGVsIGNhbiBjYWxsLiBUaGUgbW9kZWwgbmVlZHMgdG8gc3VwcG9ydCBjYWxsaW5nIHRvb2xzLlxuKi9cbiAgdG9vbHM/OiBUT09MUztcblxuICAvKipcblRoZSB0b29sIGNob2ljZSBzdHJhdGVneS4gRGVmYXVsdDogJ2F1dG8nLlxuICAgKi9cbiAgdG9vbENob2ljZT86IFRvb2xDaG9pY2U8Tm9JbmZlcjxUT09MUz4+O1xuXG4gIC8qKlxuQ29uZGl0aW9uIGZvciBzdG9wcGluZyB0aGUgZ2VuZXJhdGlvbiB3aGVuIHRoZXJlIGFyZSB0b29sIHJlc3VsdHMgaW4gdGhlIGxhc3Qgc3RlcC5cbldoZW4gdGhlIGNvbmRpdGlvbiBpcyBhbiBhcnJheSwgYW55IG9mIHRoZSBjb25kaXRpb25zIGNhbiBiZSBtZXQgdG8gc3RvcCB0aGUgZ2VuZXJhdGlvbi5cblxuQGRlZmF1bHQgc3RlcENvdW50SXMoMSlcbiAgICovXG4gIHN0b3BXaGVuPzpcbiAgICB8IFN0b3BDb25kaXRpb248Tm9JbmZlcjxUT09MUz4+XG4gICAgfCBBcnJheTxTdG9wQ29uZGl0aW9uPE5vSW5mZXI8VE9PTFM+Pj47XG5cbiAgLyoqXG5PcHRpb25hbCB0ZWxlbWV0cnkgY29uZmlndXJhdGlvbiAoZXhwZXJpbWVudGFsKS5cbiAgICovXG4gIGV4cGVyaW1lbnRhbF90ZWxlbWV0cnk/OiBUZWxlbWV0cnlTZXR0aW5ncztcblxuICAvKipcbkxpbWl0cyB0aGUgdG9vbHMgdGhhdCBhcmUgYXZhaWxhYmxlIGZvciB0aGUgbW9kZWwgdG8gY2FsbCB3aXRob3V0XG5jaGFuZ2luZyB0aGUgdG9vbCBjYWxsIGFuZCByZXN1bHQgdHlwZXMgaW4gdGhlIHJlc3VsdC5cbiAgICovXG4gIGFjdGl2ZVRvb2xzPzogQXJyYXk8a2V5b2YgTm9JbmZlcjxUT09MUz4+O1xuXG4gIC8qKlxuT3B0aW9uYWwgc3BlY2lmaWNhdGlvbiBmb3IgcGFyc2luZyBzdHJ1Y3R1cmVkIG91dHB1dHMgZnJvbSB0aGUgTExNIHJlc3BvbnNlLlxuICAgKi9cbiAgZXhwZXJpbWVudGFsX291dHB1dD86IE91dHB1dDxPVVRQVVQsIE9VVFBVVF9QQVJUSUFMPjtcblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgVXNlIGBwcmVwYXJlU3RlcGAgaW5zdGVhZC5cbiAgICovXG4gIGV4cGVyaW1lbnRhbF9wcmVwYXJlU3RlcD86IFByZXBhcmVTdGVwRnVuY3Rpb248Tm9JbmZlcjxUT09MUz4+O1xuXG4gIC8qKlxuT3B0aW9uYWwgZnVuY3Rpb24gdGhhdCB5b3UgY2FuIHVzZSB0byBwcm92aWRlIGRpZmZlcmVudCBzZXR0aW5ncyBmb3IgYSBzdGVwLlxuICAqL1xuICBwcmVwYXJlU3RlcD86IFByZXBhcmVTdGVwRnVuY3Rpb248Tm9JbmZlcjxUT09MUz4+O1xuXG4gIC8qKlxuQSBmdW5jdGlvbiB0aGF0IGF0dGVtcHRzIHRvIHJlcGFpciBhIHRvb2wgY2FsbCB0aGF0IGZhaWxlZCB0byBwYXJzZS5cbiAgICovXG4gIGV4cGVyaW1lbnRhbF9yZXBhaXJUb29sQ2FsbD86IFRvb2xDYWxsUmVwYWlyRnVuY3Rpb248Tm9JbmZlcjxUT09MUz4+O1xuXG4gIC8qKlxuICBDYWxsYmFjayB0aGF0IGlzIGNhbGxlZCB3aGVuIGVhY2ggc3RlcCAoTExNIGNhbGwpIGlzIGZpbmlzaGVkLCBpbmNsdWRpbmcgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICAqL1xuICBvblN0ZXBGaW5pc2g/OiBHZW5lcmF0ZVRleHRPblN0ZXBGaW5pc2hDYWxsYmFjazxOb0luZmVyPFRPT0xTPj47XG5cbiAgLyoqXG4gICAqIENvbnRleHQgdGhhdCBpcyBwYXNzZWQgaW50byB0b29sIGNhbGxzLlxuICAgKlxuICAgKiBFeHBlcmltZW50YWwgKGNhbiBicmVhayBpbiBwYXRjaCByZWxlYXNlcykuXG4gICAqXG4gICAqIEBkZWZhdWx0IHVuZGVmaW5lZFxuICAgKi9cbiAgZXhwZXJpbWVudGFsX2NvbnRleHQ/OiB1bmtub3duO1xuXG4gIC8qKlxuICAgKiBJbnRlcm5hbC4gRm9yIHRlc3QgdXNlIG9ubHkuIE1heSBjaGFuZ2Ugd2l0aG91dCBub3RpY2UuXG4gICAqL1xuICBfaW50ZXJuYWw/OiB7XG4gICAgZ2VuZXJhdGVJZD86IElkR2VuZXJhdG9yO1xuICAgIGN1cnJlbnREYXRlPzogKCkgPT4gRGF0ZTtcbiAgfTtcbn07XG5cbmV4cG9ydCBjbGFzcyBBZ2VudDxcbiAgVE9PTFMgZXh0ZW5kcyBUb29sU2V0LFxuICBPVVRQVVQgPSBuZXZlcixcbiAgT1VUUFVUX1BBUlRJQUwgPSBuZXZlcixcbj4ge1xuICBwcml2YXRlIHJlYWRvbmx5IHNldHRpbmdzOiBBZ2VudFNldHRpbmdzPFRPT0xTLCBPVVRQVVQsIE9VVFBVVF9QQVJUSUFMPjtcblxuICBjb25zdHJ1Y3RvcihzZXR0aW5nczogQWdlbnRTZXR0aW5nczxUT09MUywgT1VUUFVULCBPVVRQVVRfUEFSVElBTD4pIHtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZShcbiAgICBvcHRpb25zOiBQcm9tcHQgJiB7XG4gICAgICAvKipcbkFkZGl0aW9uYWwgcHJvdmlkZXItc3BlY2lmaWMgbWV0YWRhdGEuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG5mcm9tIHRoZSBwcm92aWRlciB0byB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbnJlc3VsdHMgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cbiAgICovXG4gICAgICBwcm92aWRlck1ldGFkYXRhPzogUHJvdmlkZXJNZXRhZGF0YTtcbiAgICAgIC8qKlxuQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBtZXRhZGF0YS4gVGhleSBhcmUgcGFzc2VkIHRocm91Z2hcbnRvIHRoZSBwcm92aWRlciBmcm9tIHRoZSBBSSBTREsgYW5kIGVuYWJsZSBwcm92aWRlci1zcGVjaWZpY1xuZnVuY3Rpb25hbGl0eSB0aGF0IGNhbiBiZSBmdWxseSBlbmNhcHN1bGF0ZWQgaW4gdGhlIHByb3ZpZGVyLlxuICAgICAgICAgKi9cbiAgICAgIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcbiAgICB9LFxuICApOiBQcm9taXNlPEdlbmVyYXRlVGV4dFJlc3VsdDxUT09MUywgT1VUUFVUPj4ge1xuICAgIHJldHVybiBnZW5lcmF0ZVRleHQoeyAuLi50aGlzLnNldHRpbmdzLCAuLi5vcHRpb25zIH0pO1xuICB9XG5cbiAgc3RyZWFtKFxuICAgIG9wdGlvbnM6IFByb21wdCAmIHtcbiAgICAgIC8qKlxuQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBtZXRhZGF0YS4gVGhleSBhcmUgcGFzc2VkIHRocm91Z2hcbmZyb20gdGhlIHByb3ZpZGVyIHRvIHRoZSBBSSBTREsgYW5kIGVuYWJsZSBwcm92aWRlci1zcGVjaWZpY1xucmVzdWx0cyB0aGF0IGNhbiBiZSBmdWxseSBlbmNhcHN1bGF0ZWQgaW4gdGhlIHByb3ZpZGVyLlxuICAgKi9cbiAgICAgIHByb3ZpZGVyTWV0YWRhdGE/OiBQcm92aWRlck1ldGFkYXRhO1xuICAgICAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxudG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5mdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gICAgICAgICAqL1xuICAgICAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuICAgIH0sXG4gICk6IFN0cmVhbVRleHRSZXN1bHQ8VE9PTFMsIE9VVFBVVF9QQVJUSUFMPiB7XG4gICAgcmV0dXJuIHN0cmVhbVRleHQoeyAuLi50aGlzLnNldHRpbmdzLCAuLi5vcHRpb25zIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyByZXNvbHZlRW1iZWRkaW5nTW9kZWwgfSBmcm9tICcuLi9tb2RlbC9yZXNvbHZlLW1vZGVsJztcbmltcG9ydCB7IGFzc2VtYmxlT3BlcmF0aW9uTmFtZSB9IGZyb20gJy4uL3RlbGVtZXRyeS9hc3NlbWJsZS1vcGVyYXRpb24tbmFtZSc7XG5pbXBvcnQgeyBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtYmFzZS10ZWxlbWV0cnktYXR0cmlidXRlcyc7XG5pbXBvcnQgeyBnZXRUcmFjZXIgfSBmcm9tICcuLi90ZWxlbWV0cnkvZ2V0LXRyYWNlcic7XG5pbXBvcnQgeyByZWNvcmRTcGFuIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3JlY29yZC1zcGFuJztcbmltcG9ydCB7IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMgfSBmcm9tICcuLi90ZWxlbWV0cnkvc2VsZWN0LXRlbGVtZXRyeS1hdHRyaWJ1dGVzJztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3RlbGVtZXRyeS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBFbWJlZGRpbmdNb2RlbCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IHByZXBhcmVSZXRyaWVzIH0gZnJvbSAnLi4vdXRpbC9wcmVwYXJlLXJldHJpZXMnO1xuaW1wb3J0IHsgRW1iZWRSZXN1bHQgfSBmcm9tICcuL2VtYmVkLXJlc3VsdCc7XG5cbi8qKlxuRW1iZWQgYSB2YWx1ZSB1c2luZyBhbiBlbWJlZGRpbmcgbW9kZWwuIFRoZSB0eXBlIG9mIHRoZSB2YWx1ZSBpcyBkZWZpbmVkIGJ5IHRoZSBlbWJlZGRpbmcgbW9kZWwuXG5cbkBwYXJhbSBtb2RlbCAtIFRoZSBlbWJlZGRpbmcgbW9kZWwgdG8gdXNlLlxuQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRoYXQgc2hvdWxkIGJlIGVtYmVkZGVkLlxuXG5AcGFyYW0gbWF4UmV0cmllcyAtIE1heGltdW0gbnVtYmVyIG9mIHJldHJpZXMuIFNldCB0byAwIHRvIGRpc2FibGUgcmV0cmllcy4gRGVmYXVsdDogMi5cbkBwYXJhbSBhYm9ydFNpZ25hbCAtIEFuIG9wdGlvbmFsIGFib3J0IHNpZ25hbCB0aGF0IGNhbiBiZSB1c2VkIHRvIGNhbmNlbCB0aGUgY2FsbC5cbkBwYXJhbSBoZWFkZXJzIC0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdG8gYmUgc2VudCB3aXRoIHRoZSByZXF1ZXN0LiBPbmx5IGFwcGxpY2FibGUgZm9yIEhUVFAtYmFzZWQgcHJvdmlkZXJzLlxuXG5AcmV0dXJucyBBIHJlc3VsdCBvYmplY3QgdGhhdCBjb250YWlucyB0aGUgZW1iZWRkaW5nLCB0aGUgdmFsdWUsIGFuZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1iZWQ8VkFMVUUgPSBzdHJpbmc+KHtcbiAgbW9kZWw6IG1vZGVsQXJnLFxuICB2YWx1ZSxcbiAgcHJvdmlkZXJPcHRpb25zLFxuICBtYXhSZXRyaWVzOiBtYXhSZXRyaWVzQXJnLFxuICBhYm9ydFNpZ25hbCxcbiAgaGVhZGVycyxcbiAgZXhwZXJpbWVudGFsX3RlbGVtZXRyeTogdGVsZW1ldHJ5LFxufToge1xuICAvKipcblRoZSBlbWJlZGRpbmcgbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICBtb2RlbDogRW1iZWRkaW5nTW9kZWw8VkFMVUU+O1xuXG4gIC8qKlxuVGhlIHZhbHVlIHRoYXQgc2hvdWxkIGJlIGVtYmVkZGVkLlxuICAgKi9cbiAgdmFsdWU6IFZBTFVFO1xuXG4gIC8qKlxuTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcyBwZXIgZW1iZWRkaW5nIG1vZGVsIGNhbGwuIFNldCB0byAwIHRvIGRpc2FibGUgcmV0cmllcy5cblxuQGRlZmF1bHQgMlxuICAgKi9cbiAgbWF4UmV0cmllcz86IG51bWJlcjtcblxuICAvKipcbkFib3J0IHNpZ25hbC5cbiAqL1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuXG4gIC8qKlxuQWRkaXRpb25hbCBoZWFkZXJzIHRvIGluY2x1ZGUgaW4gdGhlIHJlcXVlc3QuXG5Pbmx5IGFwcGxpY2FibGUgZm9yIEhUVFAtYmFzZWQgcHJvdmlkZXJzLlxuICovXG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gIC8qKlxuICBBZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG4gIHRvIHRoZSBwcm92aWRlciBmcm9tIHRoZSBBSSBTREsgYW5kIGVuYWJsZSBwcm92aWRlci1zcGVjaWZpY1xuICBmdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gICovXG4gIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcblxuICAvKipcbiAgICogT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG4gICAqL1xuICBleHBlcmltZW50YWxfdGVsZW1ldHJ5PzogVGVsZW1ldHJ5U2V0dGluZ3M7XG59KTogUHJvbWlzZTxFbWJlZFJlc3VsdDxWQUxVRT4+IHtcbiAgY29uc3QgbW9kZWwgPSByZXNvbHZlRW1iZWRkaW5nTW9kZWw8VkFMVUU+KG1vZGVsQXJnKTtcblxuICBjb25zdCB7IG1heFJldHJpZXMsIHJldHJ5IH0gPSBwcmVwYXJlUmV0cmllcyh7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICBhYm9ydFNpZ25hbCxcbiAgfSk7XG5cbiAgY29uc3QgYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMgPSBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgbW9kZWw6IG1vZGVsLFxuICAgIHRlbGVtZXRyeSxcbiAgICBoZWFkZXJzLFxuICAgIHNldHRpbmdzOiB7IG1heFJldHJpZXMgfSxcbiAgfSk7XG5cbiAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKHRlbGVtZXRyeSk7XG5cbiAgcmV0dXJuIHJlY29yZFNwYW4oe1xuICAgIG5hbWU6ICdhaS5lbWJlZCcsXG4gICAgYXR0cmlidXRlczogc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICB0ZWxlbWV0cnksXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIC4uLmFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7IG9wZXJhdGlvbklkOiAnYWkuZW1iZWQnLCB0ZWxlbWV0cnkgfSksXG4gICAgICAgIC4uLmJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzLFxuICAgICAgICAnYWkudmFsdWUnOiB7IGlucHV0OiAoKSA9PiBKU09OLnN0cmluZ2lmeSh2YWx1ZSkgfSxcbiAgICAgIH0sXG4gICAgfSksXG4gICAgdHJhY2VyLFxuICAgIGZuOiBhc3luYyBzcGFuID0+IHtcbiAgICAgIGNvbnN0IHsgZW1iZWRkaW5nLCB1c2FnZSwgcmVzcG9uc2UsIHByb3ZpZGVyTWV0YWRhdGEgfSA9IGF3YWl0IHJldHJ5KCgpID0+XG4gICAgICAgIC8vIG5lc3RlZCBzcGFucyB0byBhbGlnbiB3aXRoIHRoZSBlbWJlZE1hbnkgdGVsZW1ldHJ5IGRhdGE6XG4gICAgICAgIHJlY29yZFNwYW4oe1xuICAgICAgICAgIG5hbWU6ICdhaS5lbWJlZC5kb0VtYmVkJyxcbiAgICAgICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgICAgICBvcGVyYXRpb25JZDogJ2FpLmVtYmVkLmRvRW1iZWQnLFxuICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIC4uLmJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAvLyBzcGVjaWZpYyBzZXR0aW5ncyB0aGF0IG9ubHkgbWFrZSBzZW5zZSBvbiB0aGUgb3V0ZXIgbGV2ZWw6XG4gICAgICAgICAgICAgICdhaS52YWx1ZXMnOiB7IGlucHV0OiAoKSA9PiBbSlNPTi5zdHJpbmdpZnkodmFsdWUpXSB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICB0cmFjZXIsXG4gICAgICAgICAgZm46IGFzeW5jIGRvRW1iZWRTcGFuID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsUmVzcG9uc2UgPSBhd2FpdCBtb2RlbC5kb0VtYmVkKHtcbiAgICAgICAgICAgICAgdmFsdWVzOiBbdmFsdWVdLFxuICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGVtYmVkZGluZyA9IG1vZGVsUmVzcG9uc2UuZW1iZWRkaW5nc1swXTtcbiAgICAgICAgICAgIGNvbnN0IHVzYWdlID0gbW9kZWxSZXNwb25zZS51c2FnZSA/PyB7IHRva2VuczogTmFOIH07XG5cbiAgICAgICAgICAgIGRvRW1iZWRTcGFuLnNldEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAnYWkuZW1iZWRkaW5ncyc6IHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgIG1vZGVsUmVzcG9uc2UuZW1iZWRkaW5ncy5tYXAoZW1iZWRkaW5nID0+XG4gICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShlbWJlZGRpbmcpLFxuICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJ2FpLnVzYWdlLnRva2Vucyc6IHVzYWdlLnRva2VucyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGVtYmVkZGluZyxcbiAgICAgICAgICAgICAgdXNhZ2UsXG4gICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IG1vZGVsUmVzcG9uc2UucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgcmVzcG9uc2U6IG1vZGVsUmVzcG9uc2UucmVzcG9uc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgJ2FpLmVtYmVkZGluZyc6IHsgb3V0cHV0OiAoKSA9PiBKU09OLnN0cmluZ2lmeShlbWJlZGRpbmcpIH0sXG4gICAgICAgICAgICAnYWkudXNhZ2UudG9rZW5zJzogdXNhZ2UudG9rZW5zLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIG5ldyBEZWZhdWx0RW1iZWRSZXN1bHQoe1xuICAgICAgICB2YWx1ZSxcbiAgICAgICAgZW1iZWRkaW5nLFxuICAgICAgICB1c2FnZSxcbiAgICAgICAgcHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICB9KTtcbiAgICB9LFxuICB9KTtcbn1cblxuY2xhc3MgRGVmYXVsdEVtYmVkUmVzdWx0PFZBTFVFPiBpbXBsZW1lbnRzIEVtYmVkUmVzdWx0PFZBTFVFPiB7XG4gIHJlYWRvbmx5IHZhbHVlOiBFbWJlZFJlc3VsdDxWQUxVRT5bJ3ZhbHVlJ107XG4gIHJlYWRvbmx5IGVtYmVkZGluZzogRW1iZWRSZXN1bHQ8VkFMVUU+WydlbWJlZGRpbmcnXTtcbiAgcmVhZG9ubHkgdXNhZ2U6IEVtYmVkUmVzdWx0PFZBTFVFPlsndXNhZ2UnXTtcbiAgcmVhZG9ubHkgcHJvdmlkZXJNZXRhZGF0YTogRW1iZWRSZXN1bHQ8VkFMVUU+Wydwcm92aWRlck1ldGFkYXRhJ107XG4gIHJlYWRvbmx5IHJlc3BvbnNlOiBFbWJlZFJlc3VsdDxWQUxVRT5bJ3Jlc3BvbnNlJ107XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczoge1xuICAgIHZhbHVlOiBFbWJlZFJlc3VsdDxWQUxVRT5bJ3ZhbHVlJ107XG4gICAgZW1iZWRkaW5nOiBFbWJlZFJlc3VsdDxWQUxVRT5bJ2VtYmVkZGluZyddO1xuICAgIHVzYWdlOiBFbWJlZFJlc3VsdDxWQUxVRT5bJ3VzYWdlJ107XG4gICAgcHJvdmlkZXJNZXRhZGF0YT86IEVtYmVkUmVzdWx0PFZBTFVFPlsncHJvdmlkZXJNZXRhZGF0YSddO1xuICAgIHJlc3BvbnNlPzogRW1iZWRSZXN1bHQ8VkFMVUU+WydyZXNwb25zZSddO1xuICB9KSB7XG4gICAgdGhpcy52YWx1ZSA9IG9wdGlvbnMudmFsdWU7XG4gICAgdGhpcy5lbWJlZGRpbmcgPSBvcHRpb25zLmVtYmVkZGluZztcbiAgICB0aGlzLnVzYWdlID0gb3B0aW9ucy51c2FnZTtcbiAgICB0aGlzLnByb3ZpZGVyTWV0YWRhdGEgPSBvcHRpb25zLnByb3ZpZGVyTWV0YWRhdGE7XG4gICAgdGhpcy5yZXNwb25zZSA9IG9wdGlvbnMucmVzcG9uc2U7XG4gIH1cbn1cbiIsICIvKipcbiAqIFNwbGl0cyBhbiBhcnJheSBpbnRvIGNodW5rcyBvZiBhIHNwZWNpZmllZCBzaXplLlxuICpcbiAqIEB0ZW1wbGF0ZSBUIC0gVGhlIHR5cGUgb2YgZWxlbWVudHMgaW4gdGhlIGFycmF5LlxuICogQHBhcmFtIHtUW119IGFycmF5IC0gVGhlIGFycmF5IHRvIHNwbGl0LlxuICogQHBhcmFtIHtudW1iZXJ9IGNodW5rU2l6ZSAtIFRoZSBzaXplIG9mIGVhY2ggY2h1bmsuXG4gKiBAcmV0dXJucyB7VFtdW119IC0gQSBuZXcgYXJyYXkgY29udGFpbmluZyB0aGUgY2h1bmtzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRBcnJheTxUPihhcnJheTogVFtdLCBjaHVua1NpemU6IG51bWJlcik6IFRbXVtdIHtcbiAgaWYgKGNodW5rU2l6ZSA8PSAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjaHVua1NpemUgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCcpO1xuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpICs9IGNodW5rU2l6ZSkge1xuICAgIHJlc3VsdC5wdXNoKGFycmF5LnNsaWNlKGksIGkgKyBjaHVua1NpemUpKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG4iLCAiaW1wb3J0IHsgUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBwcmVwYXJlUmV0cmllcyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1yZXRyaWVzJztcbmltcG9ydCB7IHNwbGl0QXJyYXkgfSBmcm9tICcuLi91dGlsL3NwbGl0LWFycmF5JztcbmltcG9ydCB7IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3IgfSBmcm9tICcuLi9lcnJvci91bnN1cHBvcnRlZC1tb2RlbC12ZXJzaW9uLWVycm9yJztcbmltcG9ydCB7IGFzc2VtYmxlT3BlcmF0aW9uTmFtZSB9IGZyb20gJy4uL3RlbGVtZXRyeS9hc3NlbWJsZS1vcGVyYXRpb24tbmFtZSc7XG5pbXBvcnQgeyBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtYmFzZS10ZWxlbWV0cnktYXR0cmlidXRlcyc7XG5pbXBvcnQgeyBnZXRUcmFjZXIgfSBmcm9tICcuLi90ZWxlbWV0cnkvZ2V0LXRyYWNlcic7XG5pbXBvcnQgeyByZWNvcmRTcGFuIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3JlY29yZC1zcGFuJztcbmltcG9ydCB7IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMgfSBmcm9tICcuLi90ZWxlbWV0cnkvc2VsZWN0LXRlbGVtZXRyeS1hdHRyaWJ1dGVzJztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3RlbGVtZXRyeS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBFbWJlZGRpbmcsIEVtYmVkZGluZ01vZGVsLCBQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgcmVzb2x2ZUVtYmVkZGluZ01vZGVsIH0gZnJvbSAnLi4vbW9kZWwvcmVzb2x2ZS1tb2RlbCc7XG5pbXBvcnQgeyBFbWJlZE1hbnlSZXN1bHQgfSBmcm9tICcuL2VtYmVkLW1hbnktcmVzdWx0JztcblxuLyoqXG5FbWJlZCBzZXZlcmFsIHZhbHVlcyB1c2luZyBhbiBlbWJlZGRpbmcgbW9kZWwuIFRoZSB0eXBlIG9mIHRoZSB2YWx1ZSBpcyBkZWZpbmVkXG5ieSB0aGUgZW1iZWRkaW5nIG1vZGVsLlxuXG5gZW1iZWRNYW55YCBhdXRvbWF0aWNhbGx5IHNwbGl0cyBsYXJnZSByZXF1ZXN0cyBpbnRvIHNtYWxsZXIgY2h1bmtzIGlmIHRoZSBtb2RlbFxuaGFzIGEgbGltaXQgb24gaG93IG1hbnkgZW1iZWRkaW5ncyBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgc2luZ2xlIGNhbGwuXG5cbkBwYXJhbSBtb2RlbCAtIFRoZSBlbWJlZGRpbmcgbW9kZWwgdG8gdXNlLlxuQHBhcmFtIHZhbHVlcyAtIFRoZSB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgZW1iZWRkZWQuXG5cbkBwYXJhbSBtYXhSZXRyaWVzIC0gTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcy4gU2V0IHRvIDAgdG8gZGlzYWJsZSByZXRyaWVzLiBEZWZhdWx0OiAyLlxuQHBhcmFtIGFib3J0U2lnbmFsIC0gQW4gb3B0aW9uYWwgYWJvcnQgc2lnbmFsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FuY2VsIHRoZSBjYWxsLlxuQHBhcmFtIGhlYWRlcnMgLSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBiZSBzZW50IHdpdGggdGhlIHJlcXVlc3QuIE9ubHkgYXBwbGljYWJsZSBmb3IgSFRUUC1iYXNlZCBwcm92aWRlcnMuXG5cbkByZXR1cm5zIEEgcmVzdWx0IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBlbWJlZGRpbmdzLCB0aGUgdmFsdWUsIGFuZCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW1iZWRNYW55PFZBTFVFID0gc3RyaW5nPih7XG4gIG1vZGVsOiBtb2RlbEFyZyxcbiAgdmFsdWVzLFxuICBtYXhQYXJhbGxlbENhbGxzID0gSW5maW5pdHksXG4gIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gIGFib3J0U2lnbmFsLFxuICBoZWFkZXJzLFxuICBwcm92aWRlck9wdGlvbnMsXG4gIGV4cGVyaW1lbnRhbF90ZWxlbWV0cnk6IHRlbGVtZXRyeSxcbn06IHtcbiAgLyoqXG5UaGUgZW1iZWRkaW5nIG1vZGVsIHRvIHVzZS5cbiAgICAgKi9cbiAgbW9kZWw6IEVtYmVkZGluZ01vZGVsPFZBTFVFPjtcblxuICAvKipcblRoZSB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgZW1iZWRkZWQuXG4gICAqL1xuICB2YWx1ZXM6IEFycmF5PFZBTFVFPjtcblxuICAvKipcbk1heGltdW0gbnVtYmVyIG9mIHJldHJpZXMgcGVyIGVtYmVkZGluZyBtb2RlbCBjYWxsLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJldHJpZXMuXG5cbkBkZWZhdWx0IDJcbiAgICovXG4gIG1heFJldHJpZXM/OiBudW1iZXI7XG5cbiAgLyoqXG5BYm9ydCBzaWduYWwuXG4gKi9cbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcblxuICAvKipcbkFkZGl0aW9uYWwgaGVhZGVycyB0byBpbmNsdWRlIGluIHRoZSByZXF1ZXN0LlxuT25seSBhcHBsaWNhYmxlIGZvciBIVFRQLWJhc2VkIHByb3ZpZGVycy5cbiAqL1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICAvKipcbiAgICogT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG4gICAqL1xuICBleHBlcmltZW50YWxfdGVsZW1ldHJ5PzogVGVsZW1ldHJ5U2V0dGluZ3M7XG5cbiAgLyoqXG4gIEFkZGl0aW9uYWwgcHJvdmlkZXItc3BlY2lmaWMgb3B0aW9ucy4gVGhleSBhcmUgcGFzc2VkIHRocm91Z2hcbiAgdG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG4gIGZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cbiAgKi9cbiAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuXG4gIC8qKlxuICAgKiBNYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlcXVlc3RzLlxuICAgKlxuICAgKiBAZGVmYXVsdCBJbmZpbml0eVxuICAgKi9cbiAgbWF4UGFyYWxsZWxDYWxscz86IG51bWJlcjtcbn0pOiBQcm9taXNlPEVtYmVkTWFueVJlc3VsdDxWQUxVRT4+IHtcbiAgY29uc3QgbW9kZWwgPSByZXNvbHZlRW1iZWRkaW5nTW9kZWw8VkFMVUU+KG1vZGVsQXJnKTtcblxuICBjb25zdCB7IG1heFJldHJpZXMsIHJldHJ5IH0gPSBwcmVwYXJlUmV0cmllcyh7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICBhYm9ydFNpZ25hbCxcbiAgfSk7XG5cbiAgY29uc3QgYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMgPSBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgbW9kZWwsXG4gICAgdGVsZW1ldHJ5LFxuICAgIGhlYWRlcnMsXG4gICAgc2V0dGluZ3M6IHsgbWF4UmV0cmllcyB9LFxuICB9KTtcblxuICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIodGVsZW1ldHJ5KTtcblxuICByZXR1cm4gcmVjb3JkU3Bhbih7XG4gICAgbmFtZTogJ2FpLmVtYmVkTWFueScsXG4gICAgYXR0cmlidXRlczogc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICB0ZWxlbWV0cnksXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIC4uLmFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7IG9wZXJhdGlvbklkOiAnYWkuZW1iZWRNYW55JywgdGVsZW1ldHJ5IH0pLFxuICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAnYWkudmFsdWVzJzoge1xuICAgICAgICAgIGlucHV0OiAoKSA9PiB2YWx1ZXMubWFwKHZhbHVlID0+IEpTT04uc3RyaW5naWZ5KHZhbHVlKSksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pLFxuICAgIHRyYWNlcixcbiAgICBmbjogYXN5bmMgc3BhbiA9PiB7XG4gICAgICBjb25zdCBbbWF4RW1iZWRkaW5nc1BlckNhbGwsIHN1cHBvcnRzUGFyYWxsZWxDYWxsc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIG1vZGVsLm1heEVtYmVkZGluZ3NQZXJDYWxsLFxuICAgICAgICBtb2RlbC5zdXBwb3J0c1BhcmFsbGVsQ2FsbHMsXG4gICAgICBdKTtcblxuICAgICAgLy8gdGhlIG1vZGVsIGhhcyBub3Qgc3BlY2lmaWVkIGxpbWl0cyBvblxuICAgICAgLy8gaG93IG1hbnkgZW1iZWRkaW5ncyBjYW4gYmUgZ2VuZXJhdGVkIGluIGEgc2luZ2xlIGNhbGxcbiAgICAgIGlmIChtYXhFbWJlZGRpbmdzUGVyQ2FsbCA9PSBudWxsIHx8IG1heEVtYmVkZGluZ3NQZXJDYWxsID09PSBJbmZpbml0eSkge1xuICAgICAgICBjb25zdCB7IGVtYmVkZGluZ3MsIHVzYWdlLCByZXNwb25zZSwgcHJvdmlkZXJNZXRhZGF0YSB9ID0gYXdhaXQgcmV0cnkoXG4gICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgLy8gbmVzdGVkIHNwYW5zIHRvIGFsaWduIHdpdGggdGhlIGVtYmVkTWFueSB0ZWxlbWV0cnkgZGF0YTpcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRTcGFuKHtcbiAgICAgICAgICAgICAgbmFtZTogJ2FpLmVtYmVkTWFueS5kb0VtYmVkJyxcbiAgICAgICAgICAgICAgYXR0cmlidXRlczogc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgIC4uLmFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbklkOiAnYWkuZW1iZWRNYW55LmRvRW1iZWQnLFxuICAgICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgIC4uLmJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAgICAgICAgICAgJ2FpLnZhbHVlcyc6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+IHZhbHVlcy5tYXAodmFsdWUgPT4gSlNPTi5zdHJpbmdpZnkodmFsdWUpKSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIHRyYWNlcixcbiAgICAgICAgICAgICAgZm46IGFzeW5jIGRvRW1iZWRTcGFuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RlbFJlc3BvbnNlID0gYXdhaXQgbW9kZWwuZG9FbWJlZCh7XG4gICAgICAgICAgICAgICAgICB2YWx1ZXMsXG4gICAgICAgICAgICAgICAgICBhYm9ydFNpZ25hbCxcbiAgICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBlbWJlZGRpbmdzID0gbW9kZWxSZXNwb25zZS5lbWJlZGRpbmdzO1xuICAgICAgICAgICAgICAgIGNvbnN0IHVzYWdlID0gbW9kZWxSZXNwb25zZS51c2FnZSA/PyB7IHRva2VuczogTmFOIH07XG5cbiAgICAgICAgICAgICAgICBkb0VtYmVkU3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgICAgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICdhaS5lbWJlZGRpbmdzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbWJlZGRpbmdzLm1hcChlbWJlZGRpbmcgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShlbWJlZGRpbmcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgJ2FpLnVzYWdlLnRva2Vucyc6IHVzYWdlLnRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgZW1iZWRkaW5ncyxcbiAgICAgICAgICAgICAgICAgIHVzYWdlLFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogbW9kZWxSZXNwb25zZS5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IG1vZGVsUmVzcG9uc2UucmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICk7XG5cbiAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAnYWkuZW1iZWRkaW5ncyc6IHtcbiAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+XG4gICAgICAgICAgICAgICAgICBlbWJlZGRpbmdzLm1hcChlbWJlZGRpbmcgPT4gSlNPTi5zdHJpbmdpZnkoZW1iZWRkaW5nKSksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICdhaS51c2FnZS50b2tlbnMnOiB1c2FnZS50b2tlbnMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBuZXcgRGVmYXVsdEVtYmVkTWFueVJlc3VsdCh7XG4gICAgICAgICAgdmFsdWVzLFxuICAgICAgICAgIGVtYmVkZGluZ3MsXG4gICAgICAgICAgdXNhZ2UsXG4gICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICByZXNwb25zZXM6IFtyZXNwb25zZV0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBzcGxpdCB0aGUgdmFsdWVzIGludG8gY2h1bmtzIHRoYXQgYXJlIHNtYWxsIGVub3VnaCBmb3IgdGhlIG1vZGVsOlxuICAgICAgY29uc3QgdmFsdWVDaHVua3MgPSBzcGxpdEFycmF5KHZhbHVlcywgbWF4RW1iZWRkaW5nc1BlckNhbGwpO1xuXG4gICAgICAvLyBzZXJpYWxseSBlbWJlZCB0aGUgY2h1bmtzOlxuICAgICAgY29uc3QgZW1iZWRkaW5nczogQXJyYXk8RW1iZWRkaW5nPiA9IFtdO1xuICAgICAgY29uc3QgcmVzcG9uc2VzOiBBcnJheTxcbiAgICAgICAgfCB7XG4gICAgICAgICAgICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgIGJvZHk/OiB1bmtub3duO1xuICAgICAgICAgIH1cbiAgICAgICAgfCB1bmRlZmluZWRcbiAgICAgID4gPSBbXTtcbiAgICAgIGxldCB0b2tlbnMgPSAwO1xuICAgICAgbGV0IHByb3ZpZGVyTWV0YWRhdGE6IFByb3ZpZGVyTWV0YWRhdGEgfCB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHBhcmFsbGVsQ2h1bmtzID0gc3BsaXRBcnJheShcbiAgICAgICAgdmFsdWVDaHVua3MsXG4gICAgICAgIHN1cHBvcnRzUGFyYWxsZWxDYWxscyA/IG1heFBhcmFsbGVsQ2FsbHMgOiAxLFxuICAgICAgKTtcblxuICAgICAgZm9yIChjb25zdCBwYXJhbGxlbENodW5rIG9mIHBhcmFsbGVsQ2h1bmtzKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICBwYXJhbGxlbENodW5rLm1hcChjaHVuayA9PiB7XG4gICAgICAgICAgICByZXR1cm4gcmV0cnkoKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBuZXN0ZWQgc3BhbnMgdG8gYWxpZ24gd2l0aCB0aGUgZW1iZWRNYW55IHRlbGVtZXRyeSBkYXRhOlxuICAgICAgICAgICAgICByZXR1cm4gcmVjb3JkU3Bhbih7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2FpLmVtYmVkTWFueS5kb0VtYmVkJyxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb25JZDogJ2FpLmVtYmVkTWFueS5kb0VtYmVkJyxcbiAgICAgICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAgICAgICAgICAgICAnYWkudmFsdWVzJzoge1xuICAgICAgICAgICAgICAgICAgICAgIGlucHV0OiAoKSA9PiBjaHVuay5tYXAodmFsdWUgPT4gSlNPTi5zdHJpbmdpZnkodmFsdWUpKSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHJhY2VyLFxuICAgICAgICAgICAgICAgIGZuOiBhc3luYyBkb0VtYmVkU3BhbiA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBtb2RlbFJlc3BvbnNlID0gYXdhaXQgbW9kZWwuZG9FbWJlZCh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlczogY2h1bmssXG4gICAgICAgICAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgY29uc3QgZW1iZWRkaW5ncyA9IG1vZGVsUmVzcG9uc2UuZW1iZWRkaW5ncztcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHVzYWdlID0gbW9kZWxSZXNwb25zZS51c2FnZSA/PyB7IHRva2VuczogTmFOIH07XG5cbiAgICAgICAgICAgICAgICAgIGRvRW1iZWRTcGFuLnNldEF0dHJpYnV0ZXMoXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkuZW1iZWRkaW5ncyc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkZGluZ3MubWFwKGVtYmVkZGluZyA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoZW1iZWRkaW5nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS50b2tlbnMnOiB1c2FnZS50b2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBlbWJlZGRpbmdzLFxuICAgICAgICAgICAgICAgICAgICB1c2FnZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogbW9kZWxSZXNwb25zZS5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZTogbW9kZWxSZXNwb25zZS5yZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRzKSB7XG4gICAgICAgICAgZW1iZWRkaW5ncy5wdXNoKC4uLnJlc3VsdC5lbWJlZGRpbmdzKTtcbiAgICAgICAgICByZXNwb25zZXMucHVzaChyZXN1bHQucmVzcG9uc2UpO1xuICAgICAgICAgIHRva2VucyArPSByZXN1bHQudXNhZ2UudG9rZW5zO1xuICAgICAgICAgIGlmIChyZXN1bHQucHJvdmlkZXJNZXRhZGF0YSkge1xuICAgICAgICAgICAgaWYgKCFwcm92aWRlck1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGEgPSB7IC4uLnJlc3VsdC5wcm92aWRlck1ldGFkYXRhIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtwcm92aWRlck5hbWUsIG1ldGFkYXRhXSBvZiBPYmplY3QuZW50cmllcyhcbiAgICAgICAgICAgICAgICByZXN1bHQucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgICAgICAgKSkge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGFbcHJvdmlkZXJOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgIC4uLihwcm92aWRlck1ldGFkYXRhW3Byb3ZpZGVyTmFtZV0gPz8ge30pLFxuICAgICAgICAgICAgICAgICAgLi4ubWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoXG4gICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAnYWkuZW1iZWRkaW5ncyc6IHtcbiAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PlxuICAgICAgICAgICAgICAgIGVtYmVkZGluZ3MubWFwKGVtYmVkZGluZyA9PiBKU09OLnN0cmluZ2lmeShlbWJlZGRpbmcpKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnYWkudXNhZ2UudG9rZW5zJzogdG9rZW5zLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIG5ldyBEZWZhdWx0RW1iZWRNYW55UmVzdWx0KHtcbiAgICAgICAgdmFsdWVzLFxuICAgICAgICBlbWJlZGRpbmdzLFxuICAgICAgICB1c2FnZTogeyB0b2tlbnMgfSxcbiAgICAgICAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgcmVzcG9uc2VzLFxuICAgICAgfSk7XG4gICAgfSxcbiAgfSk7XG59XG5cbmNsYXNzIERlZmF1bHRFbWJlZE1hbnlSZXN1bHQ8VkFMVUU+IGltcGxlbWVudHMgRW1iZWRNYW55UmVzdWx0PFZBTFVFPiB7XG4gIHJlYWRvbmx5IHZhbHVlczogRW1iZWRNYW55UmVzdWx0PFZBTFVFPlsndmFsdWVzJ107XG4gIHJlYWRvbmx5IGVtYmVkZGluZ3M6IEVtYmVkTWFueVJlc3VsdDxWQUxVRT5bJ2VtYmVkZGluZ3MnXTtcbiAgcmVhZG9ubHkgdXNhZ2U6IEVtYmVkTWFueVJlc3VsdDxWQUxVRT5bJ3VzYWdlJ107XG4gIHJlYWRvbmx5IHByb3ZpZGVyTWV0YWRhdGE6IEVtYmVkTWFueVJlc3VsdDxWQUxVRT5bJ3Byb3ZpZGVyTWV0YWRhdGEnXTtcbiAgcmVhZG9ubHkgcmVzcG9uc2VzOiBFbWJlZE1hbnlSZXN1bHQ8VkFMVUU+WydyZXNwb25zZXMnXTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiB7XG4gICAgdmFsdWVzOiBFbWJlZE1hbnlSZXN1bHQ8VkFMVUU+Wyd2YWx1ZXMnXTtcbiAgICBlbWJlZGRpbmdzOiBFbWJlZE1hbnlSZXN1bHQ8VkFMVUU+WydlbWJlZGRpbmdzJ107XG4gICAgdXNhZ2U6IEVtYmVkTWFueVJlc3VsdDxWQUxVRT5bJ3VzYWdlJ107XG4gICAgcHJvdmlkZXJNZXRhZGF0YT86IEVtYmVkTWFueVJlc3VsdDxWQUxVRT5bJ3Byb3ZpZGVyTWV0YWRhdGEnXTtcbiAgICByZXNwb25zZXM/OiBFbWJlZE1hbnlSZXN1bHQ8VkFMVUU+WydyZXNwb25zZXMnXTtcbiAgfSkge1xuICAgIHRoaXMudmFsdWVzID0gb3B0aW9ucy52YWx1ZXM7XG4gICAgdGhpcy5lbWJlZGRpbmdzID0gb3B0aW9ucy5lbWJlZGRpbmdzO1xuICAgIHRoaXMudXNhZ2UgPSBvcHRpb25zLnVzYWdlO1xuICAgIHRoaXMucHJvdmlkZXJNZXRhZGF0YSA9IG9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YTtcbiAgICB0aGlzLnJlc3BvbnNlcyA9IG9wdGlvbnMucmVzcG9uc2VzO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgSW1hZ2VNb2RlbFYyLCBJbWFnZU1vZGVsVjJQcm92aWRlck1ldGFkYXRhIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBQcm92aWRlck9wdGlvbnMgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IE5vSW1hZ2VHZW5lcmF0ZWRFcnJvciB9IGZyb20gJy4uL2Vycm9yL25vLWltYWdlLWdlbmVyYXRlZC1lcnJvcic7XG5pbXBvcnQge1xuICBkZXRlY3RNZWRpYVR5cGUsXG4gIGltYWdlTWVkaWFUeXBlU2lnbmF0dXJlcyxcbn0gZnJvbSAnLi4vdXRpbC9kZXRlY3QtbWVkaWEtdHlwZSc7XG5pbXBvcnQgeyBwcmVwYXJlUmV0cmllcyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1yZXRyaWVzJztcbmltcG9ydCB7IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3IgfSBmcm9tICcuLi9lcnJvci91bnN1cHBvcnRlZC1tb2RlbC12ZXJzaW9uLWVycm9yJztcbmltcG9ydCB7XG4gIERlZmF1bHRHZW5lcmF0ZWRGaWxlLFxuICBHZW5lcmF0ZWRGaWxlLFxufSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L2dlbmVyYXRlZC1maWxlJztcbmltcG9ydCB7IEltYWdlR2VuZXJhdGlvbldhcm5pbmcgfSBmcm9tICcuLi90eXBlcy9pbWFnZS1tb2RlbCc7XG5pbXBvcnQgeyBJbWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL2ltYWdlLW1vZGVsLXJlc3BvbnNlLW1ldGFkYXRhJztcbmltcG9ydCB7IEdlbmVyYXRlSW1hZ2VSZXN1bHQgfSBmcm9tICcuL2dlbmVyYXRlLWltYWdlLXJlc3VsdCc7XG5cbi8qKlxuR2VuZXJhdGVzIGltYWdlcyB1c2luZyBhbiBpbWFnZSBtb2RlbC5cblxuQHBhcmFtIG1vZGVsIC0gVGhlIGltYWdlIG1vZGVsIHRvIHVzZS5cbkBwYXJhbSBwcm9tcHQgLSBUaGUgcHJvbXB0IHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGltYWdlLlxuQHBhcmFtIG4gLSBOdW1iZXIgb2YgaW1hZ2VzIHRvIGdlbmVyYXRlLiBEZWZhdWx0OiAxLlxuQHBhcmFtIHNpemUgLSBTaXplIG9mIHRoZSBpbWFnZXMgdG8gZ2VuZXJhdGUuIE11c3QgaGF2ZSB0aGUgZm9ybWF0IGB7d2lkdGh9eHtoZWlnaHR9YC5cbkBwYXJhbSBhc3BlY3RSYXRpbyAtIEFzcGVjdCByYXRpbyBvZiB0aGUgaW1hZ2VzIHRvIGdlbmVyYXRlLiBNdXN0IGhhdmUgdGhlIGZvcm1hdCBge3dpZHRofTp7aGVpZ2h0fWAuXG5AcGFyYW0gc2VlZCAtIFNlZWQgZm9yIHRoZSBpbWFnZSBnZW5lcmF0aW9uLlxuQHBhcmFtIHByb3ZpZGVyT3B0aW9ucyAtIEFkZGl0aW9uYWwgcHJvdmlkZXItc3BlY2lmaWMgb3B0aW9ucyB0aGF0IGFyZSBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXJcbmFzIGJvZHkgcGFyYW1ldGVycy5cbkBwYXJhbSBtYXhSZXRyaWVzIC0gTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcy4gU2V0IHRvIDAgdG8gZGlzYWJsZSByZXRyaWVzLiBEZWZhdWx0OiAyLlxuQHBhcmFtIGFib3J0U2lnbmFsIC0gQW4gb3B0aW9uYWwgYWJvcnQgc2lnbmFsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FuY2VsIHRoZSBjYWxsLlxuQHBhcmFtIGhlYWRlcnMgLSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBiZSBzZW50IHdpdGggdGhlIHJlcXVlc3QuIE9ubHkgYXBwbGljYWJsZSBmb3IgSFRUUC1iYXNlZCBwcm92aWRlcnMuXG5cbkByZXR1cm5zIEEgcmVzdWx0IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBnZW5lcmF0ZWQgaW1hZ2VzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVJbWFnZSh7XG4gIG1vZGVsLFxuICBwcm9tcHQsXG4gIG4gPSAxLFxuICBtYXhJbWFnZXNQZXJDYWxsLFxuICBzaXplLFxuICBhc3BlY3RSYXRpbyxcbiAgc2VlZCxcbiAgcHJvdmlkZXJPcHRpb25zLFxuICBtYXhSZXRyaWVzOiBtYXhSZXRyaWVzQXJnLFxuICBhYm9ydFNpZ25hbCxcbiAgaGVhZGVycyxcbn06IHtcbiAgLyoqXG5UaGUgaW1hZ2UgbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICBtb2RlbDogSW1hZ2VNb2RlbFYyO1xuXG4gIC8qKlxuVGhlIHByb21wdCB0aGF0IHNob3VsZCBiZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSBpbWFnZS5cbiAgICovXG4gIHByb21wdDogc3RyaW5nO1xuXG4gIC8qKlxuTnVtYmVyIG9mIGltYWdlcyB0byBnZW5lcmF0ZS5cbiAgICovXG4gIG4/OiBudW1iZXI7XG5cbiAgLyoqXG5OdW1iZXIgb2YgaW1hZ2VzIHRvIGdlbmVyYXRlLlxuICAgKi9cbiAgbWF4SW1hZ2VzUGVyQ2FsbD86IG51bWJlcjtcblxuICAvKipcblNpemUgb2YgdGhlIGltYWdlcyB0byBnZW5lcmF0ZS4gTXVzdCBoYXZlIHRoZSBmb3JtYXQgYHt3aWR0aH14e2hlaWdodH1gLiBJZiBub3QgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IHNpemUgd2lsbCBiZSB1c2VkLlxuICAgKi9cbiAgc2l6ZT86IGAke251bWJlcn14JHtudW1iZXJ9YDtcblxuICAvKipcbkFzcGVjdCByYXRpbyBvZiB0aGUgaW1hZ2VzIHRvIGdlbmVyYXRlLiBNdXN0IGhhdmUgdGhlIGZvcm1hdCBge3dpZHRofTp7aGVpZ2h0fWAuIElmIG5vdCBwcm92aWRlZCwgdGhlIGRlZmF1bHQgYXNwZWN0IHJhdGlvIHdpbGwgYmUgdXNlZC5cbiAgICovXG4gIGFzcGVjdFJhdGlvPzogYCR7bnVtYmVyfToke251bWJlcn1gO1xuXG4gIC8qKlxuU2VlZCBmb3IgdGhlIGltYWdlIGdlbmVyYXRpb24uIElmIG5vdCBwcm92aWRlZCwgdGhlIGRlZmF1bHQgc2VlZCB3aWxsIGJlIHVzZWQuXG4gICAqL1xuICBzZWVkPzogbnVtYmVyO1xuXG4gIC8qKlxuQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBvcHRpb25zIHRoYXQgYXJlIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlclxuYXMgYm9keSBwYXJhbWV0ZXJzLlxuXG5UaGUgb3V0ZXIgcmVjb3JkIGlzIGtleWVkIGJ5IHRoZSBwcm92aWRlciBuYW1lLCBhbmQgdGhlIGlubmVyXG5yZWNvcmQgaXMga2V5ZWQgYnkgdGhlIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhIGtleS5cbmBgYHRzXG57XG4gIFwib3BlbmFpXCI6IHtcbiAgICBcInN0eWxlXCI6IFwidml2aWRcIlxuICB9XG59XG5gYGBcbiAgICAgKi9cbiAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuXG4gIC8qKlxuTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcyBwZXIgZW1iZWRkaW5nIG1vZGVsIGNhbGwuIFNldCB0byAwIHRvIGRpc2FibGUgcmV0cmllcy5cblxuQGRlZmF1bHQgMlxuICAgKi9cbiAgbWF4UmV0cmllcz86IG51bWJlcjtcblxuICAvKipcbkFib3J0IHNpZ25hbC5cbiAqL1xuICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsO1xuXG4gIC8qKlxuQWRkaXRpb25hbCBoZWFkZXJzIHRvIGluY2x1ZGUgaW4gdGhlIHJlcXVlc3QuXG5Pbmx5IGFwcGxpY2FibGUgZm9yIEhUVFAtYmFzZWQgcHJvdmlkZXJzLlxuICovXG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufSk6IFByb21pc2U8R2VuZXJhdGVJbWFnZVJlc3VsdD4ge1xuICBpZiAobW9kZWwuc3BlY2lmaWNhdGlvblZlcnNpb24gIT09ICd2MicpIHtcbiAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRNb2RlbFZlcnNpb25FcnJvcih7XG4gICAgICB2ZXJzaW9uOiBtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbixcbiAgICAgIHByb3ZpZGVyOiBtb2RlbC5wcm92aWRlcixcbiAgICAgIG1vZGVsSWQ6IG1vZGVsLm1vZGVsSWQsXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCB7IHJldHJ5IH0gPSBwcmVwYXJlUmV0cmllcyh7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICBhYm9ydFNpZ25hbCxcbiAgfSk7XG5cbiAgLy8gZGVmYXVsdCB0byAxIGlmIHRoZSBtb2RlbCBoYXMgbm90IHNwZWNpZmllZCBsaW1pdHMgb25cbiAgLy8gaG93IG1hbnkgaW1hZ2VzIGNhbiBiZSBnZW5lcmF0ZWQgaW4gYSBzaW5nbGUgY2FsbFxuICBjb25zdCBtYXhJbWFnZXNQZXJDYWxsV2l0aERlZmF1bHQgPVxuICAgIG1heEltYWdlc1BlckNhbGwgPz8gKGF3YWl0IGludm9rZU1vZGVsTWF4SW1hZ2VzUGVyQ2FsbChtb2RlbCkpID8/IDE7XG5cbiAgLy8gcGFyYWxsZWxpemUgY2FsbHMgdG8gdGhlIG1vZGVsOlxuICBjb25zdCBjYWxsQ291bnQgPSBNYXRoLmNlaWwobiAvIG1heEltYWdlc1BlckNhbGxXaXRoRGVmYXVsdCk7XG4gIGNvbnN0IGNhbGxJbWFnZUNvdW50cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGNhbGxDb3VudCB9LCAoXywgaSkgPT4ge1xuICAgIGlmIChpIDwgY2FsbENvdW50IC0gMSkge1xuICAgICAgcmV0dXJuIG1heEltYWdlc1BlckNhbGxXaXRoRGVmYXVsdDtcbiAgICB9XG5cbiAgICBjb25zdCByZW1haW5kZXIgPSBuICUgbWF4SW1hZ2VzUGVyQ2FsbFdpdGhEZWZhdWx0O1xuICAgIHJldHVybiByZW1haW5kZXIgPT09IDAgPyBtYXhJbWFnZXNQZXJDYWxsV2l0aERlZmF1bHQgOiByZW1haW5kZXI7XG4gIH0pO1xuXG4gIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICBjYWxsSW1hZ2VDb3VudHMubWFwKGFzeW5jIGNhbGxJbWFnZUNvdW50ID0+XG4gICAgICByZXRyeSgoKSA9PlxuICAgICAgICBtb2RlbC5kb0dlbmVyYXRlKHtcbiAgICAgICAgICBwcm9tcHQsXG4gICAgICAgICAgbjogY2FsbEltYWdlQ291bnQsXG4gICAgICAgICAgYWJvcnRTaWduYWwsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICBzaXplLFxuICAgICAgICAgIGFzcGVjdFJhdGlvLFxuICAgICAgICAgIHNlZWQsXG4gICAgICAgICAgcHJvdmlkZXJPcHRpb25zOiBwcm92aWRlck9wdGlvbnMgPz8ge30sXG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApLFxuICApO1xuXG4gIC8vIGNvbGxlY3QgcmVzdWx0IGltYWdlcywgd2FybmluZ3MsIGFuZCByZXNwb25zZSBtZXRhZGF0YVxuICBjb25zdCBpbWFnZXM6IEFycmF5PERlZmF1bHRHZW5lcmF0ZWRGaWxlPiA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogQXJyYXk8SW1hZ2VHZW5lcmF0aW9uV2FybmluZz4gPSBbXTtcbiAgY29uc3QgcmVzcG9uc2VzOiBBcnJheTxJbWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YT4gPSBbXTtcbiAgY29uc3QgcHJvdmlkZXJNZXRhZGF0YTogSW1hZ2VNb2RlbFYyUHJvdmlkZXJNZXRhZGF0YSA9IHt9O1xuICBmb3IgKGNvbnN0IHJlc3VsdCBvZiByZXN1bHRzKSB7XG4gICAgaW1hZ2VzLnB1c2goXG4gICAgICAuLi5yZXN1bHQuaW1hZ2VzLm1hcChcbiAgICAgICAgaW1hZ2UgPT5cbiAgICAgICAgICBuZXcgRGVmYXVsdEdlbmVyYXRlZEZpbGUoe1xuICAgICAgICAgICAgZGF0YTogaW1hZ2UsXG4gICAgICAgICAgICBtZWRpYVR5cGU6XG4gICAgICAgICAgICAgIGRldGVjdE1lZGlhVHlwZSh7XG4gICAgICAgICAgICAgICAgZGF0YTogaW1hZ2UsXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlczogaW1hZ2VNZWRpYVR5cGVTaWduYXR1cmVzLFxuICAgICAgICAgICAgICB9KSA/PyAnaW1hZ2UvcG5nJyxcbiAgICAgICAgICB9KSxcbiAgICAgICksXG4gICAgKTtcbiAgICB3YXJuaW5ncy5wdXNoKC4uLnJlc3VsdC53YXJuaW5ncyk7XG5cbiAgICBpZiAocmVzdWx0LnByb3ZpZGVyTWV0YWRhdGEpIHtcbiAgICAgIGZvciAoY29uc3QgW3Byb3ZpZGVyTmFtZSwgbWV0YWRhdGFdIG9mIE9iamVjdC5lbnRyaWVzPHtcbiAgICAgICAgaW1hZ2VzOiB1bmtub3duO1xuICAgICAgfT4ocmVzdWx0LnByb3ZpZGVyTWV0YWRhdGEpKSB7XG4gICAgICAgIHByb3ZpZGVyTWV0YWRhdGFbcHJvdmlkZXJOYW1lXSA/Pz0geyBpbWFnZXM6IFtdIH07XG4gICAgICAgIHByb3ZpZGVyTWV0YWRhdGFbcHJvdmlkZXJOYW1lXS5pbWFnZXMucHVzaChcbiAgICAgICAgICAuLi5yZXN1bHQucHJvdmlkZXJNZXRhZGF0YVtwcm92aWRlck5hbWVdLmltYWdlcyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXNwb25zZXMucHVzaChyZXN1bHQucmVzcG9uc2UpO1xuICB9XG5cbiAgaWYgKCFpbWFnZXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IE5vSW1hZ2VHZW5lcmF0ZWRFcnJvcih7IHJlc3BvbnNlcyB9KTtcbiAgfVxuXG4gIHJldHVybiBuZXcgRGVmYXVsdEdlbmVyYXRlSW1hZ2VSZXN1bHQoe1xuICAgIGltYWdlcyxcbiAgICB3YXJuaW5ncyxcbiAgICByZXNwb25zZXMsXG4gICAgcHJvdmlkZXJNZXRhZGF0YSxcbiAgfSk7XG59XG5cbmNsYXNzIERlZmF1bHRHZW5lcmF0ZUltYWdlUmVzdWx0IGltcGxlbWVudHMgR2VuZXJhdGVJbWFnZVJlc3VsdCB7XG4gIHJlYWRvbmx5IGltYWdlczogQXJyYXk8R2VuZXJhdGVkRmlsZT47XG4gIHJlYWRvbmx5IHdhcm5pbmdzOiBBcnJheTxJbWFnZUdlbmVyYXRpb25XYXJuaW5nPjtcbiAgcmVhZG9ubHkgcmVzcG9uc2VzOiBBcnJheTxJbWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YT47XG4gIHJlYWRvbmx5IHByb3ZpZGVyTWV0YWRhdGE6IEltYWdlTW9kZWxWMlByb3ZpZGVyTWV0YWRhdGE7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczoge1xuICAgIGltYWdlczogQXJyYXk8R2VuZXJhdGVkRmlsZT47XG4gICAgd2FybmluZ3M6IEFycmF5PEltYWdlR2VuZXJhdGlvbldhcm5pbmc+O1xuICAgIHJlc3BvbnNlczogQXJyYXk8SW1hZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGE+O1xuICAgIHByb3ZpZGVyTWV0YWRhdGE6IEltYWdlTW9kZWxWMlByb3ZpZGVyTWV0YWRhdGE7XG4gIH0pIHtcbiAgICB0aGlzLmltYWdlcyA9IG9wdGlvbnMuaW1hZ2VzO1xuICAgIHRoaXMud2FybmluZ3MgPSBvcHRpb25zLndhcm5pbmdzO1xuICAgIHRoaXMucmVzcG9uc2VzID0gb3B0aW9ucy5yZXNwb25zZXM7XG4gICAgdGhpcy5wcm92aWRlck1ldGFkYXRhID0gb3B0aW9ucy5wcm92aWRlck1ldGFkYXRhO1xuICB9XG5cbiAgZ2V0IGltYWdlKCkge1xuICAgIHJldHVybiB0aGlzLmltYWdlc1swXTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBpbnZva2VNb2RlbE1heEltYWdlc1BlckNhbGwobW9kZWw6IEltYWdlTW9kZWxWMikge1xuICBjb25zdCBpc0Z1bmN0aW9uID0gbW9kZWwubWF4SW1hZ2VzUGVyQ2FsbCBpbnN0YW5jZW9mIEZ1bmN0aW9uO1xuXG4gIGlmICghaXNGdW5jdGlvbikge1xuICAgIHJldHVybiBtb2RlbC5tYXhJbWFnZXNQZXJDYWxsO1xuICB9XG5cbiAgcmV0dXJuIG1vZGVsLm1heEltYWdlc1BlckNhbGwoe1xuICAgIG1vZGVsSWQ6IG1vZGVsLm1vZGVsSWQsXG4gIH0pO1xufVxuIiwgImltcG9ydCB7IEpTT05WYWx1ZSB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlSWRHZW5lcmF0b3IsXG4gIEluZmVyU2NoZW1hLFxuICBQcm92aWRlck9wdGlvbnMsXG4gIFNjaGVtYSxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yJztcbmltcG9ydCB7IGV4dHJhY3RDb250ZW50VGV4dCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvZXh0cmFjdC1jb250ZW50LXRleHQnO1xuaW1wb3J0IHsgcmVzb2x2ZUxhbmd1YWdlTW9kZWwgfSBmcm9tICcuLi9tb2RlbC9yZXNvbHZlLW1vZGVsJztcbmltcG9ydCB7IENhbGxTZXR0aW5ncyB9IGZyb20gJy4uL3Byb21wdC9jYWxsLXNldHRpbmdzJztcbmltcG9ydCB7IGNvbnZlcnRUb0xhbmd1YWdlTW9kZWxQcm9tcHQgfSBmcm9tICcuLi9wcm9tcHQvY29udmVydC10by1sYW5ndWFnZS1tb2RlbC1wcm9tcHQnO1xuaW1wb3J0IHsgcHJlcGFyZUNhbGxTZXR0aW5ncyB9IGZyb20gJy4uL3Byb21wdC9wcmVwYXJlLWNhbGwtc2V0dGluZ3MnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0L3Byb21wdCc7XG5pbXBvcnQgeyBzdGFuZGFyZGl6ZVByb21wdCB9IGZyb20gJy4uL3Byb21wdC9zdGFuZGFyZGl6ZS1wcm9tcHQnO1xuaW1wb3J0IHsgd3JhcEdhdGV3YXlFcnJvciB9IGZyb20gJy4uL3Byb21wdC93cmFwLWdhdGV3YXktZXJyb3InO1xuaW1wb3J0IHsgYXNzZW1ibGVPcGVyYXRpb25OYW1lIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2Fzc2VtYmxlLW9wZXJhdGlvbi1uYW1lJztcbmltcG9ydCB7IGdldEJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2dldC1iYXNlLXRlbGVtZXRyeS1hdHRyaWJ1dGVzJztcbmltcG9ydCB7IGdldFRyYWNlciB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtdHJhY2VyJztcbmltcG9ydCB7IHJlY29yZFNwYW4gfSBmcm9tICcuLi90ZWxlbWV0cnkvcmVjb3JkLXNwYW4nO1xuaW1wb3J0IHsgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9zZWxlY3QtdGVsZW1ldHJ5LWF0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5IH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3N0cmluZ2lmeS1mb3ItdGVsZW1ldHJ5JztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3RlbGVtZXRyeS1zZXR0aW5ncyc7XG5pbXBvcnQge1xuICBDYWxsV2FybmluZyxcbiAgRmluaXNoUmVhc29uLFxuICBMYW5ndWFnZU1vZGVsLFxufSBmcm9tICcuLi90eXBlcy9sYW5ndWFnZS1tb2RlbCc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVxdWVzdE1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwtcmVxdWVzdC1tZXRhZGF0YSc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsLXJlc3BvbnNlLW1ldGFkYXRhJztcbmltcG9ydCB7IFByb3ZpZGVyTWV0YWRhdGEgfSBmcm9tICcuLi90eXBlcy9wcm92aWRlci1tZXRhZGF0YSc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsVXNhZ2UgfSBmcm9tICcuLi90eXBlcy91c2FnZSc7XG5pbXBvcnQgeyBwcmVwYXJlSGVhZGVycyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1oZWFkZXJzJztcbmltcG9ydCB7IHByZXBhcmVSZXRyaWVzIH0gZnJvbSAnLi4vdXRpbC9wcmVwYXJlLXJldHJpZXMnO1xuaW1wb3J0IHsgR2VuZXJhdGVPYmplY3RSZXN1bHQgfSBmcm9tICcuL2dlbmVyYXRlLW9iamVjdC1yZXN1bHQnO1xuaW1wb3J0IHsgZ2V0T3V0cHV0U3RyYXRlZ3kgfSBmcm9tICcuL291dHB1dC1zdHJhdGVneSc7XG5pbXBvcnQgeyBwYXJzZUFuZFZhbGlkYXRlT2JqZWN0UmVzdWx0V2l0aFJlcGFpciB9IGZyb20gJy4vcGFyc2UtYW5kLXZhbGlkYXRlLW9iamVjdC1yZXN1bHQnO1xuaW1wb3J0IHsgUmVwYWlyVGV4dEZ1bmN0aW9uIH0gZnJvbSAnLi9yZXBhaXItdGV4dCc7XG5pbXBvcnQgeyB2YWxpZGF0ZU9iamVjdEdlbmVyYXRpb25JbnB1dCB9IGZyb20gJy4vdmFsaWRhdGUtb2JqZWN0LWdlbmVyYXRpb24taW5wdXQnO1xuXG5jb25zdCBvcmlnaW5hbEdlbmVyYXRlSWQgPSBjcmVhdGVJZEdlbmVyYXRvcih7IHByZWZpeDogJ2Fpb2JqJywgc2l6ZTogMjQgfSk7XG5cbi8qKlxuR2VuZXJhdGUgYSBzdHJ1Y3R1cmVkLCB0eXBlZCBvYmplY3QgZm9yIGEgZ2l2ZW4gcHJvbXB0IGFuZCBzY2hlbWEgdXNpbmcgYSBsYW5ndWFnZSBtb2RlbC5cblxuVGhpcyBmdW5jdGlvbiBkb2VzIG5vdCBzdHJlYW0gdGhlIG91dHB1dC4gSWYgeW91IHdhbnQgdG8gc3RyZWFtIHRoZSBvdXRwdXQsIHVzZSBgc3RyZWFtT2JqZWN0YCBpbnN0ZWFkLlxuXG5AcGFyYW0gbW9kZWwgLSBUaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlLlxuQHBhcmFtIHRvb2xzIC0gVG9vbHMgdGhhdCBhcmUgYWNjZXNzaWJsZSB0byBhbmQgY2FuIGJlIGNhbGxlZCBieSB0aGUgbW9kZWwuIFRoZSBtb2RlbCBuZWVkcyB0byBzdXBwb3J0IGNhbGxpbmcgdG9vbHMuXG5cbkBwYXJhbSBzeXN0ZW0gLSBBIHN5c3RlbSBtZXNzYWdlIHRoYXQgd2lsbCBiZSBwYXJ0IG9mIHRoZSBwcm9tcHQuXG5AcGFyYW0gcHJvbXB0IC0gQSBzaW1wbGUgdGV4dCBwcm9tcHQuIFlvdSBjYW4gZWl0aGVyIHVzZSBgcHJvbXB0YCBvciBgbWVzc2FnZXNgIGJ1dCBub3QgYm90aC5cbkBwYXJhbSBtZXNzYWdlcyAtIEEgbGlzdCBvZiBtZXNzYWdlcy4gWW91IGNhbiBlaXRoZXIgdXNlIGBwcm9tcHRgIG9yIGBtZXNzYWdlc2AgYnV0IG5vdCBib3RoLlxuXG5AcGFyYW0gbWF4T3V0cHV0VG9rZW5zIC0gTWF4aW11bSBudW1iZXIgb2YgdG9rZW5zIHRvIGdlbmVyYXRlLlxuQHBhcmFtIHRlbXBlcmF0dXJlIC0gVGVtcGVyYXR1cmUgc2V0dGluZy5cblRoZSB2YWx1ZSBpcyBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXIuIFRoZSByYW5nZSBkZXBlbmRzIG9uIHRoZSBwcm92aWRlciBhbmQgbW9kZWwuXG5JdCBpcyByZWNvbW1lbmRlZCB0byBzZXQgZWl0aGVyIGB0ZW1wZXJhdHVyZWAgb3IgYHRvcFBgLCBidXQgbm90IGJvdGguXG5AcGFyYW0gdG9wUCAtIE51Y2xldXMgc2FtcGxpbmcuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuSXQgaXMgcmVjb21tZW5kZWQgdG8gc2V0IGVpdGhlciBgdGVtcGVyYXR1cmVgIG9yIGB0b3BQYCwgYnV0IG5vdCBib3RoLlxuQHBhcmFtIHRvcEsgLSBPbmx5IHNhbXBsZSBmcm9tIHRoZSB0b3AgSyBvcHRpb25zIGZvciBlYWNoIHN1YnNlcXVlbnQgdG9rZW4uXG5Vc2VkIHRvIHJlbW92ZSBcImxvbmcgdGFpbFwiIGxvdyBwcm9iYWJpbGl0eSByZXNwb25zZXMuXG5SZWNvbW1lbmRlZCBmb3IgYWR2YW5jZWQgdXNlIGNhc2VzIG9ubHkuIFlvdSB1c3VhbGx5IG9ubHkgbmVlZCB0byB1c2UgdGVtcGVyYXR1cmUuXG5AcGFyYW0gcHJlc2VuY2VQZW5hbHR5IC0gUHJlc2VuY2UgcGVuYWx0eSBzZXR0aW5nLlxuSXQgYWZmZWN0cyB0aGUgbGlrZWxpaG9vZCBvZiB0aGUgbW9kZWwgdG8gcmVwZWF0IGluZm9ybWF0aW9uIHRoYXQgaXMgYWxyZWFkeSBpbiB0aGUgcHJvbXB0LlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkBwYXJhbSBmcmVxdWVuY3lQZW5hbHR5IC0gRnJlcXVlbmN5IHBlbmFsdHkgc2V0dGluZy5cbkl0IGFmZmVjdHMgdGhlIGxpa2VsaWhvb2Qgb2YgdGhlIG1vZGVsIHRvIHJlcGVhdGVkbHkgdXNlIHRoZSBzYW1lIHdvcmRzIG9yIHBocmFzZXMuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuQHBhcmFtIHN0b3BTZXF1ZW5jZXMgLSBTdG9wIHNlcXVlbmNlcy5cbklmIHNldCwgdGhlIG1vZGVsIHdpbGwgc3RvcCBnZW5lcmF0aW5nIHRleHQgd2hlbiBvbmUgb2YgdGhlIHN0b3Agc2VxdWVuY2VzIGlzIGdlbmVyYXRlZC5cbkBwYXJhbSBzZWVkIC0gVGhlIHNlZWQgKGludGVnZXIpIHRvIHVzZSBmb3IgcmFuZG9tIHNhbXBsaW5nLlxuSWYgc2V0IGFuZCBzdXBwb3J0ZWQgYnkgdGhlIG1vZGVsLCBjYWxscyB3aWxsIGdlbmVyYXRlIGRldGVybWluaXN0aWMgcmVzdWx0cy5cblxuQHBhcmFtIG1heFJldHJpZXMgLSBNYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJldHJpZXMuIERlZmF1bHQ6IDIuXG5AcGFyYW0gYWJvcnRTaWduYWwgLSBBbiBvcHRpb25hbCBhYm9ydCBzaWduYWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIGNhbGwuXG5AcGFyYW0gaGVhZGVycyAtIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIGJlIHNlbnQgd2l0aCB0aGUgcmVxdWVzdC4gT25seSBhcHBsaWNhYmxlIGZvciBIVFRQLWJhc2VkIHByb3ZpZGVycy5cblxuQHBhcmFtIHNjaGVtYSAtIFRoZSBzY2hlbWEgb2YgdGhlIG9iamVjdCB0aGF0IHRoZSBtb2RlbCBzaG91bGQgZ2VuZXJhdGUuXG5AcGFyYW0gc2NoZW1hTmFtZSAtIE9wdGlvbmFsIG5hbWUgb2YgdGhlIG91dHB1dCB0aGF0IHNob3VsZCBiZSBnZW5lcmF0ZWQuXG5Vc2VkIGJ5IHNvbWUgcHJvdmlkZXJzIGZvciBhZGRpdGlvbmFsIExMTSBndWlkYW5jZSwgZS5nLlxudmlhIHRvb2wgb3Igc2NoZW1hIG5hbWUuXG5AcGFyYW0gc2NoZW1hRGVzY3JpcHRpb24gLSBPcHRpb25hbCBkZXNjcmlwdGlvbiBvZiB0aGUgb3V0cHV0IHRoYXQgc2hvdWxkIGJlIGdlbmVyYXRlZC5cblVzZWQgYnkgc29tZSBwcm92aWRlcnMgZm9yIGFkZGl0aW9uYWwgTExNIGd1aWRhbmNlLCBlLmcuXG52aWEgdG9vbCBvciBzY2hlbWEgZGVzY3JpcHRpb24uXG5cbkBwYXJhbSBvdXRwdXQgLSBUaGUgdHlwZSBvZiB0aGUgb3V0cHV0LlxuXG4tICdvYmplY3QnOiBUaGUgb3V0cHV0IGlzIGFuIG9iamVjdC5cbi0gJ2FycmF5JzogVGhlIG91dHB1dCBpcyBhbiBhcnJheS5cbi0gJ2VudW0nOiBUaGUgb3V0cHV0IGlzIGFuIGVudW0uXG4tICduby1zY2hlbWEnOiBUaGUgb3V0cHV0IGlzIG5vdCBhIHNjaGVtYS5cblxuQHBhcmFtIGV4cGVyaW1lbnRhbF9yZXBhaXJUZXh0IC0gQSBmdW5jdGlvbiB0aGF0IGF0dGVtcHRzIHRvIHJlcGFpciB0aGUgcmF3IG91dHB1dCBvZiB0aGUgbW9kZWxcbnRvIGVuYWJsZSBKU09OIHBhcnNpbmcuXG5cbkBwYXJhbSBleHBlcmltZW50YWxfdGVsZW1ldHJ5IC0gT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG5cbkBwYXJhbSBwcm92aWRlck9wdGlvbnMgLSBBZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG50byB0aGUgcHJvdmlkZXIgZnJvbSB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbmZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cblxuQHJldHVybnNcbkEgcmVzdWx0IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBnZW5lcmF0ZWQgb2JqZWN0LCB0aGUgZmluaXNoIHJlYXNvbiwgdGhlIHRva2VuIHVzYWdlLCBhbmQgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlT2JqZWN0PFxuICBTQ0hFTUEgZXh0ZW5kc1xuICAgIHwgejMuU2NoZW1hXG4gICAgfCB6NC5jb3JlLiRab2RUeXBlXG4gICAgfCBTY2hlbWEgPSB6NC5jb3JlLiRab2RUeXBlPEpTT05WYWx1ZT4sXG4gIE9VVFBVVCBleHRlbmRzXG4gICAgfCAnb2JqZWN0J1xuICAgIHwgJ2FycmF5J1xuICAgIHwgJ2VudW0nXG4gICAgfCAnbm8tc2NoZW1hJyA9IEluZmVyU2NoZW1hPFNDSEVNQT4gZXh0ZW5kcyBzdHJpbmcgPyAnZW51bScgOiAnb2JqZWN0JyxcbiAgUkVTVUxUID0gT1VUUFVUIGV4dGVuZHMgJ2FycmF5J1xuICAgID8gQXJyYXk8SW5mZXJTY2hlbWE8U0NIRU1BPj5cbiAgICA6IEluZmVyU2NoZW1hPFNDSEVNQT4sXG4+KFxuICBvcHRpb25zOiBPbWl0PENhbGxTZXR0aW5ncywgJ3N0b3BTZXF1ZW5jZXMnPiAmXG4gICAgUHJvbXB0ICZcbiAgICAoT1VUUFVUIGV4dGVuZHMgJ2VudW0nXG4gICAgICA/IHtcbiAgICAgICAgICAvKipcblRoZSBlbnVtIHZhbHVlcyB0aGF0IHRoZSBtb2RlbCBzaG91bGQgdXNlLlxuICAgICAgICAqL1xuICAgICAgICAgIGVudW06IEFycmF5PFJFU1VMVD47XG4gICAgICAgICAgbW9kZT86ICdqc29uJztcbiAgICAgICAgICBvdXRwdXQ6ICdlbnVtJztcbiAgICAgICAgfVxuICAgICAgOiBPVVRQVVQgZXh0ZW5kcyAnbm8tc2NoZW1hJ1xuICAgICAgICA/IHt9XG4gICAgICAgIDoge1xuICAgICAgICAgICAgLyoqXG5UaGUgc2NoZW1hIG9mIHRoZSBvYmplY3QgdGhhdCB0aGUgbW9kZWwgc2hvdWxkIGdlbmVyYXRlLlxuICAgICAgICAqL1xuICAgICAgICAgICAgc2NoZW1hOiBTQ0hFTUE7XG5cbiAgICAgICAgICAgIC8qKlxuT3B0aW9uYWwgbmFtZSBvZiB0aGUgb3V0cHV0IHRoYXQgc2hvdWxkIGJlIGdlbmVyYXRlZC5cblVzZWQgYnkgc29tZSBwcm92aWRlcnMgZm9yIGFkZGl0aW9uYWwgTExNIGd1aWRhbmNlLCBlLmcuXG52aWEgdG9vbCBvciBzY2hlbWEgbmFtZS5cbiAgICAgICAgKi9cbiAgICAgICAgICAgIHNjaGVtYU5hbWU/OiBzdHJpbmc7XG5cbiAgICAgICAgICAgIC8qKlxuT3B0aW9uYWwgZGVzY3JpcHRpb24gb2YgdGhlIG91dHB1dCB0aGF0IHNob3VsZCBiZSBnZW5lcmF0ZWQuXG5Vc2VkIGJ5IHNvbWUgcHJvdmlkZXJzIGZvciBhZGRpdGlvbmFsIExMTSBndWlkYW5jZSwgZS5nLlxudmlhIHRvb2wgb3Igc2NoZW1hIGRlc2NyaXB0aW9uLlxuICAgICAgICAqL1xuICAgICAgICAgICAgc2NoZW1hRGVzY3JpcHRpb24/OiBzdHJpbmc7XG5cbiAgICAgICAgICAgIC8qKlxuVGhlIG1vZGUgdG8gdXNlIGZvciBvYmplY3QgZ2VuZXJhdGlvbi5cblxuVGhlIHNjaGVtYSBpcyBjb252ZXJ0ZWQgaW50byBhIEpTT04gc2NoZW1hIGFuZCB1c2VkIGluIG9uZSBvZiB0aGUgZm9sbG93aW5nIHdheXNcblxuLSAnYXV0byc6IFRoZSBwcm92aWRlciB3aWxsIGNob29zZSB0aGUgYmVzdCBtb2RlIGZvciB0aGUgbW9kZWwuXG4tICd0b29sJzogQSB0b29sIHdpdGggdGhlIEpTT04gc2NoZW1hIGFzIHBhcmFtZXRlcnMgaXMgcHJvdmlkZWQgYW5kIHRoZSBwcm92aWRlciBpcyBpbnN0cnVjdGVkIHRvIHVzZSBpdC5cbi0gJ2pzb24nOiBUaGUgSlNPTiBzY2hlbWEgYW5kIGFuIGluc3RydWN0aW9uIGFyZSBpbmplY3RlZCBpbnRvIHRoZSBwcm9tcHQuIElmIHRoZSBwcm92aWRlciBzdXBwb3J0cyBKU09OIG1vZGUsIGl0IGlzIGVuYWJsZWQuIElmIHRoZSBwcm92aWRlciBzdXBwb3J0cyBKU09OIGdyYW1tYXJzLCB0aGUgZ3JhbW1hciBpcyB1c2VkLlxuXG5QbGVhc2Ugbm90ZSB0aGF0IG1vc3QgcHJvdmlkZXJzIGRvIG5vdCBzdXBwb3J0IGFsbCBtb2Rlcy5cblxuRGVmYXVsdCBhbmQgcmVjb21tZW5kZWQ6ICdhdXRvJyAoYmVzdCBtb2RlIGZvciB0aGUgbW9kZWwpLlxuICAgICAgICAqL1xuICAgICAgICAgICAgbW9kZT86ICdhdXRvJyB8ICdqc29uJyB8ICd0b29sJztcbiAgICAgICAgICB9KSAmIHtcbiAgICAgIG91dHB1dD86IE9VVFBVVDtcblxuICAgICAgLyoqXG4gIFRoZSBsYW5ndWFnZSBtb2RlbCB0byB1c2UuXG4gICAgICAgKi9cbiAgICAgIG1vZGVsOiBMYW5ndWFnZU1vZGVsO1xuICAgICAgLyoqXG4gIEEgZnVuY3Rpb24gdGhhdCBhdHRlbXB0cyB0byByZXBhaXIgdGhlIHJhdyBvdXRwdXQgb2YgdGhlIG1vZGVsXG4gIHRvIGVuYWJsZSBKU09OIHBhcnNpbmcuXG4gICAgICAgKi9cbiAgICAgIGV4cGVyaW1lbnRhbF9yZXBhaXJUZXh0PzogUmVwYWlyVGV4dEZ1bmN0aW9uO1xuXG4gICAgICAvKipcbiAgT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG4gICAgICAgICAqL1xuXG4gICAgICBleHBlcmltZW50YWxfdGVsZW1ldHJ5PzogVGVsZW1ldHJ5U2V0dGluZ3M7XG5cbiAgICAgIC8qKlxuICBBZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG4gIHRvIHRoZSBwcm92aWRlciBmcm9tIHRoZSBBSSBTREsgYW5kIGVuYWJsZSBwcm92aWRlci1zcGVjaWZpY1xuICBmdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4gICAqL1xuICAgICAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuXG4gICAgICAvKipcbiAgICAgICAqIEludGVybmFsLiBGb3IgdGVzdCB1c2Ugb25seS4gTWF5IGNoYW5nZSB3aXRob3V0IG5vdGljZS5cbiAgICAgICAqL1xuICAgICAgX2ludGVybmFsPzoge1xuICAgICAgICBnZW5lcmF0ZUlkPzogKCkgPT4gc3RyaW5nO1xuICAgICAgICBjdXJyZW50RGF0ZT86ICgpID0+IERhdGU7XG4gICAgICB9O1xuICAgIH0sXG4pOiBQcm9taXNlPEdlbmVyYXRlT2JqZWN0UmVzdWx0PFJFU1VMVD4+IHtcbiAgY29uc3Qge1xuICAgIG1vZGVsOiBtb2RlbEFyZyxcbiAgICBvdXRwdXQgPSAnb2JqZWN0JyxcbiAgICBzeXN0ZW0sXG4gICAgcHJvbXB0LFxuICAgIG1lc3NhZ2VzLFxuICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgaGVhZGVycyxcbiAgICBleHBlcmltZW50YWxfcmVwYWlyVGV4dDogcmVwYWlyVGV4dCxcbiAgICBleHBlcmltZW50YWxfdGVsZW1ldHJ5OiB0ZWxlbWV0cnksXG4gICAgcHJvdmlkZXJPcHRpb25zLFxuICAgIF9pbnRlcm5hbDoge1xuICAgICAgZ2VuZXJhdGVJZCA9IG9yaWdpbmFsR2VuZXJhdGVJZCxcbiAgICAgIGN1cnJlbnREYXRlID0gKCkgPT4gbmV3IERhdGUoKSxcbiAgICB9ID0ge30sXG4gICAgLi4uc2V0dGluZ3NcbiAgfSA9IG9wdGlvbnM7XG5cbiAgY29uc3QgbW9kZWwgPSByZXNvbHZlTGFuZ3VhZ2VNb2RlbChtb2RlbEFyZyk7XG5cbiAgY29uc3QgZW51bVZhbHVlcyA9ICdlbnVtJyBpbiBvcHRpb25zID8gb3B0aW9ucy5lbnVtIDogdW5kZWZpbmVkO1xuICBjb25zdCB7XG4gICAgc2NoZW1hOiBpbnB1dFNjaGVtYSxcbiAgICBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICBzY2hlbWFOYW1lLFxuICB9ID0gJ3NjaGVtYScgaW4gb3B0aW9ucyA/IG9wdGlvbnMgOiB7fTtcblxuICB2YWxpZGF0ZU9iamVjdEdlbmVyYXRpb25JbnB1dCh7XG4gICAgb3V0cHV0LFxuICAgIHNjaGVtYTogaW5wdXRTY2hlbWEsXG4gICAgc2NoZW1hTmFtZSxcbiAgICBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICBlbnVtVmFsdWVzLFxuICB9KTtcblxuICBjb25zdCB7IG1heFJldHJpZXMsIHJldHJ5IH0gPSBwcmVwYXJlUmV0cmllcyh7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICBhYm9ydFNpZ25hbCxcbiAgfSk7XG5cbiAgY29uc3Qgb3V0cHV0U3RyYXRlZ3kgPSBnZXRPdXRwdXRTdHJhdGVneSh7XG4gICAgb3V0cHV0LFxuICAgIHNjaGVtYTogaW5wdXRTY2hlbWEsXG4gICAgZW51bVZhbHVlcyxcbiAgfSk7XG5cbiAgY29uc3QgY2FsbFNldHRpbmdzID0gcHJlcGFyZUNhbGxTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgY29uc3QgYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMgPSBnZXRCYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgbW9kZWwsXG4gICAgdGVsZW1ldHJ5LFxuICAgIGhlYWRlcnMsXG4gICAgc2V0dGluZ3M6IHsgLi4uY2FsbFNldHRpbmdzLCBtYXhSZXRyaWVzIH0sXG4gIH0pO1xuXG4gIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcih0ZWxlbWV0cnkpO1xuXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IHJlY29yZFNwYW4oe1xuICAgICAgbmFtZTogJ2FpLmdlbmVyYXRlT2JqZWN0JyxcbiAgICAgIGF0dHJpYnV0ZXM6IHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAuLi5hc3NlbWJsZU9wZXJhdGlvbk5hbWUoe1xuICAgICAgICAgICAgb3BlcmF0aW9uSWQ6ICdhaS5nZW5lcmF0ZU9iamVjdCcsXG4gICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgfSksXG4gICAgICAgICAgLi4uYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMsXG4gICAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAgICdhaS5wcm9tcHQnOiB7XG4gICAgICAgICAgICBpbnB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkoeyBzeXN0ZW0sIHByb21wdCwgbWVzc2FnZXMgfSksXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnYWkuc2NoZW1hJzpcbiAgICAgICAgICAgIG91dHB1dFN0cmF0ZWd5Lmpzb25TY2hlbWEgIT0gbnVsbFxuICAgICAgICAgICAgICA/IHsgaW5wdXQ6ICgpID0+IEpTT04uc3RyaW5naWZ5KG91dHB1dFN0cmF0ZWd5Lmpzb25TY2hlbWEpIH1cbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgJ2FpLnNjaGVtYS5uYW1lJzogc2NoZW1hTmFtZSxcbiAgICAgICAgICAnYWkuc2NoZW1hLmRlc2NyaXB0aW9uJzogc2NoZW1hRGVzY3JpcHRpb24sXG4gICAgICAgICAgJ2FpLnNldHRpbmdzLm91dHB1dCc6IG91dHB1dFN0cmF0ZWd5LnR5cGUsXG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICAgIHRyYWNlcixcbiAgICAgIGZuOiBhc3luYyBzcGFuID0+IHtcbiAgICAgICAgbGV0IHJlc3VsdDogc3RyaW5nO1xuICAgICAgICBsZXQgZmluaXNoUmVhc29uOiBGaW5pc2hSZWFzb247XG4gICAgICAgIGxldCB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlO1xuICAgICAgICBsZXQgd2FybmluZ3M6IENhbGxXYXJuaW5nW10gfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCByZXNwb25zZTogTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGE7XG4gICAgICAgIGxldCByZXF1ZXN0OiBMYW5ndWFnZU1vZGVsUmVxdWVzdE1ldGFkYXRhO1xuICAgICAgICBsZXQgcmVzdWx0UHJvdmlkZXJNZXRhZGF0YTogUHJvdmlkZXJNZXRhZGF0YSB8IHVuZGVmaW5lZDtcblxuICAgICAgICBjb25zdCBzdGFuZGFyZGl6ZWRQcm9tcHQgPSBhd2FpdCBzdGFuZGFyZGl6ZVByb21wdCh7XG4gICAgICAgICAgc3lzdGVtLFxuICAgICAgICAgIHByb21wdCxcbiAgICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcHJvbXB0TWVzc2FnZXMgPSBhd2FpdCBjb252ZXJ0VG9MYW5ndWFnZU1vZGVsUHJvbXB0KHtcbiAgICAgICAgICBwcm9tcHQ6IHN0YW5kYXJkaXplZFByb21wdCxcbiAgICAgICAgICBzdXBwb3J0ZWRVcmxzOiBhd2FpdCBtb2RlbC5zdXBwb3J0ZWRVcmxzLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBnZW5lcmF0ZVJlc3VsdCA9IGF3YWl0IHJldHJ5KCgpID0+XG4gICAgICAgICAgcmVjb3JkU3Bhbih7XG4gICAgICAgICAgICBuYW1lOiAnYWkuZ2VuZXJhdGVPYmplY3QuZG9HZW5lcmF0ZScsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbklkOiAnYWkuZ2VuZXJhdGVPYmplY3QuZG9HZW5lcmF0ZScsXG4gICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgLi4uYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgJ2FpLnByb21wdC5tZXNzYWdlcyc6IHtcbiAgICAgICAgICAgICAgICAgIGlucHV0OiAoKSA9PiBzdHJpbmdpZnlGb3JUZWxlbWV0cnkocHJvbXB0TWVzc2FnZXMpLFxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAvLyBzdGFuZGFyZGl6ZWQgZ2VuLWFpIGxsbSBzcGFuIGF0dHJpYnV0ZXM6XG4gICAgICAgICAgICAgICAgJ2dlbl9haS5zeXN0ZW0nOiBtb2RlbC5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubW9kZWwnOiBtb2RlbC5tb2RlbElkLFxuICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC5mcmVxdWVuY3lfcGVuYWx0eSc6XG4gICAgICAgICAgICAgICAgICBjYWxsU2V0dGluZ3MuZnJlcXVlbmN5UGVuYWx0eSxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubWF4X3Rva2Vucyc6IGNhbGxTZXR0aW5ncy5tYXhPdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0LnByZXNlbmNlX3BlbmFsdHknOiBjYWxsU2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5LFxuICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC50ZW1wZXJhdHVyZSc6IGNhbGxTZXR0aW5ncy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX2snOiBjYWxsU2V0dGluZ3MudG9wSyxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX3AnOiBjYWxsU2V0dGluZ3MudG9wUCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdHJhY2VyLFxuICAgICAgICAgICAgZm46IGFzeW5jIHNwYW4gPT4ge1xuICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2RlbC5kb0dlbmVyYXRlKHtcbiAgICAgICAgICAgICAgICByZXNwb25zZUZvcm1hdDoge1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgICAgc2NoZW1hOiBvdXRwdXRTdHJhdGVneS5qc29uU2NoZW1hLFxuICAgICAgICAgICAgICAgICAgbmFtZTogc2NoZW1hTmFtZSxcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC4uLnByZXBhcmVDYWxsU2V0dGluZ3Moc2V0dGluZ3MpLFxuICAgICAgICAgICAgICAgIHByb21wdDogcHJvbXB0TWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBpZDogcmVzdWx0LnJlc3BvbnNlPy5pZCA/PyBnZW5lcmF0ZUlkKCksXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiByZXN1bHQucmVzcG9uc2U/LnRpbWVzdGFtcCA/PyBjdXJyZW50RGF0ZSgpLFxuICAgICAgICAgICAgICAgIG1vZGVsSWQ6IHJlc3VsdC5yZXNwb25zZT8ubW9kZWxJZCA/PyBtb2RlbC5tb2RlbElkLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlc3VsdC5yZXNwb25zZT8uaGVhZGVycyxcbiAgICAgICAgICAgICAgICBib2R5OiByZXN1bHQucmVzcG9uc2U/LmJvZHksXG4gICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGV4dHJhY3RDb250ZW50VGV4dChyZXN1bHQuY29udGVudCk7XG5cbiAgICAgICAgICAgICAgaWYgKHRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb09iamVjdEdlbmVyYXRlZEVycm9yKHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICAgICdObyBvYmplY3QgZ2VuZXJhdGVkOiB0aGUgbW9kZWwgZGlkIG5vdCByZXR1cm4gYSByZXNwb25zZS4nLFxuICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlRGF0YSxcbiAgICAgICAgICAgICAgICAgIHVzYWdlOiByZXN1bHQudXNhZ2UsXG4gICAgICAgICAgICAgICAgICBmaW5pc2hSZWFzb246IHJlc3VsdC5maW5pc2hSZWFzb24sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBBZGQgcmVzcG9uc2UgaW5mb3JtYXRpb24gdG8gdGhlIHNwYW46XG4gICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyhcbiAgICAgICAgICAgICAgICBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLmZpbmlzaFJlYXNvbic6IHJlc3VsdC5maW5pc2hSZWFzb24sXG4gICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5vYmplY3QnOiB7IG91dHB1dDogKCkgPT4gdGV4dCB9LFxuICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuaWQnOiByZXNwb25zZURhdGEuaWQsXG4gICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5tb2RlbCc6IHJlc3BvbnNlRGF0YS5tb2RlbElkLFxuICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudGltZXN0YW1wJzpcbiAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZURhdGEudGltZXN0YW1wLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5wcm92aWRlck1ldGFkYXRhJzogSlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyByZW5hbWUgdGVsZW1ldHJ5IGF0dHJpYnV0ZXMgdG8gaW5wdXRUb2tlbnMgYW5kIG91dHB1dFRva2Vuc1xuICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UucHJvbXB0VG9rZW5zJzogcmVzdWx0LnVzYWdlLmlucHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuY29tcGxldGlvblRva2Vucyc6IHJlc3VsdC51c2FnZS5vdXRwdXRUb2tlbnMsXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc3RhbmRhcmRpemVkIGdlbi1haSBsbG0gc3BhbiBhdHRyaWJ1dGVzOlxuICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLmZpbmlzaF9yZWFzb25zJzogW3Jlc3VsdC5maW5pc2hSZWFzb25dLFxuICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLmlkJzogcmVzcG9uc2VEYXRhLmlkLFxuICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLm1vZGVsJzogcmVzcG9uc2VEYXRhLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAgICdnZW5fYWkudXNhZ2UuaW5wdXRfdG9rZW5zJzogcmVzdWx0LnVzYWdlLmlucHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnVzYWdlLm91dHB1dF90b2tlbnMnOiByZXN1bHQudXNhZ2Uub3V0cHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICByZXR1cm4geyAuLi5yZXN1bHQsIG9iamVjdFRleHQ6IHRleHQsIHJlc3BvbnNlRGF0YSB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICByZXN1bHQgPSBnZW5lcmF0ZVJlc3VsdC5vYmplY3RUZXh0O1xuICAgICAgICBmaW5pc2hSZWFzb24gPSBnZW5lcmF0ZVJlc3VsdC5maW5pc2hSZWFzb247XG4gICAgICAgIHVzYWdlID0gZ2VuZXJhdGVSZXN1bHQudXNhZ2U7XG4gICAgICAgIHdhcm5pbmdzID0gZ2VuZXJhdGVSZXN1bHQud2FybmluZ3M7XG4gICAgICAgIHJlc3VsdFByb3ZpZGVyTWV0YWRhdGEgPSBnZW5lcmF0ZVJlc3VsdC5wcm92aWRlck1ldGFkYXRhO1xuICAgICAgICByZXF1ZXN0ID0gZ2VuZXJhdGVSZXN1bHQucmVxdWVzdCA/PyB7fTtcbiAgICAgICAgcmVzcG9uc2UgPSBnZW5lcmF0ZVJlc3VsdC5yZXNwb25zZURhdGE7XG5cbiAgICAgICAgY29uc3Qgb2JqZWN0ID0gYXdhaXQgcGFyc2VBbmRWYWxpZGF0ZU9iamVjdFJlc3VsdFdpdGhSZXBhaXIoXG4gICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgIG91dHB1dFN0cmF0ZWd5LFxuICAgICAgICAgIHJlcGFpclRleHQsXG4gICAgICAgICAge1xuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICB1c2FnZSxcbiAgICAgICAgICAgIGZpbmlzaFJlYXNvbixcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEFkZCByZXNwb25zZSBpbmZvcm1hdGlvbiB0byB0aGUgc3BhbjpcbiAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgIHNlbGVjdFRlbGVtZXRyeUF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAnYWkucmVzcG9uc2UuZmluaXNoUmVhc29uJzogZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgICAnYWkucmVzcG9uc2Uub2JqZWN0Jzoge1xuICAgICAgICAgICAgICAgIG91dHB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkob2JqZWN0KSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnByb3ZpZGVyTWV0YWRhdGEnOiBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICAgICAgICByZXN1bHRQcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAgIC8vIFRPRE8gcmVuYW1lIHRlbGVtZXRyeSBhdHRyaWJ1dGVzIHRvIGlucHV0VG9rZW5zIGFuZCBvdXRwdXRUb2tlbnNcbiAgICAgICAgICAgICAgJ2FpLnVzYWdlLnByb21wdFRva2Vucyc6IHVzYWdlLmlucHV0VG9rZW5zLFxuICAgICAgICAgICAgICAnYWkudXNhZ2UuY29tcGxldGlvblRva2Vucyc6IHVzYWdlLm91dHB1dFRva2VucyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBEZWZhdWx0R2VuZXJhdGVPYmplY3RSZXN1bHQoe1xuICAgICAgICAgIG9iamVjdCxcbiAgICAgICAgICBmaW5pc2hSZWFzb24sXG4gICAgICAgICAgdXNhZ2UsXG4gICAgICAgICAgd2FybmluZ3MsXG4gICAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiByZXN1bHRQcm92aWRlck1ldGFkYXRhLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgd3JhcEdhdGV3YXlFcnJvcihlcnJvcik7XG4gIH1cbn1cblxuY2xhc3MgRGVmYXVsdEdlbmVyYXRlT2JqZWN0UmVzdWx0PFQ+IGltcGxlbWVudHMgR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD4ge1xuICByZWFkb25seSBvYmplY3Q6IEdlbmVyYXRlT2JqZWN0UmVzdWx0PFQ+WydvYmplY3QnXTtcbiAgcmVhZG9ubHkgZmluaXNoUmVhc29uOiBHZW5lcmF0ZU9iamVjdFJlc3VsdDxUPlsnZmluaXNoUmVhc29uJ107XG4gIHJlYWRvbmx5IHVzYWdlOiBHZW5lcmF0ZU9iamVjdFJlc3VsdDxUPlsndXNhZ2UnXTtcbiAgcmVhZG9ubHkgd2FybmluZ3M6IEdlbmVyYXRlT2JqZWN0UmVzdWx0PFQ+Wyd3YXJuaW5ncyddO1xuICByZWFkb25seSBwcm92aWRlck1ldGFkYXRhOiBHZW5lcmF0ZU9iamVjdFJlc3VsdDxUPlsncHJvdmlkZXJNZXRhZGF0YSddO1xuICByZWFkb25seSByZXNwb25zZTogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ3Jlc3BvbnNlJ107XG4gIHJlYWRvbmx5IHJlcXVlc3Q6IEdlbmVyYXRlT2JqZWN0UmVzdWx0PFQ+WydyZXF1ZXN0J107XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczoge1xuICAgIG9iamVjdDogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ29iamVjdCddO1xuICAgIGZpbmlzaFJlYXNvbjogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ2ZpbmlzaFJlYXNvbiddO1xuICAgIHVzYWdlOiBHZW5lcmF0ZU9iamVjdFJlc3VsdDxUPlsndXNhZ2UnXTtcbiAgICB3YXJuaW5nczogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ3dhcm5pbmdzJ107XG4gICAgcHJvdmlkZXJNZXRhZGF0YTogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ3Byb3ZpZGVyTWV0YWRhdGEnXTtcbiAgICByZXNwb25zZTogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ3Jlc3BvbnNlJ107XG4gICAgcmVxdWVzdDogR2VuZXJhdGVPYmplY3RSZXN1bHQ8VD5bJ3JlcXVlc3QnXTtcbiAgfSkge1xuICAgIHRoaXMub2JqZWN0ID0gb3B0aW9ucy5vYmplY3Q7XG4gICAgdGhpcy5maW5pc2hSZWFzb24gPSBvcHRpb25zLmZpbmlzaFJlYXNvbjtcbiAgICB0aGlzLnVzYWdlID0gb3B0aW9ucy51c2FnZTtcbiAgICB0aGlzLndhcm5pbmdzID0gb3B0aW9ucy53YXJuaW5ncztcbiAgICB0aGlzLnByb3ZpZGVyTWV0YWRhdGEgPSBvcHRpb25zLnByb3ZpZGVyTWV0YWRhdGE7XG4gICAgdGhpcy5yZXNwb25zZSA9IG9wdGlvbnMucmVzcG9uc2U7XG4gICAgdGhpcy5yZXF1ZXN0ID0gb3B0aW9ucy5yZXF1ZXN0O1xuICB9XG5cbiAgdG9Kc29uUmVzcG9uc2UoaW5pdD86IFJlc3BvbnNlSW5pdCk6IFJlc3BvbnNlIHtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHRoaXMub2JqZWN0KSwge1xuICAgICAgc3RhdHVzOiBpbml0Py5zdGF0dXMgPz8gMjAwLFxuICAgICAgaGVhZGVyczogcHJlcGFyZUhlYWRlcnMoaW5pdD8uaGVhZGVycywge1xuICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cbn1cbiIsICJpbXBvcnQge1xuICBpc0pTT05BcnJheSxcbiAgaXNKU09OT2JqZWN0LFxuICBKU09OT2JqZWN0LFxuICBKU09OU2NoZW1hNyxcbiAgSlNPTlZhbHVlLFxuICBUeXBlVmFsaWRhdGlvbkVycm9yLFxuICBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcixcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBhc1NjaGVtYSxcbiAgc2FmZVZhbGlkYXRlVHlwZXMsXG4gIFNjaGVtYSxcbiAgVmFsaWRhdGlvblJlc3VsdCxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yJztcbmltcG9ydCB7XG4gIEFzeW5jSXRlcmFibGVTdHJlYW0sXG4gIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0sXG59IGZyb20gJy4uL3V0aWwvYXN5bmMtaXRlcmFibGUtc3RyZWFtJztcbmltcG9ydCB7IERlZXBQYXJ0aWFsIH0gZnJvbSAnLi4vdXRpbC9kZWVwLXBhcnRpYWwnO1xuaW1wb3J0IHtcbiAgRmluaXNoUmVhc29uLFxuICBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSxcbiAgTGFuZ3VhZ2VNb2RlbFVzYWdlLFxufSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBPYmplY3RTdHJlYW1QYXJ0IH0gZnJvbSAnLi9zdHJlYW0tb2JqZWN0LXJlc3VsdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3V0cHV0U3RyYXRlZ3k8UEFSVElBTCwgUkVTVUxULCBFTEVNRU5UX1NUUkVBTT4ge1xuICByZWFkb25seSB0eXBlOiAnb2JqZWN0JyB8ICdhcnJheScgfCAnZW51bScgfCAnbm8tc2NoZW1hJztcbiAgcmVhZG9ubHkganNvblNjaGVtYTogSlNPTlNjaGVtYTcgfCB1bmRlZmluZWQ7XG5cbiAgdmFsaWRhdGVQYXJ0aWFsUmVzdWx0KHtcbiAgICB2YWx1ZSxcbiAgICB0ZXh0RGVsdGEsXG4gICAgaXNGaW5hbERlbHRhLFxuICB9OiB7XG4gICAgdmFsdWU6IEpTT05WYWx1ZTtcbiAgICB0ZXh0RGVsdGE6IHN0cmluZztcbiAgICBpc0ZpcnN0RGVsdGE6IGJvb2xlYW47XG4gICAgaXNGaW5hbERlbHRhOiBib29sZWFuO1xuICAgIGxhdGVzdE9iamVjdDogUEFSVElBTCB8IHVuZGVmaW5lZDtcbiAgfSk6IFByb21pc2U8XG4gICAgVmFsaWRhdGlvblJlc3VsdDx7XG4gICAgICBwYXJ0aWFsOiBQQVJUSUFMO1xuICAgICAgdGV4dERlbHRhOiBzdHJpbmc7XG4gICAgfT5cbiAgPjtcbiAgdmFsaWRhdGVGaW5hbFJlc3VsdChcbiAgICB2YWx1ZTogSlNPTlZhbHVlIHwgdW5kZWZpbmVkLFxuICAgIGNvbnRleHQ6IHtcbiAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgIHJlc3BvbnNlOiBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YTtcbiAgICAgIHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG4gICAgfSxcbiAgKTogUHJvbWlzZTxWYWxpZGF0aW9uUmVzdWx0PFJFU1VMVD4+O1xuXG4gIGNyZWF0ZUVsZW1lbnRTdHJlYW0oXG4gICAgb3JpZ2luYWxTdHJlYW06IFJlYWRhYmxlU3RyZWFtPE9iamVjdFN0cmVhbVBhcnQ8UEFSVElBTD4+LFxuICApOiBFTEVNRU5UX1NUUkVBTTtcbn1cblxuY29uc3Qgbm9TY2hlbWFPdXRwdXRTdHJhdGVneTogT3V0cHV0U3RyYXRlZ3k8SlNPTlZhbHVlLCBKU09OVmFsdWUsIG5ldmVyPiA9IHtcbiAgdHlwZTogJ25vLXNjaGVtYScsXG4gIGpzb25TY2hlbWE6IHVuZGVmaW5lZCxcblxuICBhc3luYyB2YWxpZGF0ZVBhcnRpYWxSZXN1bHQoeyB2YWx1ZSwgdGV4dERlbHRhIH0pIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogeyBwYXJ0aWFsOiB2YWx1ZSwgdGV4dERlbHRhIH0gfTtcbiAgfSxcblxuICBhc3luYyB2YWxpZGF0ZUZpbmFsUmVzdWx0KFxuICAgIHZhbHVlOiBKU09OVmFsdWUgfCB1bmRlZmluZWQsXG4gICAgY29udGV4dDoge1xuICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgcmVzcG9uc2U6IExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhO1xuICAgICAgdXNhZ2U6IExhbmd1YWdlTW9kZWxVc2FnZTtcbiAgICAgIGZpbmlzaFJlYXNvbjogRmluaXNoUmVhc29uO1xuICAgIH0sXG4gICk6IFByb21pc2U8VmFsaWRhdGlvblJlc3VsdDxKU09OVmFsdWU+PiB7XG4gICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWRcbiAgICAgID8ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBuZXcgTm9PYmplY3RHZW5lcmF0ZWRFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnTm8gb2JqZWN0IGdlbmVyYXRlZDogcmVzcG9uc2UgZGlkIG5vdCBtYXRjaCBzY2hlbWEuJyxcbiAgICAgICAgICAgIHRleHQ6IGNvbnRleHQudGV4dCxcbiAgICAgICAgICAgIHJlc3BvbnNlOiBjb250ZXh0LnJlc3BvbnNlLFxuICAgICAgICAgICAgdXNhZ2U6IGNvbnRleHQudXNhZ2UsXG4gICAgICAgICAgICBmaW5pc2hSZWFzb246IGNvbnRleHQuZmluaXNoUmVhc29uLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9XG4gICAgICA6IHsgc3VjY2VzczogdHJ1ZSwgdmFsdWUgfTtcbiAgfSxcblxuICBjcmVhdGVFbGVtZW50U3RyZWFtKCkge1xuICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcih7XG4gICAgICBmdW5jdGlvbmFsaXR5OiAnZWxlbWVudCBzdHJlYW1zIGluIG5vLXNjaGVtYSBtb2RlJyxcbiAgICB9KTtcbiAgfSxcbn07XG5cbmNvbnN0IG9iamVjdE91dHB1dFN0cmF0ZWd5ID0gPE9CSkVDVD4oXG4gIHNjaGVtYTogU2NoZW1hPE9CSkVDVD4sXG4pOiBPdXRwdXRTdHJhdGVneTxEZWVwUGFydGlhbDxPQkpFQ1Q+LCBPQkpFQ1QsIG5ldmVyPiA9PiAoe1xuICB0eXBlOiAnb2JqZWN0JyxcbiAganNvblNjaGVtYTogc2NoZW1hLmpzb25TY2hlbWEsXG5cbiAgYXN5bmMgdmFsaWRhdGVQYXJ0aWFsUmVzdWx0KHsgdmFsdWUsIHRleHREZWx0YSB9KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB2YWx1ZToge1xuICAgICAgICAvLyBOb3RlOiBjdXJyZW50bHkgbm8gdmFsaWRhdGlvbiBvZiBwYXJ0aWFsIHJlc3VsdHM6XG4gICAgICAgIHBhcnRpYWw6IHZhbHVlIGFzIERlZXBQYXJ0aWFsPE9CSkVDVD4sXG4gICAgICAgIHRleHREZWx0YSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSxcblxuICBhc3luYyB2YWxpZGF0ZUZpbmFsUmVzdWx0KFxuICAgIHZhbHVlOiBKU09OVmFsdWUgfCB1bmRlZmluZWQsXG4gICk6IFByb21pc2U8VmFsaWRhdGlvblJlc3VsdDxPQkpFQ1Q+PiB7XG4gICAgcmV0dXJuIHNhZmVWYWxpZGF0ZVR5cGVzKHsgdmFsdWUsIHNjaGVtYSB9KTtcbiAgfSxcblxuICBjcmVhdGVFbGVtZW50U3RyZWFtKCkge1xuICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEZ1bmN0aW9uYWxpdHlFcnJvcih7XG4gICAgICBmdW5jdGlvbmFsaXR5OiAnZWxlbWVudCBzdHJlYW1zIGluIG9iamVjdCBtb2RlJyxcbiAgICB9KTtcbiAgfSxcbn0pO1xuXG5jb25zdCBhcnJheU91dHB1dFN0cmF0ZWd5ID0gPEVMRU1FTlQ+KFxuICBzY2hlbWE6IFNjaGVtYTxFTEVNRU5UPixcbik6IE91dHB1dFN0cmF0ZWd5PEVMRU1FTlRbXSwgRUxFTUVOVFtdLCBBc3luY0l0ZXJhYmxlU3RyZWFtPEVMRU1FTlQ+PiA9PiB7XG4gIC8vIHJlbW92ZSAkc2NoZW1hIGZyb20gc2NoZW1hLmpzb25TY2hlbWE6XG4gIGNvbnN0IHsgJHNjaGVtYSwgLi4uaXRlbVNjaGVtYSB9ID0gc2NoZW1hLmpzb25TY2hlbWE7XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnZW51bScsXG5cbiAgICAvLyB3cmFwIGluIG9iamVjdCB0aGF0IGNvbnRhaW5zIGFycmF5IG9mIGVsZW1lbnRzLCBzaW5jZSBtb3N0IExMTXMgd2lsbCBub3RcbiAgICAvLyBiZSBhYmxlIHRvIGdlbmVyYXRlIGFuIGFycmF5IGRpcmVjdGx5OlxuICAgIC8vIHBvc3NpYmxlIGZ1dHVyZSBvcHRpbWl6YXRpb246IHVzZSBhcnJheXMgZGlyZWN0bHkgd2hlbiBtb2RlbCBzdXBwb3J0cyBncmFtbWFyLWd1aWRlZCBnZW5lcmF0aW9uXG4gICAganNvblNjaGVtYToge1xuICAgICAgJHNjaGVtYTogJ2h0dHA6Ly9qc29uLXNjaGVtYS5vcmcvZHJhZnQtMDcvc2NoZW1hIycsXG4gICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZWxlbWVudHM6IHsgdHlwZTogJ2FycmF5JywgaXRlbXM6IGl0ZW1TY2hlbWEgfSxcbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydlbGVtZW50cyddLFxuICAgICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IGZhbHNlLFxuICAgIH0sXG5cbiAgICBhc3luYyB2YWxpZGF0ZVBhcnRpYWxSZXN1bHQoe1xuICAgICAgdmFsdWUsXG4gICAgICBsYXRlc3RPYmplY3QsXG4gICAgICBpc0ZpcnN0RGVsdGEsXG4gICAgICBpc0ZpbmFsRGVsdGEsXG4gICAgfSkge1xuICAgICAgLy8gY2hlY2sgdGhhdCB0aGUgdmFsdWUgaXMgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgYW4gYXJyYXkgb2YgZWxlbWVudHM6XG4gICAgICBpZiAoIWlzSlNPTk9iamVjdCh2YWx1ZSkgfHwgIWlzSlNPTkFycmF5KHZhbHVlLmVsZW1lbnRzKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBuZXcgVHlwZVZhbGlkYXRpb25FcnJvcih7XG4gICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgIGNhdXNlOiAndmFsdWUgbXVzdCBiZSBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhbiBhcnJheSBvZiBlbGVtZW50cycsXG4gICAgICAgICAgfSksXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSB2YWx1ZS5lbGVtZW50cyBhcyBBcnJheTxKU09OT2JqZWN0PjtcbiAgICAgIGNvbnN0IHJlc3VsdEFycmF5OiBBcnJheTxFTEVNRU5UPiA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0QXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGlucHV0QXJyYXlbaV07XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNhZmVWYWxpZGF0ZVR5cGVzKHsgdmFsdWU6IGVsZW1lbnQsIHNjaGVtYSB9KTtcblxuICAgICAgICAvLyBzcGVjaWFsIHRyZWF0bWVudCBmb3IgbGFzdCBwcm9jZXNzZWQgZWxlbWVudDpcbiAgICAgICAgLy8gaWdub3JlIHBhcnNlIG9yIHZhbGlkYXRpb24gZmFpbHVyZXMsIHNpbmNlIHRoZXkgaW5kaWNhdGUgdGhhdCB0aGVcbiAgICAgICAgLy8gbGFzdCBlbGVtZW50IGlzIGluY29tcGxldGUgYW5kIHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdCxcbiAgICAgICAgLy8gdW5sZXNzIGl0IGlzIHRoZSBmaW5hbCBkZWx0YVxuICAgICAgICBpZiAoaSA9PT0gaW5wdXRBcnJheS5sZW5ndGggLSAxICYmICFpc0ZpbmFsRGVsdGEpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzdWx0QXJyYXkucHVzaChyZXN1bHQudmFsdWUpO1xuICAgICAgfVxuXG4gICAgICAvLyBjYWxjdWxhdGUgZGVsdGE6XG4gICAgICBjb25zdCBwdWJsaXNoZWRFbGVtZW50Q291bnQgPSBsYXRlc3RPYmplY3Q/Lmxlbmd0aCA/PyAwO1xuXG4gICAgICBsZXQgdGV4dERlbHRhID0gJyc7XG5cbiAgICAgIGlmIChpc0ZpcnN0RGVsdGEpIHtcbiAgICAgICAgdGV4dERlbHRhICs9ICdbJztcbiAgICAgIH1cblxuICAgICAgaWYgKHB1Ymxpc2hlZEVsZW1lbnRDb3VudCA+IDApIHtcbiAgICAgICAgdGV4dERlbHRhICs9ICcsJztcbiAgICAgIH1cblxuICAgICAgdGV4dERlbHRhICs9IHJlc3VsdEFycmF5XG4gICAgICAgIC5zbGljZShwdWJsaXNoZWRFbGVtZW50Q291bnQpIC8vIG9ubHkgbmV3IGVsZW1lbnRzXG4gICAgICAgIC5tYXAoZWxlbWVudCA9PiBKU09OLnN0cmluZ2lmeShlbGVtZW50KSlcbiAgICAgICAgLmpvaW4oJywnKTtcblxuICAgICAgaWYgKGlzRmluYWxEZWx0YSkge1xuICAgICAgICB0ZXh0RGVsdGEgKz0gJ10nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIHBhcnRpYWw6IHJlc3VsdEFycmF5LFxuICAgICAgICAgIHRleHREZWx0YSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfSxcblxuICAgIGFzeW5jIHZhbGlkYXRlRmluYWxSZXN1bHQoXG4gICAgICB2YWx1ZTogSlNPTlZhbHVlIHwgdW5kZWZpbmVkLFxuICAgICk6IFByb21pc2U8VmFsaWRhdGlvblJlc3VsdDxBcnJheTxFTEVNRU5UPj4+IHtcbiAgICAgIC8vIGNoZWNrIHRoYXQgdGhlIHZhbHVlIGlzIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGFuIGFycmF5IG9mIGVsZW1lbnRzOlxuICAgICAgaWYgKCFpc0pTT05PYmplY3QodmFsdWUpIHx8ICFpc0pTT05BcnJheSh2YWx1ZS5lbGVtZW50cykpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogbmV3IFR5cGVWYWxpZGF0aW9uRXJyb3Ioe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBjYXVzZTogJ3ZhbHVlIG11c3QgYmUgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgYW4gYXJyYXkgb2YgZWxlbWVudHMnLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnB1dEFycmF5ID0gdmFsdWUuZWxlbWVudHMgYXMgQXJyYXk8SlNPTk9iamVjdD47XG5cbiAgICAgIC8vIGNoZWNrIHRoYXQgZWFjaCBlbGVtZW50IGluIHRoZSBhcnJheSBpcyBvZiB0aGUgY29ycmVjdCB0eXBlOlxuICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGlucHV0QXJyYXkpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2FmZVZhbGlkYXRlVHlwZXMoeyB2YWx1ZTogZWxlbWVudCwgc2NoZW1hIH0pO1xuICAgICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCB2YWx1ZTogaW5wdXRBcnJheSBhcyBBcnJheTxFTEVNRU5UPiB9O1xuICAgIH0sXG5cbiAgICBjcmVhdGVFbGVtZW50U3RyZWFtKFxuICAgICAgb3JpZ2luYWxTdHJlYW06IFJlYWRhYmxlU3RyZWFtPE9iamVjdFN0cmVhbVBhcnQ8RUxFTUVOVFtdPj4sXG4gICAgKSB7XG4gICAgICBsZXQgcHVibGlzaGVkRWxlbWVudHMgPSAwO1xuXG4gICAgICByZXR1cm4gY3JlYXRlQXN5bmNJdGVyYWJsZVN0cmVhbShcbiAgICAgICAgb3JpZ2luYWxTdHJlYW0ucGlwZVRocm91Z2goXG4gICAgICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxPYmplY3RTdHJlYW1QYXJ0PEVMRU1FTlRbXT4sIEVMRU1FTlQ+KHtcbiAgICAgICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgICBzd2l0Y2ggKGNodW5rLnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdvYmplY3QnOiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBhcnJheSA9IGNodW5rLm9iamVjdDtcblxuICAgICAgICAgICAgICAgICAgLy8gcHVibGlzaCBuZXcgZWxlbWVudHMgb25lIGJ5IG9uZTpcbiAgICAgICAgICAgICAgICAgIGZvciAoXG4gICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICAgICAgcHVibGlzaGVkRWxlbWVudHMgPCBhcnJheS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHB1Ymxpc2hlZEVsZW1lbnRzKytcbiAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoYXJyYXlbcHVibGlzaGVkRWxlbWVudHNdKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dC1kZWx0YSc6XG4gICAgICAgICAgICAgICAgY2FzZSAnZmluaXNoJzpcbiAgICAgICAgICAgICAgICBjYXNlICdlcnJvcic6IC8vIHN1cHByZXNzIGVycm9yICh1c2Ugb25FcnJvciBpbnN0ZWFkKVxuICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IGNodW5rO1xuICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgICAgICBgVW5zdXBwb3J0ZWQgY2h1bmsgdHlwZTogJHtfZXhoYXVzdGl2ZUNoZWNrfWAsXG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSxcbiAgfTtcbn07XG5cbmNvbnN0IGVudW1PdXRwdXRTdHJhdGVneSA9IDxFTlVNIGV4dGVuZHMgc3RyaW5nPihcbiAgZW51bVZhbHVlczogQXJyYXk8RU5VTT4sXG4pOiBPdXRwdXRTdHJhdGVneTxzdHJpbmcsIEVOVU0sIG5ldmVyPiA9PiB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ2VudW0nLFxuXG4gICAgLy8gd3JhcCBpbiBvYmplY3QgdGhhdCBjb250YWlucyByZXN1bHQsIHNpbmNlIG1vc3QgTExNcyB3aWxsIG5vdFxuICAgIC8vIGJlIGFibGUgdG8gZ2VuZXJhdGUgYW4gZW51bSB2YWx1ZSBkaXJlY3RseTpcbiAgICAvLyBwb3NzaWJsZSBmdXR1cmUgb3B0aW1pemF0aW9uOiB1c2UgZW51bXMgZGlyZWN0bHkgd2hlbiBtb2RlbCBzdXBwb3J0cyB0b3AtbGV2ZWwgZW51bXNcbiAgICBqc29uU2NoZW1hOiB7XG4gICAgICAkc2NoZW1hOiAnaHR0cDovL2pzb24tc2NoZW1hLm9yZy9kcmFmdC0wNy9zY2hlbWEjJyxcbiAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICByZXN1bHQ6IHsgdHlwZTogJ3N0cmluZycsIGVudW06IGVudW1WYWx1ZXMgfSxcbiAgICAgIH0sXG4gICAgICByZXF1aXJlZDogWydyZXN1bHQnXSxcbiAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgICB9LFxuXG4gICAgYXN5bmMgdmFsaWRhdGVGaW5hbFJlc3VsdChcbiAgICAgIHZhbHVlOiBKU09OVmFsdWUgfCB1bmRlZmluZWQsXG4gICAgKTogUHJvbWlzZTxWYWxpZGF0aW9uUmVzdWx0PEVOVU0+PiB7XG4gICAgICAvLyBjaGVjayB0aGF0IHRoZSB2YWx1ZSBpcyBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhbiBhcnJheSBvZiBlbGVtZW50czpcbiAgICAgIGlmICghaXNKU09OT2JqZWN0KHZhbHVlKSB8fCB0eXBlb2YgdmFsdWUucmVzdWx0ICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBuZXcgVHlwZVZhbGlkYXRpb25FcnJvcih7XG4gICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgIGNhdXNlOlxuICAgICAgICAgICAgICAndmFsdWUgbXVzdCBiZSBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhIHN0cmluZyBpbiB0aGUgXCJyZXN1bHRcIiBwcm9wZXJ0eS4nLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSB2YWx1ZS5yZXN1bHQgYXMgc3RyaW5nO1xuXG4gICAgICByZXR1cm4gZW51bVZhbHVlcy5pbmNsdWRlcyhyZXN1bHQgYXMgRU5VTSlcbiAgICAgICAgPyB7IHN1Y2Nlc3M6IHRydWUsIHZhbHVlOiByZXN1bHQgYXMgRU5VTSB9XG4gICAgICAgIDoge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjogbmV3IFR5cGVWYWxpZGF0aW9uRXJyb3Ioe1xuICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgY2F1c2U6ICd2YWx1ZSBtdXN0IGJlIGEgc3RyaW5nIGluIHRoZSBlbnVtJyxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgfSxcblxuICAgIGFzeW5jIHZhbGlkYXRlUGFydGlhbFJlc3VsdCh7IHZhbHVlLCB0ZXh0RGVsdGEgfSkge1xuICAgICAgaWYgKCFpc0pTT05PYmplY3QodmFsdWUpIHx8IHR5cGVvZiB2YWx1ZS5yZXN1bHQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IG5ldyBUeXBlVmFsaWRhdGlvbkVycm9yKHtcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgY2F1c2U6XG4gICAgICAgICAgICAgICd2YWx1ZSBtdXN0IGJlIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGEgc3RyaW5nIGluIHRoZSBcInJlc3VsdFwiIHByb3BlcnR5LicsXG4gICAgICAgICAgfSksXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbHVlLnJlc3VsdCBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBwb3NzaWJsZUVudW1WYWx1ZXMgPSBlbnVtVmFsdWVzLmZpbHRlcihlbnVtVmFsdWUgPT5cbiAgICAgICAgZW51bVZhbHVlLnN0YXJ0c1dpdGgocmVzdWx0KSxcbiAgICAgICk7XG5cbiAgICAgIGlmICh2YWx1ZS5yZXN1bHQubGVuZ3RoID09PSAwIHx8IHBvc3NpYmxlRW51bVZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogbmV3IFR5cGVWYWxpZGF0aW9uRXJyb3Ioe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBjYXVzZTogJ3ZhbHVlIG11c3QgYmUgYSBzdHJpbmcgaW4gdGhlIGVudW0nLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIHBhcnRpYWw6XG4gICAgICAgICAgICBwb3NzaWJsZUVudW1WYWx1ZXMubGVuZ3RoID4gMSA/IHJlc3VsdCA6IHBvc3NpYmxlRW51bVZhbHVlc1swXSxcbiAgICAgICAgICB0ZXh0RGVsdGEsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjcmVhdGVFbGVtZW50U3RyZWFtKCkge1xuICAgICAgLy8gbm8gc3RyZWFtaW5nIGluIGVudW0gbW9kZVxuICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRnVuY3Rpb25hbGl0eUVycm9yKHtcbiAgICAgICAgZnVuY3Rpb25hbGl0eTogJ2VsZW1lbnQgc3RyZWFtcyBpbiBlbnVtIG1vZGUnLFxuICAgICAgfSk7XG4gICAgfSxcbiAgfTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPdXRwdXRTdHJhdGVneTxTQ0hFTUE+KHtcbiAgb3V0cHV0LFxuICBzY2hlbWEsXG4gIGVudW1WYWx1ZXMsXG59OiB7XG4gIG91dHB1dDogJ29iamVjdCcgfCAnYXJyYXknIHwgJ2VudW0nIHwgJ25vLXNjaGVtYSc7XG4gIHNjaGVtYT86XG4gICAgfCB6NC5jb3JlLiRab2RUeXBlPFNDSEVNQSwgYW55PlxuICAgIHwgejMuU2NoZW1hPFNDSEVNQSwgejMuWm9kVHlwZURlZiwgYW55PlxuICAgIHwgU2NoZW1hPFNDSEVNQT47XG4gIGVudW1WYWx1ZXM/OiBBcnJheTxTQ0hFTUE+O1xufSk6IE91dHB1dFN0cmF0ZWd5PGFueSwgYW55LCBhbnk+IHtcbiAgc3dpdGNoIChvdXRwdXQpIHtcbiAgICBjYXNlICdvYmplY3QnOlxuICAgICAgcmV0dXJuIG9iamVjdE91dHB1dFN0cmF0ZWd5KGFzU2NoZW1hKHNjaGVtYSEpKTtcbiAgICBjYXNlICdhcnJheSc6XG4gICAgICByZXR1cm4gYXJyYXlPdXRwdXRTdHJhdGVneShhc1NjaGVtYShzY2hlbWEhKSk7XG4gICAgY2FzZSAnZW51bSc6XG4gICAgICByZXR1cm4gZW51bU91dHB1dFN0cmF0ZWd5KGVudW1WYWx1ZXMhIGFzIEFycmF5PHN0cmluZz4pO1xuICAgIGNhc2UgJ25vLXNjaGVtYSc6XG4gICAgICByZXR1cm4gbm9TY2hlbWFPdXRwdXRTdHJhdGVneTtcbiAgICBkZWZhdWx0OiB7XG4gICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IG91dHB1dDtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgb3V0cHV0OiAke19leGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgfVxuICB9XG59XG4iLCAiaW1wb3J0IHsgSlNPTlBhcnNlRXJyb3IsIFR5cGVWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IHNhZmVQYXJzZUpTT04gfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yJztcbmltcG9ydCB0eXBlIHtcbiAgRmluaXNoUmVhc29uLFxuICBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSxcbiAgTGFuZ3VhZ2VNb2RlbFVzYWdlLFxufSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IE91dHB1dFN0cmF0ZWd5IH0gZnJvbSAnLi9vdXRwdXQtc3RyYXRlZ3knO1xuaW1wb3J0IHsgUmVwYWlyVGV4dEZ1bmN0aW9uIH0gZnJvbSAnLi9yZXBhaXItdGV4dCc7XG5cbi8qKlxuICogUGFyc2VzIGFuZCB2YWxpZGF0ZXMgYSByZXN1bHQgc3RyaW5nIGJ5IHBhcnNpbmcgaXQgYXMgSlNPTiBhbmQgdmFsaWRhdGluZyBhZ2FpbnN0IHRoZSBvdXRwdXQgc3RyYXRlZ3kuXG4gKlxuICogQHBhcmFtIHJlc3VsdCAtIFRoZSByZXN1bHQgc3RyaW5nIHRvIHBhcnNlIGFuZCB2YWxpZGF0ZVxuICogQHBhcmFtIG91dHB1dFN0cmF0ZWd5IC0gVGhlIG91dHB1dCBzdHJhdGVneSBjb250YWluaW5nIHZhbGlkYXRpb24gbG9naWNcbiAqIEBwYXJhbSBjb250ZXh0IC0gQWRkaXRpb25hbCBjb250ZXh0IGZvciBlcnJvciByZXBvcnRpbmdcbiAqIEByZXR1cm5zIFRoZSB2YWxpZGF0ZWQgcmVzdWx0XG4gKiBAdGhyb3dzIE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgaWYgcGFyc2luZyBvciB2YWxpZGF0aW9uIGZhaWxzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHBhcnNlQW5kVmFsaWRhdGVPYmplY3RSZXN1bHQ8UkVTVUxUPihcbiAgcmVzdWx0OiBzdHJpbmcsXG4gIG91dHB1dFN0cmF0ZWd5OiBPdXRwdXRTdHJhdGVneTxhbnksIFJFU1VMVCwgYW55PixcbiAgY29udGV4dDoge1xuICAgIHJlc3BvbnNlOiBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YTtcbiAgICB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlO1xuICAgIGZpbmlzaFJlYXNvbjogRmluaXNoUmVhc29uO1xuICB9LFxuKTogUHJvbWlzZTxSRVNVTFQ+IHtcbiAgY29uc3QgcGFyc2VSZXN1bHQgPSBhd2FpdCBzYWZlUGFyc2VKU09OKHsgdGV4dDogcmVzdWx0IH0pO1xuXG4gIGlmICghcGFyc2VSZXN1bHQuc3VjY2Vzcykge1xuICAgIHRocm93IG5ldyBOb09iamVjdEdlbmVyYXRlZEVycm9yKHtcbiAgICAgIG1lc3NhZ2U6ICdObyBvYmplY3QgZ2VuZXJhdGVkOiBjb3VsZCBub3QgcGFyc2UgdGhlIHJlc3BvbnNlLicsXG4gICAgICBjYXVzZTogcGFyc2VSZXN1bHQuZXJyb3IsXG4gICAgICB0ZXh0OiByZXN1bHQsXG4gICAgICByZXNwb25zZTogY29udGV4dC5yZXNwb25zZSxcbiAgICAgIHVzYWdlOiBjb250ZXh0LnVzYWdlLFxuICAgICAgZmluaXNoUmVhc29uOiBjb250ZXh0LmZpbmlzaFJlYXNvbixcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBhd2FpdCBvdXRwdXRTdHJhdGVneS52YWxpZGF0ZUZpbmFsUmVzdWx0KFxuICAgIHBhcnNlUmVzdWx0LnZhbHVlLFxuICAgIHtcbiAgICAgIHRleHQ6IHJlc3VsdCxcbiAgICAgIHJlc3BvbnNlOiBjb250ZXh0LnJlc3BvbnNlLFxuICAgICAgdXNhZ2U6IGNvbnRleHQudXNhZ2UsXG4gICAgfSxcbiAgKTtcblxuICBpZiAoIXZhbGlkYXRpb25SZXN1bHQuc3VjY2Vzcykge1xuICAgIHRocm93IG5ldyBOb09iamVjdEdlbmVyYXRlZEVycm9yKHtcbiAgICAgIG1lc3NhZ2U6ICdObyBvYmplY3QgZ2VuZXJhdGVkOiByZXNwb25zZSBkaWQgbm90IG1hdGNoIHNjaGVtYS4nLFxuICAgICAgY2F1c2U6IHZhbGlkYXRpb25SZXN1bHQuZXJyb3IsXG4gICAgICB0ZXh0OiByZXN1bHQsXG4gICAgICByZXNwb25zZTogY29udGV4dC5yZXNwb25zZSxcbiAgICAgIHVzYWdlOiBjb250ZXh0LnVzYWdlLFxuICAgICAgZmluaXNoUmVhc29uOiBjb250ZXh0LmZpbmlzaFJlYXNvbixcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB2YWxpZGF0aW9uUmVzdWx0LnZhbHVlO1xufVxuXG4vKipcbiAqIFBhcnNlcyBhbmQgdmFsaWRhdGVzIGEgcmVzdWx0IHN0cmluZyBieSBwYXJzaW5nIGl0IGFzIEpTT04gYW5kIHZhbGlkYXRpbmcgYWdhaW5zdCB0aGUgb3V0cHV0IHN0cmF0ZWd5LlxuICogSWYgdGhlIHJlc3VsdCBjYW5ub3QgYmUgcGFyc2VkLCBpdCBhdHRlbXB0cyB0byByZXBhaXIgdGhlIHJlc3VsdCB1c2luZyB0aGUgcmVwYWlyVGV4dCBmdW5jdGlvbi5cbiAqXG4gKiBAcGFyYW0gcmVzdWx0IC0gVGhlIHJlc3VsdCBzdHJpbmcgdG8gcGFyc2UgYW5kIHZhbGlkYXRlXG4gKiBAcGFyYW0gb3V0cHV0U3RyYXRlZ3kgLSBUaGUgb3V0cHV0IHN0cmF0ZWd5IGNvbnRhaW5pbmcgdmFsaWRhdGlvbiBsb2dpY1xuICogQHBhcmFtIHJlcGFpclRleHQgLSBBIGZ1bmN0aW9uIHRoYXQgYXR0ZW1wdHMgdG8gcmVwYWlyIHRoZSByZXN1bHQgc3RyaW5nXG4gKiBAcGFyYW0gY29udGV4dCAtIEFkZGl0aW9uYWwgY29udGV4dCBmb3IgZXJyb3IgcmVwb3J0aW5nXG4gKiBAcmV0dXJucyBUaGUgdmFsaWRhdGVkIHJlc3VsdFxuICogQHRocm93cyBOb09iamVjdEdlbmVyYXRlZEVycm9yIGlmIHBhcnNpbmcgb3IgdmFsaWRhdGlvbiBmYWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VBbmRWYWxpZGF0ZU9iamVjdFJlc3VsdFdpdGhSZXBhaXI8UkVTVUxUPihcbiAgcmVzdWx0OiBzdHJpbmcsXG4gIG91dHB1dFN0cmF0ZWd5OiBPdXRwdXRTdHJhdGVneTxhbnksIFJFU1VMVCwgYW55PixcbiAgcmVwYWlyVGV4dDogUmVwYWlyVGV4dEZ1bmN0aW9uIHwgdW5kZWZpbmVkLFxuICBjb250ZXh0OiB7XG4gICAgcmVzcG9uc2U6IExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhO1xuICAgIHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2U7XG4gICAgZmluaXNoUmVhc29uOiBGaW5pc2hSZWFzb247XG4gIH0sXG4pOiBQcm9taXNlPFJFU1VMVD4ge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBwYXJzZUFuZFZhbGlkYXRlT2JqZWN0UmVzdWx0KHJlc3VsdCwgb3V0cHV0U3RyYXRlZ3ksIGNvbnRleHQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChcbiAgICAgIHJlcGFpclRleHQgIT0gbnVsbCAmJlxuICAgICAgTm9PYmplY3RHZW5lcmF0ZWRFcnJvci5pc0luc3RhbmNlKGVycm9yKSAmJlxuICAgICAgKEpTT05QYXJzZUVycm9yLmlzSW5zdGFuY2UoZXJyb3IuY2F1c2UpIHx8XG4gICAgICAgIFR5cGVWYWxpZGF0aW9uRXJyb3IuaXNJbnN0YW5jZShlcnJvci5jYXVzZSkpXG4gICAgKSB7XG4gICAgICBjb25zdCByZXBhaXJlZFRleHQgPSBhd2FpdCByZXBhaXJUZXh0KHtcbiAgICAgICAgdGV4dDogcmVzdWx0LFxuICAgICAgICBlcnJvcjogZXJyb3IuY2F1c2UsXG4gICAgICB9KTtcbiAgICAgIGlmIChyZXBhaXJlZFRleHQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXdhaXQgcGFyc2VBbmRWYWxpZGF0ZU9iamVjdFJlc3VsdChcbiAgICAgICAgcmVwYWlyZWRUZXh0LFxuICAgICAgICBvdXRwdXRTdHJhdGVneSxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICk7XG4gICAgfVxuICAgIHRocm93IGVycm9yO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgU2NoZW1hIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IEludmFsaWRBcmd1bWVudEVycm9yIH0gZnJvbSAnLi4vZXJyb3IvaW52YWxpZC1hcmd1bWVudC1lcnJvcic7XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZU9iamVjdEdlbmVyYXRpb25JbnB1dCh7XG4gIG91dHB1dCxcbiAgc2NoZW1hLFxuICBzY2hlbWFOYW1lLFxuICBzY2hlbWFEZXNjcmlwdGlvbixcbiAgZW51bVZhbHVlcyxcbn06IHtcbiAgb3V0cHV0PzogJ29iamVjdCcgfCAnYXJyYXknIHwgJ2VudW0nIHwgJ25vLXNjaGVtYSc7XG4gIHNjaGVtYT86IHo0LmNvcmUuJFpvZFR5cGUgfCB6My5TY2hlbWE8YW55LCB6My5ab2RUeXBlRGVmLCBhbnk+IHwgU2NoZW1hPGFueT47XG4gIHNjaGVtYU5hbWU/OiBzdHJpbmc7XG4gIHNjaGVtYURlc2NyaXB0aW9uPzogc3RyaW5nO1xuICBlbnVtVmFsdWVzPzogQXJyYXk8dW5rbm93bj47XG59KSB7XG4gIGlmIChcbiAgICBvdXRwdXQgIT0gbnVsbCAmJlxuICAgIG91dHB1dCAhPT0gJ29iamVjdCcgJiZcbiAgICBvdXRwdXQgIT09ICdhcnJheScgJiZcbiAgICBvdXRwdXQgIT09ICdlbnVtJyAmJlxuICAgIG91dHB1dCAhPT0gJ25vLXNjaGVtYSdcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgIHBhcmFtZXRlcjogJ291dHB1dCcsXG4gICAgICB2YWx1ZTogb3V0cHV0LFxuICAgICAgbWVzc2FnZTogJ0ludmFsaWQgb3V0cHV0IHR5cGUuJyxcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChvdXRwdXQgPT09ICduby1zY2hlbWEnKSB7XG4gICAgaWYgKHNjaGVtYSAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdzY2hlbWEnLFxuICAgICAgICB2YWx1ZTogc2NoZW1hLFxuICAgICAgICBtZXNzYWdlOiAnU2NoZW1hIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIG5vLXNjaGVtYSBvdXRwdXQuJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChzY2hlbWFEZXNjcmlwdGlvbiAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdzY2hlbWFEZXNjcmlwdGlvbicsXG4gICAgICAgIHZhbHVlOiBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICAgICAgbWVzc2FnZTogJ1NjaGVtYSBkZXNjcmlwdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGZvciBuby1zY2hlbWEgb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoc2NoZW1hTmFtZSAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdzY2hlbWFOYW1lJyxcbiAgICAgICAgdmFsdWU6IHNjaGVtYU5hbWUsXG4gICAgICAgIG1lc3NhZ2U6ICdTY2hlbWEgbmFtZSBpcyBub3Qgc3VwcG9ydGVkIGZvciBuby1zY2hlbWEgb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZW51bVZhbHVlcyAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdlbnVtVmFsdWVzJyxcbiAgICAgICAgdmFsdWU6IGVudW1WYWx1ZXMsXG4gICAgICAgIG1lc3NhZ2U6ICdFbnVtIHZhbHVlcyBhcmUgbm90IHN1cHBvcnRlZCBmb3Igbm8tc2NoZW1hIG91dHB1dC4nLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG91dHB1dCA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAoc2NoZW1hID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgIHBhcmFtZXRlcjogJ3NjaGVtYScsXG4gICAgICAgIHZhbHVlOiBzY2hlbWEsXG4gICAgICAgIG1lc3NhZ2U6ICdTY2hlbWEgaXMgcmVxdWlyZWQgZm9yIG9iamVjdCBvdXRwdXQuJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChlbnVtVmFsdWVzICE9IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgIHBhcmFtZXRlcjogJ2VudW1WYWx1ZXMnLFxuICAgICAgICB2YWx1ZTogZW51bVZhbHVlcyxcbiAgICAgICAgbWVzc2FnZTogJ0VudW0gdmFsdWVzIGFyZSBub3Qgc3VwcG9ydGVkIGZvciBvYmplY3Qgb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBpZiAob3V0cHV0ID09PSAnYXJyYXknKSB7XG4gICAgaWYgKHNjaGVtYSA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdzY2hlbWEnLFxuICAgICAgICB2YWx1ZTogc2NoZW1hLFxuICAgICAgICBtZXNzYWdlOiAnRWxlbWVudCBzY2hlbWEgaXMgcmVxdWlyZWQgZm9yIGFycmF5IG91dHB1dC4nLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGVudW1WYWx1ZXMgIT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAnZW51bVZhbHVlcycsXG4gICAgICAgIHZhbHVlOiBlbnVtVmFsdWVzLFxuICAgICAgICBtZXNzYWdlOiAnRW51bSB2YWx1ZXMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIGFycmF5IG91dHB1dC4nLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG91dHB1dCA9PT0gJ2VudW0nKSB7XG4gICAgaWYgKHNjaGVtYSAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdzY2hlbWEnLFxuICAgICAgICB2YWx1ZTogc2NoZW1hLFxuICAgICAgICBtZXNzYWdlOiAnU2NoZW1hIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIGVudW0gb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoc2NoZW1hRGVzY3JpcHRpb24gIT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEludmFsaWRBcmd1bWVudEVycm9yKHtcbiAgICAgICAgcGFyYW1ldGVyOiAnc2NoZW1hRGVzY3JpcHRpb24nLFxuICAgICAgICB2YWx1ZTogc2NoZW1hRGVzY3JpcHRpb24sXG4gICAgICAgIG1lc3NhZ2U6ICdTY2hlbWEgZGVzY3JpcHRpb24gaXMgbm90IHN1cHBvcnRlZCBmb3IgZW51bSBvdXRwdXQuJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChzY2hlbWFOYW1lICE9IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgIHBhcmFtZXRlcjogJ3NjaGVtYU5hbWUnLFxuICAgICAgICB2YWx1ZTogc2NoZW1hTmFtZSxcbiAgICAgICAgbWVzc2FnZTogJ1NjaGVtYSBuYW1lIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIGVudW0gb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZW51bVZhbHVlcyA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBwYXJhbWV0ZXI6ICdlbnVtVmFsdWVzJyxcbiAgICAgICAgdmFsdWU6IGVudW1WYWx1ZXMsXG4gICAgICAgIG1lc3NhZ2U6ICdFbnVtIHZhbHVlcyBhcmUgcmVxdWlyZWQgZm9yIGVudW0gb3V0cHV0LicsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIGVudW1WYWx1ZXMpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICAgICAgcGFyYW1ldGVyOiAnZW51bVZhbHVlcycsXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgbWVzc2FnZTogJ0VudW0gdmFsdWVzIG11c3QgYmUgc3RyaW5ncy4nLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQge1xuICBKU09OVmFsdWUsXG4gIExhbmd1YWdlTW9kZWxWMkNhbGxXYXJuaW5nLFxuICBMYW5ndWFnZU1vZGVsVjJGaW5pc2hSZWFzb24sXG4gIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQsXG4gIExhbmd1YWdlTW9kZWxWMlVzYWdlLFxuICBTaGFyZWRWMlByb3ZpZGVyTWV0YWRhdGEsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlSWRHZW5lcmF0b3IsXG4gIFByb3ZpZGVyT3B0aW9ucyxcbiAgdHlwZSBJbmZlclNjaGVtYSxcbiAgdHlwZSBTY2hlbWEsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgU2VydmVyUmVzcG9uc2UgfSBmcm9tICdodHRwJztcbmltcG9ydCAqIGFzIHozIGZyb20gJ3pvZC92Myc7XG5pbXBvcnQgKiBhcyB6NCBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgcmVzb2x2ZUxhbmd1YWdlTW9kZWwgfSBmcm9tICcuLi9tb2RlbC9yZXNvbHZlLW1vZGVsJztcbmltcG9ydCB7IENhbGxTZXR0aW5ncyB9IGZyb20gJy4uL3Byb21wdC9jYWxsLXNldHRpbmdzJztcbmltcG9ydCB7IGNvbnZlcnRUb0xhbmd1YWdlTW9kZWxQcm9tcHQgfSBmcm9tICcuLi9wcm9tcHQvY29udmVydC10by1sYW5ndWFnZS1tb2RlbC1wcm9tcHQnO1xuaW1wb3J0IHsgcHJlcGFyZUNhbGxTZXR0aW5ncyB9IGZyb20gJy4uL3Byb21wdC9wcmVwYXJlLWNhbGwtc2V0dGluZ3MnO1xuaW1wb3J0IHsgUHJvbXB0IH0gZnJvbSAnLi4vcHJvbXB0L3Byb21wdCc7XG5pbXBvcnQgeyBzdGFuZGFyZGl6ZVByb21wdCB9IGZyb20gJy4uL3Byb21wdC9zdGFuZGFyZGl6ZS1wcm9tcHQnO1xuaW1wb3J0IHsgd3JhcEdhdGV3YXlFcnJvciB9IGZyb20gJy4uL3Byb21wdC93cmFwLWdhdGV3YXktZXJyb3InO1xuaW1wb3J0IHsgYXNzZW1ibGVPcGVyYXRpb25OYW1lIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2Fzc2VtYmxlLW9wZXJhdGlvbi1uYW1lJztcbmltcG9ydCB7IGdldEJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L2dldC1iYXNlLXRlbGVtZXRyeS1hdHRyaWJ1dGVzJztcbmltcG9ydCB7IGdldFRyYWNlciB9IGZyb20gJy4uL3RlbGVtZXRyeS9nZXQtdHJhY2VyJztcbmltcG9ydCB7IHJlY29yZFNwYW4gfSBmcm9tICcuLi90ZWxlbWV0cnkvcmVjb3JkLXNwYW4nO1xuaW1wb3J0IHsgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyB9IGZyb20gJy4uL3RlbGVtZXRyeS9zZWxlY3QtdGVsZW1ldHJ5LWF0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgc3RyaW5naWZ5Rm9yVGVsZW1ldHJ5IH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3N0cmluZ2lmeS1mb3ItdGVsZW1ldHJ5JztcbmltcG9ydCB7IFRlbGVtZXRyeVNldHRpbmdzIH0gZnJvbSAnLi4vdGVsZW1ldHJ5L3RlbGVtZXRyeS1zZXR0aW5ncyc7XG5pbXBvcnQgeyBjcmVhdGVUZXh0U3RyZWFtUmVzcG9uc2UgfSBmcm9tICcuLi90ZXh0LXN0cmVhbS9jcmVhdGUtdGV4dC1zdHJlYW0tcmVzcG9uc2UnO1xuaW1wb3J0IHsgcGlwZVRleHRTdHJlYW1Ub1Jlc3BvbnNlIH0gZnJvbSAnLi4vdGV4dC1zdHJlYW0vcGlwZS10ZXh0LXN0cmVhbS10by1yZXNwb25zZSc7XG5pbXBvcnQge1xuICBDYWxsV2FybmluZyxcbiAgRmluaXNoUmVhc29uLFxuICBMYW5ndWFnZU1vZGVsLFxufSBmcm9tICcuLi90eXBlcy9sYW5ndWFnZS1tb2RlbCc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVxdWVzdE1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwtcmVxdWVzdC1tZXRhZGF0YSc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsUmVzcG9uc2VNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsLXJlc3BvbnNlLW1ldGFkYXRhJztcbmltcG9ydCB7IFByb3ZpZGVyTWV0YWRhdGEgfSBmcm9tICcuLi90eXBlcy9wcm92aWRlci1tZXRhZGF0YSc7XG5pbXBvcnQgeyBMYW5ndWFnZU1vZGVsVXNhZ2UgfSBmcm9tICcuLi90eXBlcy91c2FnZSc7XG5pbXBvcnQgeyBEZWVwUGFydGlhbCwgaXNEZWVwRXF1YWxEYXRhLCBwYXJzZVBhcnRpYWxKc29uIH0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQge1xuICBBc3luY0l0ZXJhYmxlU3RyZWFtLFxuICBjcmVhdGVBc3luY0l0ZXJhYmxlU3RyZWFtLFxufSBmcm9tICcuLi91dGlsL2FzeW5jLWl0ZXJhYmxlLXN0cmVhbSc7XG5pbXBvcnQgeyBjcmVhdGVTdGl0Y2hhYmxlU3RyZWFtIH0gZnJvbSAnLi4vdXRpbC9jcmVhdGUtc3RpdGNoYWJsZS1zdHJlYW0nO1xuaW1wb3J0IHsgRGVsYXllZFByb21pc2UgfSBmcm9tICcuLi91dGlsL2RlbGF5ZWQtcHJvbWlzZSc7XG5pbXBvcnQgeyBub3cgYXMgb3JpZ2luYWxOb3cgfSBmcm9tICcuLi91dGlsL25vdyc7XG5pbXBvcnQgeyBwcmVwYXJlUmV0cmllcyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1yZXRyaWVzJztcbmltcG9ydCB7IGdldE91dHB1dFN0cmF0ZWd5LCBPdXRwdXRTdHJhdGVneSB9IGZyb20gJy4vb3V0cHV0LXN0cmF0ZWd5JztcbmltcG9ydCB7IHBhcnNlQW5kVmFsaWRhdGVPYmplY3RSZXN1bHRXaXRoUmVwYWlyIH0gZnJvbSAnLi9wYXJzZS1hbmQtdmFsaWRhdGUtb2JqZWN0LXJlc3VsdCc7XG5pbXBvcnQgeyBSZXBhaXJUZXh0RnVuY3Rpb24gfSBmcm9tICcuL3JlcGFpci10ZXh0JztcbmltcG9ydCB7IE9iamVjdFN0cmVhbVBhcnQsIFN0cmVhbU9iamVjdFJlc3VsdCB9IGZyb20gJy4vc3RyZWFtLW9iamVjdC1yZXN1bHQnO1xuaW1wb3J0IHsgdmFsaWRhdGVPYmplY3RHZW5lcmF0aW9uSW5wdXQgfSBmcm9tICcuL3ZhbGlkYXRlLW9iamVjdC1nZW5lcmF0aW9uLWlucHV0JztcblxuY29uc3Qgb3JpZ2luYWxHZW5lcmF0ZUlkID0gY3JlYXRlSWRHZW5lcmF0b3IoeyBwcmVmaXg6ICdhaW9iaicsIHNpemU6IDI0IH0pO1xuXG4vKipcbkNhbGxiYWNrIHRoYXQgaXMgc2V0IHVzaW5nIHRoZSBgb25FcnJvcmAgb3B0aW9uLlxuXG5AcGFyYW0gZXZlbnQgLSBUaGUgZXZlbnQgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGNhbGxiYWNrLlxuICovXG5leHBvcnQgdHlwZSBTdHJlYW1PYmplY3RPbkVycm9yQ2FsbGJhY2sgPSAoZXZlbnQ6IHtcbiAgZXJyb3I6IHVua25vd247XG59KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZDtcblxuLyoqXG5DYWxsYmFjayB0aGF0IGlzIHNldCB1c2luZyB0aGUgYG9uRmluaXNoYCBvcHRpb24uXG5cbkBwYXJhbSBldmVudCAtIFRoZSBldmVudCB0aGF0IGlzIHBhc3NlZCB0byB0aGUgY2FsbGJhY2suXG4gKi9cbmV4cG9ydCB0eXBlIFN0cmVhbU9iamVjdE9uRmluaXNoQ2FsbGJhY2s8UkVTVUxUPiA9IChldmVudDoge1xuICAvKipcblRoZSB0b2tlbiB1c2FnZSBvZiB0aGUgZ2VuZXJhdGVkIHJlc3BvbnNlLlxuKi9cbiAgdXNhZ2U6IExhbmd1YWdlTW9kZWxVc2FnZTtcblxuICAvKipcblRoZSBnZW5lcmF0ZWQgb2JqZWN0LiBDYW4gYmUgdW5kZWZpbmVkIGlmIHRoZSBmaW5hbCBvYmplY3QgZG9lcyBub3QgbWF0Y2ggdGhlIHNjaGVtYS5cbiovXG4gIG9iamVjdDogUkVTVUxUIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuT3B0aW9uYWwgZXJyb3Igb2JqZWN0LiBUaGlzIGlzIGUuZy4gYSBUeXBlVmFsaWRhdGlvbkVycm9yIHdoZW4gdGhlIGZpbmFsIG9iamVjdCBkb2VzIG5vdCBtYXRjaCB0aGUgc2NoZW1hLlxuKi9cbiAgZXJyb3I6IHVua25vd24gfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG5SZXNwb25zZSBtZXRhZGF0YS5cbiAqL1xuICByZXNwb25zZTogTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGE7XG5cbiAgLyoqXG5XYXJuaW5ncyBmcm9tIHRoZSBtb2RlbCBwcm92aWRlciAoZS5nLiB1bnN1cHBvcnRlZCBzZXR0aW5ncykuXG4qL1xuICB3YXJuaW5ncz86IENhbGxXYXJuaW5nW107XG5cbiAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhLiBUaGV5IGFyZSBwYXNzZWQgdGhyb3VnaFxudG8gdGhlIHByb3ZpZGVyIGZyb20gdGhlIEFJIFNESyBhbmQgZW5hYmxlIHByb3ZpZGVyLXNwZWNpZmljXG5mdW5jdGlvbmFsaXR5IHRoYXQgY2FuIGJlIGZ1bGx5IGVuY2Fwc3VsYXRlZCBpbiB0aGUgcHJvdmlkZXIuXG4qL1xuICBwcm92aWRlck1ldGFkYXRhOiBQcm92aWRlck1ldGFkYXRhIHwgdW5kZWZpbmVkO1xufSkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQ7XG5cbi8qKlxuR2VuZXJhdGUgYSBzdHJ1Y3R1cmVkLCB0eXBlZCBvYmplY3QgZm9yIGEgZ2l2ZW4gcHJvbXB0IGFuZCBzY2hlbWEgdXNpbmcgYSBsYW5ndWFnZSBtb2RlbC5cblxuVGhpcyBmdW5jdGlvbiBzdHJlYW1zIHRoZSBvdXRwdXQuIElmIHlvdSBkbyBub3Qgd2FudCB0byBzdHJlYW0gdGhlIG91dHB1dCwgdXNlIGBnZW5lcmF0ZU9iamVjdGAgaW5zdGVhZC5cblxuQHBhcmFtIG1vZGVsIC0gVGhlIGxhbmd1YWdlIG1vZGVsIHRvIHVzZS5cbkBwYXJhbSB0b29scyAtIFRvb2xzIHRoYXQgYXJlIGFjY2Vzc2libGUgdG8gYW5kIGNhbiBiZSBjYWxsZWQgYnkgdGhlIG1vZGVsLiBUaGUgbW9kZWwgbmVlZHMgdG8gc3VwcG9ydCBjYWxsaW5nIHRvb2xzLlxuXG5AcGFyYW0gc3lzdGVtIC0gQSBzeXN0ZW0gbWVzc2FnZSB0aGF0IHdpbGwgYmUgcGFydCBvZiB0aGUgcHJvbXB0LlxuQHBhcmFtIHByb21wdCAtIEEgc2ltcGxlIHRleHQgcHJvbXB0LiBZb3UgY2FuIGVpdGhlciB1c2UgYHByb21wdGAgb3IgYG1lc3NhZ2VzYCBidXQgbm90IGJvdGguXG5AcGFyYW0gbWVzc2FnZXMgLSBBIGxpc3Qgb2YgbWVzc2FnZXMuIFlvdSBjYW4gZWl0aGVyIHVzZSBgcHJvbXB0YCBvciBgbWVzc2FnZXNgIGJ1dCBub3QgYm90aC5cblxuQHBhcmFtIG1heE91dHB1dFRva2VucyAtIE1heGltdW0gbnVtYmVyIG9mIHRva2VucyB0byBnZW5lcmF0ZS5cbkBwYXJhbSB0ZW1wZXJhdHVyZSAtIFRlbXBlcmF0dXJlIHNldHRpbmcuXG5UaGUgdmFsdWUgaXMgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyLiBUaGUgcmFuZ2UgZGVwZW5kcyBvbiB0aGUgcHJvdmlkZXIgYW5kIG1vZGVsLlxuSXQgaXMgcmVjb21tZW5kZWQgdG8gc2V0IGVpdGhlciBgdGVtcGVyYXR1cmVgIG9yIGB0b3BQYCwgYnV0IG5vdCBib3RoLlxuQHBhcmFtIHRvcFAgLSBOdWNsZXVzIHNhbXBsaW5nLlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkl0IGlzIHJlY29tbWVuZGVkIHRvIHNldCBlaXRoZXIgYHRlbXBlcmF0dXJlYCBvciBgdG9wUGAsIGJ1dCBub3QgYm90aC5cbkBwYXJhbSB0b3BLIC0gT25seSBzYW1wbGUgZnJvbSB0aGUgdG9wIEsgb3B0aW9ucyBmb3IgZWFjaCBzdWJzZXF1ZW50IHRva2VuLlxuVXNlZCB0byByZW1vdmUgXCJsb25nIHRhaWxcIiBsb3cgcHJvYmFiaWxpdHkgcmVzcG9uc2VzLlxuUmVjb21tZW5kZWQgZm9yIGFkdmFuY2VkIHVzZSBjYXNlcyBvbmx5LiBZb3UgdXN1YWxseSBvbmx5IG5lZWQgdG8gdXNlIHRlbXBlcmF0dXJlLlxuQHBhcmFtIHByZXNlbmNlUGVuYWx0eSAtIFByZXNlbmNlIHBlbmFsdHkgc2V0dGluZy5cbkl0IGFmZmVjdHMgdGhlIGxpa2VsaWhvb2Qgb2YgdGhlIG1vZGVsIHRvIHJlcGVhdCBpbmZvcm1hdGlvbiB0aGF0IGlzIGFscmVhZHkgaW4gdGhlIHByb21wdC5cblRoZSB2YWx1ZSBpcyBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXIuIFRoZSByYW5nZSBkZXBlbmRzIG9uIHRoZSBwcm92aWRlciBhbmQgbW9kZWwuXG5AcGFyYW0gZnJlcXVlbmN5UGVuYWx0eSAtIEZyZXF1ZW5jeSBwZW5hbHR5IHNldHRpbmcuXG5JdCBhZmZlY3RzIHRoZSBsaWtlbGlob29kIG9mIHRoZSBtb2RlbCB0byByZXBlYXRlZGx5IHVzZSB0aGUgc2FtZSB3b3JkcyBvciBwaHJhc2VzLlxuVGhlIHZhbHVlIGlzIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlci4gVGhlIHJhbmdlIGRlcGVuZHMgb24gdGhlIHByb3ZpZGVyIGFuZCBtb2RlbC5cbkBwYXJhbSBzdG9wU2VxdWVuY2VzIC0gU3RvcCBzZXF1ZW5jZXMuXG5JZiBzZXQsIHRoZSBtb2RlbCB3aWxsIHN0b3AgZ2VuZXJhdGluZyB0ZXh0IHdoZW4gb25lIG9mIHRoZSBzdG9wIHNlcXVlbmNlcyBpcyBnZW5lcmF0ZWQuXG5AcGFyYW0gc2VlZCAtIFRoZSBzZWVkIChpbnRlZ2VyKSB0byB1c2UgZm9yIHJhbmRvbSBzYW1wbGluZy5cbklmIHNldCBhbmQgc3VwcG9ydGVkIGJ5IHRoZSBtb2RlbCwgY2FsbHMgd2lsbCBnZW5lcmF0ZSBkZXRlcm1pbmlzdGljIHJlc3VsdHMuXG5cbkBwYXJhbSBtYXhSZXRyaWVzIC0gTWF4aW11bSBudW1iZXIgb2YgcmV0cmllcy4gU2V0IHRvIDAgdG8gZGlzYWJsZSByZXRyaWVzLiBEZWZhdWx0OiAyLlxuQHBhcmFtIGFib3J0U2lnbmFsIC0gQW4gb3B0aW9uYWwgYWJvcnQgc2lnbmFsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2FuY2VsIHRoZSBjYWxsLlxuQHBhcmFtIGhlYWRlcnMgLSBBZGRpdGlvbmFsIEhUVFAgaGVhZGVycyB0byBiZSBzZW50IHdpdGggdGhlIHJlcXVlc3QuIE9ubHkgYXBwbGljYWJsZSBmb3IgSFRUUC1iYXNlZCBwcm92aWRlcnMuXG5cbkBwYXJhbSBzY2hlbWEgLSBUaGUgc2NoZW1hIG9mIHRoZSBvYmplY3QgdGhhdCB0aGUgbW9kZWwgc2hvdWxkIGdlbmVyYXRlLlxuQHBhcmFtIHNjaGVtYU5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBvdXRwdXQgdGhhdCBzaG91bGQgYmUgZ2VuZXJhdGVkLlxuVXNlZCBieSBzb21lIHByb3ZpZGVycyBmb3IgYWRkaXRpb25hbCBMTE0gZ3VpZGFuY2UsIGUuZy5cbnZpYSB0b29sIG9yIHNjaGVtYSBuYW1lLlxuQHBhcmFtIHNjaGVtYURlc2NyaXB0aW9uIC0gT3B0aW9uYWwgZGVzY3JpcHRpb24gb2YgdGhlIG91dHB1dCB0aGF0IHNob3VsZCBiZSBnZW5lcmF0ZWQuXG5Vc2VkIGJ5IHNvbWUgcHJvdmlkZXJzIGZvciBhZGRpdGlvbmFsIExMTSBndWlkYW5jZSwgZS5nLlxudmlhIHRvb2wgb3Igc2NoZW1hIGRlc2NyaXB0aW9uLlxuXG5AcGFyYW0gb3V0cHV0IC0gVGhlIHR5cGUgb2YgdGhlIG91dHB1dC5cblxuLSAnb2JqZWN0JzogVGhlIG91dHB1dCBpcyBhbiBvYmplY3QuXG4tICdhcnJheSc6IFRoZSBvdXRwdXQgaXMgYW4gYXJyYXkuXG4tICdlbnVtJzogVGhlIG91dHB1dCBpcyBhbiBlbnVtLlxuLSAnbm8tc2NoZW1hJzogVGhlIG91dHB1dCBpcyBub3QgYSBzY2hlbWEuXG5cbkBwYXJhbSBleHBlcmltZW50YWxfdGVsZW1ldHJ5IC0gT3B0aW9uYWwgdGVsZW1ldHJ5IGNvbmZpZ3VyYXRpb24gKGV4cGVyaW1lbnRhbCkuXG5cbkBwYXJhbSBwcm92aWRlck9wdGlvbnMgLSBBZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG50byB0aGUgcHJvdmlkZXIgZnJvbSB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbmZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cblxuQHJldHVybnNcbkEgcmVzdWx0IG9iamVjdCBmb3IgYWNjZXNzaW5nIHRoZSBwYXJ0aWFsIG9iamVjdCBzdHJlYW0gYW5kIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJlYW1PYmplY3Q8XG4gIFNDSEVNQSBleHRlbmRzXG4gICAgfCB6My5TY2hlbWFcbiAgICB8IHo0LmNvcmUuJFpvZFR5cGVcbiAgICB8IFNjaGVtYSA9IHo0LmNvcmUuJFpvZFR5cGU8SlNPTlZhbHVlPixcbiAgT1VUUFVUIGV4dGVuZHNcbiAgICB8ICdvYmplY3QnXG4gICAgfCAnYXJyYXknXG4gICAgfCAnZW51bSdcbiAgICB8ICduby1zY2hlbWEnID0gSW5mZXJTY2hlbWE8U0NIRU1BPiBleHRlbmRzIHN0cmluZyA/ICdlbnVtJyA6ICdvYmplY3QnLFxuICBSRVNVTFQgPSBPVVRQVVQgZXh0ZW5kcyAnYXJyYXknXG4gICAgPyBBcnJheTxJbmZlclNjaGVtYTxTQ0hFTUE+PlxuICAgIDogSW5mZXJTY2hlbWE8U0NIRU1BPixcbj4oXG4gIG9wdGlvbnM6IE9taXQ8Q2FsbFNldHRpbmdzLCAnc3RvcFNlcXVlbmNlcyc+ICZcbiAgICBQcm9tcHQgJlxuICAgIChPVVRQVVQgZXh0ZW5kcyAnZW51bSdcbiAgICAgID8ge1xuICAgICAgICAgIC8qKlxuVGhlIGVudW0gdmFsdWVzIHRoYXQgdGhlIG1vZGVsIHNob3VsZCB1c2UuXG4gICAgICAgICovXG4gICAgICAgICAgZW51bTogQXJyYXk8UkVTVUxUPjtcbiAgICAgICAgICBtb2RlPzogJ2pzb24nO1xuICAgICAgICAgIG91dHB1dDogJ2VudW0nO1xuICAgICAgICB9XG4gICAgICA6IE9VVFBVVCBleHRlbmRzICduby1zY2hlbWEnXG4gICAgICAgID8ge31cbiAgICAgICAgOiB7XG4gICAgICAgICAgICAvKipcblRoZSBzY2hlbWEgb2YgdGhlIG9iamVjdCB0aGF0IHRoZSBtb2RlbCBzaG91bGQgZ2VuZXJhdGUuXG4gICAgICAqL1xuICAgICAgICAgICAgc2NoZW1hOiBTQ0hFTUE7XG5cbiAgICAgICAgICAgIC8qKlxuT3B0aW9uYWwgbmFtZSBvZiB0aGUgb3V0cHV0IHRoYXQgc2hvdWxkIGJlIGdlbmVyYXRlZC5cblVzZWQgYnkgc29tZSBwcm92aWRlcnMgZm9yIGFkZGl0aW9uYWwgTExNIGd1aWRhbmNlLCBlLmcuXG52aWEgdG9vbCBvciBzY2hlbWEgbmFtZS5cbiAgICAgICovXG4gICAgICAgICAgICBzY2hlbWFOYW1lPzogc3RyaW5nO1xuXG4gICAgICAgICAgICAvKipcbk9wdGlvbmFsIGRlc2NyaXB0aW9uIG9mIHRoZSBvdXRwdXQgdGhhdCBzaG91bGQgYmUgZ2VuZXJhdGVkLlxuVXNlZCBieSBzb21lIHByb3ZpZGVycyBmb3IgYWRkaXRpb25hbCBMTE0gZ3VpZGFuY2UsIGUuZy5cbnZpYSB0b29sIG9yIHNjaGVtYSBkZXNjcmlwdGlvbi5cbiAgICAgICovXG4gICAgICAgICAgICBzY2hlbWFEZXNjcmlwdGlvbj86IHN0cmluZztcblxuICAgICAgICAgICAgLyoqXG5UaGUgbW9kZSB0byB1c2UgZm9yIG9iamVjdCBnZW5lcmF0aW9uLlxuXG5UaGUgc2NoZW1hIGlzIGNvbnZlcnRlZCBpbnRvIGEgSlNPTiBzY2hlbWEgYW5kIHVzZWQgaW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgd2F5c1xuXG4tICdhdXRvJzogVGhlIHByb3ZpZGVyIHdpbGwgY2hvb3NlIHRoZSBiZXN0IG1vZGUgZm9yIHRoZSBtb2RlbC5cbi0gJ3Rvb2wnOiBBIHRvb2wgd2l0aCB0aGUgSlNPTiBzY2hlbWEgYXMgcGFyYW1ldGVycyBpcyBwcm92aWRlZCBhbmQgdGhlIHByb3ZpZGVyIGlzIGluc3RydWN0ZWQgdG8gdXNlIGl0LlxuLSAnanNvbic6IFRoZSBKU09OIHNjaGVtYSBhbmQgYW4gaW5zdHJ1Y3Rpb24gYXJlIGluamVjdGVkIGludG8gdGhlIHByb21wdC4gSWYgdGhlIHByb3ZpZGVyIHN1cHBvcnRzIEpTT04gbW9kZSwgaXQgaXMgZW5hYmxlZC4gSWYgdGhlIHByb3ZpZGVyIHN1cHBvcnRzIEpTT04gZ3JhbW1hcnMsIHRoZSBncmFtbWFyIGlzIHVzZWQuXG5cblBsZWFzZSBub3RlIHRoYXQgbW9zdCBwcm92aWRlcnMgZG8gbm90IHN1cHBvcnQgYWxsIG1vZGVzLlxuXG5EZWZhdWx0IGFuZCByZWNvbW1lbmRlZDogJ2F1dG8nIChiZXN0IG1vZGUgZm9yIHRoZSBtb2RlbCkuXG4gICAgICAqL1xuICAgICAgICAgICAgbW9kZT86ICdhdXRvJyB8ICdqc29uJyB8ICd0b29sJztcbiAgICAgICAgICB9KSAmIHtcbiAgICAgIG91dHB1dD86IE9VVFBVVDtcblxuICAgICAgLyoqXG5UaGUgbGFuZ3VhZ2UgbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICAgICAgbW9kZWw6IExhbmd1YWdlTW9kZWw7XG5cbiAgICAgIC8qKlxuQSBmdW5jdGlvbiB0aGF0IGF0dGVtcHRzIHRvIHJlcGFpciB0aGUgcmF3IG91dHB1dCBvZiB0aGUgbW9kZWxcbnRvIGVuYWJsZSBKU09OIHBhcnNpbmcuXG4gICAgICAgKi9cbiAgICAgIGV4cGVyaW1lbnRhbF9yZXBhaXJUZXh0PzogUmVwYWlyVGV4dEZ1bmN0aW9uO1xuXG4gICAgICAvKipcbk9wdGlvbmFsIHRlbGVtZXRyeSBjb25maWd1cmF0aW9uIChleHBlcmltZW50YWwpLlxuICAgICAgICovXG5cbiAgICAgIGV4cGVyaW1lbnRhbF90ZWxlbWV0cnk/OiBUZWxlbWV0cnlTZXR0aW5ncztcblxuICAgICAgLyoqXG5BZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMuIFRoZXkgYXJlIHBhc3NlZCB0aHJvdWdoXG50byB0aGUgcHJvdmlkZXIgZnJvbSB0aGUgQUkgU0RLIGFuZCBlbmFibGUgcHJvdmlkZXItc3BlY2lmaWNcbmZ1bmN0aW9uYWxpdHkgdGhhdCBjYW4gYmUgZnVsbHkgZW5jYXBzdWxhdGVkIGluIHRoZSBwcm92aWRlci5cbiAqL1xuICAgICAgcHJvdmlkZXJPcHRpb25zPzogUHJvdmlkZXJPcHRpb25zO1xuXG4gICAgICAvKipcbkNhbGxiYWNrIHRoYXQgaXMgaW52b2tlZCB3aGVuIGFuIGVycm9yIG9jY3VycyBkdXJpbmcgc3RyZWFtaW5nLlxuWW91IGNhbiB1c2UgaXQgdG8gbG9nIGVycm9ycy5cblRoZSBzdHJlYW0gcHJvY2Vzc2luZyB3aWxsIHBhdXNlIHVudGlsIHRoZSBjYWxsYmFjayBwcm9taXNlIGlzIHJlc29sdmVkLlxuICAgICAqL1xuICAgICAgb25FcnJvcj86IFN0cmVhbU9iamVjdE9uRXJyb3JDYWxsYmFjaztcblxuICAgICAgLyoqXG5DYWxsYmFjayB0aGF0IGlzIGNhbGxlZCB3aGVuIHRoZSBMTE0gcmVzcG9uc2UgYW5kIHRoZSBmaW5hbCBvYmplY3QgdmFsaWRhdGlvbiBhcmUgZmluaXNoZWQuXG4qL1xuICAgICAgb25GaW5pc2g/OiBTdHJlYW1PYmplY3RPbkZpbmlzaENhbGxiYWNrPFJFU1VMVD47XG5cbiAgICAgIC8qKlxuICAgICAgICogSW50ZXJuYWwuIEZvciB0ZXN0IHVzZSBvbmx5LiBNYXkgY2hhbmdlIHdpdGhvdXQgbm90aWNlLlxuICAgICAgICovXG4gICAgICBfaW50ZXJuYWw/OiB7XG4gICAgICAgIGdlbmVyYXRlSWQ/OiAoKSA9PiBzdHJpbmc7XG4gICAgICAgIGN1cnJlbnREYXRlPzogKCkgPT4gRGF0ZTtcbiAgICAgICAgbm93PzogKCkgPT4gbnVtYmVyO1xuICAgICAgfTtcbiAgICB9LFxuKTogU3RyZWFtT2JqZWN0UmVzdWx0PFxuICBPVVRQVVQgZXh0ZW5kcyAnZW51bSdcbiAgICA/IHN0cmluZ1xuICAgIDogT1VUUFVUIGV4dGVuZHMgJ2FycmF5J1xuICAgICAgPyBSRVNVTFRcbiAgICAgIDogRGVlcFBhcnRpYWw8UkVTVUxUPixcbiAgT1VUUFVUIGV4dGVuZHMgJ2FycmF5JyA/IFJFU1VMVCA6IFJFU1VMVCxcbiAgT1VUUFVUIGV4dGVuZHMgJ2FycmF5J1xuICAgID8gUkVTVUxUIGV4dGVuZHMgQXJyYXk8aW5mZXIgVT5cbiAgICAgID8gQXN5bmNJdGVyYWJsZVN0cmVhbTxVPlxuICAgICAgOiBuZXZlclxuICAgIDogbmV2ZXJcbj4ge1xuICBjb25zdCB7XG4gICAgbW9kZWwsXG4gICAgb3V0cHV0ID0gJ29iamVjdCcsXG4gICAgc3lzdGVtLFxuICAgIHByb21wdCxcbiAgICBtZXNzYWdlcyxcbiAgICBtYXhSZXRyaWVzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIGhlYWRlcnMsXG4gICAgZXhwZXJpbWVudGFsX3JlcGFpclRleHQ6IHJlcGFpclRleHQsXG4gICAgZXhwZXJpbWVudGFsX3RlbGVtZXRyeTogdGVsZW1ldHJ5LFxuICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICBvbkVycm9yID0gKHsgZXJyb3IgfTogeyBlcnJvcjogdW5rbm93biB9KSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9LFxuICAgIG9uRmluaXNoLFxuICAgIF9pbnRlcm5hbDoge1xuICAgICAgZ2VuZXJhdGVJZCA9IG9yaWdpbmFsR2VuZXJhdGVJZCxcbiAgICAgIGN1cnJlbnREYXRlID0gKCkgPT4gbmV3IERhdGUoKSxcbiAgICAgIG5vdyA9IG9yaWdpbmFsTm93LFxuICAgIH0gPSB7fSxcbiAgICAuLi5zZXR0aW5nc1xuICB9ID0gb3B0aW9ucztcblxuICBjb25zdCBlbnVtVmFsdWVzID1cbiAgICAnZW51bScgaW4gb3B0aW9ucyAmJiBvcHRpb25zLmVudW0gPyBvcHRpb25zLmVudW0gOiB1bmRlZmluZWQ7XG5cbiAgY29uc3Qge1xuICAgIHNjaGVtYTogaW5wdXRTY2hlbWEsXG4gICAgc2NoZW1hRGVzY3JpcHRpb24sXG4gICAgc2NoZW1hTmFtZSxcbiAgfSA9ICdzY2hlbWEnIGluIG9wdGlvbnMgPyBvcHRpb25zIDoge307XG5cbiAgdmFsaWRhdGVPYmplY3RHZW5lcmF0aW9uSW5wdXQoe1xuICAgIG91dHB1dCxcbiAgICBzY2hlbWE6IGlucHV0U2NoZW1hLFxuICAgIHNjaGVtYU5hbWUsXG4gICAgc2NoZW1hRGVzY3JpcHRpb24sXG4gICAgZW51bVZhbHVlcyxcbiAgfSk7XG5cbiAgY29uc3Qgb3V0cHV0U3RyYXRlZ3kgPSBnZXRPdXRwdXRTdHJhdGVneSh7XG4gICAgb3V0cHV0LFxuICAgIHNjaGVtYTogaW5wdXRTY2hlbWEsXG4gICAgZW51bVZhbHVlcyxcbiAgfSk7XG5cbiAgcmV0dXJuIG5ldyBEZWZhdWx0U3RyZWFtT2JqZWN0UmVzdWx0KHtcbiAgICBtb2RlbCxcbiAgICB0ZWxlbWV0cnksXG4gICAgaGVhZGVycyxcbiAgICBzZXR0aW5ncyxcbiAgICBtYXhSZXRyaWVzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIG91dHB1dFN0cmF0ZWd5LFxuICAgIHN5c3RlbSxcbiAgICBwcm9tcHQsXG4gICAgbWVzc2FnZXMsXG4gICAgc2NoZW1hTmFtZSxcbiAgICBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgcmVwYWlyVGV4dCxcbiAgICBvbkVycm9yLFxuICAgIG9uRmluaXNoLFxuICAgIGdlbmVyYXRlSWQsXG4gICAgY3VycmVudERhdGUsXG4gICAgbm93LFxuICB9KTtcbn1cblxuY2xhc3MgRGVmYXVsdFN0cmVhbU9iamVjdFJlc3VsdDxQQVJUSUFMLCBSRVNVTFQsIEVMRU1FTlRfU1RSRUFNPlxuICBpbXBsZW1lbnRzIFN0cmVhbU9iamVjdFJlc3VsdDxQQVJUSUFMLCBSRVNVTFQsIEVMRU1FTlRfU1RSRUFNPlxue1xuICBwcml2YXRlIHJlYWRvbmx5IF9vYmplY3QgPSBuZXcgRGVsYXllZFByb21pc2U8UkVTVUxUPigpO1xuICBwcml2YXRlIHJlYWRvbmx5IF91c2FnZSA9IG5ldyBEZWxheWVkUHJvbWlzZTxMYW5ndWFnZU1vZGVsVXNhZ2U+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3Byb3ZpZGVyTWV0YWRhdGEgPSBuZXcgRGVsYXllZFByb21pc2U8XG4gICAgUHJvdmlkZXJNZXRhZGF0YSB8IHVuZGVmaW5lZFxuICA+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3dhcm5pbmdzID0gbmV3IERlbGF5ZWRQcm9taXNlPENhbGxXYXJuaW5nW10gfCB1bmRlZmluZWQ+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3JlcXVlc3QgPVxuICAgIG5ldyBEZWxheWVkUHJvbWlzZTxMYW5ndWFnZU1vZGVsUmVxdWVzdE1ldGFkYXRhPigpO1xuICBwcml2YXRlIHJlYWRvbmx5IF9yZXNwb25zZSA9XG4gICAgbmV3IERlbGF5ZWRQcm9taXNlPExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhPigpO1xuICBwcml2YXRlIHJlYWRvbmx5IF9maW5pc2hSZWFzb24gPSBuZXcgRGVsYXllZFByb21pc2U8RmluaXNoUmVhc29uPigpO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgYmFzZVN0cmVhbTogUmVhZGFibGVTdHJlYW08T2JqZWN0U3RyZWFtUGFydDxQQVJUSUFMPj47XG5cbiAgcHJpdmF0ZSByZWFkb25seSBvdXRwdXRTdHJhdGVneTogT3V0cHV0U3RyYXRlZ3k8XG4gICAgUEFSVElBTCxcbiAgICBSRVNVTFQsXG4gICAgRUxFTUVOVF9TVFJFQU1cbiAgPjtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgbW9kZWw6IG1vZGVsQXJnLFxuICAgIGhlYWRlcnMsXG4gICAgdGVsZW1ldHJ5LFxuICAgIHNldHRpbmdzLFxuICAgIG1heFJldHJpZXM6IG1heFJldHJpZXNBcmcsXG4gICAgYWJvcnRTaWduYWwsXG4gICAgb3V0cHV0U3RyYXRlZ3ksXG4gICAgc3lzdGVtLFxuICAgIHByb21wdCxcbiAgICBtZXNzYWdlcyxcbiAgICBzY2hlbWFOYW1lLFxuICAgIHNjaGVtYURlc2NyaXB0aW9uLFxuICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICByZXBhaXJUZXh0LFxuICAgIG9uRXJyb3IsXG4gICAgb25GaW5pc2gsXG4gICAgZ2VuZXJhdGVJZCxcbiAgICBjdXJyZW50RGF0ZSxcbiAgICBub3csXG4gIH06IHtcbiAgICBtb2RlbDogTGFuZ3VhZ2VNb2RlbDtcbiAgICB0ZWxlbWV0cnk6IFRlbGVtZXRyeVNldHRpbmdzIHwgdW5kZWZpbmVkO1xuICAgIGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD4gfCB1bmRlZmluZWQ7XG4gICAgc2V0dGluZ3M6IE9taXQ8Q2FsbFNldHRpbmdzLCAnYWJvcnRTaWduYWwnIHwgJ2hlYWRlcnMnPjtcbiAgICBtYXhSZXRyaWVzOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gICAgYWJvcnRTaWduYWw6IEFib3J0U2lnbmFsIHwgdW5kZWZpbmVkO1xuICAgIG91dHB1dFN0cmF0ZWd5OiBPdXRwdXRTdHJhdGVneTxQQVJUSUFMLCBSRVNVTFQsIEVMRU1FTlRfU1RSRUFNPjtcbiAgICBzeXN0ZW06IFByb21wdFsnc3lzdGVtJ107XG4gICAgcHJvbXB0OiBQcm9tcHRbJ3Byb21wdCddO1xuICAgIG1lc3NhZ2VzOiBQcm9tcHRbJ21lc3NhZ2VzJ107XG4gICAgc2NoZW1hTmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIHNjaGVtYURlc2NyaXB0aW9uOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgcHJvdmlkZXJPcHRpb25zOiBQcm92aWRlck9wdGlvbnMgfCB1bmRlZmluZWQ7XG4gICAgcmVwYWlyVGV4dDogUmVwYWlyVGV4dEZ1bmN0aW9uIHwgdW5kZWZpbmVkO1xuICAgIG9uRXJyb3I6IFN0cmVhbU9iamVjdE9uRXJyb3JDYWxsYmFjaztcbiAgICBvbkZpbmlzaDogU3RyZWFtT2JqZWN0T25GaW5pc2hDYWxsYmFjazxSRVNVTFQ+IHwgdW5kZWZpbmVkO1xuICAgIGdlbmVyYXRlSWQ6ICgpID0+IHN0cmluZztcbiAgICBjdXJyZW50RGF0ZTogKCkgPT4gRGF0ZTtcbiAgICBub3c6ICgpID0+IG51bWJlcjtcbiAgfSkge1xuICAgIGNvbnN0IG1vZGVsID0gcmVzb2x2ZUxhbmd1YWdlTW9kZWwobW9kZWxBcmcpO1xuXG4gICAgY29uc3QgeyBtYXhSZXRyaWVzLCByZXRyeSB9ID0gcHJlcGFyZVJldHJpZXMoe1xuICAgICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICAgIGFib3J0U2lnbmFsLFxuICAgIH0pO1xuXG4gICAgY29uc3QgY2FsbFNldHRpbmdzID0gcHJlcGFyZUNhbGxTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgICBjb25zdCBiYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyA9IGdldEJhc2VUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgIG1vZGVsLFxuICAgICAgdGVsZW1ldHJ5LFxuICAgICAgaGVhZGVycyxcbiAgICAgIHNldHRpbmdzOiB7IC4uLmNhbGxTZXR0aW5ncywgbWF4UmV0cmllcyB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKHRlbGVtZXRyeSk7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICBjb25zdCBzdGl0Y2hhYmxlU3RyZWFtID1cbiAgICAgIGNyZWF0ZVN0aXRjaGFibGVTdHJlYW08T2JqZWN0U3RyZWFtUGFydDxQQVJUSUFMPj4oKTtcblxuICAgIGNvbnN0IGV2ZW50UHJvY2Vzc29yID0gbmV3IFRyYW5zZm9ybVN0cmVhbTxcbiAgICAgIE9iamVjdFN0cmVhbVBhcnQ8UEFSVElBTD4sXG4gICAgICBPYmplY3RTdHJlYW1QYXJ0PFBBUlRJQUw+XG4gICAgPih7XG4gICAgICB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rKTtcblxuICAgICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgIG9uRXJyb3IoeyBlcnJvcjogd3JhcEdhdGV3YXlFcnJvcihjaHVuay5lcnJvcikgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLmJhc2VTdHJlYW0gPSBzdGl0Y2hhYmxlU3RyZWFtLnN0cmVhbS5waXBlVGhyb3VnaChldmVudFByb2Nlc3Nvcik7XG5cbiAgICByZWNvcmRTcGFuKHtcbiAgICAgIG5hbWU6ICdhaS5zdHJlYW1PYmplY3QnLFxuICAgICAgYXR0cmlidXRlczogc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgIC4uLmFzc2VtYmxlT3BlcmF0aW9uTmFtZSh7XG4gICAgICAgICAgICBvcGVyYXRpb25JZDogJ2FpLnN0cmVhbU9iamVjdCcsXG4gICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgfSksXG4gICAgICAgICAgLi4uYmFzZVRlbGVtZXRyeUF0dHJpYnV0ZXMsXG4gICAgICAgICAgLy8gc3BlY2lmaWMgc2V0dGluZ3MgdGhhdCBvbmx5IG1ha2Ugc2Vuc2Ugb24gdGhlIG91dGVyIGxldmVsOlxuICAgICAgICAgICdhaS5wcm9tcHQnOiB7XG4gICAgICAgICAgICBpbnB1dDogKCkgPT4gSlNPTi5zdHJpbmdpZnkoeyBzeXN0ZW0sIHByb21wdCwgbWVzc2FnZXMgfSksXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnYWkuc2NoZW1hJzpcbiAgICAgICAgICAgIG91dHB1dFN0cmF0ZWd5Lmpzb25TY2hlbWEgIT0gbnVsbFxuICAgICAgICAgICAgICA/IHsgaW5wdXQ6ICgpID0+IEpTT04uc3RyaW5naWZ5KG91dHB1dFN0cmF0ZWd5Lmpzb25TY2hlbWEpIH1cbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgJ2FpLnNjaGVtYS5uYW1lJzogc2NoZW1hTmFtZSxcbiAgICAgICAgICAnYWkuc2NoZW1hLmRlc2NyaXB0aW9uJzogc2NoZW1hRGVzY3JpcHRpb24sXG4gICAgICAgICAgJ2FpLnNldHRpbmdzLm91dHB1dCc6IG91dHB1dFN0cmF0ZWd5LnR5cGUsXG4gICAgICAgIH0sXG4gICAgICB9KSxcbiAgICAgIHRyYWNlcixcbiAgICAgIGVuZFdoZW5Eb25lOiBmYWxzZSxcbiAgICAgIGZuOiBhc3luYyByb290U3BhbiA9PiB7XG4gICAgICAgIGNvbnN0IHN0YW5kYXJkaXplZFByb21wdCA9IGF3YWl0IHN0YW5kYXJkaXplUHJvbXB0KHtcbiAgICAgICAgICBzeXN0ZW0sXG4gICAgICAgICAgcHJvbXB0LFxuICAgICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjYWxsT3B0aW9ucyA9IHtcbiAgICAgICAgICByZXNwb25zZUZvcm1hdDoge1xuICAgICAgICAgICAgdHlwZTogJ2pzb24nIGFzIGNvbnN0LFxuICAgICAgICAgICAgc2NoZW1hOiBvdXRwdXRTdHJhdGVneS5qc29uU2NoZW1hLFxuICAgICAgICAgICAgbmFtZTogc2NoZW1hTmFtZSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzY2hlbWFEZXNjcmlwdGlvbixcbiAgICAgICAgICB9LFxuICAgICAgICAgIC4uLnByZXBhcmVDYWxsU2V0dGluZ3Moc2V0dGluZ3MpLFxuICAgICAgICAgIHByb21wdDogYXdhaXQgY29udmVydFRvTGFuZ3VhZ2VNb2RlbFByb21wdCh7XG4gICAgICAgICAgICBwcm9tcHQ6IHN0YW5kYXJkaXplZFByb21wdCxcbiAgICAgICAgICAgIHN1cHBvcnRlZFVybHM6IGF3YWl0IG1vZGVsLnN1cHBvcnRlZFVybHMsXG4gICAgICAgICAgfSksXG4gICAgICAgICAgcHJvdmlkZXJPcHRpb25zLFxuICAgICAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgaW5jbHVkZVJhd0NodW5rczogZmFsc2UsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgdHJhbnNmb3JtZXI6IFRyYW5zZm9ybWVyPFxuICAgICAgICAgIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQsXG4gICAgICAgICAgT2JqZWN0U3RyZWFtSW5wdXRQYXJ0XG4gICAgICAgID4gPSB7XG4gICAgICAgICAgdHJhbnNmb3JtOiAoY2h1bmssIGNvbnRyb2xsZXIpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoY2h1bmsudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlICd0ZXh0LWRlbHRhJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmsuZGVsdGEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlICdyZXNwb25zZS1tZXRhZGF0YSc6XG4gICAgICAgICAgICAgIGNhc2UgJ2ZpbmlzaCc6XG4gICAgICAgICAgICAgIGNhc2UgJ2Vycm9yJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHJlc3VsdDogeyBzdHJlYW0sIHJlc3BvbnNlLCByZXF1ZXN0IH0sXG4gICAgICAgICAgZG9TdHJlYW1TcGFuLFxuICAgICAgICAgIHN0YXJ0VGltZXN0YW1wTXMsXG4gICAgICAgIH0gPSBhd2FpdCByZXRyeSgoKSA9PlxuICAgICAgICAgIHJlY29yZFNwYW4oe1xuICAgICAgICAgICAgbmFtZTogJ2FpLnN0cmVhbU9iamVjdC5kb1N0cmVhbScsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgLi4uYXNzZW1ibGVPcGVyYXRpb25OYW1lKHtcbiAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbklkOiAnYWkuc3RyZWFtT2JqZWN0LmRvU3RyZWFtJyxcbiAgICAgICAgICAgICAgICAgIHRlbGVtZXRyeSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAuLi5iYXNlVGVsZW1ldHJ5QXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAnYWkucHJvbXB0Lm1lc3NhZ2VzJzoge1xuICAgICAgICAgICAgICAgICAgaW5wdXQ6ICgpID0+IHN0cmluZ2lmeUZvclRlbGVtZXRyeShjYWxsT3B0aW9ucy5wcm9tcHQpLFxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAvLyBzdGFuZGFyZGl6ZWQgZ2VuLWFpIGxsbSBzcGFuIGF0dHJpYnV0ZXM6XG4gICAgICAgICAgICAgICAgJ2dlbl9haS5zeXN0ZW0nOiBtb2RlbC5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubW9kZWwnOiBtb2RlbC5tb2RlbElkLFxuICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC5mcmVxdWVuY3lfcGVuYWx0eSc6XG4gICAgICAgICAgICAgICAgICBjYWxsU2V0dGluZ3MuZnJlcXVlbmN5UGVuYWx0eSxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QubWF4X3Rva2Vucyc6IGNhbGxTZXR0aW5ncy5tYXhPdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgJ2dlbl9haS5yZXF1ZXN0LnByZXNlbmNlX3BlbmFsdHknOiBjYWxsU2V0dGluZ3MucHJlc2VuY2VQZW5hbHR5LFxuICAgICAgICAgICAgICAgICdnZW5fYWkucmVxdWVzdC50ZW1wZXJhdHVyZSc6IGNhbGxTZXR0aW5ncy50ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX2snOiBjYWxsU2V0dGluZ3MudG9wSyxcbiAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlcXVlc3QudG9wX3AnOiBjYWxsU2V0dGluZ3MudG9wUCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdHJhY2VyLFxuICAgICAgICAgICAgZW5kV2hlbkRvbmU6IGZhbHNlLFxuICAgICAgICAgICAgZm46IGFzeW5jIGRvU3RyZWFtU3BhbiA9PiAoe1xuICAgICAgICAgICAgICBzdGFydFRpbWVzdGFtcE1zOiBub3coKSxcbiAgICAgICAgICAgICAgZG9TdHJlYW1TcGFuLFxuICAgICAgICAgICAgICByZXN1bHQ6IGF3YWl0IG1vZGVsLmRvU3RyZWFtKGNhbGxPcHRpb25zKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIHNlbGYuX3JlcXVlc3QucmVzb2x2ZShyZXF1ZXN0ID8/IHt9KTtcblxuICAgICAgICAvLyBzdG9yZSBpbmZvcm1hdGlvbiBmb3Igb25GaW5pc2ggY2FsbGJhY2s6XG4gICAgICAgIGxldCB3YXJuaW5nczogTGFuZ3VhZ2VNb2RlbFYyQ2FsbFdhcm5pbmdbXSB8IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IHVzYWdlOiBMYW5ndWFnZU1vZGVsVXNhZ2UgPSB7XG4gICAgICAgICAgaW5wdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICBvdXRwdXRUb2tlbnM6IHVuZGVmaW5lZCxcbiAgICAgICAgICB0b3RhbFRva2VuczogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICBsZXQgZmluaXNoUmVhc29uOiBMYW5ndWFnZU1vZGVsVjJGaW5pc2hSZWFzb24gfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCBwcm92aWRlck1ldGFkYXRhOiBQcm92aWRlck1ldGFkYXRhIHwgdW5kZWZpbmVkO1xuICAgICAgICBsZXQgb2JqZWN0OiBSRVNVTFQgfCB1bmRlZmluZWQ7XG4gICAgICAgIGxldCBlcnJvcjogdW5rbm93biB8IHVuZGVmaW5lZDtcblxuICAgICAgICAvLyBwaXBlIGNodW5rcyB0aHJvdWdoIGEgdHJhbnNmb3JtYXRpb24gc3RyZWFtIHRoYXQgZXh0cmFjdHMgbWV0YWRhdGE6XG4gICAgICAgIGxldCBhY2N1bXVsYXRlZFRleHQgPSAnJztcbiAgICAgICAgbGV0IHRleHREZWx0YSA9ICcnO1xuICAgICAgICBsZXQgZnVsbFJlc3BvbnNlOiB7XG4gICAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGU7XG4gICAgICAgICAgbW9kZWxJZDogc3RyaW5nO1xuICAgICAgICB9ID0ge1xuICAgICAgICAgIGlkOiBnZW5lcmF0ZUlkKCksXG4gICAgICAgICAgdGltZXN0YW1wOiBjdXJyZW50RGF0ZSgpLFxuICAgICAgICAgIG1vZGVsSWQ6IG1vZGVsLm1vZGVsSWQsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gS2VlcCB0cmFjayBvZiByYXcgcGFyc2UgcmVzdWx0IGJlZm9yZSB0eXBlIHZhbGlkYXRpb24sIHNpbmNlIGUuZy4gWm9kIG1pZ2h0XG4gICAgICAgIC8vIGNoYW5nZSB0aGUgb2JqZWN0IGJ5IG1hcHBpbmcgcHJvcGVydGllcy5cbiAgICAgICAgbGV0IGxhdGVzdE9iamVjdEpzb246IEpTT05WYWx1ZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IGxhdGVzdE9iamVjdDogUEFSVElBTCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IGlzRmlyc3RDaHVuayA9IHRydWU7XG4gICAgICAgIGxldCBpc0ZpcnN0RGVsdGEgPSB0cnVlO1xuXG4gICAgICAgIGNvbnN0IHRyYW5zZm9ybWVkU3RyZWFtID0gc3RyZWFtXG4gICAgICAgICAgLnBpcGVUaHJvdWdoKG5ldyBUcmFuc2Zvcm1TdHJlYW0odHJhbnNmb3JtZXIpKVxuICAgICAgICAgIC5waXBlVGhyb3VnaChcbiAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08XG4gICAgICAgICAgICAgIHN0cmluZyB8IE9iamVjdFN0cmVhbUlucHV0UGFydCxcbiAgICAgICAgICAgICAgT2JqZWN0U3RyZWFtUGFydDxQQVJUSUFMPlxuICAgICAgICAgICAgPih7XG4gICAgICAgICAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgIHR5cGVvZiBjaHVuayA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgICAgICAgIGNodW5rLnR5cGUgPT09ICdzdHJlYW0tc3RhcnQnXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICB3YXJuaW5ncyA9IGNodW5rLndhcm5pbmdzO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBzdHJlYW0gc3RhcnQgY2h1bmtzIGFyZSBzZW50IGltbWVkaWF0ZWx5IGFuZCBkbyBub3QgY291bnQgYXMgZmlyc3QgY2h1bmtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUZWxlbWV0cnkgZXZlbnQgZm9yIGZpcnN0IGNodW5rOlxuICAgICAgICAgICAgICAgIGlmIChpc0ZpcnN0Q2h1bmspIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG1zVG9GaXJzdENodW5rID0gbm93KCkgLSBzdGFydFRpbWVzdGFtcE1zO1xuXG4gICAgICAgICAgICAgICAgICBpc0ZpcnN0Q2h1bmsgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgZG9TdHJlYW1TcGFuLmFkZEV2ZW50KCdhaS5zdHJlYW0uZmlyc3RDaHVuaycsIHtcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnN0cmVhbS5tc1RvRmlyc3RDaHVuayc6IG1zVG9GaXJzdENodW5rLFxuICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2FpLnN0cmVhbS5tc1RvRmlyc3RDaHVuayc6IG1zVG9GaXJzdENodW5rLFxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBwYXJ0aWFsIHRleHQgY2h1bmtzXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkVGV4dCArPSBjaHVuaztcbiAgICAgICAgICAgICAgICAgIHRleHREZWx0YSArPSBjaHVuaztcblxuICAgICAgICAgICAgICAgICAgY29uc3QgeyB2YWx1ZTogY3VycmVudE9iamVjdEpzb24sIHN0YXRlOiBwYXJzZVN0YXRlIH0gPVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwYXJzZVBhcnRpYWxKc29uKGFjY3VtdWxhdGVkVGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE9iamVjdEpzb24gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAhaXNEZWVwRXF1YWxEYXRhKGxhdGVzdE9iamVjdEpzb24sIGN1cnJlbnRPYmplY3RKc29uKVxuICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPVxuICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG91dHB1dFN0cmF0ZWd5LnZhbGlkYXRlUGFydGlhbFJlc3VsdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY3VycmVudE9iamVjdEpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RGVsdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXRlc3RPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0ZpcnN0RGVsdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0ZpbmFsRGVsdGE6IHBhcnNlU3RhdGUgPT09ICdzdWNjZXNzZnVsLXBhcnNlJyxcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvblJlc3VsdC5zdWNjZXNzICYmXG4gICAgICAgICAgICAgICAgICAgICAgIWlzRGVlcEVxdWFsRGF0YShcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGVzdE9iamVjdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHQudmFsdWUucGFydGlhbCxcbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIGluc2lkZSBpbm5lciBjaGVjayB0byBjb3JyZWN0bHkgcGFyc2UgdGhlIGZpbmFsIGVsZW1lbnQgaW4gYXJyYXkgbW9kZTpcbiAgICAgICAgICAgICAgICAgICAgICBsYXRlc3RPYmplY3RKc29uID0gY3VycmVudE9iamVjdEpzb247XG4gICAgICAgICAgICAgICAgICAgICAgbGF0ZXN0T2JqZWN0ID0gdmFsaWRhdGlvblJlc3VsdC52YWx1ZS5wYXJ0aWFsO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0OiBsYXRlc3RPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQtZGVsdGEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dERlbHRhOiB2YWxpZGF0aW9uUmVzdWx0LnZhbHVlLnRleHREZWx0YSxcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgIHRleHREZWx0YSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgIGlzRmlyc3REZWx0YSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNodW5rLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgIGNhc2UgJ3Jlc3BvbnNlLW1ldGFkYXRhJzoge1xuICAgICAgICAgICAgICAgICAgICBmdWxsUmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IGNodW5rLmlkID8/IGZ1bGxSZXNwb25zZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGNodW5rLnRpbWVzdGFtcCA/PyBmdWxsUmVzcG9uc2UudGltZXN0YW1wLFxuICAgICAgICAgICAgICAgICAgICAgIG1vZGVsSWQ6IGNodW5rLm1vZGVsSWQgPz8gZnVsbFJlc3BvbnNlLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBjYXNlICdmaW5pc2gnOiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgZmluYWwgdGV4dCBkZWx0YTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHREZWx0YSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1kZWx0YScsIHRleHREZWx0YSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIGZpbmlzaCByZWFzb24gZm9yIHRlbGVtZXRyeTpcbiAgICAgICAgICAgICAgICAgICAgZmluaXNoUmVhc29uID0gY2h1bmsuZmluaXNoUmVhc29uO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIHVzYWdlIGFuZCBtZXRhZGF0YSBmb3IgcHJvbWlzZXMgYW5kIG9uRmluaXNoIGNhbGxiYWNrOlxuICAgICAgICAgICAgICAgICAgICB1c2FnZSA9IGNodW5rLnVzYWdlO1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhID0gY2h1bmsucHJvdmlkZXJNZXRhZGF0YTtcblxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIC4uLmNodW5rLFxuICAgICAgICAgICAgICAgICAgICAgIHVzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiBmdWxsUmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc29sdmUgcHJvbWlzZXMgdGhhdCBjYW4gYmUgcmVzb2x2ZWQgbm93OlxuICAgICAgICAgICAgICAgICAgICBzZWxmLl91c2FnZS5yZXNvbHZlKHVzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcHJvdmlkZXJNZXRhZGF0YS5yZXNvbHZlKHByb3ZpZGVyTWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9yZXNwb25zZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAuLi5mdWxsUmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogcmVzcG9uc2U/LmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9maW5pc2hSZWFzb24ucmVzb2x2ZShmaW5pc2hSZWFzb24gPz8gJ3Vua25vd24nKTtcblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IGF3YWl0IHBhcnNlQW5kVmFsaWRhdGVPYmplY3RSZXN1bHRXaXRoUmVwYWlyKFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0U3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBhaXJUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZTogZnVsbFJlc3BvbnNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB1c2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX29iamVjdC5yZXNvbHZlKG9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5fb2JqZWN0LnJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgLy8gaW52b2tlIG9uRmluaXNoIGNhbGxiYWNrIGFuZCByZXNvbHZlIHRvb2xSZXN1bHRzIHByb21pc2Ugd2hlbiB0aGUgc3RyZWFtIGlzIGFib3V0IHRvIGNsb3NlOlxuICAgICAgICAgICAgICBhc3luYyBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsVXNhZ2UgPSB1c2FnZSA/PyB7XG4gICAgICAgICAgICAgICAgICAgIHByb21wdFRva2VuczogTmFOLFxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uVG9rZW5zOiBOYU4sXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsVG9rZW5zOiBOYU4sXG4gICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICBkb1N0cmVhbVNwYW4uc2V0QXR0cmlidXRlcyhcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0VGVsZW1ldHJ5QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5LFxuICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5maW5pc2hSZWFzb24nOiBmaW5pc2hSZWFzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2Uub2JqZWN0Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6ICgpID0+IEpTT04uc3RyaW5naWZ5KG9iamVjdCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLmlkJzogZnVsbFJlc3BvbnNlLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLm1vZGVsJzogZnVsbFJlc3BvbnNlLm1vZGVsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkucmVzcG9uc2UudGltZXN0YW1wJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFJlc3BvbnNlLnRpbWVzdGFtcC50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLnByb3ZpZGVyTWV0YWRhdGEnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShwcm92aWRlck1ldGFkYXRhKSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnVzYWdlLmlucHV0VG9rZW5zJzogZmluYWxVc2FnZS5pbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS5vdXRwdXRUb2tlbnMnOiBmaW5hbFVzYWdlLm91dHB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS50b3RhbFRva2Vucyc6IGZpbmFsVXNhZ2UudG90YWxUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UucmVhc29uaW5nVG9rZW5zJzogZmluYWxVc2FnZS5yZWFzb25pbmdUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuY2FjaGVkSW5wdXRUb2tlbnMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFVzYWdlLmNhY2hlZElucHV0VG9rZW5zLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFuZGFyZGl6ZWQgZ2VuLWFpIGxsbSBzcGFuIGF0dHJpYnV0ZXM6XG4gICAgICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLmZpbmlzaF9yZWFzb25zJzogW2ZpbmlzaFJlYXNvbl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAnZ2VuX2FpLnJlc3BvbnNlLmlkJzogZnVsbFJlc3BvbnNlLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2dlbl9haS5yZXNwb25zZS5tb2RlbCc6IGZ1bGxSZXNwb25zZS5tb2RlbElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2dlbl9haS51c2FnZS5pbnB1dF90b2tlbnMnOiBmaW5hbFVzYWdlLmlucHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2dlbl9haS51c2FnZS5vdXRwdXRfdG9rZW5zJzogZmluYWxVc2FnZS5vdXRwdXRUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAvLyBmaW5pc2ggZG9TdHJlYW1TcGFuIGJlZm9yZSBvdGhlciBvcGVyYXRpb25zIGZvciBjb3JyZWN0IHRpbWluZzpcbiAgICAgICAgICAgICAgICAgIGRvU3RyZWFtU3Bhbi5lbmQoKTtcblxuICAgICAgICAgICAgICAgICAgLy8gQWRkIHJlc3BvbnNlIGluZm9ybWF0aW9uIHRvIHRoZSByb290IHNwYW46XG4gICAgICAgICAgICAgICAgICByb290U3Bhbi5zZXRBdHRyaWJ1dGVzKFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RUZWxlbWV0cnlBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICB0ZWxlbWV0cnksXG4gICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnVzYWdlLmlucHV0VG9rZW5zJzogZmluYWxVc2FnZS5pbnB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS5vdXRwdXRUb2tlbnMnOiBmaW5hbFVzYWdlLm91dHB1dFRva2VucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS51c2FnZS50b3RhbFRva2Vucyc6IGZpbmFsVXNhZ2UudG90YWxUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UucmVhc29uaW5nVG9rZW5zJzogZmluYWxVc2FnZS5yZWFzb25pbmdUb2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYWkudXNhZ2UuY2FjaGVkSW5wdXRUb2tlbnMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFVzYWdlLmNhY2hlZElucHV0VG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FpLnJlc3BvbnNlLm9iamVjdCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiAoKSA9PiBKU09OLnN0cmluZ2lmeShvYmplY3QpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdhaS5yZXNwb25zZS5wcm92aWRlck1ldGFkYXRhJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkocHJvdmlkZXJNZXRhZGF0YSksXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAvLyBjYWxsIG9uRmluaXNoIGNhbGxiYWNrOlxuICAgICAgICAgICAgICAgICAgYXdhaXQgb25GaW5pc2g/Lih7XG4gICAgICAgICAgICAgICAgICAgIHVzYWdlOiBmaW5hbFVzYWdlLFxuICAgICAgICAgICAgICAgICAgICBvYmplY3QsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yLFxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgICAgICAgICAgICAgIC4uLmZ1bGxSZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZT8uaGVhZGVycyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgd2FybmluZ3MsXG4gICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ2Vycm9yJywgZXJyb3IgfSk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgIHJvb3RTcGFuLmVuZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgc3RpdGNoYWJsZVN0cmVhbS5hZGRTdHJlYW0odHJhbnNmb3JtZWRTdHJlYW0pO1xuICAgICAgfSxcbiAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgLy8gYWRkIGFuIGVtcHR5IHN0cmVhbSB3aXRoIGFuIGVycm9yIHRvIGJyZWFrIHRoZSBzdHJlYW06XG4gICAgICAgIHN0aXRjaGFibGVTdHJlYW0uYWRkU3RyZWFtKFxuICAgICAgICAgIG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICdlcnJvcicsIGVycm9yIH0pO1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgc3RpdGNoYWJsZVN0cmVhbS5jbG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLm91dHB1dFN0cmF0ZWd5ID0gb3V0cHV0U3RyYXRlZ3k7XG4gIH1cblxuICBnZXQgb2JqZWN0KCkge1xuICAgIHJldHVybiB0aGlzLl9vYmplY3QucHJvbWlzZTtcbiAgfVxuXG4gIGdldCB1c2FnZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fdXNhZ2UucHJvbWlzZTtcbiAgfVxuXG4gIGdldCBwcm92aWRlck1ldGFkYXRhKCkge1xuICAgIHJldHVybiB0aGlzLl9wcm92aWRlck1ldGFkYXRhLnByb21pc2U7XG4gIH1cblxuICBnZXQgd2FybmluZ3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3dhcm5pbmdzLnByb21pc2U7XG4gIH1cblxuICBnZXQgcmVxdWVzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdC5wcm9taXNlO1xuICB9XG5cbiAgZ2V0IHJlc3BvbnNlKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXNwb25zZS5wcm9taXNlO1xuICB9XG5cbiAgZ2V0IGZpbmlzaFJlYXNvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fZmluaXNoUmVhc29uLnByb21pc2U7XG4gIH1cblxuICBnZXQgcGFydGlhbE9iamVjdFN0cmVhbSgpOiBBc3luY0l0ZXJhYmxlU3RyZWFtPFBBUlRJQUw+IHtcbiAgICByZXR1cm4gY3JlYXRlQXN5bmNJdGVyYWJsZVN0cmVhbShcbiAgICAgIHRoaXMuYmFzZVN0cmVhbS5waXBlVGhyb3VnaChcbiAgICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxPYmplY3RTdHJlYW1QYXJ0PFBBUlRJQUw+LCBQQVJUSUFMPih7XG4gICAgICAgICAgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNodW5rLnR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmsub2JqZWN0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlICd0ZXh0LWRlbHRhJzpcbiAgICAgICAgICAgICAgY2FzZSAnZmluaXNoJzpcbiAgICAgICAgICAgICAgY2FzZSAnZXJyb3InOiAvLyBzdXBwcmVzcyBlcnJvciAodXNlIG9uRXJyb3IgaW5zdGVhZClcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgY29uc3QgX2V4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBjaHVuaztcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGNodW5rIHR5cGU6ICR7X2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApO1xuICB9XG5cbiAgZ2V0IGVsZW1lbnRTdHJlYW0oKTogRUxFTUVOVF9TVFJFQU0ge1xuICAgIHJldHVybiB0aGlzLm91dHB1dFN0cmF0ZWd5LmNyZWF0ZUVsZW1lbnRTdHJlYW0odGhpcy5iYXNlU3RyZWFtKTtcbiAgfVxuXG4gIGdldCB0ZXh0U3RyZWFtKCk6IEFzeW5jSXRlcmFibGVTdHJlYW08c3RyaW5nPiB7XG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0oXG4gICAgICB0aGlzLmJhc2VTdHJlYW0ucGlwZVRocm91Z2goXG4gICAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08T2JqZWN0U3RyZWFtUGFydDxQQVJUSUFMPiwgc3RyaW5nPih7XG4gICAgICAgICAgdHJhbnNmb3JtKGNodW5rLCBjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNodW5rLnR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAndGV4dC1kZWx0YSc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGNodW5rLnRleHREZWx0YSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICAgICAgY2FzZSAnZmluaXNoJzpcbiAgICAgICAgICAgICAgY2FzZSAnZXJyb3InOiAvLyBzdXBwcmVzcyBlcnJvciAodXNlIG9uRXJyb3IgaW5zdGVhZClcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgY29uc3QgX2V4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBjaHVuaztcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGNodW5rIHR5cGU6ICR7X2V4aGF1c3RpdmVDaGVja31gKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApO1xuICB9XG5cbiAgZ2V0IGZ1bGxTdHJlYW0oKTogQXN5bmNJdGVyYWJsZVN0cmVhbTxPYmplY3RTdHJlYW1QYXJ0PFBBUlRJQUw+PiB7XG4gICAgcmV0dXJuIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0odGhpcy5iYXNlU3RyZWFtKTtcbiAgfVxuXG4gIHBpcGVUZXh0U3RyZWFtVG9SZXNwb25zZShyZXNwb25zZTogU2VydmVyUmVzcG9uc2UsIGluaXQ/OiBSZXNwb25zZUluaXQpIHtcbiAgICBwaXBlVGV4dFN0cmVhbVRvUmVzcG9uc2Uoe1xuICAgICAgcmVzcG9uc2UsXG4gICAgICB0ZXh0U3RyZWFtOiB0aGlzLnRleHRTdHJlYW0sXG4gICAgICAuLi5pbml0LFxuICAgIH0pO1xuICB9XG5cbiAgdG9UZXh0U3RyZWFtUmVzcG9uc2UoaW5pdD86IFJlc3BvbnNlSW5pdCk6IFJlc3BvbnNlIHtcbiAgICByZXR1cm4gY3JlYXRlVGV4dFN0cmVhbVJlc3BvbnNlKHtcbiAgICAgIHRleHRTdHJlYW06IHRoaXMudGV4dFN0cmVhbSxcbiAgICAgIC4uLmluaXQsXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgT2JqZWN0U3RyZWFtSW5wdXRQYXJ0ID1cbiAgfCBzdHJpbmdcbiAgfCB7XG4gICAgICB0eXBlOiAnc3RyZWFtLXN0YXJ0JztcbiAgICAgIHdhcm5pbmdzOiBMYW5ndWFnZU1vZGVsVjJDYWxsV2FybmluZ1tdO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAnZXJyb3InO1xuICAgICAgZXJyb3I6IHVua25vd247XG4gICAgfVxuICB8IHtcbiAgICAgIHR5cGU6ICdyZXNwb25zZS1tZXRhZGF0YSc7XG4gICAgICBpZD86IHN0cmluZztcbiAgICAgIHRpbWVzdGFtcD86IERhdGU7XG4gICAgICBtb2RlbElkPzogc3RyaW5nO1xuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiAnZmluaXNoJztcbiAgICAgIGZpbmlzaFJlYXNvbjogTGFuZ3VhZ2VNb2RlbFYyRmluaXNoUmVhc29uO1xuICAgICAgdXNhZ2U6IExhbmd1YWdlTW9kZWxWMlVzYWdlO1xuICAgICAgcHJvdmlkZXJNZXRhZGF0YT86IFNoYXJlZFYyUHJvdmlkZXJNZXRhZGF0YTtcbiAgICB9O1xuIiwgImltcG9ydCB7IEludmFsaWRBcmd1bWVudEVycm9yIH0gZnJvbSAnLi4vZXJyb3IvaW52YWxpZC1hcmd1bWVudC1lcnJvcic7XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgY29zaW5lIHNpbWlsYXJpdHkgYmV0d2VlbiB0d28gdmVjdG9ycy4gVGhpcyBpcyBhIHVzZWZ1bCBtZXRyaWMgZm9yXG4gKiBjb21wYXJpbmcgdGhlIHNpbWlsYXJpdHkgb2YgdHdvIHZlY3RvcnMgc3VjaCBhcyBlbWJlZGRpbmdzLlxuICpcbiAqIEBwYXJhbSB2ZWN0b3IxIC0gVGhlIGZpcnN0IHZlY3Rvci5cbiAqIEBwYXJhbSB2ZWN0b3IyIC0gVGhlIHNlY29uZCB2ZWN0b3IuXG4gKlxuICogQHJldHVybnMgVGhlIGNvc2luZSBzaW1pbGFyaXR5IGJldHdlZW4gdmVjdG9yMSBhbmQgdmVjdG9yMi5cbiAqIEByZXR1cm5zIDAgaWYgZWl0aGVyIHZlY3RvciBpcyB0aGUgemVybyB2ZWN0b3IuXG4gKlxuICogQHRocm93cyB7SW52YWxpZEFyZ3VtZW50RXJyb3J9IElmIHRoZSB2ZWN0b3JzIGRvIG5vdCBoYXZlIHRoZSBzYW1lIGxlbmd0aC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvc2luZVNpbWlsYXJpdHkodmVjdG9yMTogbnVtYmVyW10sIHZlY3RvcjI6IG51bWJlcltdKTogbnVtYmVyIHtcbiAgaWYgKHZlY3RvcjEubGVuZ3RoICE9PSB2ZWN0b3IyLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBJbnZhbGlkQXJndW1lbnRFcnJvcih7XG4gICAgICBwYXJhbWV0ZXI6ICd2ZWN0b3IxLHZlY3RvcjInLFxuICAgICAgdmFsdWU6IHsgdmVjdG9yMUxlbmd0aDogdmVjdG9yMS5sZW5ndGgsIHZlY3RvcjJMZW5ndGg6IHZlY3RvcjIubGVuZ3RoIH0sXG4gICAgICBtZXNzYWdlOiBgVmVjdG9ycyBtdXN0IGhhdmUgdGhlIHNhbWUgbGVuZ3RoYCxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IG4gPSB2ZWN0b3IxLmxlbmd0aDtcblxuICBpZiAobiA9PT0gMCkge1xuICAgIHJldHVybiAwOyAvLyBSZXR1cm4gMCBmb3IgZW1wdHkgdmVjdG9ycyBpZiBubyBlcnJvciBpcyB0aHJvd25cbiAgfVxuXG4gIGxldCBtYWduaXR1ZGVTcXVhcmVkMSA9IDA7XG4gIGxldCBtYWduaXR1ZGVTcXVhcmVkMiA9IDA7XG4gIGxldCBkb3RQcm9kdWN0ID0gMDtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xuICAgIGNvbnN0IHZhbHVlMSA9IHZlY3RvcjFbaV07XG4gICAgY29uc3QgdmFsdWUyID0gdmVjdG9yMltpXTtcblxuICAgIG1hZ25pdHVkZVNxdWFyZWQxICs9IHZhbHVlMSAqIHZhbHVlMTtcbiAgICBtYWduaXR1ZGVTcXVhcmVkMiArPSB2YWx1ZTIgKiB2YWx1ZTI7XG4gICAgZG90UHJvZHVjdCArPSB2YWx1ZTEgKiB2YWx1ZTI7XG4gIH1cblxuICByZXR1cm4gbWFnbml0dWRlU3F1YXJlZDEgPT09IDAgfHwgbWFnbml0dWRlU3F1YXJlZDIgPT09IDBcbiAgICA/IDBcbiAgICA6IGRvdFByb2R1Y3QgL1xuICAgICAgICAoTWF0aC5zcXJ0KG1hZ25pdHVkZVNxdWFyZWQxKSAqIE1hdGguc3FydChtYWduaXR1ZGVTcXVhcmVkMikpO1xufVxuIiwgIi8qKlxuICogQ29udmVydHMgYSBkYXRhIFVSTCBvZiB0eXBlIHRleHQvKiB0byBhIHRleHQgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGV4dEZyb21EYXRhVXJsKGRhdGFVcmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IFtoZWFkZXIsIGJhc2U2NENvbnRlbnRdID0gZGF0YVVybC5zcGxpdCgnLCcpO1xuICBjb25zdCBtZWRpYVR5cGUgPSBoZWFkZXIuc3BsaXQoJzsnKVswXS5zcGxpdCgnOicpWzFdO1xuXG4gIGlmIChtZWRpYVR5cGUgPT0gbnVsbCB8fCBiYXNlNjRDb250ZW50ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZGF0YSBVUkwgZm9ybWF0Jyk7XG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiB3aW5kb3cuYXRvYihiYXNlNjRDb250ZW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGRlY29kaW5nIGRhdGEgVVJMYCk7XG4gIH1cbn1cbiIsICIvKipcbiAqIFBlcmZvcm1zIGEgZGVlcC1lcXVhbCBjb21wYXJpc29uIG9mIHR3byBwYXJzZWQgSlNPTiBvYmplY3RzLlxuICpcbiAqIEBwYXJhbSB7YW55fSBvYmoxIC0gVGhlIGZpcnN0IG9iamVjdCB0byBjb21wYXJlLlxuICogQHBhcmFtIHthbnl9IG9iajIgLSBUaGUgc2Vjb25kIG9iamVjdCB0byBjb21wYXJlLlxuICogQHJldHVybnMge2Jvb2xlYW59IC0gUmV0dXJucyB0cnVlIGlmIHRoZSB0d28gb2JqZWN0cyBhcmUgZGVlcGx5IGVxdWFsLCBmYWxzZSBvdGhlcndpc2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0RlZXBFcXVhbERhdGEob2JqMTogYW55LCBvYmoyOiBhbnkpOiBib29sZWFuIHtcbiAgLy8gQ2hlY2sgZm9yIHN0cmljdCBlcXVhbGl0eSBmaXJzdFxuICBpZiAob2JqMSA9PT0gb2JqMikgcmV0dXJuIHRydWU7XG5cbiAgLy8gQ2hlY2sgaWYgZWl0aGVyIGlzIG51bGwgb3IgdW5kZWZpbmVkXG4gIGlmIChvYmoxID09IG51bGwgfHwgb2JqMiA9PSBudWxsKSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gQ2hlY2sgaWYgYm90aCBhcmUgb2JqZWN0c1xuICBpZiAodHlwZW9mIG9iajEgIT09ICdvYmplY3QnICYmIHR5cGVvZiBvYmoyICE9PSAnb2JqZWN0JylcbiAgICByZXR1cm4gb2JqMSA9PT0gb2JqMjtcblxuICAvLyBJZiB0aGV5IGFyZSBub3Qgc3RyaWN0bHkgZXF1YWwsIHRoZXkgYm90aCBuZWVkIHRvIGJlIE9iamVjdHNcbiAgaWYgKG9iajEuY29uc3RydWN0b3IgIT09IG9iajIuY29uc3RydWN0b3IpIHJldHVybiBmYWxzZTtcblxuICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBEYXRlIG9iamVjdHNcbiAgaWYgKG9iajEgaW5zdGFuY2VvZiBEYXRlICYmIG9iajIgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgcmV0dXJuIG9iajEuZ2V0VGltZSgpID09PSBvYmoyLmdldFRpbWUoKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBhcnJheXM6IGNvbXBhcmUgbGVuZ3RoIGFuZCB0aGVuIHBlcmZvcm0gYSByZWN1cnNpdmUgZGVlcCBjb21wYXJpc29uIG9uIGVhY2ggaXRlbVxuICBpZiAoQXJyYXkuaXNBcnJheShvYmoxKSkge1xuICAgIGlmIChvYmoxLmxlbmd0aCAhPT0gb2JqMi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9iajEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghaXNEZWVwRXF1YWxEYXRhKG9iajFbaV0sIG9iajJbaV0pKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlOyAvLyBBbGwgYXJyYXkgZWxlbWVudHMgbWF0Y2hlZFxuICB9XG5cbiAgLy8gQ29tcGFyZSB0aGUgc2V0IG9mIGtleXMgaW4gZWFjaCBvYmplY3RcbiAgY29uc3Qga2V5czEgPSBPYmplY3Qua2V5cyhvYmoxKTtcbiAgY29uc3Qga2V5czIgPSBPYmplY3Qua2V5cyhvYmoyKTtcbiAgaWYgKGtleXMxLmxlbmd0aCAhPT0ga2V5czIubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gQ2hlY2sgZWFjaCBrZXktdmFsdWUgcGFpciByZWN1cnNpdmVseVxuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzMSkge1xuICAgIGlmICgha2V5czIuaW5jbHVkZXMoa2V5KSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmICghaXNEZWVwRXF1YWxEYXRhKG9iajFba2V5XSwgb2JqMltrZXldKSkgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7IC8vIEFsbCBrZXlzIGFuZCB2YWx1ZXMgbWF0Y2hlZFxufVxuIiwgImltcG9ydCB7IEpvYiB9IGZyb20gJy4vam9iJztcblxuZXhwb3J0IGNsYXNzIFNlcmlhbEpvYkV4ZWN1dG9yIHtcbiAgcHJpdmF0ZSBxdWV1ZTogQXJyYXk8Sm9iPiA9IFtdO1xuICBwcml2YXRlIGlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuXG4gIHByaXZhdGUgYXN5bmMgcHJvY2Vzc1F1ZXVlKCkge1xuICAgIGlmICh0aGlzLmlzUHJvY2Vzc2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gdHJ1ZTtcblxuICAgIHdoaWxlICh0aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgIGF3YWl0IHRoaXMucXVldWVbMF0oKTtcbiAgICAgIHRoaXMucXVldWUuc2hpZnQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuICB9XG5cbiAgYXN5bmMgcnVuKGpvYjogSm9iKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMucXVldWUucHVzaChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgam9iKCk7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB2b2lkIHRoaXMucHJvY2Vzc1F1ZXVlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBkZWxheSBhcyBkZWxheUZ1bmN0aW9uIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlYWRhYmxlU3RyZWFtIHRoYXQgZW1pdHMgdGhlIHByb3ZpZGVkIHZhbHVlcyB3aXRoIGFuIG9wdGlvbmFsIGRlbGF5IGJldHdlZW4gZWFjaCB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFRoZSBjb25maWd1cmF0aW9uIG9wdGlvbnNcbiAqIEBwYXJhbSBvcHRpb25zLmNodW5rcyAtIEFycmF5IG9mIHZhbHVlcyB0byBiZSBlbWl0dGVkIGJ5IHRoZSBzdHJlYW1cbiAqIEBwYXJhbSBvcHRpb25zLmluaXRpYWxEZWxheUluTXMgLSBPcHRpb25hbCBpbml0aWFsIGRlbGF5IGluIG1pbGxpc2Vjb25kcyBiZWZvcmUgZW1pdHRpbmcgdGhlIGZpcnN0IHZhbHVlIChkZWZhdWx0OiAwKS4gQ2FuIGJlIHNldCB0byBgbnVsbGAgdG8gc2tpcCB0aGUgaW5pdGlhbCBkZWxheS4gVGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBgaW5pdGlhbERlbGF5SW5NczogbnVsbGAgYW5kIGBpbml0aWFsRGVsYXlJbk1zOiAwYCBpcyB0aGF0IGBpbml0aWFsRGVsYXlJbk1zOiBudWxsYCB3aWxsIGVtaXQgdGhlIHZhbHVlcyB3aXRob3V0IGFueSBkZWxheSwgd2hpbGUgYGluaXRpYWxEZWxheUluTXM6IDBgIHdpbGwgZW1pdCB0aGUgdmFsdWVzIHdpdGggYSBkZWxheSBvZiAwIG1pbGxpc2Vjb25kcy5cbiAqIEBwYXJhbSBvcHRpb25zLmNodW5rRGVsYXlJbk1zIC0gT3B0aW9uYWwgZGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJldHdlZW4gZW1pdHRpbmcgZWFjaCB2YWx1ZSAoZGVmYXVsdDogMCkuIENhbiBiZSBzZXQgdG8gYG51bGxgIHRvIHNraXAgdGhlIGRlbGF5LiBUaGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGBjaHVua0RlbGF5SW5NczogbnVsbGAgYW5kIGBjaHVua0RlbGF5SW5NczogMGAgaXMgdGhhdCBgY2h1bmtEZWxheUluTXM6IG51bGxgIHdpbGwgZW1pdCB0aGUgdmFsdWVzIHdpdGhvdXQgYW55IGRlbGF5LCB3aGlsZSBgY2h1bmtEZWxheUluTXM6IDBgIHdpbGwgZW1pdCB0aGUgdmFsdWVzIHdpdGggYSBkZWxheSBvZiAwIG1pbGxpc2Vjb25kcy5cbiAqIEByZXR1cm5zIEEgUmVhZGFibGVTdHJlYW0gdGhhdCBlbWl0cyB0aGUgcHJvdmlkZWQgdmFsdWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaW11bGF0ZVJlYWRhYmxlU3RyZWFtPFQ+KHtcbiAgY2h1bmtzLFxuICBpbml0aWFsRGVsYXlJbk1zID0gMCxcbiAgY2h1bmtEZWxheUluTXMgPSAwLFxuICBfaW50ZXJuYWwsXG59OiB7XG4gIGNodW5rczogVFtdO1xuICBpbml0aWFsRGVsYXlJbk1zPzogbnVtYmVyIHwgbnVsbDtcbiAgY2h1bmtEZWxheUluTXM/OiBudW1iZXIgfCBudWxsO1xuICBfaW50ZXJuYWw/OiB7XG4gICAgZGVsYXk/OiAobXM6IG51bWJlciB8IG51bGwpID0+IFByb21pc2U8dm9pZD47XG4gIH07XG59KTogUmVhZGFibGVTdHJlYW08VD4ge1xuICBjb25zdCBkZWxheSA9IF9pbnRlcm5hbD8uZGVsYXkgPz8gZGVsYXlGdW5jdGlvbjtcblxuICBsZXQgaW5kZXggPSAwO1xuXG4gIHJldHVybiBuZXcgUmVhZGFibGVTdHJlYW0oe1xuICAgIGFzeW5jIHB1bGwoY29udHJvbGxlcikge1xuICAgICAgaWYgKGluZGV4IDwgY2h1bmtzLmxlbmd0aCkge1xuICAgICAgICBhd2FpdCBkZWxheShpbmRleCA9PT0gMCA/IGluaXRpYWxEZWxheUluTXMgOiBjaHVua0RlbGF5SW5Ncyk7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShjaHVua3NbaW5kZXgrK10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0sXG4gIH0pO1xufVxuIiwgImltcG9ydCB7IEFJU0RLRXJyb3IgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IFNwZWVjaE1vZGVsUmVzcG9uc2VNZXRhZGF0YSB9IGZyb20gJy4uL3R5cGVzL3NwZWVjaC1tb2RlbC1yZXNwb25zZS1tZXRhZGF0YSc7XG5cbi8qKlxuRXJyb3IgdGhhdCBpcyB0aHJvd24gd2hlbiBubyBzcGVlY2ggYXVkaW8gd2FzIGdlbmVyYXRlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIE5vU3BlZWNoR2VuZXJhdGVkRXJyb3IgZXh0ZW5kcyBBSVNES0Vycm9yIHtcbiAgcmVhZG9ubHkgcmVzcG9uc2VzOiBBcnJheTxTcGVlY2hNb2RlbFJlc3BvbnNlTWV0YWRhdGE+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHsgcmVzcG9uc2VzOiBBcnJheTxTcGVlY2hNb2RlbFJlc3BvbnNlTWV0YWRhdGE+IH0pIHtcbiAgICBzdXBlcih7XG4gICAgICBuYW1lOiAnQUlfTm9TcGVlY2hHZW5lcmF0ZWRFcnJvcicsXG4gICAgICBtZXNzYWdlOiAnTm8gc3BlZWNoIGF1ZGlvIGdlbmVyYXRlZC4nLFxuICAgIH0pO1xuXG4gICAgdGhpcy5yZXNwb25zZXMgPSBvcHRpb25zLnJlc3BvbnNlcztcbiAgfVxufVxuIiwgImltcG9ydCB7XG4gIEdlbmVyYXRlZEZpbGUsXG4gIERlZmF1bHRHZW5lcmF0ZWRGaWxlLFxufSBmcm9tICcuLi9nZW5lcmF0ZS10ZXh0L2dlbmVyYXRlZC1maWxlJztcblxuLyoqXG4gKiBBIGdlbmVyYXRlZCBhdWRpbyBmaWxlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZEF1ZGlvRmlsZSBleHRlbmRzIEdlbmVyYXRlZEZpbGUge1xuICAvKipcbiAgICogQXVkaW8gZm9ybWF0IG9mIHRoZSBmaWxlIChlLmcuLCAnbXAzJywgJ3dhdicsIGV0Yy4pXG4gICAqL1xuICByZWFkb25seSBmb3JtYXQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIERlZmF1bHRHZW5lcmF0ZWRBdWRpb0ZpbGVcbiAgZXh0ZW5kcyBEZWZhdWx0R2VuZXJhdGVkRmlsZVxuICBpbXBsZW1lbnRzIEdlbmVyYXRlZEF1ZGlvRmlsZVxue1xuICByZWFkb25seSBmb3JtYXQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgZGF0YSxcbiAgICBtZWRpYVR5cGUsXG4gIH06IHtcbiAgICBkYXRhOiBzdHJpbmcgfCBVaW50OEFycmF5O1xuICAgIG1lZGlhVHlwZTogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBkYXRhLCBtZWRpYVR5cGUgfSk7XG4gICAgbGV0IGZvcm1hdCA9ICdtcDMnO1xuXG4gICAgLy8gSWYgZm9ybWF0IGlzIG5vdCBwcm92aWRlZCwgdHJ5IHRvIGRldGVybWluZSBpdCBmcm9tIHRoZSBtZWRpYSB0eXBlXG4gICAgaWYgKG1lZGlhVHlwZSkge1xuICAgICAgY29uc3QgbWVkaWFUeXBlUGFydHMgPSBtZWRpYVR5cGUuc3BsaXQoJy8nKTtcblxuICAgICAgaWYgKG1lZGlhVHlwZVBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAvLyBIYW5kbGUgc3BlY2lhbCBjYXNlcyBmb3IgYXVkaW8gZm9ybWF0c1xuICAgICAgICBpZiAobWVkaWFUeXBlICE9PSAnYXVkaW8vbXBlZycpIHtcbiAgICAgICAgICBmb3JtYXQgPSBtZWRpYVR5cGVQYXJ0c1sxXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghZm9ybWF0KSB7XG4gICAgICAvLyBUT0RPIHRoaXMgc2hvdWxkIGJlIGFuIEFJIFNESyBlcnJvclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnQXVkaW8gZm9ybWF0IG11c3QgYmUgcHJvdmlkZWQgb3IgZGV0ZXJtaW5hYmxlIGZyb20gbWVkaWEgdHlwZScsXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0R2VuZXJhdGVkQXVkaW9GaWxlV2l0aFR5cGUgZXh0ZW5kcyBEZWZhdWx0R2VuZXJhdGVkQXVkaW9GaWxlIHtcbiAgcmVhZG9ubHkgdHlwZSA9ICdhdWRpbyc7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczoge1xuICAgIGRhdGE6IHN0cmluZyB8IFVpbnQ4QXJyYXk7XG4gICAgbWVkaWFUeXBlOiBzdHJpbmc7XG4gICAgZm9ybWF0OiBzdHJpbmc7XG4gIH0pIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEpTT05WYWx1ZSwgU3BlZWNoTW9kZWxWMiB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgUHJvdmlkZXJPcHRpb25zIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBOb1NwZWVjaEdlbmVyYXRlZEVycm9yIH0gZnJvbSAnLi4vZXJyb3Ivbm8tc3BlZWNoLWdlbmVyYXRlZC1lcnJvcic7XG5pbXBvcnQge1xuICBhdWRpb01lZGlhVHlwZVNpZ25hdHVyZXMsXG4gIGRldGVjdE1lZGlhVHlwZSxcbn0gZnJvbSAnLi4vdXRpbC9kZXRlY3QtbWVkaWEtdHlwZSc7XG5pbXBvcnQgeyBwcmVwYXJlUmV0cmllcyB9IGZyb20gJy4uL3V0aWwvcHJlcGFyZS1yZXRyaWVzJztcbmltcG9ydCB7IFVuc3VwcG9ydGVkTW9kZWxWZXJzaW9uRXJyb3IgfSBmcm9tICcuLi9lcnJvci91bnN1cHBvcnRlZC1tb2RlbC12ZXJzaW9uLWVycm9yJztcbmltcG9ydCB7IFNwZWVjaFdhcm5pbmcgfSBmcm9tICcuLi90eXBlcy9zcGVlY2gtbW9kZWwnO1xuaW1wb3J0IHsgU3BlZWNoTW9kZWxSZXNwb25zZU1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvc3BlZWNoLW1vZGVsLXJlc3BvbnNlLW1ldGFkYXRhJztcbmltcG9ydCB7IFNwZWVjaFJlc3VsdCB9IGZyb20gJy4vZ2VuZXJhdGUtc3BlZWNoLXJlc3VsdCc7XG5pbXBvcnQge1xuICBEZWZhdWx0R2VuZXJhdGVkQXVkaW9GaWxlLFxuICBHZW5lcmF0ZWRBdWRpb0ZpbGUsXG59IGZyb20gJy4vZ2VuZXJhdGVkLWF1ZGlvLWZpbGUnO1xuXG4vKipcbkdlbmVyYXRlcyBzcGVlY2ggYXVkaW8gdXNpbmcgYSBzcGVlY2ggbW9kZWwuXG5cbkBwYXJhbSBtb2RlbCAtIFRoZSBzcGVlY2ggbW9kZWwgdG8gdXNlLlxuQHBhcmFtIHRleHQgLSBUaGUgdGV4dCB0byBjb252ZXJ0IHRvIHNwZWVjaC5cbkBwYXJhbSB2b2ljZSAtIFRoZSB2b2ljZSB0byB1c2UgZm9yIHNwZWVjaCBnZW5lcmF0aW9uLlxuQHBhcmFtIG91dHB1dEZvcm1hdCAtIFRoZSBvdXRwdXQgZm9ybWF0IHRvIHVzZSBmb3Igc3BlZWNoIGdlbmVyYXRpb24gZS5nLiBcIm1wM1wiLCBcIndhdlwiLCBldGMuXG5AcGFyYW0gaW5zdHJ1Y3Rpb25zIC0gSW5zdHJ1Y3Rpb25zIGZvciB0aGUgc3BlZWNoIGdlbmVyYXRpb24gZS5nLiBcIlNwZWFrIGluIGEgc2xvdyBhbmQgc3RlYWR5IHRvbmVcIi5cbkBwYXJhbSBzcGVlZCAtIFRoZSBzcGVlZCBvZiB0aGUgc3BlZWNoIGdlbmVyYXRpb24uXG5AcGFyYW0gcHJvdmlkZXJPcHRpb25zIC0gQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBvcHRpb25zIHRoYXQgYXJlIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlclxuYXMgYm9keSBwYXJhbWV0ZXJzLlxuQHBhcmFtIG1heFJldHJpZXMgLSBNYXhpbXVtIG51bWJlciBvZiByZXRyaWVzLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJldHJpZXMuIERlZmF1bHQ6IDIuXG5AcGFyYW0gYWJvcnRTaWduYWwgLSBBbiBvcHRpb25hbCBhYm9ydCBzaWduYWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjYW5jZWwgdGhlIGNhbGwuXG5AcGFyYW0gaGVhZGVycyAtIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIGJlIHNlbnQgd2l0aCB0aGUgcmVxdWVzdC4gT25seSBhcHBsaWNhYmxlIGZvciBIVFRQLWJhc2VkIHByb3ZpZGVycy5cblxuQHJldHVybnMgQSByZXN1bHQgb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIGdlbmVyYXRlZCBhdWRpbyBkYXRhLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTcGVlY2goe1xuICBtb2RlbCxcbiAgdGV4dCxcbiAgdm9pY2UsXG4gIG91dHB1dEZvcm1hdCxcbiAgaW5zdHJ1Y3Rpb25zLFxuICBzcGVlZCxcbiAgbGFuZ3VhZ2UsXG4gIHByb3ZpZGVyT3B0aW9ucyA9IHt9LFxuICBtYXhSZXRyaWVzOiBtYXhSZXRyaWVzQXJnLFxuICBhYm9ydFNpZ25hbCxcbiAgaGVhZGVycyxcbn06IHtcbiAgLyoqXG5UaGUgc3BlZWNoIG1vZGVsIHRvIHVzZS5cbiAgICAgKi9cbiAgbW9kZWw6IFNwZWVjaE1vZGVsVjI7XG5cbiAgLyoqXG5UaGUgdGV4dCB0byBjb252ZXJ0IHRvIHNwZWVjaC5cbiAgICovXG4gIHRleHQ6IHN0cmluZztcblxuICAvKipcblRoZSB2b2ljZSB0byB1c2UgZm9yIHNwZWVjaCBnZW5lcmF0aW9uLlxuICAgKi9cbiAgdm9pY2U/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBkZXNpcmVkIG91dHB1dCBmb3JtYXQgZm9yIHRoZSBhdWRpbyBlLmcuIFwibXAzXCIsIFwid2F2XCIsIGV0Yy5cbiAgICovXG4gIG91dHB1dEZvcm1hdD86ICdtcDMnIHwgJ3dhdicgfCAoc3RyaW5nICYge30pO1xuXG4gIC8qKlxuICAgIEluc3RydWN0aW9ucyBmb3IgdGhlIHNwZWVjaCBnZW5lcmF0aW9uIGUuZy4gXCJTcGVhayBpbiBhIHNsb3cgYW5kIHN0ZWFkeSB0b25lXCIuXG4gICovXG4gIGluc3RydWN0aW9ucz86IHN0cmluZztcblxuICAvKipcbiAgVGhlIHNwZWVkIG9mIHRoZSBzcGVlY2ggZ2VuZXJhdGlvbi5cbiAgICovXG4gIHNwZWVkPzogbnVtYmVyO1xuXG4gIC8qKlxuICBUaGUgbGFuZ3VhZ2UgZm9yIHNwZWVjaCBnZW5lcmF0aW9uLiBUaGlzIHNob3VsZCBiZSBhbiBJU08gNjM5LTEgbGFuZ3VhZ2UgY29kZSAoZS5nLiBcImVuXCIsIFwiZXNcIiwgXCJmclwiKVxuICBvciBcImF1dG9cIiBmb3IgYXV0b21hdGljIGxhbmd1YWdlIGRldGVjdGlvbi4gUHJvdmlkZXIgc3VwcG9ydCB2YXJpZXMuXG4gICAqL1xuICBsYW5ndWFnZT86IHN0cmluZztcblxuICAvKipcbkFkZGl0aW9uYWwgcHJvdmlkZXItc3BlY2lmaWMgb3B0aW9ucyB0aGF0IGFyZSBwYXNzZWQgdGhyb3VnaCB0byB0aGUgcHJvdmlkZXJcbmFzIGJvZHkgcGFyYW1ldGVycy5cblxuVGhlIG91dGVyIHJlY29yZCBpcyBrZXllZCBieSB0aGUgcHJvdmlkZXIgbmFtZSwgYW5kIHRoZSBpbm5lclxucmVjb3JkIGlzIGtleWVkIGJ5IHRoZSBwcm92aWRlci1zcGVjaWZpYyBtZXRhZGF0YSBrZXkuXG5gYGB0c1xue1xuICBcIm9wZW5haVwiOiB7fVxufVxuYGBgXG4gICAgICovXG4gIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcblxuICAvKipcbk1heGltdW0gbnVtYmVyIG9mIHJldHJpZXMgcGVyIHNwZWVjaCBtb2RlbCBjYWxsLiBTZXQgdG8gMCB0byBkaXNhYmxlIHJldHJpZXMuXG5cbkBkZWZhdWx0IDJcbiAgICovXG4gIG1heFJldHJpZXM/OiBudW1iZXI7XG5cbiAgLyoqXG5BYm9ydCBzaWduYWwuXG4gKi9cbiAgYWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDtcblxuICAvKipcbkFkZGl0aW9uYWwgaGVhZGVycyB0byBpbmNsdWRlIGluIHRoZSByZXF1ZXN0LlxuT25seSBhcHBsaWNhYmxlIGZvciBIVFRQLWJhc2VkIHByb3ZpZGVycy5cbiAqL1xuICBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbn0pOiBQcm9taXNlPFNwZWVjaFJlc3VsdD4ge1xuICBpZiAobW9kZWwuc3BlY2lmaWNhdGlvblZlcnNpb24gIT09ICd2MicpIHtcbiAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRNb2RlbFZlcnNpb25FcnJvcih7XG4gICAgICB2ZXJzaW9uOiBtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbixcbiAgICAgIHByb3ZpZGVyOiBtb2RlbC5wcm92aWRlcixcbiAgICAgIG1vZGVsSWQ6IG1vZGVsLm1vZGVsSWQsXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCB7IHJldHJ5IH0gPSBwcmVwYXJlUmV0cmllcyh7XG4gICAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgICBhYm9ydFNpZ25hbCxcbiAgfSk7XG5cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmV0cnkoKCkgPT5cbiAgICBtb2RlbC5kb0dlbmVyYXRlKHtcbiAgICAgIHRleHQsXG4gICAgICB2b2ljZSxcbiAgICAgIG91dHB1dEZvcm1hdCxcbiAgICAgIGluc3RydWN0aW9ucyxcbiAgICAgIHNwZWVkLFxuICAgICAgbGFuZ3VhZ2UsXG4gICAgICBhYm9ydFNpZ25hbCxcbiAgICAgIGhlYWRlcnMsXG4gICAgICBwcm92aWRlck9wdGlvbnMsXG4gICAgfSksXG4gICk7XG5cbiAgaWYgKCFyZXN1bHQuYXVkaW8gfHwgcmVzdWx0LmF1ZGlvLmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBOb1NwZWVjaEdlbmVyYXRlZEVycm9yKHsgcmVzcG9uc2VzOiBbcmVzdWx0LnJlc3BvbnNlXSB9KTtcbiAgfVxuXG4gIHJldHVybiBuZXcgRGVmYXVsdFNwZWVjaFJlc3VsdCh7XG4gICAgYXVkaW86IG5ldyBEZWZhdWx0R2VuZXJhdGVkQXVkaW9GaWxlKHtcbiAgICAgIGRhdGE6IHJlc3VsdC5hdWRpbyxcbiAgICAgIG1lZGlhVHlwZTpcbiAgICAgICAgZGV0ZWN0TWVkaWFUeXBlKHtcbiAgICAgICAgICBkYXRhOiByZXN1bHQuYXVkaW8sXG4gICAgICAgICAgc2lnbmF0dXJlczogYXVkaW9NZWRpYVR5cGVTaWduYXR1cmVzLFxuICAgICAgICB9KSA/PyAnYXVkaW8vbXAzJyxcbiAgICB9KSxcbiAgICB3YXJuaW5nczogcmVzdWx0Lndhcm5pbmdzLFxuICAgIHJlc3BvbnNlczogW3Jlc3VsdC5yZXNwb25zZV0sXG4gICAgcHJvdmlkZXJNZXRhZGF0YTogcmVzdWx0LnByb3ZpZGVyTWV0YWRhdGEsXG4gIH0pO1xufVxuXG5jbGFzcyBEZWZhdWx0U3BlZWNoUmVzdWx0IGltcGxlbWVudHMgU3BlZWNoUmVzdWx0IHtcbiAgcmVhZG9ubHkgYXVkaW86IEdlbmVyYXRlZEF1ZGlvRmlsZTtcbiAgcmVhZG9ubHkgd2FybmluZ3M6IEFycmF5PFNwZWVjaFdhcm5pbmc+O1xuICByZWFkb25seSByZXNwb25zZXM6IEFycmF5PFNwZWVjaE1vZGVsUmVzcG9uc2VNZXRhZGF0YT47XG4gIHJlYWRvbmx5IHByb3ZpZGVyTWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIEpTT05WYWx1ZT4+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHtcbiAgICBhdWRpbzogR2VuZXJhdGVkQXVkaW9GaWxlO1xuICAgIHdhcm5pbmdzOiBBcnJheTxTcGVlY2hXYXJuaW5nPjtcbiAgICByZXNwb25zZXM6IEFycmF5PFNwZWVjaE1vZGVsUmVzcG9uc2VNZXRhZGF0YT47XG4gICAgcHJvdmlkZXJNZXRhZGF0YTogUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgSlNPTlZhbHVlPj4gfCB1bmRlZmluZWQ7XG4gIH0pIHtcbiAgICB0aGlzLmF1ZGlvID0gb3B0aW9ucy5hdWRpbztcbiAgICB0aGlzLndhcm5pbmdzID0gb3B0aW9ucy53YXJuaW5ncztcbiAgICB0aGlzLnJlc3BvbnNlcyA9IG9wdGlvbnMucmVzcG9uc2VzO1xuICAgIHRoaXMucHJvdmlkZXJNZXRhZGF0YSA9IG9wdGlvbnMucHJvdmlkZXJNZXRhZGF0YSA/PyB7fTtcbiAgfVxufVxuIiwgImltcG9ydCB7IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBhc1NjaGVtYSxcbiAgc2FmZVBhcnNlSlNPTixcbiAgc2FmZVZhbGlkYXRlVHlwZXMsXG4gIFNjaGVtYSxcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgKiBhcyB6MyBmcm9tICd6b2QvdjMnO1xuaW1wb3J0ICogYXMgejQgZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IE5vT2JqZWN0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby1vYmplY3QtZ2VuZXJhdGVkLWVycm9yJztcbmltcG9ydCB7IERlZXBQYXJ0aWFsIH0gZnJvbSAnLi4vdXRpbC9kZWVwLXBhcnRpYWwnO1xuaW1wb3J0IHsgcGFyc2VQYXJ0aWFsSnNvbiB9IGZyb20gJy4uL3V0aWwvcGFyc2UtcGFydGlhbC1qc29uJztcbmltcG9ydCB7IEZpbmlzaFJlYXNvbiB9IGZyb20gJy4uL3R5cGVzL2xhbmd1YWdlLW1vZGVsJztcbmltcG9ydCB7IExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvbGFuZ3VhZ2UtbW9kZWwtcmVzcG9uc2UtbWV0YWRhdGEnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VNb2RlbFVzYWdlIH0gZnJvbSAnLi4vdHlwZXMvdXNhZ2UnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE91dHB1dDxPVVRQVVQsIFBBUlRJQUw+IHtcbiAgcmVhZG9ubHkgdHlwZTogJ29iamVjdCcgfCAndGV4dCc7XG5cbiAgcmVzcG9uc2VGb3JtYXQ6IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zWydyZXNwb25zZUZvcm1hdCddO1xuXG4gIHBhcnNlUGFydGlhbChvcHRpb25zOiB7XG4gICAgdGV4dDogc3RyaW5nO1xuICB9KTogUHJvbWlzZTx7IHBhcnRpYWw6IFBBUlRJQUwgfSB8IHVuZGVmaW5lZD47XG5cbiAgcGFyc2VPdXRwdXQoXG4gICAgb3B0aW9uczogeyB0ZXh0OiBzdHJpbmcgfSxcbiAgICBjb250ZXh0OiB7XG4gICAgICByZXNwb25zZTogTGFuZ3VhZ2VNb2RlbFJlc3BvbnNlTWV0YWRhdGE7XG4gICAgICB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlO1xuICAgICAgZmluaXNoUmVhc29uOiBGaW5pc2hSZWFzb247XG4gICAgfSxcbiAgKTogUHJvbWlzZTxPVVRQVVQ+O1xufVxuXG5leHBvcnQgY29uc3QgdGV4dCA9ICgpOiBPdXRwdXQ8c3RyaW5nLCBzdHJpbmc+ID0+ICh7XG4gIHR5cGU6ICd0ZXh0JyxcblxuICByZXNwb25zZUZvcm1hdDogeyB0eXBlOiAndGV4dCcgfSxcblxuICBhc3luYyBwYXJzZVBhcnRpYWwoeyB0ZXh0IH06IHsgdGV4dDogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4geyBwYXJ0aWFsOiB0ZXh0IH07XG4gIH0sXG5cbiAgYXN5bmMgcGFyc2VPdXRwdXQoeyB0ZXh0IH06IHsgdGV4dDogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfSxcbn0pO1xuXG5leHBvcnQgY29uc3Qgb2JqZWN0ID0gPE9VVFBVVD4oe1xuICBzY2hlbWE6IGlucHV0U2NoZW1hLFxufToge1xuICBzY2hlbWE6XG4gICAgfCB6NC5jb3JlLiRab2RUeXBlPE9VVFBVVCwgYW55PlxuICAgIHwgejMuU2NoZW1hPE9VVFBVVCwgejMuWm9kVHlwZURlZiwgYW55PlxuICAgIHwgU2NoZW1hPE9VVFBVVD47XG59KTogT3V0cHV0PE9VVFBVVCwgRGVlcFBhcnRpYWw8T1VUUFVUPj4gPT4ge1xuICBjb25zdCBzY2hlbWEgPSBhc1NjaGVtYShpbnB1dFNjaGVtYSk7XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnb2JqZWN0JyxcblxuICAgIHJlc3BvbnNlRm9ybWF0OiB7XG4gICAgICB0eXBlOiAnanNvbicsXG4gICAgICBzY2hlbWE6IHNjaGVtYS5qc29uU2NoZW1hLFxuICAgIH0sXG5cbiAgICBhc3luYyBwYXJzZVBhcnRpYWwoeyB0ZXh0IH06IHsgdGV4dDogc3RyaW5nIH0pIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBhcnNlUGFydGlhbEpzb24odGV4dCk7XG5cbiAgICAgIHN3aXRjaCAocmVzdWx0LnN0YXRlKSB7XG4gICAgICAgIGNhc2UgJ2ZhaWxlZC1wYXJzZSc6XG4gICAgICAgIGNhc2UgJ3VuZGVmaW5lZC1pbnB1dCc6XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgICAgICBjYXNlICdyZXBhaXJlZC1wYXJzZSc6XG4gICAgICAgIGNhc2UgJ3N1Y2Nlc3NmdWwtcGFyc2UnOlxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyBOb3RlOiBjdXJyZW50bHkgbm8gdmFsaWRhdGlvbiBvZiBwYXJ0aWFsIHJlc3VsdHM6XG4gICAgICAgICAgICBwYXJ0aWFsOiByZXN1bHQudmFsdWUgYXMgRGVlcFBhcnRpYWw8T1VUUFVUPixcbiAgICAgICAgICB9O1xuXG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICBjb25zdCBfZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IHJlc3VsdC5zdGF0ZTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIHBhcnNlIHN0YXRlOiAke19leGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYXN5bmMgcGFyc2VPdXRwdXQoXG4gICAgICB7IHRleHQgfTogeyB0ZXh0OiBzdHJpbmcgfSxcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgcmVzcG9uc2U6IExhbmd1YWdlTW9kZWxSZXNwb25zZU1ldGFkYXRhO1xuICAgICAgICB1c2FnZTogTGFuZ3VhZ2VNb2RlbFVzYWdlO1xuICAgICAgICBmaW5pc2hSZWFzb246IEZpbmlzaFJlYXNvbjtcbiAgICAgIH0sXG4gICAgKSB7XG4gICAgICBjb25zdCBwYXJzZVJlc3VsdCA9IGF3YWl0IHNhZmVQYXJzZUpTT04oeyB0ZXh0IH0pO1xuXG4gICAgICBpZiAoIXBhcnNlUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgdGhyb3cgbmV3IE5vT2JqZWN0R2VuZXJhdGVkRXJyb3Ioe1xuICAgICAgICAgIG1lc3NhZ2U6ICdObyBvYmplY3QgZ2VuZXJhdGVkOiBjb3VsZCBub3QgcGFyc2UgdGhlIHJlc3BvbnNlLicsXG4gICAgICAgICAgY2F1c2U6IHBhcnNlUmVzdWx0LmVycm9yLFxuICAgICAgICAgIHRleHQsXG4gICAgICAgICAgcmVzcG9uc2U6IGNvbnRleHQucmVzcG9uc2UsXG4gICAgICAgICAgdXNhZ2U6IGNvbnRleHQudXNhZ2UsXG4gICAgICAgICAgZmluaXNoUmVhc29uOiBjb250ZXh0LmZpbmlzaFJlYXNvbixcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBhd2FpdCBzYWZlVmFsaWRhdGVUeXBlcyh7XG4gICAgICAgIHZhbHVlOiBwYXJzZVJlc3VsdC52YWx1ZSxcbiAgICAgICAgc2NoZW1hLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghdmFsaWRhdGlvblJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIHRocm93IG5ldyBOb09iamVjdEdlbmVyYXRlZEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiAnTm8gb2JqZWN0IGdlbmVyYXRlZDogcmVzcG9uc2UgZGlkIG5vdCBtYXRjaCBzY2hlbWEuJyxcbiAgICAgICAgICBjYXVzZTogdmFsaWRhdGlvblJlc3VsdC5lcnJvcixcbiAgICAgICAgICB0ZXh0LFxuICAgICAgICAgIHJlc3BvbnNlOiBjb250ZXh0LnJlc3BvbnNlLFxuICAgICAgICAgIHVzYWdlOiBjb250ZXh0LnVzYWdlLFxuICAgICAgICAgIGZpbmlzaFJlYXNvbjogY29udGV4dC5maW5pc2hSZWFzb24sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmFsaWRhdGlvblJlc3VsdC52YWx1ZTtcbiAgICB9LFxuICB9O1xufTtcbiIsICJpbXBvcnQgeyBkZWxheSBhcyBvcmlnaW5hbERlbGF5IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQgeyBUZXh0U3RyZWFtUGFydCB9IGZyb20gJy4vc3RyZWFtLXRleHQtcmVzdWx0JztcbmltcG9ydCB7IFRvb2xTZXQgfSBmcm9tICcuL3Rvb2wtc2V0JztcbmltcG9ydCB7IEludmFsaWRBcmd1bWVudEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmNvbnN0IENIVU5LSU5HX1JFR0VYUFMgPSB7XG4gIHdvcmQ6IC9cXFMrXFxzKy9tLFxuICBsaW5lOiAvXFxuKy9tLFxufTtcblxuLyoqXG4gKiBEZXRlY3RzIHRoZSBmaXJzdCBjaHVuayBpbiBhIGJ1ZmZlci5cbiAqXG4gKiBAcGFyYW0gYnVmZmVyIC0gVGhlIGJ1ZmZlciB0byBkZXRlY3QgdGhlIGZpcnN0IGNodW5rIGluLlxuICpcbiAqIEByZXR1cm5zIFRoZSBmaXJzdCBkZXRlY3RlZCBjaHVuaywgb3IgYHVuZGVmaW5lZGAgaWYgbm8gY2h1bmsgd2FzIGRldGVjdGVkLlxuICovXG5leHBvcnQgdHlwZSBDaHVua0RldGVjdG9yID0gKGJ1ZmZlcjogc3RyaW5nKSA9PiBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsO1xuXG4vKipcbiAqIFNtb290aHMgdGV4dCBzdHJlYW1pbmcgb3V0cHV0LlxuICpcbiAqIEBwYXJhbSBkZWxheUluTXMgLSBUaGUgZGVsYXkgaW4gbWlsbGlzZWNvbmRzIGJldHdlZW4gZWFjaCBjaHVuay4gRGVmYXVsdHMgdG8gMTBtcy4gQ2FuIGJlIHNldCB0byBgbnVsbGAgdG8gc2tpcCB0aGUgZGVsYXkuXG4gKiBAcGFyYW0gY2h1bmtpbmcgLSBDb250cm9scyBob3cgdGhlIHRleHQgaXMgY2h1bmtlZCBmb3Igc3RyZWFtaW5nLiBVc2UgXCJ3b3JkXCIgdG8gc3RyZWFtIHdvcmQgYnkgd29yZCAoZGVmYXVsdCksIFwibGluZVwiIHRvIHN0cmVhbSBsaW5lIGJ5IGxpbmUsIG9yIHByb3ZpZGUgYSBjdXN0b20gUmVnRXhwIHBhdHRlcm4gZm9yIGN1c3RvbSBjaHVua2luZy5cbiAqXG4gKiBAcmV0dXJucyBBIHRyYW5zZm9ybSBzdHJlYW0gdGhhdCBzbW9vdGhzIHRleHQgc3RyZWFtaW5nIG91dHB1dC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNtb290aFN0cmVhbTxUT09MUyBleHRlbmRzIFRvb2xTZXQ+KHtcbiAgZGVsYXlJbk1zID0gMTAsXG4gIGNodW5raW5nID0gJ3dvcmQnLFxuICBfaW50ZXJuYWw6IHsgZGVsYXkgPSBvcmlnaW5hbERlbGF5IH0gPSB7fSxcbn06IHtcbiAgZGVsYXlJbk1zPzogbnVtYmVyIHwgbnVsbDtcbiAgY2h1bmtpbmc/OiAnd29yZCcgfCAnbGluZScgfCBSZWdFeHAgfCBDaHVua0RldGVjdG9yO1xuICAvKipcbiAgICogSW50ZXJuYWwuIEZvciB0ZXN0IHVzZSBvbmx5LiBNYXkgY2hhbmdlIHdpdGhvdXQgbm90aWNlLlxuICAgKi9cbiAgX2ludGVybmFsPzoge1xuICAgIGRlbGF5PzogKGRlbGF5SW5NczogbnVtYmVyIHwgbnVsbCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgfTtcbn0gPSB7fSk6IChvcHRpb25zOiB7XG4gIHRvb2xzOiBUT09MUztcbn0pID0+IFRyYW5zZm9ybVN0cmVhbTxUZXh0U3RyZWFtUGFydDxUT09MUz4sIFRleHRTdHJlYW1QYXJ0PFRPT0xTPj4ge1xuICBsZXQgZGV0ZWN0Q2h1bms6IENodW5rRGV0ZWN0b3I7XG5cbiAgaWYgKHR5cGVvZiBjaHVua2luZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRldGVjdENodW5rID0gYnVmZmVyID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoID0gY2h1bmtpbmcoYnVmZmVyKTtcblxuICAgICAgaWYgKG1hdGNoID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICghbWF0Y2gubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2h1bmtpbmcgZnVuY3Rpb24gbXVzdCByZXR1cm4gYSBub24tZW1wdHkgc3RyaW5nLmApO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWJ1ZmZlci5zdGFydHNXaXRoKG1hdGNoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYENodW5raW5nIGZ1bmN0aW9uIG11c3QgcmV0dXJuIGEgbWF0Y2ggdGhhdCBpcyBhIHByZWZpeCBvZiB0aGUgYnVmZmVyLiBSZWNlaXZlZDogXCIke21hdGNofVwiIGV4cGVjdGVkIHRvIHN0YXJ0IHdpdGggXCIke2J1ZmZlcn1cImAsXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBtYXRjaDtcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGNodW5raW5nUmVnZXggPVxuICAgICAgdHlwZW9mIGNodW5raW5nID09PSAnc3RyaW5nJyA/IENIVU5LSU5HX1JFR0VYUFNbY2h1bmtpbmddIDogY2h1bmtpbmc7XG5cbiAgICBpZiAoY2h1bmtpbmdSZWdleCA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgSW52YWxpZEFyZ3VtZW50RXJyb3Ioe1xuICAgICAgICBhcmd1bWVudDogJ2NodW5raW5nJyxcbiAgICAgICAgbWVzc2FnZTogYENodW5raW5nIG11c3QgYmUgXCJ3b3JkXCIgb3IgXCJsaW5lXCIgb3IgYSBSZWdFeHAuIFJlY2VpdmVkOiAke2NodW5raW5nfWAsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBkZXRlY3RDaHVuayA9IGJ1ZmZlciA9PiB7XG4gICAgICBjb25zdCBtYXRjaCA9IGNodW5raW5nUmVnZXguZXhlYyhidWZmZXIpO1xuXG4gICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnVmZmVyLnNsaWNlKDAsIG1hdGNoLmluZGV4KSArIG1hdGNoPy5bMF07XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiAoKSA9PiB7XG4gICAgbGV0IGJ1ZmZlciA9ICcnO1xuICAgIGxldCBpZCA9ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBUcmFuc2Zvcm1TdHJlYW08VGV4dFN0cmVhbVBhcnQ8VE9PTFM+LCBUZXh0U3RyZWFtUGFydDxUT09MUz4+KHtcbiAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICBpZiAoY2h1bmsudHlwZSAhPT0gJ3RleHQtZGVsdGEnKSB7XG4gICAgICAgICAgaWYgKGJ1ZmZlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1kZWx0YScsIHRleHQ6IGJ1ZmZlciwgaWQgfSk7XG4gICAgICAgICAgICBidWZmZXIgPSAnJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaHVuay5pZCAhPT0gaWQgJiYgYnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1kZWx0YScsIHRleHQ6IGJ1ZmZlciwgaWQgfSk7XG4gICAgICAgICAgYnVmZmVyID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBidWZmZXIgKz0gY2h1bmsudGV4dDtcbiAgICAgICAgaWQgPSBjaHVuay5pZDtcblxuICAgICAgICBsZXQgbWF0Y2g7XG5cbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGRldGVjdENodW5rKGJ1ZmZlcikpICE9IG51bGwpIHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1kZWx0YScsIHRleHQ6IG1hdGNoLCBpZCB9KTtcbiAgICAgICAgICBidWZmZXIgPSBidWZmZXIuc2xpY2UobWF0Y2gubGVuZ3RoKTtcblxuICAgICAgICAgIGF3YWl0IGRlbGF5KGRlbGF5SW5Ncyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH07XG59XG4iLCAiaW1wb3J0IHtcbiAgTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnMsXG4gIExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmUsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgbWVyZ2VPYmplY3RzIH0gZnJvbSAnLi4vdXRpbC9tZXJnZS1vYmplY3RzJztcblxuLyoqXG4gKiBBcHBsaWVzIGRlZmF1bHQgc2V0dGluZ3MgZm9yIGEgbGFuZ3VhZ2UgbW9kZWwuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0U2V0dGluZ3NNaWRkbGV3YXJlKHtcbiAgc2V0dGluZ3MsXG59OiB7XG4gIHNldHRpbmdzOiBQYXJ0aWFsPHtcbiAgICBtYXhPdXRwdXRUb2tlbnM/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1snbWF4T3V0cHV0VG9rZW5zJ107XG4gICAgdGVtcGVyYXR1cmU/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1sndGVtcGVyYXR1cmUnXTtcbiAgICBzdG9wU2VxdWVuY2VzPzogTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnNbJ3N0b3BTZXF1ZW5jZXMnXTtcbiAgICB0b3BQPzogTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnNbJ3RvcFAnXTtcbiAgICB0b3BLPzogTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnNbJ3RvcEsnXTtcbiAgICBwcmVzZW5jZVBlbmFsdHk/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1sncHJlc2VuY2VQZW5hbHR5J107XG4gICAgZnJlcXVlbmN5UGVuYWx0eT86IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zWydmcmVxdWVuY3lQZW5hbHR5J107XG4gICAgcmVzcG9uc2VGb3JtYXQ/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1sncmVzcG9uc2VGb3JtYXQnXTtcbiAgICBzZWVkPzogTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnNbJ3NlZWQnXTtcbiAgICB0b29scz86IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zWyd0b29scyddO1xuICAgIHRvb2xDaG9pY2U/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1sndG9vbENob2ljZSddO1xuICAgIGhlYWRlcnM/OiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9uc1snaGVhZGVycyddO1xuICAgIHByb3ZpZGVyT3B0aW9ucz86IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zWydwcm92aWRlck9wdGlvbnMnXTtcbiAgfT47XG59KTogTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZSB7XG4gIHJldHVybiB7XG4gICAgbWlkZGxld2FyZVZlcnNpb246ICd2MicsXG4gICAgdHJhbnNmb3JtUGFyYW1zOiBhc3luYyAoeyBwYXJhbXMgfSkgPT4ge1xuICAgICAgcmV0dXJuIG1lcmdlT2JqZWN0cyhzZXR0aW5ncywgcGFyYW1zKSBhcyBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9ucztcbiAgICB9LFxuICB9O1xufVxuIiwgIi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHN0YXJ0IG9mIHRoZSBzZWFyY2hlZFRleHQgaW4gdGhlIHRleHQsIG9yIG51bGwgaWYgaXRcbiAqIGlzIG5vdCBmb3VuZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFBvdGVudGlhbFN0YXJ0SW5kZXgoXG4gIHRleHQ6IHN0cmluZyxcbiAgc2VhcmNoZWRUZXh0OiBzdHJpbmcsXG4pOiBudW1iZXIgfCBudWxsIHtcbiAgLy8gUmV0dXJuIG51bGwgaW1tZWRpYXRlbHkgaWYgc2VhcmNoZWRUZXh0IGlzIGVtcHR5LlxuICBpZiAoc2VhcmNoZWRUZXh0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgdGhlIHNlYXJjaGVkVGV4dCBleGlzdHMgYXMgYSBkaXJlY3Qgc3Vic3RyaW5nIG9mIHRleHQuXG4gIGNvbnN0IGRpcmVjdEluZGV4ID0gdGV4dC5pbmRleE9mKHNlYXJjaGVkVGV4dCk7XG4gIGlmIChkaXJlY3RJbmRleCAhPT0gLTEpIHtcbiAgICByZXR1cm4gZGlyZWN0SW5kZXg7XG4gIH1cblxuICAvLyBPdGhlcndpc2UsIGxvb2sgZm9yIHRoZSBsYXJnZXN0IHN1ZmZpeCBvZiBcInRleHRcIiB0aGF0IG1hdGNoZXNcbiAgLy8gYSBwcmVmaXggb2YgXCJzZWFyY2hlZFRleHRcIi4gV2UgZ28gZnJvbSB0aGUgZW5kIG9mIHRleHQgaW53YXJkLlxuICBmb3IgKGxldCBpID0gdGV4dC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIGNvbnN0IHN1ZmZpeCA9IHRleHQuc3Vic3RyaW5nKGkpO1xuICAgIGlmIChzZWFyY2hlZFRleHQuc3RhcnRzV2l0aChzdWZmaXgpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbiIsICJpbXBvcnQgdHlwZSB7XG4gIExhbmd1YWdlTW9kZWxWMkNvbnRlbnQsXG4gIExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmUsXG4gIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgZ2V0UG90ZW50aWFsU3RhcnRJbmRleCB9IGZyb20gJy4uL3V0aWwvZ2V0LXBvdGVudGlhbC1zdGFydC1pbmRleCc7XG5cbi8qKlxuICogRXh0cmFjdCBhbiBYTUwtdGFnZ2VkIHJlYXNvbmluZyBzZWN0aW9uIGZyb20gdGhlIGdlbmVyYXRlZCB0ZXh0IGFuZCBleHBvc2VzIGl0XG4gKiBhcyBhIGByZWFzb25pbmdgIHByb3BlcnR5IG9uIHRoZSByZXN1bHQuXG4gKlxuICogQHBhcmFtIHRhZ05hbWUgLSBUaGUgbmFtZSBvZiB0aGUgWE1MIHRhZyB0byBleHRyYWN0IHJlYXNvbmluZyBmcm9tLlxuICogQHBhcmFtIHNlcGFyYXRvciAtIFRoZSBzZXBhcmF0b3IgdG8gdXNlIGJldHdlZW4gcmVhc29uaW5nIGFuZCB0ZXh0IHNlY3Rpb25zLlxuICogQHBhcmFtIHN0YXJ0V2l0aFJlYXNvbmluZyAtIFdoZXRoZXIgdG8gc3RhcnQgd2l0aCByZWFzb25pbmcgdG9rZW5zLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFJlYXNvbmluZ01pZGRsZXdhcmUoe1xuICB0YWdOYW1lLFxuICBzZXBhcmF0b3IgPSAnXFxuJyxcbiAgc3RhcnRXaXRoUmVhc29uaW5nID0gZmFsc2UsXG59OiB7XG4gIHRhZ05hbWU6IHN0cmluZztcbiAgc2VwYXJhdG9yPzogc3RyaW5nO1xuICBzdGFydFdpdGhSZWFzb25pbmc/OiBib29sZWFuO1xufSk6IExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmUge1xuICBjb25zdCBvcGVuaW5nVGFnID0gYDwke3RhZ05hbWV9PmA7XG4gIGNvbnN0IGNsb3NpbmdUYWcgPSBgPFxcLyR7dGFnTmFtZX0+YDtcblxuICByZXR1cm4ge1xuICAgIG1pZGRsZXdhcmVWZXJzaW9uOiAndjInLFxuICAgIHdyYXBHZW5lcmF0ZTogYXN5bmMgKHsgZG9HZW5lcmF0ZSB9KSA9PiB7XG4gICAgICBjb25zdCB7IGNvbnRlbnQsIC4uLnJlc3QgfSA9IGF3YWl0IGRvR2VuZXJhdGUoKTtcblxuICAgICAgY29uc3QgdHJhbnNmb3JtZWRDb250ZW50OiBMYW5ndWFnZU1vZGVsVjJDb250ZW50W10gPSBbXTtcbiAgICAgIGZvciAoY29uc3QgcGFydCBvZiBjb250ZW50KSB7XG4gICAgICAgIGlmIChwYXJ0LnR5cGUgIT09ICd0ZXh0Jykge1xuICAgICAgICAgIHRyYW5zZm9ybWVkQ29udGVudC5wdXNoKHBhcnQpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGV4dCA9IHN0YXJ0V2l0aFJlYXNvbmluZyA/IG9wZW5pbmdUYWcgKyBwYXJ0LnRleHQgOiBwYXJ0LnRleHQ7XG5cbiAgICAgICAgY29uc3QgcmVnZXhwID0gbmV3IFJlZ0V4cChgJHtvcGVuaW5nVGFnfSguKj8pJHtjbG9zaW5nVGFnfWAsICdncycpO1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gQXJyYXkuZnJvbSh0ZXh0Lm1hdGNoQWxsKHJlZ2V4cCkpO1xuXG4gICAgICAgIGlmICghbWF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgICAgICB0cmFuc2Zvcm1lZENvbnRlbnQucHVzaChwYXJ0KTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlYXNvbmluZ1RleHQgPSBtYXRjaGVzLm1hcChtYXRjaCA9PiBtYXRjaFsxXSkuam9pbihzZXBhcmF0b3IpO1xuXG4gICAgICAgIGxldCB0ZXh0V2l0aG91dFJlYXNvbmluZyA9IHRleHQ7XG4gICAgICAgIGZvciAobGV0IGkgPSBtYXRjaGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgY29uc3QgbWF0Y2ggPSBtYXRjaGVzW2ldO1xuXG4gICAgICAgICAgY29uc3QgYmVmb3JlTWF0Y2ggPSB0ZXh0V2l0aG91dFJlYXNvbmluZy5zbGljZSgwLCBtYXRjaC5pbmRleCk7XG4gICAgICAgICAgY29uc3QgYWZ0ZXJNYXRjaCA9IHRleHRXaXRob3V0UmVhc29uaW5nLnNsaWNlKFxuICAgICAgICAgICAgbWF0Y2guaW5kZXghICsgbWF0Y2hbMF0ubGVuZ3RoLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICB0ZXh0V2l0aG91dFJlYXNvbmluZyA9XG4gICAgICAgICAgICBiZWZvcmVNYXRjaCArXG4gICAgICAgICAgICAoYmVmb3JlTWF0Y2gubGVuZ3RoID4gMCAmJiBhZnRlck1hdGNoLmxlbmd0aCA+IDAgPyBzZXBhcmF0b3IgOiAnJykgK1xuICAgICAgICAgICAgYWZ0ZXJNYXRjaDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyYW5zZm9ybWVkQ29udGVudC5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAncmVhc29uaW5nJyxcbiAgICAgICAgICB0ZXh0OiByZWFzb25pbmdUZXh0LFxuICAgICAgICB9KTtcblxuICAgICAgICB0cmFuc2Zvcm1lZENvbnRlbnQucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgIHRleHQ6IHRleHRXaXRob3V0UmVhc29uaW5nLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHsgY29udGVudDogdHJhbnNmb3JtZWRDb250ZW50LCAuLi5yZXN0IH07XG4gICAgfSxcblxuICAgIHdyYXBTdHJlYW06IGFzeW5jICh7IGRvU3RyZWFtIH0pID0+IHtcbiAgICAgIGNvbnN0IHsgc3RyZWFtLCAuLi5yZXN0IH0gPSBhd2FpdCBkb1N0cmVhbSgpO1xuXG4gICAgICBjb25zdCByZWFzb25pbmdFeHRyYWN0aW9uczogUmVjb3JkPFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIHtcbiAgICAgICAgICBpc0ZpcnN0UmVhc29uaW5nOiBib29sZWFuO1xuICAgICAgICAgIGlzRmlyc3RUZXh0OiBib29sZWFuO1xuICAgICAgICAgIGFmdGVyU3dpdGNoOiBib29sZWFuO1xuICAgICAgICAgIGlzUmVhc29uaW5nOiBib29sZWFuO1xuICAgICAgICAgIGJ1ZmZlcjogc3RyaW5nO1xuICAgICAgICAgIGlkQ291bnRlcjogbnVtYmVyO1xuICAgICAgICAgIHRleHRJZDogc3RyaW5nO1xuICAgICAgICB9XG4gICAgICA+ID0ge307XG5cbiAgICAgIGxldCBkZWxheWVkVGV4dFN0YXJ0OiBMYW5ndWFnZU1vZGVsVjJTdHJlYW1QYXJ0IHwgdW5kZWZpbmVkO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdHJlYW06IHN0cmVhbS5waXBlVGhyb3VnaChcbiAgICAgICAgICBuZXcgVHJhbnNmb3JtU3RyZWFtPFxuICAgICAgICAgICAgTGFuZ3VhZ2VNb2RlbFYyU3RyZWFtUGFydCxcbiAgICAgICAgICAgIExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnRcbiAgICAgICAgICA+KHtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogKGNodW5rLCBjb250cm9sbGVyKSA9PiB7XG4gICAgICAgICAgICAgIC8vIGRvIG5vdCBzZW5kIGB0ZXh0LXN0YXJ0YCBiZWZvcmUgYHJlYXNvbmluZy1zdGFydGBcbiAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9haS9pc3N1ZXMvNzc3NFxuICAgICAgICAgICAgICBpZiAoY2h1bmsudHlwZSA9PT0gJ3RleHQtc3RhcnQnKSB7XG4gICAgICAgICAgICAgICAgZGVsYXllZFRleHRTdGFydCA9IGNodW5rO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChjaHVuay50eXBlID09PSAndGV4dC1lbmQnICYmIGRlbGF5ZWRUZXh0U3RhcnQpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZGVsYXllZFRleHRTdGFydCk7XG4gICAgICAgICAgICAgICAgZGVsYXllZFRleHRTdGFydCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChjaHVuay50eXBlICE9PSAndGV4dC1kZWx0YScpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmspO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmIChyZWFzb25pbmdFeHRyYWN0aW9uc1tjaHVuay5pZF0gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJlYXNvbmluZ0V4dHJhY3Rpb25zW2NodW5rLmlkXSA9IHtcbiAgICAgICAgICAgICAgICAgIGlzRmlyc3RSZWFzb25pbmc6IHRydWUsXG4gICAgICAgICAgICAgICAgICBpc0ZpcnN0VGV4dDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGFmdGVyU3dpdGNoOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgIGlzUmVhc29uaW5nOiBzdGFydFdpdGhSZWFzb25pbmcsXG4gICAgICAgICAgICAgICAgICBidWZmZXI6ICcnLFxuICAgICAgICAgICAgICAgICAgaWRDb3VudGVyOiAwLFxuICAgICAgICAgICAgICAgICAgdGV4dElkOiBjaHVuay5pZCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY29uc3QgYWN0aXZlRXh0cmFjdGlvbiA9IHJlYXNvbmluZ0V4dHJhY3Rpb25zW2NodW5rLmlkXTtcblxuICAgICAgICAgICAgICBhY3RpdmVFeHRyYWN0aW9uLmJ1ZmZlciArPSBjaHVuay5kZWx0YTtcblxuICAgICAgICAgICAgICBmdW5jdGlvbiBwdWJsaXNoKHRleHQ6IHN0cmluZykge1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHByZWZpeCA9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUV4dHJhY3Rpb24uYWZ0ZXJTd2l0Y2ggJiZcbiAgICAgICAgICAgICAgICAgICAgKGFjdGl2ZUV4dHJhY3Rpb24uaXNSZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICA/ICFhY3RpdmVFeHRyYWN0aW9uLmlzRmlyc3RSZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgICAgICA6ICFhY3RpdmVFeHRyYWN0aW9uLmlzRmlyc3RUZXh0KVxuICAgICAgICAgICAgICAgICAgICAgID8gc2VwYXJhdG9yXG4gICAgICAgICAgICAgICAgICAgICAgOiAnJztcblxuICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVFeHRyYWN0aW9uLmlzUmVhc29uaW5nICYmXG4gICAgICAgICAgICAgICAgICAgIChhY3RpdmVFeHRyYWN0aW9uLmFmdGVyU3dpdGNoIHx8XG4gICAgICAgICAgICAgICAgICAgICAgYWN0aXZlRXh0cmFjdGlvbi5pc0ZpcnN0UmVhc29uaW5nKVxuICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3JlYXNvbmluZy1zdGFydCcsXG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IGByZWFzb25pbmctJHthY3RpdmVFeHRyYWN0aW9uLmlkQ291bnRlcn1gLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUV4dHJhY3Rpb24uaXNSZWFzb25pbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVhc29uaW5nLWRlbHRhJyxcbiAgICAgICAgICAgICAgICAgICAgICBkZWx0YTogcHJlZml4ICsgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICBpZDogYHJlYXNvbmluZy0ke2FjdGl2ZUV4dHJhY3Rpb24uaWRDb3VudGVyfWAsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGF5ZWRUZXh0U3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZGVsYXllZFRleHRTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgZGVsYXllZFRleHRTdGFydCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0LWRlbHRhJyxcbiAgICAgICAgICAgICAgICAgICAgICBkZWx0YTogcHJlZml4ICsgdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICBpZDogYWN0aXZlRXh0cmFjdGlvbi50ZXh0SWQsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgYWN0aXZlRXh0cmFjdGlvbi5hZnRlclN3aXRjaCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlRXh0cmFjdGlvbi5pc1JlYXNvbmluZykge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVFeHRyYWN0aW9uLmlzRmlyc3RSZWFzb25pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUV4dHJhY3Rpb24uaXNGaXJzdFRleHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dFRhZyA9IGFjdGl2ZUV4dHJhY3Rpb24uaXNSZWFzb25pbmdcbiAgICAgICAgICAgICAgICAgID8gY2xvc2luZ1RhZ1xuICAgICAgICAgICAgICAgICAgOiBvcGVuaW5nVGFnO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGdldFBvdGVudGlhbFN0YXJ0SW5kZXgoXG4gICAgICAgICAgICAgICAgICBhY3RpdmVFeHRyYWN0aW9uLmJ1ZmZlcixcbiAgICAgICAgICAgICAgICAgIG5leHRUYWcsXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIC8vIG5vIG9wZW5pbmcgb3IgY2xvc2luZyB0YWcgZm91bmQsIHB1Ymxpc2ggdGhlIGJ1ZmZlclxuICAgICAgICAgICAgICAgIGlmIChzdGFydEluZGV4ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIHB1Ymxpc2goYWN0aXZlRXh0cmFjdGlvbi5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgYWN0aXZlRXh0cmFjdGlvbi5idWZmZXIgPSAnJztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHB1Ymxpc2ggdGV4dCBiZWZvcmUgdGhlIHRhZ1xuICAgICAgICAgICAgICAgIHB1Ymxpc2goYWN0aXZlRXh0cmFjdGlvbi5idWZmZXIuc2xpY2UoMCwgc3RhcnRJbmRleCkpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZm91bmRGdWxsTWF0Y2ggPVxuICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleCArIG5leHRUYWcubGVuZ3RoIDw9IGFjdGl2ZUV4dHJhY3Rpb24uYnVmZmVyLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZEZ1bGxNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgYWN0aXZlRXh0cmFjdGlvbi5idWZmZXIgPSBhY3RpdmVFeHRyYWN0aW9uLmJ1ZmZlci5zbGljZShcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleCArIG5leHRUYWcubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgLy8gcmVhc29uaW5nIHBhcnQgZmluaXNoZWQ6XG4gICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlRXh0cmFjdGlvbi5pc1JlYXNvbmluZykge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoe1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmctZW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICBpZDogYHJlYXNvbmluZy0ke2FjdGl2ZUV4dHJhY3Rpb24uaWRDb3VudGVyKyt9YCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGFjdGl2ZUV4dHJhY3Rpb24uaXNSZWFzb25pbmcgPSAhYWN0aXZlRXh0cmFjdGlvbi5pc1JlYXNvbmluZztcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZUV4dHJhY3Rpb24uYWZ0ZXJTd2l0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBhY3RpdmVFeHRyYWN0aW9uLmJ1ZmZlciA9XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUV4dHJhY3Rpb24uYnVmZmVyLnNsaWNlKHN0YXJ0SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IHdoaWxlICh0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgICksXG4gICAgICAgIC4uLnJlc3QsXG4gICAgICB9O1xuICAgIH0sXG4gIH07XG59XG4iLCAiaW1wb3J0IHR5cGUge1xuICBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlLFxuICBMYW5ndWFnZU1vZGVsVjJTdHJlYW1QYXJ0LFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuLyoqXG4gKiBTaW11bGF0ZXMgc3RyZWFtaW5nIGNodW5rcyB3aXRoIHRoZSByZXNwb25zZSBmcm9tIGEgZ2VuZXJhdGUgY2FsbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpbXVsYXRlU3RyZWFtaW5nTWlkZGxld2FyZSgpOiBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlIHtcbiAgcmV0dXJuIHtcbiAgICBtaWRkbGV3YXJlVmVyc2lvbjogJ3YyJyxcbiAgICB3cmFwU3RyZWFtOiBhc3luYyAoeyBkb0dlbmVyYXRlIH0pID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRvR2VuZXJhdGUoKTtcblxuICAgICAgbGV0IGlkID0gMDtcblxuICAgICAgY29uc3Qgc2ltdWxhdGVkU3RyZWFtID0gbmV3IFJlYWRhYmxlU3RyZWFtPExhbmd1YWdlTW9kZWxWMlN0cmVhbVBhcnQ+KHtcbiAgICAgICAgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7XG4gICAgICAgICAgICB0eXBlOiAnc3RyZWFtLXN0YXJ0JyxcbiAgICAgICAgICAgIHdhcm5pbmdzOiByZXN1bHQud2FybmluZ3MsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAncmVzcG9uc2UtbWV0YWRhdGEnLCAuLi5yZXN1bHQucmVzcG9uc2UgfSk7XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcmVzdWx0LmNvbnRlbnQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocGFydC50eXBlKSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3RleHQnOiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnQudGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1zdGFydCcsIGlkOiBTdHJpbmcoaWQpIH0pO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQtZGVsdGEnLFxuICAgICAgICAgICAgICAgICAgICBpZDogU3RyaW5nKGlkKSxcbiAgICAgICAgICAgICAgICAgICAgZGVsdGE6IHBhcnQudGV4dCxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ3RleHQtZW5kJywgaWQ6IFN0cmluZyhpZCkgfSk7XG4gICAgICAgICAgICAgICAgICBpZCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjYXNlICdyZWFzb25pbmcnOiB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmctc3RhcnQnLFxuICAgICAgICAgICAgICAgICAgaWQ6IFN0cmluZyhpZCksXG4gICAgICAgICAgICAgICAgICBwcm92aWRlck1ldGFkYXRhOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZWFzb25pbmctZGVsdGEnLFxuICAgICAgICAgICAgICAgICAgaWQ6IFN0cmluZyhpZCksXG4gICAgICAgICAgICAgICAgICBkZWx0YTogcGFydC50ZXh0LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICdyZWFzb25pbmctZW5kJywgaWQ6IFN0cmluZyhpZCkgfSk7XG4gICAgICAgICAgICAgICAgaWQrKztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHBhcnQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHtcbiAgICAgICAgICAgIHR5cGU6ICdmaW5pc2gnLFxuICAgICAgICAgICAgZmluaXNoUmVhc29uOiByZXN1bHQuZmluaXNoUmVhc29uLFxuICAgICAgICAgICAgdXNhZ2U6IHJlc3VsdC51c2FnZSxcbiAgICAgICAgICAgIHByb3ZpZGVyTWV0YWRhdGE6IHJlc3VsdC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0cmVhbTogc2ltdWxhdGVkU3RyZWFtLFxuICAgICAgICByZXF1ZXN0OiByZXN1bHQucmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2U6IHJlc3VsdC5yZXNwb25zZSxcbiAgICAgIH07XG4gICAgfSxcbiAgfTtcbn1cbiIsICJpbXBvcnQge1xuICBMYW5ndWFnZU1vZGVsVjIsXG4gIExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zLFxuICBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IGFzQXJyYXkgfSBmcm9tICcuLi91dGlsL2FzLWFycmF5JztcblxuLyoqXG4gKiBXcmFwcyBhIExhbmd1YWdlTW9kZWxWMiBpbnN0YW5jZSB3aXRoIG1pZGRsZXdhcmUgZnVuY3Rpb25hbGl0eS5cbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHlvdSB0byBhcHBseSBtaWRkbGV3YXJlIHRvIHRyYW5zZm9ybSBwYXJhbWV0ZXJzLFxuICogd3JhcCBnZW5lcmF0ZSBvcGVyYXRpb25zLCBhbmQgd3JhcCBzdHJlYW0gb3BlcmF0aW9ucyBvZiBhIGxhbmd1YWdlIG1vZGVsLlxuICpcbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB3cmFwcGluZyB0aGUgbGFuZ3VhZ2UgbW9kZWwuXG4gKiBAcGFyYW0gb3B0aW9ucy5tb2RlbCAtIFRoZSBvcmlnaW5hbCBMYW5ndWFnZU1vZGVsVjIgaW5zdGFuY2UgdG8gYmUgd3JhcHBlZC5cbiAqIEBwYXJhbSBvcHRpb25zLm1pZGRsZXdhcmUgLSBUaGUgbWlkZGxld2FyZSB0byBiZSBhcHBsaWVkIHRvIHRoZSBsYW5ndWFnZSBtb2RlbC4gV2hlbiBtdWx0aXBsZSBtaWRkbGV3YXJlcyBhcmUgcHJvdmlkZWQsIHRoZSBmaXJzdCBtaWRkbGV3YXJlIHdpbGwgdHJhbnNmb3JtIHRoZSBpbnB1dCBmaXJzdCwgYW5kIHRoZSBsYXN0IG1pZGRsZXdhcmUgd2lsbCBiZSB3cmFwcGVkIGRpcmVjdGx5IGFyb3VuZCB0aGUgbW9kZWwuXG4gKiBAcGFyYW0gb3B0aW9ucy5tb2RlbElkIC0gT3B0aW9uYWwgY3VzdG9tIG1vZGVsIElEIHRvIG92ZXJyaWRlIHRoZSBvcmlnaW5hbCBtb2RlbCdzIElELlxuICogQHBhcmFtIG9wdGlvbnMucHJvdmlkZXJJZCAtIE9wdGlvbmFsIGN1c3RvbSBwcm92aWRlciBJRCB0byBvdmVycmlkZSB0aGUgb3JpZ2luYWwgbW9kZWwncyBwcm92aWRlciBJRC5cbiAqIEByZXR1cm5zIEEgbmV3IExhbmd1YWdlTW9kZWxWMiBpbnN0YW5jZSB3aXRoIG1pZGRsZXdhcmUgYXBwbGllZC5cbiAqL1xuZXhwb3J0IGNvbnN0IHdyYXBMYW5ndWFnZU1vZGVsID0gKHtcbiAgbW9kZWwsXG4gIG1pZGRsZXdhcmU6IG1pZGRsZXdhcmVBcmcsXG4gIG1vZGVsSWQsXG4gIHByb3ZpZGVySWQsXG59OiB7XG4gIG1vZGVsOiBMYW5ndWFnZU1vZGVsVjI7XG4gIG1pZGRsZXdhcmU6IExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmUgfCBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlW107XG4gIG1vZGVsSWQ/OiBzdHJpbmc7XG4gIHByb3ZpZGVySWQ/OiBzdHJpbmc7XG59KTogTGFuZ3VhZ2VNb2RlbFYyID0+IHtcbiAgcmV0dXJuIGFzQXJyYXkobWlkZGxld2FyZUFyZylcbiAgICAucmV2ZXJzZSgpXG4gICAgLnJlZHVjZSgod3JhcHBlZE1vZGVsLCBtaWRkbGV3YXJlKSA9PiB7XG4gICAgICByZXR1cm4gZG9XcmFwKHsgbW9kZWw6IHdyYXBwZWRNb2RlbCwgbWlkZGxld2FyZSwgbW9kZWxJZCwgcHJvdmlkZXJJZCB9KTtcbiAgICB9LCBtb2RlbCk7XG59O1xuXG5jb25zdCBkb1dyYXAgPSAoe1xuICBtb2RlbCxcbiAgbWlkZGxld2FyZToge1xuICAgIHRyYW5zZm9ybVBhcmFtcyxcbiAgICB3cmFwR2VuZXJhdGUsXG4gICAgd3JhcFN0cmVhbSxcbiAgICBvdmVycmlkZVByb3ZpZGVyLFxuICAgIG92ZXJyaWRlTW9kZWxJZCxcbiAgICBvdmVycmlkZVN1cHBvcnRlZFVybHMsXG4gIH0sXG4gIG1vZGVsSWQsXG4gIHByb3ZpZGVySWQsXG59OiB7XG4gIG1vZGVsOiBMYW5ndWFnZU1vZGVsVjI7XG4gIG1pZGRsZXdhcmU6IExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmU7XG4gIG1vZGVsSWQ/OiBzdHJpbmc7XG4gIHByb3ZpZGVySWQ/OiBzdHJpbmc7XG59KTogTGFuZ3VhZ2VNb2RlbFYyID0+IHtcbiAgYXN5bmMgZnVuY3Rpb24gZG9UcmFuc2Zvcm0oe1xuICAgIHBhcmFtcyxcbiAgICB0eXBlLFxuICB9OiB7XG4gICAgcGFyYW1zOiBMYW5ndWFnZU1vZGVsVjJDYWxsT3B0aW9ucztcbiAgICB0eXBlOiAnZ2VuZXJhdGUnIHwgJ3N0cmVhbSc7XG4gIH0pIHtcbiAgICByZXR1cm4gdHJhbnNmb3JtUGFyYW1zXG4gICAgICA/IGF3YWl0IHRyYW5zZm9ybVBhcmFtcyh7IHBhcmFtcywgdHlwZSwgbW9kZWwgfSlcbiAgICAgIDogcGFyYW1zO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBzcGVjaWZpY2F0aW9uVmVyc2lvbjogJ3YyJyxcblxuICAgIHByb3ZpZGVyOiBwcm92aWRlcklkID8/IG92ZXJyaWRlUHJvdmlkZXI/Lih7IG1vZGVsIH0pID8/IG1vZGVsLnByb3ZpZGVyLFxuICAgIG1vZGVsSWQ6IG1vZGVsSWQgPz8gb3ZlcnJpZGVNb2RlbElkPy4oeyBtb2RlbCB9KSA/PyBtb2RlbC5tb2RlbElkLFxuICAgIHN1cHBvcnRlZFVybHM6IG92ZXJyaWRlU3VwcG9ydGVkVXJscz8uKHsgbW9kZWwgfSkgPz8gbW9kZWwuc3VwcG9ydGVkVXJscyxcblxuICAgIGFzeW5jIGRvR2VuZXJhdGUoXG4gICAgICBwYXJhbXM6IExhbmd1YWdlTW9kZWxWMkNhbGxPcHRpb25zLFxuICAgICk6IFByb21pc2U8QXdhaXRlZDxSZXR1cm5UeXBlPExhbmd1YWdlTW9kZWxWMlsnZG9HZW5lcmF0ZSddPj4+IHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkUGFyYW1zID0gYXdhaXQgZG9UcmFuc2Zvcm0oeyBwYXJhbXMsIHR5cGU6ICdnZW5lcmF0ZScgfSk7XG4gICAgICBjb25zdCBkb0dlbmVyYXRlID0gYXN5bmMgKCkgPT4gbW9kZWwuZG9HZW5lcmF0ZSh0cmFuc2Zvcm1lZFBhcmFtcyk7XG4gICAgICBjb25zdCBkb1N0cmVhbSA9IGFzeW5jICgpID0+IG1vZGVsLmRvU3RyZWFtKHRyYW5zZm9ybWVkUGFyYW1zKTtcbiAgICAgIHJldHVybiB3cmFwR2VuZXJhdGVcbiAgICAgICAgPyB3cmFwR2VuZXJhdGUoe1xuICAgICAgICAgICAgZG9HZW5lcmF0ZSxcbiAgICAgICAgICAgIGRvU3RyZWFtLFxuICAgICAgICAgICAgcGFyYW1zOiB0cmFuc2Zvcm1lZFBhcmFtcyxcbiAgICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgIH0pXG4gICAgICAgIDogZG9HZW5lcmF0ZSgpO1xuICAgIH0sXG5cbiAgICBhc3luYyBkb1N0cmVhbShcbiAgICAgIHBhcmFtczogTGFuZ3VhZ2VNb2RlbFYyQ2FsbE9wdGlvbnMsXG4gICAgKTogUHJvbWlzZTxBd2FpdGVkPFJldHVyblR5cGU8TGFuZ3VhZ2VNb2RlbFYyWydkb1N0cmVhbSddPj4+IHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkUGFyYW1zID0gYXdhaXQgZG9UcmFuc2Zvcm0oeyBwYXJhbXMsIHR5cGU6ICdzdHJlYW0nIH0pO1xuICAgICAgY29uc3QgZG9HZW5lcmF0ZSA9IGFzeW5jICgpID0+IG1vZGVsLmRvR2VuZXJhdGUodHJhbnNmb3JtZWRQYXJhbXMpO1xuICAgICAgY29uc3QgZG9TdHJlYW0gPSBhc3luYyAoKSA9PiBtb2RlbC5kb1N0cmVhbSh0cmFuc2Zvcm1lZFBhcmFtcyk7XG4gICAgICByZXR1cm4gd3JhcFN0cmVhbVxuICAgICAgICA/IHdyYXBTdHJlYW0oeyBkb0dlbmVyYXRlLCBkb1N0cmVhbSwgcGFyYW1zOiB0cmFuc2Zvcm1lZFBhcmFtcywgbW9kZWwgfSlcbiAgICAgICAgOiBkb1N0cmVhbSgpO1xuICAgIH0sXG4gIH07XG59O1xuIiwgImltcG9ydCB0eXBlIHsgTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZSwgUHJvdmlkZXJWMiB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHsgd3JhcExhbmd1YWdlTW9kZWwgfSBmcm9tICcuL3dyYXAtbGFuZ3VhZ2UtbW9kZWwnO1xuXG4vKipcbiAqIFdyYXBzIGEgUHJvdmlkZXJWMiBpbnN0YW5jZSB3aXRoIG1pZGRsZXdhcmUgZnVuY3Rpb25hbGl0eS5cbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHlvdSB0byBhcHBseSBtaWRkbGV3YXJlIHRvIGFsbCBsYW5ndWFnZSBtb2RlbHNcbiAqIGZyb20gdGhlIHByb3ZpZGVyLCBlbmFibGluZyB5b3UgdG8gdHJhbnNmb3JtIHBhcmFtZXRlcnMsIHdyYXAgZ2VuZXJhdGVcbiAqIG9wZXJhdGlvbnMsIGFuZCB3cmFwIHN0cmVhbSBvcGVyYXRpb25zIGZvciBldmVyeSBsYW5ndWFnZSBtb2RlbC5cbiAqXG4gKiBAcGFyYW0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3Igd3JhcHBpbmcgdGhlIHByb3ZpZGVyLlxuICogQHBhcmFtIG9wdGlvbnMucHJvdmlkZXIgLSBUaGUgb3JpZ2luYWwgUHJvdmlkZXJWMiBpbnN0YW5jZSB0byBiZSB3cmFwcGVkLlxuICogQHBhcmFtIG9wdGlvbnMubGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmUgLSBUaGUgbWlkZGxld2FyZSB0byBiZSBhcHBsaWVkIHRvIGFsbCBsYW5ndWFnZSBtb2RlbHMgZnJvbSB0aGUgcHJvdmlkZXIuIFdoZW4gbXVsdGlwbGUgbWlkZGxld2FyZXMgYXJlIHByb3ZpZGVkLCB0aGUgZmlyc3QgbWlkZGxld2FyZSB3aWxsIHRyYW5zZm9ybSB0aGUgaW5wdXQgZmlyc3QsIGFuZCB0aGUgbGFzdCBtaWRkbGV3YXJlIHdpbGwgYmUgd3JhcHBlZCBkaXJlY3RseSBhcm91bmQgdGhlIG1vZGVsLlxuICogQHJldHVybnMgQSBuZXcgUHJvdmlkZXJWMiBpbnN0YW5jZSB3aXRoIG1pZGRsZXdhcmUgYXBwbGllZCB0byBhbGwgbGFuZ3VhZ2UgbW9kZWxzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gd3JhcFByb3ZpZGVyKHtcbiAgcHJvdmlkZXIsXG4gIGxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlLFxufToge1xuICBwcm92aWRlcjogUHJvdmlkZXJWMjtcbiAgbGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmU6XG4gICAgfCBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlXG4gICAgfCBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlW107XG59KTogUHJvdmlkZXJWMiB7XG4gIGNvbnN0IHdyYXBwZWRQcm92aWRlciA9IHtcbiAgICBsYW5ndWFnZU1vZGVsKG1vZGVsSWQ6IHN0cmluZykge1xuICAgICAgbGV0IG1vZGVsID0gcHJvdmlkZXIubGFuZ3VhZ2VNb2RlbChtb2RlbElkKTtcbiAgICAgIG1vZGVsID0gd3JhcExhbmd1YWdlTW9kZWwoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgbWlkZGxld2FyZTogbGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmUsXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9LFxuICAgIHRleHRFbWJlZGRpbmdNb2RlbDogcHJvdmlkZXIudGV4dEVtYmVkZGluZ01vZGVsLFxuICAgIGltYWdlTW9kZWw6IHByb3ZpZGVyLmltYWdlTW9kZWwsXG4gICAgdHJhbnNjcmlwdGlvbk1vZGVsOiBwcm92aWRlci50cmFuc2NyaXB0aW9uTW9kZWwsXG4gICAgc3BlZWNoTW9kZWw6IHByb3ZpZGVyLnNwZWVjaE1vZGVsLFxuICB9O1xuXG4gIHJldHVybiB3cmFwcGVkUHJvdmlkZXI7XG59XG4iLCAiaW1wb3J0IHtcbiAgRW1iZWRkaW5nTW9kZWxWMixcbiAgSW1hZ2VNb2RlbFYyLFxuICBMYW5ndWFnZU1vZGVsVjIsXG4gIE5vU3VjaE1vZGVsRXJyb3IsXG4gIFByb3ZpZGVyVjIsXG4gIFNwZWVjaE1vZGVsVjIsXG4gIFRyYW5zY3JpcHRpb25Nb2RlbFYyLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcblxuLyoqXG4gKiBDcmVhdGVzIGEgY3VzdG9tIHByb3ZpZGVyIHdpdGggc3BlY2lmaWVkIGxhbmd1YWdlIG1vZGVscywgdGV4dCBlbWJlZGRpbmcgbW9kZWxzLCBpbWFnZSBtb2RlbHMsIHRyYW5zY3JpcHRpb24gbW9kZWxzLCBzcGVlY2ggbW9kZWxzLCBhbmQgYW4gb3B0aW9uYWwgZmFsbGJhY2sgcHJvdmlkZXIuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUaGUgb3B0aW9ucyBmb3IgY3JlYXRpbmcgdGhlIGN1c3RvbSBwcm92aWRlci5cbiAqIEBwYXJhbSB7UmVjb3JkPHN0cmluZywgTGFuZ3VhZ2VNb2RlbD59IFtvcHRpb25zLmxhbmd1YWdlTW9kZWxzXSAtIEEgcmVjb3JkIG9mIGxhbmd1YWdlIG1vZGVscywgd2hlcmUga2V5cyBhcmUgbW9kZWwgSURzIGFuZCB2YWx1ZXMgYXJlIExhbmd1YWdlTW9kZWwgaW5zdGFuY2VzLlxuICogQHBhcmFtIHtSZWNvcmQ8c3RyaW5nLCBFbWJlZGRpbmdNb2RlbDxzdHJpbmc+Pn0gW29wdGlvbnMudGV4dEVtYmVkZGluZ01vZGVsc10gLSBBIHJlY29yZCBvZiB0ZXh0IGVtYmVkZGluZyBtb2RlbHMsIHdoZXJlIGtleXMgYXJlIG1vZGVsIElEcyBhbmQgdmFsdWVzIGFyZSBFbWJlZGRpbmdNb2RlbDxzdHJpbmc+IGluc3RhbmNlcy5cbiAqIEBwYXJhbSB7UmVjb3JkPHN0cmluZywgSW1hZ2VNb2RlbD59IFtvcHRpb25zLmltYWdlTW9kZWxzXSAtIEEgcmVjb3JkIG9mIGltYWdlIG1vZGVscywgd2hlcmUga2V5cyBhcmUgbW9kZWwgSURzIGFuZCB2YWx1ZXMgYXJlIEltYWdlTW9kZWwgaW5zdGFuY2VzLlxuICogQHBhcmFtIHtSZWNvcmQ8c3RyaW5nLCBUcmFuc2NyaXB0aW9uTW9kZWw+fSBbb3B0aW9ucy50cmFuc2NyaXB0aW9uTW9kZWxzXSAtIEEgcmVjb3JkIG9mIHRyYW5zY3JpcHRpb24gbW9kZWxzLCB3aGVyZSBrZXlzIGFyZSBtb2RlbCBJRHMgYW5kIHZhbHVlcyBhcmUgVHJhbnNjcmlwdGlvbk1vZGVsIGluc3RhbmNlcy5cbiAqIEBwYXJhbSB7UmVjb3JkPHN0cmluZywgU3BlZWNoTW9kZWw+fSBbb3B0aW9ucy5zcGVlY2hNb2RlbHNdIC0gQSByZWNvcmQgb2Ygc3BlZWNoIG1vZGVscywgd2hlcmUga2V5cyBhcmUgbW9kZWwgSURzIGFuZCB2YWx1ZXMgYXJlIFNwZWVjaE1vZGVsIGluc3RhbmNlcy5cbiAqIEBwYXJhbSB7UHJvdmlkZXJ9IFtvcHRpb25zLmZhbGxiYWNrUHJvdmlkZXJdIC0gQW4gb3B0aW9uYWwgZmFsbGJhY2sgcHJvdmlkZXIgdG8gdXNlIHdoZW4gYSByZXF1ZXN0ZWQgbW9kZWwgaXMgbm90IGZvdW5kIGluIHRoZSBjdXN0b20gcHJvdmlkZXIuXG4gKiBAcmV0dXJucyB7UHJvdmlkZXJ9IEEgUHJvdmlkZXIgb2JqZWN0IHdpdGggbGFuZ3VhZ2VNb2RlbCwgdGV4dEVtYmVkZGluZ01vZGVsLCBpbWFnZU1vZGVsLCB0cmFuc2NyaXB0aW9uTW9kZWwsIGFuZCBzcGVlY2hNb2RlbCBtZXRob2RzLlxuICpcbiAqIEB0aHJvd3Mge05vU3VjaE1vZGVsRXJyb3J9IFRocm93cyB3aGVuIGEgcmVxdWVzdGVkIG1vZGVsIGlzIG5vdCBmb3VuZCBhbmQgbm8gZmFsbGJhY2sgcHJvdmlkZXIgaXMgYXZhaWxhYmxlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY3VzdG9tUHJvdmlkZXI8XG4gIExBTkdVQUdFX01PREVMUyBleHRlbmRzIFJlY29yZDxzdHJpbmcsIExhbmd1YWdlTW9kZWxWMj4sXG4gIEVNQkVERElOR19NT0RFTFMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz4+LFxuICBJTUFHRV9NT0RFTFMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBJbWFnZU1vZGVsVjI+LFxuICBUUkFOU0NSSVBUSU9OX01PREVMUyBleHRlbmRzIFJlY29yZDxzdHJpbmcsIFRyYW5zY3JpcHRpb25Nb2RlbFYyPixcbiAgU1BFRUNIX01PREVMUyBleHRlbmRzIFJlY29yZDxzdHJpbmcsIFNwZWVjaE1vZGVsVjI+LFxuPih7XG4gIGxhbmd1YWdlTW9kZWxzLFxuICB0ZXh0RW1iZWRkaW5nTW9kZWxzLFxuICBpbWFnZU1vZGVscyxcbiAgdHJhbnNjcmlwdGlvbk1vZGVscyxcbiAgc3BlZWNoTW9kZWxzLFxuICBmYWxsYmFja1Byb3ZpZGVyLFxufToge1xuICBsYW5ndWFnZU1vZGVscz86IExBTkdVQUdFX01PREVMUztcbiAgdGV4dEVtYmVkZGluZ01vZGVscz86IEVNQkVERElOR19NT0RFTFM7XG4gIGltYWdlTW9kZWxzPzogSU1BR0VfTU9ERUxTO1xuICB0cmFuc2NyaXB0aW9uTW9kZWxzPzogVFJBTlNDUklQVElPTl9NT0RFTFM7XG4gIHNwZWVjaE1vZGVscz86IFNQRUVDSF9NT0RFTFM7XG4gIGZhbGxiYWNrUHJvdmlkZXI/OiBQcm92aWRlclYyO1xufSk6IFByb3ZpZGVyVjIgJiB7XG4gIGxhbmd1YWdlTW9kZWwobW9kZWxJZDogRXh0cmFjdE1vZGVsSWQ8TEFOR1VBR0VfTU9ERUxTPik6IExhbmd1YWdlTW9kZWxWMjtcbiAgdGV4dEVtYmVkZGluZ01vZGVsKFxuICAgIG1vZGVsSWQ6IEV4dHJhY3RNb2RlbElkPEVNQkVERElOR19NT0RFTFM+LFxuICApOiBFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz47XG4gIGltYWdlTW9kZWwobW9kZWxJZDogRXh0cmFjdE1vZGVsSWQ8SU1BR0VfTU9ERUxTPik6IEltYWdlTW9kZWxWMjtcbiAgdHJhbnNjcmlwdGlvbk1vZGVsKFxuICAgIG1vZGVsSWQ6IEV4dHJhY3RNb2RlbElkPFRSQU5TQ1JJUFRJT05fTU9ERUxTPixcbiAgKTogVHJhbnNjcmlwdGlvbk1vZGVsVjI7XG4gIHNwZWVjaE1vZGVsKG1vZGVsSWQ6IEV4dHJhY3RNb2RlbElkPFNQRUVDSF9NT0RFTFM+KTogU3BlZWNoTW9kZWxWMjtcbn0ge1xuICByZXR1cm4ge1xuICAgIGxhbmd1YWdlTW9kZWwobW9kZWxJZDogRXh0cmFjdE1vZGVsSWQ8TEFOR1VBR0VfTU9ERUxTPik6IExhbmd1YWdlTW9kZWxWMiB7XG4gICAgICBpZiAobGFuZ3VhZ2VNb2RlbHMgIT0gbnVsbCAmJiBtb2RlbElkIGluIGxhbmd1YWdlTW9kZWxzKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZU1vZGVsc1ttb2RlbElkXTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZhbGxiYWNrUHJvdmlkZXIpIHtcbiAgICAgICAgcmV0dXJuIGZhbGxiYWNrUHJvdmlkZXIubGFuZ3VhZ2VNb2RlbChtb2RlbElkKTtcbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IE5vU3VjaE1vZGVsRXJyb3IoeyBtb2RlbElkLCBtb2RlbFR5cGU6ICdsYW5ndWFnZU1vZGVsJyB9KTtcbiAgICB9LFxuXG4gICAgdGV4dEVtYmVkZGluZ01vZGVsKFxuICAgICAgbW9kZWxJZDogRXh0cmFjdE1vZGVsSWQ8RU1CRURESU5HX01PREVMUz4sXG4gICAgKTogRW1iZWRkaW5nTW9kZWxWMjxzdHJpbmc+IHtcbiAgICAgIGlmICh0ZXh0RW1iZWRkaW5nTW9kZWxzICE9IG51bGwgJiYgbW9kZWxJZCBpbiB0ZXh0RW1iZWRkaW5nTW9kZWxzKSB7XG4gICAgICAgIHJldHVybiB0ZXh0RW1iZWRkaW5nTW9kZWxzW21vZGVsSWRdO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmFsbGJhY2tQcm92aWRlcikge1xuICAgICAgICByZXR1cm4gZmFsbGJhY2tQcm92aWRlci50ZXh0RW1iZWRkaW5nTW9kZWwobW9kZWxJZCk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHsgbW9kZWxJZCwgbW9kZWxUeXBlOiAndGV4dEVtYmVkZGluZ01vZGVsJyB9KTtcbiAgICB9LFxuXG4gICAgaW1hZ2VNb2RlbChtb2RlbElkOiBFeHRyYWN0TW9kZWxJZDxJTUFHRV9NT0RFTFM+KTogSW1hZ2VNb2RlbFYyIHtcbiAgICAgIGlmIChpbWFnZU1vZGVscyAhPSBudWxsICYmIG1vZGVsSWQgaW4gaW1hZ2VNb2RlbHMpIHtcbiAgICAgICAgcmV0dXJuIGltYWdlTW9kZWxzW21vZGVsSWRdO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmFsbGJhY2tQcm92aWRlcj8uaW1hZ2VNb2RlbCkge1xuICAgICAgICByZXR1cm4gZmFsbGJhY2tQcm92aWRlci5pbWFnZU1vZGVsKG1vZGVsSWQpO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgTm9TdWNoTW9kZWxFcnJvcih7IG1vZGVsSWQsIG1vZGVsVHlwZTogJ2ltYWdlTW9kZWwnIH0pO1xuICAgIH0sXG5cbiAgICB0cmFuc2NyaXB0aW9uTW9kZWwoXG4gICAgICBtb2RlbElkOiBFeHRyYWN0TW9kZWxJZDxUUkFOU0NSSVBUSU9OX01PREVMUz4sXG4gICAgKTogVHJhbnNjcmlwdGlvbk1vZGVsVjIge1xuICAgICAgaWYgKHRyYW5zY3JpcHRpb25Nb2RlbHMgIT0gbnVsbCAmJiBtb2RlbElkIGluIHRyYW5zY3JpcHRpb25Nb2RlbHMpIHtcbiAgICAgICAgcmV0dXJuIHRyYW5zY3JpcHRpb25Nb2RlbHNbbW9kZWxJZF07XG4gICAgICB9XG5cbiAgICAgIGlmIChmYWxsYmFja1Byb3ZpZGVyPy50cmFuc2NyaXB0aW9uTW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIGZhbGxiYWNrUHJvdmlkZXIudHJhbnNjcmlwdGlvbk1vZGVsKG1vZGVsSWQpO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgTm9TdWNoTW9kZWxFcnJvcih7IG1vZGVsSWQsIG1vZGVsVHlwZTogJ3RyYW5zY3JpcHRpb25Nb2RlbCcgfSk7XG4gICAgfSxcblxuICAgIHNwZWVjaE1vZGVsKG1vZGVsSWQ6IEV4dHJhY3RNb2RlbElkPFNQRUVDSF9NT0RFTFM+KTogU3BlZWNoTW9kZWxWMiB7XG4gICAgICBpZiAoc3BlZWNoTW9kZWxzICE9IG51bGwgJiYgbW9kZWxJZCBpbiBzcGVlY2hNb2RlbHMpIHtcbiAgICAgICAgcmV0dXJuIHNwZWVjaE1vZGVsc1ttb2RlbElkXTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZhbGxiYWNrUHJvdmlkZXI/LnNwZWVjaE1vZGVsKSB7XG4gICAgICAgIHJldHVybiBmYWxsYmFja1Byb3ZpZGVyLnNwZWVjaE1vZGVsKG1vZGVsSWQpO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgTm9TdWNoTW9kZWxFcnJvcih7IG1vZGVsSWQsIG1vZGVsVHlwZTogJ3NwZWVjaE1vZGVsJyB9KTtcbiAgICB9LFxuICB9O1xufVxuXG4vKipcbiAqIEBkZXByZWNhdGVkIFVzZSBgY3VzdG9tUHJvdmlkZXJgIGluc3RlYWQuXG4gKi9cbmV4cG9ydCBjb25zdCBleHBlcmltZW50YWxfY3VzdG9tUHJvdmlkZXIgPSBjdXN0b21Qcm92aWRlcjtcblxudHlwZSBFeHRyYWN0TW9kZWxJZDxNT0RFTFMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4gPSBFeHRyYWN0PFxuICBrZXlvZiBNT0RFTFMsXG4gIHN0cmluZ1xuPjtcbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yLCBOb1N1Y2hNb2RlbEVycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5cbmNvbnN0IG5hbWUgPSAnQUlfTm9TdWNoUHJvdmlkZXJFcnJvcic7XG5jb25zdCBtYXJrZXIgPSBgdmVyY2VsLmFpLmVycm9yLiR7bmFtZX1gO1xuY29uc3Qgc3ltYm9sID0gU3ltYm9sLmZvcihtYXJrZXIpO1xuXG5leHBvcnQgY2xhc3MgTm9TdWNoUHJvdmlkZXJFcnJvciBleHRlbmRzIE5vU3VjaE1vZGVsRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IFtzeW1ib2xdID0gdHJ1ZTsgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG5cbiAgcmVhZG9ubHkgcHJvdmlkZXJJZDogc3RyaW5nO1xuICByZWFkb25seSBhdmFpbGFibGVQcm92aWRlcnM6IHN0cmluZ1tdO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtb2RlbElkLFxuICAgIG1vZGVsVHlwZSxcbiAgICBwcm92aWRlcklkLFxuICAgIGF2YWlsYWJsZVByb3ZpZGVycyxcbiAgICBtZXNzYWdlID0gYE5vIHN1Y2ggcHJvdmlkZXI6ICR7cHJvdmlkZXJJZH0gKGF2YWlsYWJsZSBwcm92aWRlcnM6ICR7YXZhaWxhYmxlUHJvdmlkZXJzLmpvaW4oKX0pYCxcbiAgfToge1xuICAgIG1vZGVsSWQ6IHN0cmluZztcbiAgICBtb2RlbFR5cGU6XG4gICAgICB8ICdsYW5ndWFnZU1vZGVsJ1xuICAgICAgfCAndGV4dEVtYmVkZGluZ01vZGVsJ1xuICAgICAgfCAnaW1hZ2VNb2RlbCdcbiAgICAgIHwgJ3RyYW5zY3JpcHRpb25Nb2RlbCdcbiAgICAgIHwgJ3NwZWVjaE1vZGVsJztcbiAgICBwcm92aWRlcklkOiBzdHJpbmc7XG4gICAgYXZhaWxhYmxlUHJvdmlkZXJzOiBzdHJpbmdbXTtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9KSB7XG4gICAgc3VwZXIoeyBlcnJvck5hbWU6IG5hbWUsIG1vZGVsSWQsIG1vZGVsVHlwZSwgbWVzc2FnZSB9KTtcblxuICAgIHRoaXMucHJvdmlkZXJJZCA9IHByb3ZpZGVySWQ7XG4gICAgdGhpcy5hdmFpbGFibGVQcm92aWRlcnMgPSBhdmFpbGFibGVQcm92aWRlcnM7XG4gIH1cblxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcjogdW5rbm93bik6IGVycm9yIGlzIE5vU3VjaFByb3ZpZGVyRXJyb3Ige1xuICAgIHJldHVybiBBSVNES0Vycm9yLmhhc01hcmtlcihlcnJvciwgbWFya2VyKTtcbiAgfVxufVxuIiwgImltcG9ydCB7XG4gIEVtYmVkZGluZ01vZGVsVjIsXG4gIEltYWdlTW9kZWxWMixcbiAgTGFuZ3VhZ2VNb2RlbFYyLFxuICBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlLFxuICBOb1N1Y2hNb2RlbEVycm9yLFxuICBQcm92aWRlclYyLFxuICBTcGVlY2hNb2RlbFYyLFxuICBUcmFuc2NyaXB0aW9uTW9kZWxWMixcbn0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBOb1N1Y2hQcm92aWRlckVycm9yIH0gZnJvbSAnLi9uby1zdWNoLXByb3ZpZGVyLWVycm9yJztcbmltcG9ydCB7IHdyYXBMYW5ndWFnZU1vZGVsIH0gZnJvbSAnLi4vbWlkZGxld2FyZS93cmFwLWxhbmd1YWdlLW1vZGVsJztcblxudHlwZSBFeHRyYWN0TGl0ZXJhbFVuaW9uPFQ+ID0gVCBleHRlbmRzIHN0cmluZ1xuICA/IHN0cmluZyBleHRlbmRzIFRcbiAgICA/IG5ldmVyXG4gICAgOiBUXG4gIDogbmV2ZXI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmlkZXJSZWdpc3RyeVByb3ZpZGVyPFxuICBQUk9WSURFUlMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBQcm92aWRlclYyPiA9IFJlY29yZDxzdHJpbmcsIFByb3ZpZGVyVjI+LFxuICBTRVBBUkFUT1IgZXh0ZW5kcyBzdHJpbmcgPSAnOicsXG4+IHtcbiAgbGFuZ3VhZ2VNb2RlbDxLRVkgZXh0ZW5kcyBrZXlvZiBQUk9WSURFUlM+KFxuICAgIGlkOiBLRVkgZXh0ZW5kcyBzdHJpbmdcbiAgICAgID8gYCR7S0VZICYgc3RyaW5nfSR7U0VQQVJBVE9SfSR7RXh0cmFjdExpdGVyYWxVbmlvbjxQYXJhbWV0ZXJzPE5vbk51bGxhYmxlPFBST1ZJREVSU1tLRVldWydsYW5ndWFnZU1vZGVsJ10+PlswXT59YFxuICAgICAgOiBuZXZlcixcbiAgKTogTGFuZ3VhZ2VNb2RlbFYyO1xuICBsYW5ndWFnZU1vZGVsPEtFWSBleHRlbmRzIGtleW9mIFBST1ZJREVSUz4oXG4gICAgaWQ6IEtFWSBleHRlbmRzIHN0cmluZyA/IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke3N0cmluZ31gIDogbmV2ZXIsXG4gICk6IExhbmd1YWdlTW9kZWxWMjtcblxuICB0ZXh0RW1iZWRkaW5nTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogS0VZIGV4dGVuZHMgc3RyaW5nXG4gICAgICA/IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke0V4dHJhY3RMaXRlcmFsVW5pb248UGFyYW1ldGVyczxOb25OdWxsYWJsZTxQUk9WSURFUlNbS0VZXVsndGV4dEVtYmVkZGluZ01vZGVsJ10+PlswXT59YFxuICAgICAgOiBuZXZlcixcbiAgKTogRW1iZWRkaW5nTW9kZWxWMjxzdHJpbmc+O1xuICB0ZXh0RW1iZWRkaW5nTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogS0VZIGV4dGVuZHMgc3RyaW5nID8gYCR7S0VZICYgc3RyaW5nfSR7U0VQQVJBVE9SfSR7c3RyaW5nfWAgOiBuZXZlcixcbiAgKTogRW1iZWRkaW5nTW9kZWxWMjxzdHJpbmc+O1xuXG4gIGltYWdlTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogS0VZIGV4dGVuZHMgc3RyaW5nXG4gICAgICA/IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke0V4dHJhY3RMaXRlcmFsVW5pb248UGFyYW1ldGVyczxOb25OdWxsYWJsZTxQUk9WSURFUlNbS0VZXVsnaW1hZ2VNb2RlbCddPj5bMF0+fWBcbiAgICAgIDogbmV2ZXIsXG4gICk6IEltYWdlTW9kZWxWMjtcbiAgaW1hZ2VNb2RlbDxLRVkgZXh0ZW5kcyBrZXlvZiBQUk9WSURFUlM+KFxuICAgIGlkOiBLRVkgZXh0ZW5kcyBzdHJpbmcgPyBgJHtLRVkgJiBzdHJpbmd9JHtTRVBBUkFUT1J9JHtzdHJpbmd9YCA6IG5ldmVyLFxuICApOiBJbWFnZU1vZGVsVjI7XG5cbiAgdHJhbnNjcmlwdGlvbk1vZGVsPEtFWSBleHRlbmRzIGtleW9mIFBST1ZJREVSUz4oXG4gICAgaWQ6IEtFWSBleHRlbmRzIHN0cmluZ1xuICAgICAgPyBgJHtLRVkgJiBzdHJpbmd9JHtTRVBBUkFUT1J9JHtFeHRyYWN0TGl0ZXJhbFVuaW9uPFBhcmFtZXRlcnM8Tm9uTnVsbGFibGU8UFJPVklERVJTW0tFWV1bJ3RyYW5zY3JpcHRpb25Nb2RlbCddPj5bMF0+fWBcbiAgICAgIDogbmV2ZXIsXG4gICk6IFRyYW5zY3JpcHRpb25Nb2RlbFYyO1xuICB0cmFuc2NyaXB0aW9uTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogS0VZIGV4dGVuZHMgc3RyaW5nID8gYCR7S0VZICYgc3RyaW5nfSR7U0VQQVJBVE9SfSR7c3RyaW5nfWAgOiBuZXZlcixcbiAgKTogVHJhbnNjcmlwdGlvbk1vZGVsVjI7XG5cbiAgc3BlZWNoTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogS0VZIGV4dGVuZHMgc3RyaW5nXG4gICAgICA/IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke0V4dHJhY3RMaXRlcmFsVW5pb248UGFyYW1ldGVyczxOb25OdWxsYWJsZTxQUk9WSURFUlNbS0VZXVsnc3BlZWNoTW9kZWwnXT4+WzBdPn1gXG4gICAgICA6IG5ldmVyLFxuICApOiBTcGVlY2hNb2RlbFYyO1xuICBzcGVlY2hNb2RlbDxLRVkgZXh0ZW5kcyBrZXlvZiBQUk9WSURFUlM+KFxuICAgIGlkOiBLRVkgZXh0ZW5kcyBzdHJpbmcgPyBgJHtLRVkgJiBzdHJpbmd9JHtTRVBBUkFUT1J9JHtzdHJpbmd9YCA6IG5ldmVyLFxuICApOiBTcGVlY2hNb2RlbFYyO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSByZWdpc3RyeSBmb3IgdGhlIGdpdmVuIHByb3ZpZGVycyB3aXRoIG9wdGlvbmFsIG1pZGRsZXdhcmUgZnVuY3Rpb25hbGl0eS5cbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHlvdSB0byByZWdpc3RlciBtdWx0aXBsZSBwcm92aWRlcnMgYW5kIG9wdGlvbmFsbHkgYXBwbHkgbWlkZGxld2FyZVxuICogdG8gYWxsIGxhbmd1YWdlIG1vZGVscyBmcm9tIHRoZSByZWdpc3RyeSwgZW5hYmxpbmcgeW91IHRvIHRyYW5zZm9ybSBwYXJhbWV0ZXJzLCB3cmFwIGdlbmVyYXRlXG4gKiBvcGVyYXRpb25zLCBhbmQgd3JhcCBzdHJlYW0gb3BlcmF0aW9ucyBmb3IgZXZlcnkgbGFuZ3VhZ2UgbW9kZWwgYWNjZXNzZWQgdGhyb3VnaCB0aGUgcmVnaXN0cnkuXG4gKlxuICogQHBhcmFtIHByb3ZpZGVycyAtIEEgcmVjb3JkIG9mIHByb3ZpZGVyIGluc3RhbmNlcyB0byBiZSByZWdpc3RlcmVkIGluIHRoZSByZWdpc3RyeS5cbiAqIEBwYXJhbSBvcHRpb25zIC0gQ29uZmlndXJhdGlvbiBvcHRpb25zIGZvciB0aGUgcHJvdmlkZXIgcmVnaXN0cnkuXG4gKiBAcGFyYW0gb3B0aW9ucy5zZXBhcmF0b3IgLSBUaGUgc2VwYXJhdG9yIHVzZWQgYmV0d2VlbiBwcm92aWRlciBJRCBhbmQgbW9kZWwgSUQgaW4gdGhlIGNvbWJpbmVkIGlkZW50aWZpZXIuIERlZmF1bHRzIHRvICc6Jy5cbiAqIEBwYXJhbSBvcHRpb25zLmxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlIC0gT3B0aW9uYWwgbWlkZGxld2FyZSB0byBiZSBhcHBsaWVkIHRvIGFsbCBsYW5ndWFnZSBtb2RlbHMgZnJvbSB0aGUgcmVnaXN0cnkuIFdoZW4gbXVsdGlwbGUgbWlkZGxld2FyZXMgYXJlIHByb3ZpZGVkLCB0aGUgZmlyc3QgbWlkZGxld2FyZSB3aWxsIHRyYW5zZm9ybSB0aGUgaW5wdXQgZmlyc3QsIGFuZCB0aGUgbGFzdCBtaWRkbGV3YXJlIHdpbGwgYmUgd3JhcHBlZCBkaXJlY3RseSBhcm91bmQgdGhlIG1vZGVsLlxuICogQHJldHVybnMgQSBuZXcgUHJvdmlkZXJSZWdpc3RyeVByb3ZpZGVyIGluc3RhbmNlIHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIGFsbCByZWdpc3RlcmVkIHByb3ZpZGVycyB3aXRoIG9wdGlvbmFsIG1pZGRsZXdhcmUgYXBwbGllZCB0byBsYW5ndWFnZSBtb2RlbHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcm92aWRlclJlZ2lzdHJ5PFxuICBQUk9WSURFUlMgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBQcm92aWRlclYyPixcbiAgU0VQQVJBVE9SIGV4dGVuZHMgc3RyaW5nID0gJzonLFxuPihcbiAgcHJvdmlkZXJzOiBQUk9WSURFUlMsXG4gIHtcbiAgICBzZXBhcmF0b3IgPSAnOicgYXMgU0VQQVJBVE9SLFxuICAgIGxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlLFxuICB9OiB7XG4gICAgc2VwYXJhdG9yPzogU0VQQVJBVE9SO1xuICAgIGxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlPzpcbiAgICAgIHwgTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZVxuICAgICAgfCBMYW5ndWFnZU1vZGVsVjJNaWRkbGV3YXJlW107XG4gIH0gPSB7fSxcbik6IFByb3ZpZGVyUmVnaXN0cnlQcm92aWRlcjxQUk9WSURFUlMsIFNFUEFSQVRPUj4ge1xuICBjb25zdCByZWdpc3RyeSA9IG5ldyBEZWZhdWx0UHJvdmlkZXJSZWdpc3RyeTxQUk9WSURFUlMsIFNFUEFSQVRPUj4oe1xuICAgIHNlcGFyYXRvcixcbiAgICBsYW5ndWFnZU1vZGVsTWlkZGxld2FyZSxcbiAgfSk7XG5cbiAgZm9yIChjb25zdCBbaWQsIHByb3ZpZGVyXSBvZiBPYmplY3QuZW50cmllcyhwcm92aWRlcnMpKSB7XG4gICAgcmVnaXN0cnkucmVnaXN0ZXJQcm92aWRlcih7IGlkLCBwcm92aWRlciB9IGFzIHtcbiAgICAgIGlkOiBrZXlvZiBQUk9WSURFUlM7XG4gICAgICBwcm92aWRlcjogUFJPVklERVJTW2tleW9mIFBST1ZJREVSU107XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gcmVnaXN0cnk7XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVXNlIGBjcmVhdGVQcm92aWRlclJlZ2lzdHJ5YCBpbnN0ZWFkLlxuICovXG5leHBvcnQgY29uc3QgZXhwZXJpbWVudGFsX2NyZWF0ZVByb3ZpZGVyUmVnaXN0cnkgPSBjcmVhdGVQcm92aWRlclJlZ2lzdHJ5O1xuXG5jbGFzcyBEZWZhdWx0UHJvdmlkZXJSZWdpc3RyeTxcbiAgUFJPVklERVJTIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgUHJvdmlkZXJWMj4sXG4gIFNFUEFSQVRPUiBleHRlbmRzIHN0cmluZyxcbj4gaW1wbGVtZW50cyBQcm92aWRlclJlZ2lzdHJ5UHJvdmlkZXI8UFJPVklERVJTLCBTRVBBUkFUT1I+XG57XG4gIHByaXZhdGUgcHJvdmlkZXJzOiBQUk9WSURFUlMgPSB7fSBhcyBQUk9WSURFUlM7XG4gIHByaXZhdGUgc2VwYXJhdG9yOiBTRVBBUkFUT1I7XG4gIHByaXZhdGUgbGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmU/OlxuICAgIHwgTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZVxuICAgIHwgTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZVtdO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBzZXBhcmF0b3IsXG4gICAgbGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmUsXG4gIH06IHtcbiAgICBzZXBhcmF0b3I6IFNFUEFSQVRPUjtcbiAgICBsYW5ndWFnZU1vZGVsTWlkZGxld2FyZT86XG4gICAgICB8IExhbmd1YWdlTW9kZWxWMk1pZGRsZXdhcmVcbiAgICAgIHwgTGFuZ3VhZ2VNb2RlbFYyTWlkZGxld2FyZVtdO1xuICB9KSB7XG4gICAgdGhpcy5zZXBhcmF0b3IgPSBzZXBhcmF0b3I7XG4gICAgdGhpcy5sYW5ndWFnZU1vZGVsTWlkZGxld2FyZSA9IGxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlO1xuICB9XG5cbiAgcmVnaXN0ZXJQcm92aWRlcjxLIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPih7XG4gICAgaWQsXG4gICAgcHJvdmlkZXIsXG4gIH06IHtcbiAgICBpZDogSztcbiAgICBwcm92aWRlcjogUFJPVklERVJTW0tdO1xuICB9KTogdm9pZCB7XG4gICAgdGhpcy5wcm92aWRlcnNbaWRdID0gcHJvdmlkZXI7XG4gIH1cblxuICBwcml2YXRlIGdldFByb3ZpZGVyKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgbW9kZWxUeXBlOlxuICAgICAgfCAnbGFuZ3VhZ2VNb2RlbCdcbiAgICAgIHwgJ3RleHRFbWJlZGRpbmdNb2RlbCdcbiAgICAgIHwgJ2ltYWdlTW9kZWwnXG4gICAgICB8ICd0cmFuc2NyaXB0aW9uTW9kZWwnXG4gICAgICB8ICdzcGVlY2hNb2RlbCcsXG4gICk6IFByb3ZpZGVyVjIge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5wcm92aWRlcnNbaWQgYXMga2V5b2YgUFJPVklERVJTXTtcblxuICAgIGlmIChwcm92aWRlciA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgTm9TdWNoUHJvdmlkZXJFcnJvcih7XG4gICAgICAgIG1vZGVsSWQ6IGlkLFxuICAgICAgICBtb2RlbFR5cGUsXG4gICAgICAgIHByb3ZpZGVySWQ6IGlkLFxuICAgICAgICBhdmFpbGFibGVQcm92aWRlcnM6IE9iamVjdC5rZXlzKHRoaXMucHJvdmlkZXJzKSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcm92aWRlcjtcbiAgfVxuXG4gIHByaXZhdGUgc3BsaXRJZChcbiAgICBpZDogc3RyaW5nLFxuICAgIG1vZGVsVHlwZTpcbiAgICAgIHwgJ2xhbmd1YWdlTW9kZWwnXG4gICAgICB8ICd0ZXh0RW1iZWRkaW5nTW9kZWwnXG4gICAgICB8ICdpbWFnZU1vZGVsJ1xuICAgICAgfCAndHJhbnNjcmlwdGlvbk1vZGVsJ1xuICAgICAgfCAnc3BlZWNoTW9kZWwnLFxuICApOiBbc3RyaW5nLCBzdHJpbmddIHtcbiAgICBjb25zdCBpbmRleCA9IGlkLmluZGV4T2YodGhpcy5zZXBhcmF0b3IpO1xuXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IE5vU3VjaE1vZGVsRXJyb3Ioe1xuICAgICAgICBtb2RlbElkOiBpZCxcbiAgICAgICAgbW9kZWxUeXBlLFxuICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgIGBJbnZhbGlkICR7bW9kZWxUeXBlfSBpZCBmb3IgcmVnaXN0cnk6ICR7aWR9IGAgK1xuICAgICAgICAgIGAobXVzdCBiZSBpbiB0aGUgZm9ybWF0IFwicHJvdmlkZXJJZCR7dGhpcy5zZXBhcmF0b3J9bW9kZWxJZFwiKWAsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gW2lkLnNsaWNlKDAsIGluZGV4KSwgaWQuc2xpY2UoaW5kZXggKyB0aGlzLnNlcGFyYXRvci5sZW5ndGgpXTtcbiAgfVxuXG4gIGxhbmd1YWdlTW9kZWw8S0VZIGV4dGVuZHMga2V5b2YgUFJPVklERVJTPihcbiAgICBpZDogYCR7S0VZICYgc3RyaW5nfSR7U0VQQVJBVE9SfSR7c3RyaW5nfWAsXG4gICk6IExhbmd1YWdlTW9kZWxWMiB7XG4gICAgY29uc3QgW3Byb3ZpZGVySWQsIG1vZGVsSWRdID0gdGhpcy5zcGxpdElkKGlkLCAnbGFuZ3VhZ2VNb2RlbCcpO1xuICAgIGxldCBtb2RlbCA9IHRoaXMuZ2V0UHJvdmlkZXIocHJvdmlkZXJJZCwgJ2xhbmd1YWdlTW9kZWwnKS5sYW5ndWFnZU1vZGVsPy4oXG4gICAgICBtb2RlbElkLFxuICAgICk7XG5cbiAgICBpZiAobW9kZWwgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IE5vU3VjaE1vZGVsRXJyb3IoeyBtb2RlbElkOiBpZCwgbW9kZWxUeXBlOiAnbGFuZ3VhZ2VNb2RlbCcgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubGFuZ3VhZ2VNb2RlbE1pZGRsZXdhcmUgIT0gbnVsbCkge1xuICAgICAgbW9kZWwgPSB3cmFwTGFuZ3VhZ2VNb2RlbCh7XG4gICAgICAgIG1vZGVsLFxuICAgICAgICBtaWRkbGV3YXJlOiB0aGlzLmxhbmd1YWdlTW9kZWxNaWRkbGV3YXJlLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vZGVsO1xuICB9XG5cbiAgdGV4dEVtYmVkZGluZ01vZGVsPEtFWSBleHRlbmRzIGtleW9mIFBST1ZJREVSUz4oXG4gICAgaWQ6IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke3N0cmluZ31gLFxuICApOiBFbWJlZGRpbmdNb2RlbFYyPHN0cmluZz4ge1xuICAgIGNvbnN0IFtwcm92aWRlcklkLCBtb2RlbElkXSA9IHRoaXMuc3BsaXRJZChpZCwgJ3RleHRFbWJlZGRpbmdNb2RlbCcpO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihwcm92aWRlcklkLCAndGV4dEVtYmVkZGluZ01vZGVsJyk7XG5cbiAgICBjb25zdCBtb2RlbCA9IHByb3ZpZGVyLnRleHRFbWJlZGRpbmdNb2RlbD8uKG1vZGVsSWQpO1xuXG4gICAgaWYgKG1vZGVsID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHtcbiAgICAgICAgbW9kZWxJZDogaWQsXG4gICAgICAgIG1vZGVsVHlwZTogJ3RleHRFbWJlZGRpbmdNb2RlbCcsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbW9kZWw7XG4gIH1cblxuICBpbWFnZU1vZGVsPEtFWSBleHRlbmRzIGtleW9mIFBST1ZJREVSUz4oXG4gICAgaWQ6IGAke0tFWSAmIHN0cmluZ30ke1NFUEFSQVRPUn0ke3N0cmluZ31gLFxuICApOiBJbWFnZU1vZGVsVjIge1xuICAgIGNvbnN0IFtwcm92aWRlcklkLCBtb2RlbElkXSA9IHRoaXMuc3BsaXRJZChpZCwgJ2ltYWdlTW9kZWwnKTtcbiAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIocHJvdmlkZXJJZCwgJ2ltYWdlTW9kZWwnKTtcblxuICAgIGNvbnN0IG1vZGVsID0gcHJvdmlkZXIuaW1hZ2VNb2RlbD8uKG1vZGVsSWQpO1xuXG4gICAgaWYgKG1vZGVsID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHsgbW9kZWxJZDogaWQsIG1vZGVsVHlwZTogJ2ltYWdlTW9kZWwnIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBtb2RlbDtcbiAgfVxuXG4gIHRyYW5zY3JpcHRpb25Nb2RlbDxLRVkgZXh0ZW5kcyBrZXlvZiBQUk9WSURFUlM+KFxuICAgIGlkOiBgJHtLRVkgJiBzdHJpbmd9JHtTRVBBUkFUT1J9JHtzdHJpbmd9YCxcbiAgKTogVHJhbnNjcmlwdGlvbk1vZGVsVjIge1xuICAgIGNvbnN0IFtwcm92aWRlcklkLCBtb2RlbElkXSA9IHRoaXMuc3BsaXRJZChpZCwgJ3RyYW5zY3JpcHRpb25Nb2RlbCcpO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihwcm92aWRlcklkLCAndHJhbnNjcmlwdGlvbk1vZGVsJyk7XG5cbiAgICBjb25zdCBtb2RlbCA9IHByb3ZpZGVyLnRyYW5zY3JpcHRpb25Nb2RlbD8uKG1vZGVsSWQpO1xuXG4gICAgaWYgKG1vZGVsID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBOb1N1Y2hNb2RlbEVycm9yKHtcbiAgICAgICAgbW9kZWxJZDogaWQsXG4gICAgICAgIG1vZGVsVHlwZTogJ3RyYW5zY3JpcHRpb25Nb2RlbCcsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbW9kZWw7XG4gIH1cblxuICBzcGVlY2hNb2RlbDxLRVkgZXh0ZW5kcyBrZXlvZiBQUk9WSURFUlM+KFxuICAgIGlkOiBgJHtLRVkgJiBzdHJpbmd9JHtTRVBBUkFUT1J9JHtzdHJpbmd9YCxcbiAgKTogU3BlZWNoTW9kZWxWMiB7XG4gICAgY29uc3QgW3Byb3ZpZGVySWQsIG1vZGVsSWRdID0gdGhpcy5zcGxpdElkKGlkLCAnc3BlZWNoTW9kZWwnKTtcbiAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIocHJvdmlkZXJJZCwgJ3NwZWVjaE1vZGVsJyk7XG5cbiAgICBjb25zdCBtb2RlbCA9IHByb3ZpZGVyLnNwZWVjaE1vZGVsPy4obW9kZWxJZCk7XG5cbiAgICBpZiAobW9kZWwgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IE5vU3VjaE1vZGVsRXJyb3IoeyBtb2RlbElkOiBpZCwgbW9kZWxUeXBlOiAnc3BlZWNoTW9kZWwnIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBtb2RlbDtcbiAgfVxufVxuIiwgImltcG9ydCB7IEpTT05TY2hlbWE3IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQge1xuICBkeW5hbWljVG9vbCxcbiAganNvblNjaGVtYSxcbiAgVG9vbCxcbiAgdG9vbCxcbiAgVG9vbENhbGxPcHRpb25zLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IHosIFpvZFR5cGUgfSBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgTUNQQ2xpZW50RXJyb3IgfSBmcm9tICcuLi8uLi9lcnJvci9tY3AtY2xpZW50LWVycm9yJztcbmltcG9ydCB7XG4gIEpTT05SUENFcnJvcixcbiAgSlNPTlJQQ05vdGlmaWNhdGlvbixcbiAgSlNPTlJQQ1JlcXVlc3QsXG4gIEpTT05SUENSZXNwb25zZSxcbn0gZnJvbSAnLi9qc29uLXJwYy1tZXNzYWdlJztcbmltcG9ydCB7XG4gIGNyZWF0ZU1jcFRyYW5zcG9ydCxcbiAgaXNDdXN0b21NY3BUcmFuc3BvcnQsXG4gIE1DUFRyYW5zcG9ydCxcbiAgTUNQVHJhbnNwb3J0Q29uZmlnLFxufSBmcm9tICcuL21jcC10cmFuc3BvcnQnO1xuaW1wb3J0IHtcbiAgQ2FsbFRvb2xSZXN1bHQsXG4gIENhbGxUb29sUmVzdWx0U2NoZW1hLFxuICBDb25maWd1cmF0aW9uIGFzIENsaWVudENvbmZpZ3VyYXRpb24sXG4gIEluaXRpYWxpemVSZXN1bHRTY2hlbWEsXG4gIExBVEVTVF9QUk9UT0NPTF9WRVJTSU9OLFxuICBMaXN0VG9vbHNSZXN1bHQsXG4gIExpc3RUb29sc1Jlc3VsdFNjaGVtYSxcbiAgTWNwVG9vbFNldCxcbiAgTm90aWZpY2F0aW9uLFxuICBQYWdpbmF0ZWRSZXF1ZXN0LFxuICBSZXF1ZXN0LFxuICBSZXF1ZXN0T3B0aW9ucyxcbiAgU2VydmVyQ2FwYWJpbGl0aWVzLFxuICBTVVBQT1JURURfUFJPVE9DT0xfVkVSU0lPTlMsXG4gIFRvb2xTY2hlbWFzLFxufSBmcm9tICcuL3R5cGVzJztcblxuY29uc3QgQ0xJRU5UX1ZFUlNJT04gPSAnMS4wLjAnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1DUENsaWVudENvbmZpZyB7XG4gIC8qKiBUcmFuc3BvcnQgY29uZmlndXJhdGlvbiBmb3IgY29ubmVjdGluZyB0byB0aGUgTUNQIHNlcnZlciAqL1xuICB0cmFuc3BvcnQ6IE1DUFRyYW5zcG9ydENvbmZpZyB8IE1DUFRyYW5zcG9ydDtcbiAgLyoqIE9wdGlvbmFsIGNhbGxiYWNrIGZvciB1bmNhdWdodCBlcnJvcnMgKi9cbiAgb25VbmNhdWdodEVycm9yPzogKGVycm9yOiB1bmtub3duKSA9PiB2b2lkO1xuICAvKiogT3B0aW9uYWwgY2xpZW50IG5hbWUsIGRlZmF1bHRzIHRvICdhaS1zZGstbWNwLWNsaWVudCcgKi9cbiAgbmFtZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU1DUENsaWVudChcbiAgY29uZmlnOiBNQ1BDbGllbnRDb25maWcsXG4pOiBQcm9taXNlPE1DUENsaWVudD4ge1xuICBjb25zdCBjbGllbnQgPSBuZXcgRGVmYXVsdE1DUENsaWVudChjb25maWcpO1xuICBhd2FpdCBjbGllbnQuaW5pdCgpO1xuICByZXR1cm4gY2xpZW50O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1DUENsaWVudCB7XG4gIHRvb2xzPFRPT0xfU0NIRU1BUyBleHRlbmRzIFRvb2xTY2hlbWFzID0gJ2F1dG9tYXRpYyc+KG9wdGlvbnM/OiB7XG4gICAgc2NoZW1hcz86IFRPT0xfU0NIRU1BUztcbiAgfSk6IFByb21pc2U8TWNwVG9vbFNldDxUT09MX1NDSEVNQVM+PjtcblxuICBjbG9zZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuLyoqXG4gKiBBIGxpZ2h0d2VpZ2h0IE1DUCBDbGllbnQgaW1wbGVtZW50YXRpb25cbiAqXG4gKiBUaGUgcHJpbWFyeSBwdXJwb3NlIG9mIHRoaXMgY2xpZW50IGlzIHRvb2wgY29udmVyc2lvbiBiZXR3ZWVuIE1DUDw+QUkgU0RLXG4gKiBidXQgY2FuIGxhdGVyIGJlIGV4dGVuZGVkIHRvIHN1cHBvcnQgb3RoZXIgTUNQIGZlYXR1cmVzXG4gKlxuICogVG9vbCBwYXJhbWV0ZXJzIGFyZSBhdXRvbWF0aWNhbGx5IGluZmVycmVkIGZyb20gdGhlIHNlcnZlcidzIEpTT04gc2NoZW1hXG4gKiBpZiBub3QgZXhwbGljaXRseSBwcm92aWRlZCBpbiB0aGUgdG9vbHMgY29uZmlndXJhdGlvblxuICpcbiAqIFRoaXMgY2xpZW50IGlzIG1lYW50IHRvIGJlIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCBhIHNpbmdsZSBzZXJ2ZXIuIFRvIGNvbW11bmljYXRlIGFuZCBmZXRjaCB0b29scyBhY3Jvc3MgbXVsdGlwbGUgc2VydmVycywgaXQncyByZWNvbW1lbmRlZCB0byBjcmVhdGUgYSBuZXcgY2xpZW50IGluc3RhbmNlIHBlciBzZXJ2ZXIuXG4gKlxuICogTm90IHN1cHBvcnRlZDpcbiAqIC0gQ2xpZW50IG9wdGlvbnMgKGUuZy4gc2FtcGxpbmcsIHJvb3RzKSBhcyB0aGV5IGFyZSBub3QgbmVlZGVkIGZvciB0b29sIGNvbnZlcnNpb25cbiAqIC0gQWNjZXB0aW5nIG5vdGlmaWNhdGlvbnNcbiAqIC0gU2Vzc2lvbiBtYW5hZ2VtZW50ICh3aGVuIHBhc3NpbmcgYSBzZXNzaW9uSWQgdG8gYW4gaW5zdGFuY2Ugb2YgdGhlIFN0cmVhbWFibGUgSFRUUCB0cmFuc3BvcnQpXG4gKiAtIFJlc3VtYWJsZSBTU0Ugc3RyZWFtc1xuICovXG5jbGFzcyBEZWZhdWx0TUNQQ2xpZW50IGltcGxlbWVudHMgTUNQQ2xpZW50IHtcbiAgcHJpdmF0ZSB0cmFuc3BvcnQ6IE1DUFRyYW5zcG9ydDtcbiAgcHJpdmF0ZSBvblVuY2F1Z2h0RXJyb3I/OiAoZXJyb3I6IHVua25vd24pID0+IHZvaWQ7XG4gIHByaXZhdGUgY2xpZW50SW5mbzogQ2xpZW50Q29uZmlndXJhdGlvbjtcbiAgcHJpdmF0ZSByZXF1ZXN0TWVzc2FnZUlkID0gMDtcbiAgcHJpdmF0ZSByZXNwb25zZUhhbmRsZXJzOiBNYXA8XG4gICAgbnVtYmVyLFxuICAgIChyZXNwb25zZTogSlNPTlJQQ1Jlc3BvbnNlIHwgRXJyb3IpID0+IHZvaWRcbiAgPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBzZXJ2ZXJDYXBhYmlsaXRpZXM6IFNlcnZlckNhcGFiaWxpdGllcyA9IHt9O1xuICBwcml2YXRlIGlzQ2xvc2VkID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcih7XG4gICAgdHJhbnNwb3J0OiB0cmFuc3BvcnRDb25maWcsXG4gICAgbmFtZSA9ICdhaS1zZGstbWNwLWNsaWVudCcsXG4gICAgb25VbmNhdWdodEVycm9yLFxuICB9OiBNQ1BDbGllbnRDb25maWcpIHtcbiAgICB0aGlzLm9uVW5jYXVnaHRFcnJvciA9IG9uVW5jYXVnaHRFcnJvcjtcblxuICAgIGlmIChpc0N1c3RvbU1jcFRyYW5zcG9ydCh0cmFuc3BvcnRDb25maWcpKSB7XG4gICAgICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydENvbmZpZztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50cmFuc3BvcnQgPSBjcmVhdGVNY3BUcmFuc3BvcnQodHJhbnNwb3J0Q29uZmlnKTtcbiAgICB9XG5cbiAgICB0aGlzLnRyYW5zcG9ydC5vbmNsb3NlID0gKCkgPT4gdGhpcy5vbkNsb3NlKCk7XG4gICAgdGhpcy50cmFuc3BvcnQub25lcnJvciA9IChlcnJvcjogRXJyb3IpID0+IHRoaXMub25FcnJvcihlcnJvcik7XG4gICAgdGhpcy50cmFuc3BvcnQub25tZXNzYWdlID0gbWVzc2FnZSA9PiB7XG4gICAgICBpZiAoJ21ldGhvZCcgaW4gbWVzc2FnZSkge1xuICAgICAgICAvLyBUaGlzIGxpZ2h0d2VpZ2h0IGNsaWVudCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICAgIC8vIHJlY2VpdmluZyBub3RpZmljYXRpb25zIG9yIHJlcXVlc3RzIGZyb20gc2VydmVyLlxuICAgICAgICAvLyBJZiB3ZSBnZXQgYW4gdW5zdXBwb3J0ZWQgbWVzc2FnZSwgd2UgY2FuIHNhZmVseSBpZ25vcmUgaXQgYW5kIHBhc3MgdG8gdGhlIG9uRXJyb3IgaGFuZGxlcjpcbiAgICAgICAgdGhpcy5vbkVycm9yKFxuICAgICAgICAgIG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnVW5zdXBwb3J0ZWQgbWVzc2FnZSB0eXBlJyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9uUmVzcG9uc2UobWVzc2FnZSk7XG4gICAgfTtcblxuICAgIHRoaXMuY2xpZW50SW5mbyA9IHtcbiAgICAgIG5hbWUsXG4gICAgICB2ZXJzaW9uOiBDTElFTlRfVkVSU0lPTixcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgaW5pdCgpOiBQcm9taXNlPHRoaXM+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy50cmFuc3BvcnQuc3RhcnQoKTtcbiAgICAgIHRoaXMuaXNDbG9zZWQgPSBmYWxzZTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5yZXF1ZXN0KHtcbiAgICAgICAgcmVxdWVzdDoge1xuICAgICAgICAgIG1ldGhvZDogJ2luaXRpYWxpemUnLFxuICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgcHJvdG9jb2xWZXJzaW9uOiBMQVRFU1RfUFJPVE9DT0xfVkVSU0lPTixcbiAgICAgICAgICAgIGNhcGFiaWxpdGllczoge30sXG4gICAgICAgICAgICBjbGllbnRJbmZvOiB0aGlzLmNsaWVudEluZm8sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVzdWx0U2NoZW1hOiBJbml0aWFsaXplUmVzdWx0U2NoZW1hLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICAgIG1lc3NhZ2U6ICdTZXJ2ZXIgc2VudCBpbnZhbGlkIGluaXRpYWxpemUgcmVzdWx0JyxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghU1VQUE9SVEVEX1BST1RPQ09MX1ZFUlNJT05TLmluY2x1ZGVzKHJlc3VsdC5wcm90b2NvbFZlcnNpb24pKSB7XG4gICAgICAgIHRocm93IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogYFNlcnZlcidzIHByb3RvY29sIHZlcnNpb24gaXMgbm90IHN1cHBvcnRlZDogJHtyZXN1bHQucHJvdG9jb2xWZXJzaW9ufWAsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNlcnZlckNhcGFiaWxpdGllcyA9IHJlc3VsdC5jYXBhYmlsaXRpZXM7XG5cbiAgICAgIC8vIENvbXBsZXRlIGluaXRpYWxpemF0aW9uIGhhbmRzaGFrZTpcbiAgICAgIGF3YWl0IHRoaXMubm90aWZpY2F0aW9uKHtcbiAgICAgICAgbWV0aG9kOiAnbm90aWZpY2F0aW9ucy9pbml0aWFsaXplZCcsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGF3YWl0IHRoaXMuY2xvc2UoKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmlzQ2xvc2VkKSByZXR1cm47XG4gICAgYXdhaXQgdGhpcy50cmFuc3BvcnQ/LmNsb3NlKCk7XG4gICAgdGhpcy5vbkNsb3NlKCk7XG4gIH1cblxuICBwcml2YXRlIGFzc2VydENhcGFiaWxpdHkobWV0aG9kOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBzd2l0Y2ggKG1ldGhvZCkge1xuICAgICAgY2FzZSAnaW5pdGlhbGl6ZSc6XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndG9vbHMvbGlzdCc6XG4gICAgICBjYXNlICd0b29scy9jYWxsJzpcbiAgICAgICAgaWYgKCF0aGlzLnNlcnZlckNhcGFiaWxpdGllcy50b29scykge1xuICAgICAgICAgIHRocm93IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiBgU2VydmVyIGRvZXMgbm90IHN1cHBvcnQgdG9vbHNgLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IE1DUENsaWVudEVycm9yKHtcbiAgICAgICAgICBtZXNzYWdlOiBgVW5zdXBwb3J0ZWQgbWV0aG9kOiAke21ldGhvZH1gLFxuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHJlcXVlc3Q8VCBleHRlbmRzIFpvZFR5cGU8b2JqZWN0Pj4oe1xuICAgIHJlcXVlc3QsXG4gICAgcmVzdWx0U2NoZW1hLFxuICAgIG9wdGlvbnMsXG4gIH06IHtcbiAgICByZXF1ZXN0OiBSZXF1ZXN0O1xuICAgIHJlc3VsdFNjaGVtYTogVDtcbiAgICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnM7XG4gIH0pOiBQcm9taXNlPHouaW5mZXI8VD4+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaXNDbG9zZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChcbiAgICAgICAgICBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogJ0F0dGVtcHRlZCB0byBzZW5kIGEgcmVxdWVzdCBmcm9tIGEgY2xvc2VkIGNsaWVudCcsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXNzZXJ0Q2FwYWJpbGl0eShyZXF1ZXN0Lm1ldGhvZCk7XG5cbiAgICAgIGNvbnN0IHNpZ25hbCA9IG9wdGlvbnM/LnNpZ25hbDtcbiAgICAgIHNpZ25hbD8udGhyb3dJZkFib3J0ZWQoKTtcblxuICAgICAgY29uc3QgbWVzc2FnZUlkID0gdGhpcy5yZXF1ZXN0TWVzc2FnZUlkKys7XG4gICAgICBjb25zdCBqc29ucnBjUmVxdWVzdDogSlNPTlJQQ1JlcXVlc3QgPSB7XG4gICAgICAgIC4uLnJlcXVlc3QsXG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogbWVzc2FnZUlkLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5yZXNwb25zZUhhbmRsZXJzLmRlbGV0ZShtZXNzYWdlSWQpO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5yZXNwb25zZUhhbmRsZXJzLnNldChtZXNzYWdlSWQsIHJlc3BvbnNlID0+IHtcbiAgICAgICAgaWYgKHNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgICAgIHJldHVybiByZWplY3QoXG4gICAgICAgICAgICBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICAgICAgICBtZXNzYWdlOiAnUmVxdWVzdCB3YXMgYWJvcnRlZCcsXG4gICAgICAgICAgICAgIGNhdXNlOiBzaWduYWwucmVhc29uLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHJlc3VsdFNjaGVtYS5wYXJzZShyZXNwb25zZS5yZXN1bHQpO1xuICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zdCBwYXJzZUVycm9yID0gbmV3IE1DUENsaWVudEVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gcGFyc2Ugc2VydmVyIHJlc3BvbnNlJyxcbiAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZWplY3QocGFyc2VFcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLnRyYW5zcG9ydC5zZW5kKGpzb25ycGNSZXF1ZXN0KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBsaXN0VG9vbHMoe1xuICAgIHBhcmFtcyxcbiAgICBvcHRpb25zLFxuICB9OiB7XG4gICAgcGFyYW1zPzogUGFnaW5hdGVkUmVxdWVzdFsncGFyYW1zJ107XG4gICAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zO1xuICB9ID0ge30pOiBQcm9taXNlPExpc3RUb29sc1Jlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHtcbiAgICAgICAgcmVxdWVzdDogeyBtZXRob2Q6ICd0b29scy9saXN0JywgcGFyYW1zIH0sXG4gICAgICAgIHJlc3VsdFNjaGVtYTogTGlzdFRvb2xzUmVzdWx0U2NoZW1hLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2FsbFRvb2woe1xuICAgIG5hbWUsXG4gICAgYXJncyxcbiAgICBvcHRpb25zLFxuICB9OiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGFyZ3M6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgIG9wdGlvbnM/OiBUb29sQ2FsbE9wdGlvbnM7XG4gIH0pOiBQcm9taXNlPENhbGxUb29sUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICByZXF1ZXN0OiB7IG1ldGhvZDogJ3Rvb2xzL2NhbGwnLCBwYXJhbXM6IHsgbmFtZSwgYXJndW1lbnRzOiBhcmdzIH0gfSxcbiAgICAgICAgcmVzdWx0U2NoZW1hOiBDYWxsVG9vbFJlc3VsdFNjaGVtYSxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIHNpZ25hbDogb3B0aW9ucz8uYWJvcnRTaWduYWwsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBub3RpZmljYXRpb24obm90aWZpY2F0aW9uOiBOb3RpZmljYXRpb24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBqc29ucnBjTm90aWZpY2F0aW9uOiBKU09OUlBDTm90aWZpY2F0aW9uID0ge1xuICAgICAgLi4ubm90aWZpY2F0aW9uLFxuICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgfTtcbiAgICBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kKGpzb25ycGNOb3RpZmljYXRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBzZXQgb2YgQUkgU0RLIHRvb2xzIGZyb20gdGhlIE1DUCBzZXJ2ZXJcbiAgICogQHJldHVybnMgQSByZWNvcmQgb2YgdG9vbCBuYW1lcyB0byB0aGVpciBpbXBsZW1lbnRhdGlvbnNcbiAgICovXG4gIGFzeW5jIHRvb2xzPFRPT0xfU0NIRU1BUyBleHRlbmRzIFRvb2xTY2hlbWFzID0gJ2F1dG9tYXRpYyc+KHtcbiAgICBzY2hlbWFzID0gJ2F1dG9tYXRpYycsXG4gIH06IHtcbiAgICBzY2hlbWFzPzogVE9PTF9TQ0hFTUFTO1xuICB9ID0ge30pOiBQcm9taXNlPE1jcFRvb2xTZXQ8VE9PTF9TQ0hFTUFTPj4ge1xuICAgIGNvbnN0IHRvb2xzOiBSZWNvcmQ8c3RyaW5nLCBUb29sPiA9IHt9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxpc3RUb29sc1Jlc3VsdCA9IGF3YWl0IHRoaXMubGlzdFRvb2xzKCk7XG5cbiAgICAgIGZvciAoY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgaW5wdXRTY2hlbWEgfSBvZiBsaXN0VG9vbHNSZXN1bHQudG9vbHMpIHtcbiAgICAgICAgaWYgKHNjaGVtYXMgIT09ICdhdXRvbWF0aWMnICYmICEobmFtZSBpbiBzY2hlbWFzKSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgY29uc3QgZXhlY3V0ZSA9IGFzeW5jIChcbiAgICAgICAgICBhcmdzOiBhbnksXG4gICAgICAgICAgb3B0aW9uczogVG9vbENhbGxPcHRpb25zLFxuICAgICAgICApOiBQcm9taXNlPENhbGxUb29sUmVzdWx0PiA9PiB7XG4gICAgICAgICAgb3B0aW9ucz8uYWJvcnRTaWduYWw/LnRocm93SWZBYm9ydGVkKCk7XG4gICAgICAgICAgcmV0dXJuIHNlbGYuY2FsbFRvb2woeyBuYW1lLCBhcmdzLCBvcHRpb25zIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHRvb2xXaXRoRXhlY3V0ZSA9XG4gICAgICAgICAgc2NoZW1hcyA9PT0gJ2F1dG9tYXRpYydcbiAgICAgICAgICAgID8gZHluYW1pY1Rvb2woe1xuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgIGlucHV0U2NoZW1hOiBqc29uU2NoZW1hKHtcbiAgICAgICAgICAgICAgICAgIC4uLmlucHV0U2NoZW1hLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogaW5wdXRTY2hlbWEucHJvcGVydGllcyA/PyB7fSxcbiAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxQcm9wZXJ0aWVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9IGFzIEpTT05TY2hlbWE3KSxcbiAgICAgICAgICAgICAgICBleGVjdXRlLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiB0b29sKHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICBpbnB1dFNjaGVtYTogc2NoZW1hc1tuYW1lXS5pbnB1dFNjaGVtYSxcbiAgICAgICAgICAgICAgICBleGVjdXRlLFxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB0b29sc1tuYW1lXSA9IHRvb2xXaXRoRXhlY3V0ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvb2xzIGFzIE1jcFRvb2xTZXQ8VE9PTF9TQ0hFTUFTPjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBvbkNsb3NlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzQ2xvc2VkKSByZXR1cm47XG5cbiAgICB0aGlzLmlzQ2xvc2VkID0gdHJ1ZTtcbiAgICBjb25zdCBlcnJvciA9IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICBtZXNzYWdlOiAnQ29ubmVjdGlvbiBjbG9zZWQnLFxuICAgIH0pO1xuXG4gICAgZm9yIChjb25zdCBoYW5kbGVyIG9mIHRoaXMucmVzcG9uc2VIYW5kbGVycy52YWx1ZXMoKSkge1xuICAgICAgaGFuZGxlcihlcnJvcik7XG4gICAgfVxuXG4gICAgdGhpcy5yZXNwb25zZUhhbmRsZXJzLmNsZWFyKCk7XG4gIH1cblxuICBwcml2YXRlIG9uRXJyb3IoZXJyb3I6IHVua25vd24pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5vblVuY2F1Z2h0RXJyb3IpIHtcbiAgICAgIHRoaXMub25VbmNhdWdodEVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG9uUmVzcG9uc2UocmVzcG9uc2U6IEpTT05SUENSZXNwb25zZSB8IEpTT05SUENFcnJvcik6IHZvaWQge1xuICAgIGNvbnN0IG1lc3NhZ2VJZCA9IE51bWJlcihyZXNwb25zZS5pZCk7XG4gICAgY29uc3QgaGFuZGxlciA9IHRoaXMucmVzcG9uc2VIYW5kbGVycy5nZXQobWVzc2FnZUlkKTtcblxuICAgIGlmIChoYW5kbGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgIG1lc3NhZ2U6IGBQcm90b2NvbCBlcnJvcjogUmVjZWl2ZWQgYSByZXNwb25zZSBmb3IgYW4gdW5rbm93biBtZXNzYWdlIElEOiAke0pTT04uc3RyaW5naWZ5KFxuICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICApfWAsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc3BvbnNlSGFuZGxlcnMuZGVsZXRlKG1lc3NhZ2VJZCk7XG5cbiAgICBoYW5kbGVyKFxuICAgICAgJ3Jlc3VsdCcgaW4gcmVzcG9uc2VcbiAgICAgICAgPyByZXNwb25zZVxuICAgICAgICA6IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZS5lcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgY2F1c2U6IHJlc3BvbnNlLmVycm9yLFxuICAgICAgICAgIH0pLFxuICAgICk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBFdmVudFNvdXJjZVBhcnNlclN0cmVhbSB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgTUNQQ2xpZW50RXJyb3IgfSBmcm9tICcuLi8uLi9lcnJvci9tY3AtY2xpZW50LWVycm9yJztcbmltcG9ydCB7IEpTT05SUENNZXNzYWdlLCBKU09OUlBDTWVzc2FnZVNjaGVtYSB9IGZyb20gJy4vanNvbi1ycGMtbWVzc2FnZSc7XG5pbXBvcnQgeyBNQ1BUcmFuc3BvcnQgfSBmcm9tICcuL21jcC10cmFuc3BvcnQnO1xuXG5leHBvcnQgY2xhc3MgU3NlTUNQVHJhbnNwb3J0IGltcGxlbWVudHMgTUNQVHJhbnNwb3J0IHtcbiAgcHJpdmF0ZSBlbmRwb2ludD86IFVSTDtcbiAgcHJpdmF0ZSBhYm9ydENvbnRyb2xsZXI/OiBBYm9ydENvbnRyb2xsZXI7XG4gIHByaXZhdGUgdXJsOiBVUkw7XG4gIHByaXZhdGUgY29ubmVjdGVkID0gZmFsc2U7XG4gIHByaXZhdGUgc3NlQ29ubmVjdGlvbj86IHtcbiAgICBjbG9zZTogKCkgPT4gdm9pZDtcbiAgfTtcbiAgcHJpdmF0ZSBoZWFkZXJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblxuICBvbmNsb3NlPzogKCkgPT4gdm9pZDtcbiAgb25lcnJvcj86IChlcnJvcjogdW5rbm93bikgPT4gdm9pZDtcbiAgb25tZXNzYWdlPzogKG1lc3NhZ2U6IEpTT05SUENNZXNzYWdlKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICB1cmwsXG4gICAgaGVhZGVycyxcbiAgfToge1xuICAgIHVybDogc3RyaW5nO1xuICAgIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICB9KSB7XG4gICAgdGhpcy51cmwgPSBuZXcgVVJMKHVybCk7XG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAodGhpcy5jb25uZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgICAgIGNvbnN0IGVzdGFibGlzaENvbm5lY3Rpb24gPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyk7XG4gICAgICAgICAgaGVhZGVycy5zZXQoJ0FjY2VwdCcsICd0ZXh0L2V2ZW50LXN0cmVhbScpO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy51cmwuaHJlZiwge1xuICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgIHNpZ25hbDogdGhpcy5hYm9ydENvbnRyb2xsZXI/LnNpZ25hbCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2sgfHwgIXJlc3BvbnNlLmJvZHkpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IE1DUENsaWVudEVycm9yKHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogYE1DUCBTU0UgVHJhbnNwb3J0IEVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWAsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub25lcnJvcj8uKGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IHJlc3BvbnNlLmJvZHlcbiAgICAgICAgICAgIC5waXBlVGhyb3VnaChuZXcgVGV4dERlY29kZXJTdHJlYW0oKSlcbiAgICAgICAgICAgIC5waXBlVGhyb3VnaChuZXcgRXZlbnRTb3VyY2VQYXJzZXJTdHJlYW0oKSk7XG5cbiAgICAgICAgICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG5cbiAgICAgICAgICBjb25zdCBwcm9jZXNzRXZlbnRzID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICAgICAgICAnTUNQIFNTRSBUcmFuc3BvcnQgRXJyb3I6IENvbm5lY3Rpb24gY2xvc2VkIHVuZXhwZWN0ZWRseScsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZXZlbnQsIGRhdGEgfSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50ID09PSAnZW5kcG9pbnQnKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gbmV3IFVSTChkYXRhLCB0aGlzLnVybCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuZHBvaW50Lm9yaWdpbiAhPT0gdGhpcy51cmwub3JpZ2luKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYE1DUCBTU0UgVHJhbnNwb3J0IEVycm9yOiBFbmRwb2ludCBvcmlnaW4gZG9lcyBub3QgbWF0Y2ggY29ubmVjdGlvbiBvcmlnaW46ICR7dGhpcy5lbmRwb2ludC5vcmlnaW59YCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OUlBDTWVzc2FnZVNjaGVtYS5wYXJzZShcbiAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKGRhdGEpLFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubWVzc2FnZT8uKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBNQ1BDbGllbnRFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICdNQ1AgU1NFIFRyYW5zcG9ydCBFcnJvcjogRmFpbGVkIHRvIHBhcnNlIG1lc3NhZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcj8uKGUpO1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBub3QgdGhyb3cgaGVyZSBzbyB3ZSBjb250aW51ZSBwcm9jZXNzaW5nIGV2ZW50cyBhZnRlciByZXBvcnRpbmcgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICB0aGlzLm9uZXJyb3I/LihlcnJvcik7XG4gICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRoaXMuc3NlQ29ubmVjdGlvbiA9IHtcbiAgICAgICAgICAgIGNsb3NlOiAoKSA9PiByZWFkZXIuY2FuY2VsKCksXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHByb2Nlc3NFdmVudHMoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9uZXJyb3I/LihlcnJvcik7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZXN0YWJsaXNoQ29ubmVjdGlvbigpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY2xvc2UoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLnNzZUNvbm5lY3Rpb24/LmNsb3NlKCk7XG4gICAgdGhpcy5hYm9ydENvbnRyb2xsZXI/LmFib3J0KCk7XG4gICAgdGhpcy5vbmNsb3NlPy4oKTtcbiAgfVxuXG4gIGFzeW5jIHNlbmQobWVzc2FnZTogSlNPTlJQQ01lc3NhZ2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuZW5kcG9pbnQgfHwgIXRoaXMuY29ubmVjdGVkKSB7XG4gICAgICB0aHJvdyBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICBtZXNzYWdlOiAnTUNQIFNTRSBUcmFuc3BvcnQgRXJyb3I6IE5vdCBjb25uZWN0ZWQnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycyh0aGlzLmhlYWRlcnMpO1xuICAgICAgaGVhZGVycy5zZXQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICBjb25zdCBpbml0ID0ge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobWVzc2FnZSksXG4gICAgICAgIHNpZ25hbDogdGhpcy5hYm9ydENvbnRyb2xsZXI/LnNpZ25hbCxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5lbmRwb2ludCwgaW5pdCk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiBudWxsKTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgICAgIG1lc3NhZ2U6IGBNQ1AgU1NFIFRyYW5zcG9ydCBFcnJvcjogUE9TVGluZyB0byBlbmRwb2ludCAoSFRUUCAke3Jlc3BvbnNlLnN0YXR1c30pOiAke3RleHR9YCxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub25lcnJvcj8uKGVycm9yKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLm9uZXJyb3I/LihlcnJvcik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXNlcmlhbGl6ZU1lc3NhZ2UobGluZTogc3RyaW5nKTogSlNPTlJQQ01lc3NhZ2Uge1xuICByZXR1cm4gSlNPTlJQQ01lc3NhZ2VTY2hlbWEucGFyc2UoSlNPTi5wYXJzZShsaW5lKSk7XG59XG4iLCAiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZC92NCc7XG5pbXBvcnQgeyBCYXNlUGFyYW1zU2NoZW1hLCBSZXF1ZXN0U2NoZW1hLCBSZXN1bHRTY2hlbWEgfSBmcm9tICcuL3R5cGVzJztcblxuY29uc3QgSlNPTlJQQ19WRVJTSU9OID0gJzIuMCc7XG5cbmNvbnN0IEpTT05SUENSZXF1ZXN0U2NoZW1hID0gelxuICAub2JqZWN0KHtcbiAgICBqc29ucnBjOiB6LmxpdGVyYWwoSlNPTlJQQ19WRVJTSU9OKSxcbiAgICBpZDogei51bmlvbihbei5zdHJpbmcoKSwgei5udW1iZXIoKS5pbnQoKV0pLFxuICB9KVxuICAubWVyZ2UoUmVxdWVzdFNjaGVtYSlcbiAgLnN0cmljdCgpO1xuXG5leHBvcnQgdHlwZSBKU09OUlBDUmVxdWVzdCA9IHouaW5mZXI8dHlwZW9mIEpTT05SUENSZXF1ZXN0U2NoZW1hPjtcblxuY29uc3QgSlNPTlJQQ1Jlc3BvbnNlU2NoZW1hID0gelxuICAub2JqZWN0KHtcbiAgICBqc29ucnBjOiB6LmxpdGVyYWwoSlNPTlJQQ19WRVJTSU9OKSxcbiAgICBpZDogei51bmlvbihbei5zdHJpbmcoKSwgei5udW1iZXIoKS5pbnQoKV0pLFxuICAgIHJlc3VsdDogUmVzdWx0U2NoZW1hLFxuICB9KVxuICAuc3RyaWN0KCk7XG5cbmV4cG9ydCB0eXBlIEpTT05SUENSZXNwb25zZSA9IHouaW5mZXI8dHlwZW9mIEpTT05SUENSZXNwb25zZVNjaGVtYT47XG5cbmNvbnN0IEpTT05SUENFcnJvclNjaGVtYSA9IHpcbiAgLm9iamVjdCh7XG4gICAganNvbnJwYzogei5saXRlcmFsKEpTT05SUENfVkVSU0lPTiksXG4gICAgaWQ6IHoudW5pb24oW3ouc3RyaW5nKCksIHoubnVtYmVyKCkuaW50KCldKSxcbiAgICBlcnJvcjogei5vYmplY3Qoe1xuICAgICAgY29kZTogei5udW1iZXIoKS5pbnQoKSxcbiAgICAgIG1lc3NhZ2U6IHouc3RyaW5nKCksXG4gICAgICBkYXRhOiB6Lm9wdGlvbmFsKHoudW5rbm93bigpKSxcbiAgICB9KSxcbiAgfSlcbiAgLnN0cmljdCgpO1xuXG5leHBvcnQgdHlwZSBKU09OUlBDRXJyb3IgPSB6LmluZmVyPHR5cGVvZiBKU09OUlBDRXJyb3JTY2hlbWE+O1xuXG5jb25zdCBKU09OUlBDTm90aWZpY2F0aW9uU2NoZW1hID0gelxuICAub2JqZWN0KHtcbiAgICBqc29ucnBjOiB6LmxpdGVyYWwoSlNPTlJQQ19WRVJTSU9OKSxcbiAgfSlcbiAgLm1lcmdlKFxuICAgIHoub2JqZWN0KHtcbiAgICAgIG1ldGhvZDogei5zdHJpbmcoKSxcbiAgICAgIHBhcmFtczogei5vcHRpb25hbChCYXNlUGFyYW1zU2NoZW1hKSxcbiAgICB9KSxcbiAgKVxuICAuc3RyaWN0KCk7XG5cbmV4cG9ydCB0eXBlIEpTT05SUENOb3RpZmljYXRpb24gPSB6LmluZmVyPHR5cGVvZiBKU09OUlBDTm90aWZpY2F0aW9uU2NoZW1hPjtcblxuZXhwb3J0IGNvbnN0IEpTT05SUENNZXNzYWdlU2NoZW1hID0gei51bmlvbihbXG4gIEpTT05SUENSZXF1ZXN0U2NoZW1hLFxuICBKU09OUlBDTm90aWZpY2F0aW9uU2NoZW1hLFxuICBKU09OUlBDUmVzcG9uc2VTY2hlbWEsXG4gIEpTT05SUENFcnJvclNjaGVtYSxcbl0pO1xuXG5leHBvcnQgdHlwZSBKU09OUlBDTWVzc2FnZSA9IHouaW5mZXI8dHlwZW9mIEpTT05SUENNZXNzYWdlU2NoZW1hPjtcbiIsICJpbXBvcnQgeyB6IH0gZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IEpTT05PYmplY3QgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IEZsZXhpYmxlU2NoZW1hLCBUb29sIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5cbmV4cG9ydCBjb25zdCBMQVRFU1RfUFJPVE9DT0xfVkVSU0lPTiA9ICcyMDI1LTA2LTE4JztcbmV4cG9ydCBjb25zdCBTVVBQT1JURURfUFJPVE9DT0xfVkVSU0lPTlMgPSBbXG4gIExBVEVTVF9QUk9UT0NPTF9WRVJTSU9OLFxuICAnMjAyNS0wMy0yNicsXG4gICcyMDI0LTExLTA1Jyxcbl07XG5cbmV4cG9ydCB0eXBlIFRvb2xTY2hlbWFzID1cbiAgfCBSZWNvcmQ8c3RyaW5nLCB7IGlucHV0U2NoZW1hOiBGbGV4aWJsZVNjaGVtYTxKU09OT2JqZWN0IHwgdW5rbm93bj4gfT5cbiAgfCAnYXV0b21hdGljJ1xuICB8IHVuZGVmaW5lZDtcblxuZXhwb3J0IHR5cGUgTWNwVG9vbFNldDxUT09MX1NDSEVNQVMgZXh0ZW5kcyBUb29sU2NoZW1hcyA9ICdhdXRvbWF0aWMnPiA9XG4gIFRPT0xfU0NIRU1BUyBleHRlbmRzIFJlY29yZDxzdHJpbmcsIHsgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPGFueT4gfT5cbiAgICA/IHtcbiAgICAgICAgW0sgaW4ga2V5b2YgVE9PTF9TQ0hFTUFTXTogVE9PTF9TQ0hFTUFTW0tdIGV4dGVuZHMge1xuICAgICAgICAgIGlucHV0U2NoZW1hOiBGbGV4aWJsZVNjaGVtYTxpbmZlciBJTlBVVD47XG4gICAgICAgIH1cbiAgICAgICAgICA/IFRvb2w8SU5QVVQsIENhbGxUb29sUmVzdWx0PiAmXG4gICAgICAgICAgICAgIFJlcXVpcmVkPFBpY2s8VG9vbDxJTlBVVCwgQ2FsbFRvb2xSZXN1bHQ+LCAnZXhlY3V0ZSc+PlxuICAgICAgICAgIDogbmV2ZXI7XG4gICAgICB9XG4gICAgOiBNY3BUb29sU2V0PFJlY29yZDxzdHJpbmcsIHsgaW5wdXRTY2hlbWE6IEZsZXhpYmxlU2NoZW1hPHVua25vd24+IH0+PjtcblxuY29uc3QgQ2xpZW50T3JTZXJ2ZXJJbXBsZW1lbnRhdGlvblNjaGVtYSA9IHoubG9vc2VPYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLFxuICB2ZXJzaW9uOiB6LnN0cmluZygpLFxufSk7XG5cbmV4cG9ydCB0eXBlIENvbmZpZ3VyYXRpb24gPSB6LmluZmVyPHR5cGVvZiBDbGllbnRPclNlcnZlckltcGxlbWVudGF0aW9uU2NoZW1hPjtcblxuZXhwb3J0IGNvbnN0IEJhc2VQYXJhbXNTY2hlbWEgPSB6Lmxvb3NlT2JqZWN0KHtcbiAgX21ldGE6IHoub3B0aW9uYWwoei5vYmplY3Qoe30pLmxvb3NlKCkpLFxufSk7XG50eXBlIEJhc2VQYXJhbXMgPSB6LmluZmVyPHR5cGVvZiBCYXNlUGFyYW1zU2NoZW1hPjtcbmV4cG9ydCBjb25zdCBSZXN1bHRTY2hlbWEgPSBCYXNlUGFyYW1zU2NoZW1hO1xuXG5leHBvcnQgY29uc3QgUmVxdWVzdFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgbWV0aG9kOiB6LnN0cmluZygpLFxuICBwYXJhbXM6IHoub3B0aW9uYWwoQmFzZVBhcmFtc1NjaGVtYSksXG59KTtcbmV4cG9ydCB0eXBlIFJlcXVlc3QgPSB6LmluZmVyPHR5cGVvZiBSZXF1ZXN0U2NoZW1hPjtcbmV4cG9ydCB0eXBlIFJlcXVlc3RPcHRpb25zID0ge1xuICBzaWduYWw/OiBBYm9ydFNpZ25hbDtcbiAgdGltZW91dD86IG51bWJlcjtcbiAgbWF4VG90YWxUaW1lb3V0PzogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgTm90aWZpY2F0aW9uID0gei5pbmZlcjx0eXBlb2YgUmVxdWVzdFNjaGVtYT47XG5cbmNvbnN0IFNlcnZlckNhcGFiaWxpdGllc1NjaGVtYSA9IHoubG9vc2VPYmplY3Qoe1xuICBleHBlcmltZW50YWw6IHoub3B0aW9uYWwoei5vYmplY3Qoe30pLmxvb3NlKCkpLFxuICBsb2dnaW5nOiB6Lm9wdGlvbmFsKHoub2JqZWN0KHt9KS5sb29zZSgpKSxcbiAgcHJvbXB0czogei5vcHRpb25hbChcbiAgICB6Lmxvb3NlT2JqZWN0KHtcbiAgICAgIGxpc3RDaGFuZ2VkOiB6Lm9wdGlvbmFsKHouYm9vbGVhbigpKSxcbiAgICB9KSxcbiAgKSxcbiAgcmVzb3VyY2VzOiB6Lm9wdGlvbmFsKFxuICAgIHoubG9vc2VPYmplY3Qoe1xuICAgICAgc3Vic2NyaWJlOiB6Lm9wdGlvbmFsKHouYm9vbGVhbigpKSxcbiAgICAgIGxpc3RDaGFuZ2VkOiB6Lm9wdGlvbmFsKHouYm9vbGVhbigpKSxcbiAgICB9KSxcbiAgKSxcbiAgdG9vbHM6IHoub3B0aW9uYWwoXG4gICAgei5sb29zZU9iamVjdCh7XG4gICAgICBsaXN0Q2hhbmdlZDogei5vcHRpb25hbCh6LmJvb2xlYW4oKSksXG4gICAgfSksXG4gICksXG59KTtcblxuZXhwb3J0IHR5cGUgU2VydmVyQ2FwYWJpbGl0aWVzID0gei5pbmZlcjx0eXBlb2YgU2VydmVyQ2FwYWJpbGl0aWVzU2NoZW1hPjtcblxuZXhwb3J0IGNvbnN0IEluaXRpYWxpemVSZXN1bHRTY2hlbWEgPSBSZXN1bHRTY2hlbWEuZXh0ZW5kKHtcbiAgcHJvdG9jb2xWZXJzaW9uOiB6LnN0cmluZygpLFxuICBjYXBhYmlsaXRpZXM6IFNlcnZlckNhcGFiaWxpdGllc1NjaGVtYSxcbiAgc2VydmVySW5mbzogQ2xpZW50T3JTZXJ2ZXJJbXBsZW1lbnRhdGlvblNjaGVtYSxcbiAgaW5zdHJ1Y3Rpb25zOiB6Lm9wdGlvbmFsKHouc3RyaW5nKCkpLFxufSk7XG5leHBvcnQgdHlwZSBJbml0aWFsaXplUmVzdWx0ID0gei5pbmZlcjx0eXBlb2YgSW5pdGlhbGl6ZVJlc3VsdFNjaGVtYT47XG5cbmV4cG9ydCB0eXBlIFBhZ2luYXRlZFJlcXVlc3QgPSBSZXF1ZXN0ICYge1xuICBwYXJhbXM/OiBCYXNlUGFyYW1zICYge1xuICAgIGN1cnNvcj86IHN0cmluZztcbiAgfTtcbn07XG5cbmNvbnN0IFBhZ2luYXRlZFJlc3VsdFNjaGVtYSA9IFJlc3VsdFNjaGVtYS5leHRlbmQoe1xuICBuZXh0Q3Vyc29yOiB6Lm9wdGlvbmFsKHouc3RyaW5nKCkpLFxufSk7XG5cbmNvbnN0IFRvb2xTY2hlbWEgPSB6XG4gIC5vYmplY3Qoe1xuICAgIG5hbWU6IHouc3RyaW5nKCksXG4gICAgZGVzY3JpcHRpb246IHoub3B0aW9uYWwoei5zdHJpbmcoKSksXG4gICAgaW5wdXRTY2hlbWE6IHpcbiAgICAgIC5vYmplY3Qoe1xuICAgICAgICB0eXBlOiB6LmxpdGVyYWwoJ29iamVjdCcpLFxuICAgICAgICBwcm9wZXJ0aWVzOiB6Lm9wdGlvbmFsKHoub2JqZWN0KHt9KS5sb29zZSgpKSxcbiAgICAgIH0pXG4gICAgICAubG9vc2UoKSxcbiAgfSlcbiAgLmxvb3NlKCk7XG5leHBvcnQgdHlwZSBNQ1BUb29sID0gei5pbmZlcjx0eXBlb2YgVG9vbFNjaGVtYT47XG5leHBvcnQgY29uc3QgTGlzdFRvb2xzUmVzdWx0U2NoZW1hID0gUGFnaW5hdGVkUmVzdWx0U2NoZW1hLmV4dGVuZCh7XG4gIHRvb2xzOiB6LmFycmF5KFRvb2xTY2hlbWEpLFxufSk7XG5leHBvcnQgdHlwZSBMaXN0VG9vbHNSZXN1bHQgPSB6LmluZmVyPHR5cGVvZiBMaXN0VG9vbHNSZXN1bHRTY2hlbWE+O1xuXG5jb25zdCBUZXh0Q29udGVudFNjaGVtYSA9IHpcbiAgLm9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCd0ZXh0JyksXG4gICAgdGV4dDogei5zdHJpbmcoKSxcbiAgfSlcbiAgLmxvb3NlKCk7XG5jb25zdCBJbWFnZUNvbnRlbnRTY2hlbWEgPSB6XG4gIC5vYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgnaW1hZ2UnKSxcbiAgICBkYXRhOiB6LmJhc2U2NCgpLFxuICAgIG1pbWVUeXBlOiB6LnN0cmluZygpLFxuICB9KVxuICAubG9vc2UoKTtcbmNvbnN0IFJlc291cmNlQ29udGVudHNTY2hlbWEgPSB6XG4gIC5vYmplY3Qoe1xuICAgIC8qKlxuICAgICAqIFRoZSBVUkkgb2YgdGhpcyByZXNvdXJjZS5cbiAgICAgKi9cbiAgICB1cmk6IHouc3RyaW5nKCksXG4gICAgLyoqXG4gICAgICogVGhlIE1JTUUgdHlwZSBvZiB0aGlzIHJlc291cmNlLCBpZiBrbm93bi5cbiAgICAgKi9cbiAgICBtaW1lVHlwZTogei5vcHRpb25hbCh6LnN0cmluZygpKSxcbiAgfSlcbiAgLmxvb3NlKCk7XG5jb25zdCBUZXh0UmVzb3VyY2VDb250ZW50c1NjaGVtYSA9IFJlc291cmNlQ29udGVudHNTY2hlbWEuZXh0ZW5kKHtcbiAgdGV4dDogei5zdHJpbmcoKSxcbn0pO1xuY29uc3QgQmxvYlJlc291cmNlQ29udGVudHNTY2hlbWEgPSBSZXNvdXJjZUNvbnRlbnRzU2NoZW1hLmV4dGVuZCh7XG4gIGJsb2I6IHouYmFzZTY0KCksXG59KTtcbmNvbnN0IEVtYmVkZGVkUmVzb3VyY2VTY2hlbWEgPSB6XG4gIC5vYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgncmVzb3VyY2UnKSxcbiAgICByZXNvdXJjZTogei51bmlvbihbVGV4dFJlc291cmNlQ29udGVudHNTY2hlbWEsIEJsb2JSZXNvdXJjZUNvbnRlbnRzU2NoZW1hXSksXG4gIH0pXG4gIC5sb29zZSgpO1xuXG5leHBvcnQgY29uc3QgQ2FsbFRvb2xSZXN1bHRTY2hlbWEgPSBSZXN1bHRTY2hlbWEuZXh0ZW5kKHtcbiAgY29udGVudDogei5hcnJheShcbiAgICB6LnVuaW9uKFtUZXh0Q29udGVudFNjaGVtYSwgSW1hZ2VDb250ZW50U2NoZW1hLCBFbWJlZGRlZFJlc291cmNlU2NoZW1hXSksXG4gICksXG4gIGlzRXJyb3I6IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpLm9wdGlvbmFsKCksXG59KS5vcihcbiAgUmVzdWx0U2NoZW1hLmV4dGVuZCh7XG4gICAgdG9vbFJlc3VsdDogei51bmtub3duKCksXG4gIH0pLFxuKTtcbmV4cG9ydCB0eXBlIENhbGxUb29sUmVzdWx0ID0gei5pbmZlcjx0eXBlb2YgQ2FsbFRvb2xSZXN1bHRTY2hlbWE+O1xuIiwgImltcG9ydCB7IE1DUENsaWVudEVycm9yIH0gZnJvbSAnLi4vLi4vZXJyb3IvbWNwLWNsaWVudC1lcnJvcic7XG5pbXBvcnQgeyBKU09OUlBDTWVzc2FnZSB9IGZyb20gJy4vanNvbi1ycGMtbWVzc2FnZSc7XG5pbXBvcnQgeyBTc2VNQ1BUcmFuc3BvcnQgfSBmcm9tICcuL21jcC1zc2UtdHJhbnNwb3J0JztcblxuLyoqXG4gKiBUcmFuc3BvcnQgaW50ZXJmYWNlIGZvciBNQ1AgKE1vZGVsIENvbnRleHQgUHJvdG9jb2wpIGNvbW11bmljYXRpb24uXG4gKiBNYXBzIHRvIHRoZSBgVHJhbnNwb3J0YCBpbnRlcmZhY2UgaW4gdGhlIE1DUCBzcGVjLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIE1DUFRyYW5zcG9ydCB7XG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGFuZCBzdGFydCB0aGUgdHJhbnNwb3J0XG4gICAqL1xuICBzdGFydCgpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBTZW5kIGEgSlNPTi1SUEMgbWVzc2FnZSB0aHJvdWdoIHRoZSB0cmFuc3BvcnRcbiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIEpTT04tUlBDIG1lc3NhZ2UgdG8gc2VuZFxuICAgKi9cbiAgc2VuZChtZXNzYWdlOiBKU09OUlBDTWVzc2FnZSk6IFByb21pc2U8dm9pZD47XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIGFuZCBjbG9zZSB0aGUgdHJhbnNwb3J0XG4gICAqL1xuICBjbG9zZSgpOiBQcm9taXNlPHZvaWQ+O1xuXG4gIC8qKlxuICAgKiBFdmVudCBoYW5kbGVyIGZvciB0cmFuc3BvcnQgY2xvc3VyZVxuICAgKi9cbiAgb25jbG9zZT86ICgpID0+IHZvaWQ7XG5cbiAgLyoqXG4gICAqIEV2ZW50IGhhbmRsZXIgZm9yIHRyYW5zcG9ydCBlcnJvcnNcbiAgICovXG4gIG9uZXJyb3I/OiAoZXJyb3I6IEVycm9yKSA9PiB2b2lkO1xuXG4gIC8qKlxuICAgKiBFdmVudCBoYW5kbGVyIGZvciByZWNlaXZlZCBtZXNzYWdlc1xuICAgKi9cbiAgb25tZXNzYWdlPzogKG1lc3NhZ2U6IEpTT05SUENNZXNzYWdlKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgdHlwZSBNQ1BUcmFuc3BvcnRDb25maWcgPSB7XG4gIHR5cGU6ICdzc2UnO1xuXG4gIC8qKlxuICAgKiBUaGUgVVJMIG9mIHRoZSBNQ1Agc2VydmVyLlxuICAgKi9cbiAgdXJsOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEFkZGl0aW9uYWwgSFRUUCBoZWFkZXJzIHRvIGJlIHNlbnQgd2l0aCByZXF1ZXN0cy5cbiAgICovXG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU1jcFRyYW5zcG9ydChjb25maWc6IE1DUFRyYW5zcG9ydENvbmZpZyk6IE1DUFRyYW5zcG9ydCB7XG4gIGlmIChjb25maWcudHlwZSAhPT0gJ3NzZScpIHtcbiAgICB0aHJvdyBuZXcgTUNQQ2xpZW50RXJyb3Ioe1xuICAgICAgbWVzc2FnZTpcbiAgICAgICAgJ1Vuc3VwcG9ydGVkIG9yIGludmFsaWQgdHJhbnNwb3J0IGNvbmZpZ3VyYXRpb24uIElmIHlvdSBhcmUgdXNpbmcgYSBjdXN0b20gdHJhbnNwb3J0LCBtYWtlIHN1cmUgaXQgaW1wbGVtZW50cyB0aGUgTUNQVHJhbnNwb3J0IGludGVyZmFjZS4nLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBTc2VNQ1BUcmFuc3BvcnQoY29uZmlnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ3VzdG9tTWNwVHJhbnNwb3J0KFxuICB0cmFuc3BvcnQ6IE1DUFRyYW5zcG9ydENvbmZpZyB8IE1DUFRyYW5zcG9ydCxcbik6IHRyYW5zcG9ydCBpcyBNQ1BUcmFuc3BvcnQge1xuICByZXR1cm4gKFxuICAgICdzdGFydCcgaW4gdHJhbnNwb3J0ICYmXG4gICAgdHlwZW9mIHRyYW5zcG9ydC5zdGFydCA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICdzZW5kJyBpbiB0cmFuc3BvcnQgJiZcbiAgICB0eXBlb2YgdHJhbnNwb3J0LnNlbmQgPT09ICdmdW5jdGlvbicgJiZcbiAgICAnY2xvc2UnIGluIHRyYW5zcG9ydCAmJlxuICAgIHR5cGVvZiB0cmFuc3BvcnQuY2xvc2UgPT09ICdmdW5jdGlvbidcbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBBSVNES0Vycm9yIH0gZnJvbSAnQGFpLXNkay9wcm92aWRlcic7XG5pbXBvcnQgeyBUcmFuc2NyaXB0aW9uTW9kZWxSZXNwb25zZU1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvdHJhbnNjcmlwdGlvbi1tb2RlbC1yZXNwb25zZS1tZXRhZGF0YSc7XG5cbi8qKlxuRXJyb3IgdGhhdCBpcyB0aHJvd24gd2hlbiBubyB0cmFuc2NyaXB0IHdhcyBnZW5lcmF0ZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBOb1RyYW5zY3JpcHRHZW5lcmF0ZWRFcnJvciBleHRlbmRzIEFJU0RLRXJyb3Ige1xuICByZWFkb25seSByZXNwb25zZXM6IEFycmF5PFRyYW5zY3JpcHRpb25Nb2RlbFJlc3BvbnNlTWV0YWRhdGE+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHtcbiAgICByZXNwb25zZXM6IEFycmF5PFRyYW5zY3JpcHRpb25Nb2RlbFJlc3BvbnNlTWV0YWRhdGE+O1xuICB9KSB7XG4gICAgc3VwZXIoe1xuICAgICAgbmFtZTogJ0FJX05vVHJhbnNjcmlwdEdlbmVyYXRlZEVycm9yJyxcbiAgICAgIG1lc3NhZ2U6ICdObyB0cmFuc2NyaXB0IGdlbmVyYXRlZC4nLFxuICAgIH0pO1xuXG4gICAgdGhpcy5yZXNwb25zZXMgPSBvcHRpb25zLnJlc3BvbnNlcztcbiAgfVxufVxuIiwgImltcG9ydCB7IEpTT05WYWx1ZSwgVHJhbnNjcmlwdGlvbk1vZGVsVjIgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyJztcbmltcG9ydCB7IFByb3ZpZGVyT3B0aW9ucyB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgTm9UcmFuc2NyaXB0R2VuZXJhdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvci9uby10cmFuc2NyaXB0LWdlbmVyYXRlZC1lcnJvcic7XG5pbXBvcnQge1xuICBhdWRpb01lZGlhVHlwZVNpZ25hdHVyZXMsXG4gIGRldGVjdE1lZGlhVHlwZSxcbn0gZnJvbSAnLi4vdXRpbC9kZXRlY3QtbWVkaWEtdHlwZSc7XG5pbXBvcnQgeyBkb3dubG9hZCB9IGZyb20gJy4uL3V0aWwvZG93bmxvYWQnO1xuaW1wb3J0IHsgcHJlcGFyZVJldHJpZXMgfSBmcm9tICcuLi91dGlsL3ByZXBhcmUtcmV0cmllcyc7XG5pbXBvcnQgeyBVbnN1cHBvcnRlZE1vZGVsVmVyc2lvbkVycm9yIH0gZnJvbSAnLi4vZXJyb3IvdW5zdXBwb3J0ZWQtbW9kZWwtdmVyc2lvbi1lcnJvcic7XG5pbXBvcnQgeyBEYXRhQ29udGVudCB9IGZyb20gJy4uL3Byb21wdCc7XG5pbXBvcnQgeyBjb252ZXJ0RGF0YUNvbnRlbnRUb1VpbnQ4QXJyYXkgfSBmcm9tICcuLi9wcm9tcHQvZGF0YS1jb250ZW50JztcbmltcG9ydCB7IFRyYW5zY3JpcHRpb25XYXJuaW5nIH0gZnJvbSAnLi4vdHlwZXMvdHJhbnNjcmlwdGlvbi1tb2RlbCc7XG5pbXBvcnQgeyBUcmFuc2NyaXB0aW9uTW9kZWxSZXNwb25zZU1ldGFkYXRhIH0gZnJvbSAnLi4vdHlwZXMvdHJhbnNjcmlwdGlvbi1tb2RlbC1yZXNwb25zZS1tZXRhZGF0YSc7XG5pbXBvcnQgeyBUcmFuc2NyaXB0aW9uUmVzdWx0IH0gZnJvbSAnLi90cmFuc2NyaWJlLXJlc3VsdCc7XG5cbi8qKlxuR2VuZXJhdGVzIHRyYW5zY3JpcHRzIHVzaW5nIGEgdHJhbnNjcmlwdGlvbiBtb2RlbC5cblxuQHBhcmFtIG1vZGVsIC0gVGhlIHRyYW5zY3JpcHRpb24gbW9kZWwgdG8gdXNlLlxuQHBhcmFtIGF1ZGlvIC0gVGhlIGF1ZGlvIGRhdGEgdG8gdHJhbnNjcmliZSBhcyBEYXRhQ29udGVudCAoc3RyaW5nIHwgVWludDhBcnJheSB8IEFycmF5QnVmZmVyIHwgQnVmZmVyKSBvciBhIFVSTC5cbkBwYXJhbSBwcm92aWRlck9wdGlvbnMgLSBBZGRpdGlvbmFsIHByb3ZpZGVyLXNwZWNpZmljIG9wdGlvbnMgdGhhdCBhcmUgcGFzc2VkIHRocm91Z2ggdG8gdGhlIHByb3ZpZGVyXG5hcyBib2R5IHBhcmFtZXRlcnMuXG5AcGFyYW0gbWF4UmV0cmllcyAtIE1heGltdW0gbnVtYmVyIG9mIHJldHJpZXMuIFNldCB0byAwIHRvIGRpc2FibGUgcmV0cmllcy4gRGVmYXVsdDogMi5cbkBwYXJhbSBhYm9ydFNpZ25hbCAtIEFuIG9wdGlvbmFsIGFib3J0IHNpZ25hbCB0aGF0IGNhbiBiZSB1c2VkIHRvIGNhbmNlbCB0aGUgY2FsbC5cbkBwYXJhbSBoZWFkZXJzIC0gQWRkaXRpb25hbCBIVFRQIGhlYWRlcnMgdG8gYmUgc2VudCB3aXRoIHRoZSByZXF1ZXN0LiBPbmx5IGFwcGxpY2FibGUgZm9yIEhUVFAtYmFzZWQgcHJvdmlkZXJzLlxuXG5AcmV0dXJucyBBIHJlc3VsdCBvYmplY3QgdGhhdCBjb250YWlucyB0aGUgZ2VuZXJhdGVkIHRyYW5zY3JpcHQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmFuc2NyaWJlKHtcbiAgbW9kZWwsXG4gIGF1ZGlvLFxuICBwcm92aWRlck9wdGlvbnMgPSB7fSxcbiAgbWF4UmV0cmllczogbWF4UmV0cmllc0FyZyxcbiAgYWJvcnRTaWduYWwsXG4gIGhlYWRlcnMsXG59OiB7XG4gIC8qKlxuVGhlIHRyYW5zY3JpcHRpb24gbW9kZWwgdG8gdXNlLlxuICAgICAqL1xuICBtb2RlbDogVHJhbnNjcmlwdGlvbk1vZGVsVjI7XG5cbiAgLyoqXG5UaGUgYXVkaW8gZGF0YSB0byB0cmFuc2NyaWJlLlxuICAgKi9cbiAgYXVkaW86IERhdGFDb250ZW50IHwgVVJMO1xuXG4gIC8qKlxuQWRkaXRpb25hbCBwcm92aWRlci1zcGVjaWZpYyBvcHRpb25zIHRoYXQgYXJlIHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwcm92aWRlclxuYXMgYm9keSBwYXJhbWV0ZXJzLlxuXG5UaGUgb3V0ZXIgcmVjb3JkIGlzIGtleWVkIGJ5IHRoZSBwcm92aWRlciBuYW1lLCBhbmQgdGhlIGlubmVyXG5yZWNvcmQgaXMga2V5ZWQgYnkgdGhlIHByb3ZpZGVyLXNwZWNpZmljIG1ldGFkYXRhIGtleS5cbmBgYHRzXG57XG4gIFwib3BlbmFpXCI6IHtcbiAgICBcInRlbXBlcmF0dXJlXCI6IDBcbiAgfVxufVxuYGBgXG4gICAgICovXG4gIHByb3ZpZGVyT3B0aW9ucz86IFByb3ZpZGVyT3B0aW9ucztcblxuICAvKipcbk1heGltdW0gbnVtYmVyIG9mIHJldHJpZXMgcGVyIHRyYW5zY3JpcHQgbW9kZWwgY2FsbC4gU2V0IHRvIDAgdG8gZGlzYWJsZSByZXRyaWVzLlxuXG5AZGVmYXVsdCAyXG4gICAqL1xuICBtYXhSZXRyaWVzPzogbnVtYmVyO1xuXG4gIC8qKlxuQWJvcnQgc2lnbmFsLlxuICovXG4gIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWw7XG5cbiAgLyoqXG5BZGRpdGlvbmFsIGhlYWRlcnMgdG8gaW5jbHVkZSBpbiB0aGUgcmVxdWVzdC5cbk9ubHkgYXBwbGljYWJsZSBmb3IgSFRUUC1iYXNlZCBwcm92aWRlcnMuXG4gKi9cbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG59KTogUHJvbWlzZTxUcmFuc2NyaXB0aW9uUmVzdWx0PiB7XG4gIGlmIChtb2RlbC5zcGVjaWZpY2F0aW9uVmVyc2lvbiAhPT0gJ3YyJykge1xuICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE1vZGVsVmVyc2lvbkVycm9yKHtcbiAgICAgIHZlcnNpb246IG1vZGVsLnNwZWNpZmljYXRpb25WZXJzaW9uLFxuICAgICAgcHJvdmlkZXI6IG1vZGVsLnByb3ZpZGVyLFxuICAgICAgbW9kZWxJZDogbW9kZWwubW9kZWxJZCxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHsgcmV0cnkgfSA9IHByZXBhcmVSZXRyaWVzKHtcbiAgICBtYXhSZXRyaWVzOiBtYXhSZXRyaWVzQXJnLFxuICAgIGFib3J0U2lnbmFsLFxuICB9KTtcblxuICBjb25zdCBhdWRpb0RhdGEgPVxuICAgIGF1ZGlvIGluc3RhbmNlb2YgVVJMXG4gICAgICA/IChhd2FpdCBkb3dubG9hZCh7IHVybDogYXVkaW8gfSkpLmRhdGFcbiAgICAgIDogY29udmVydERhdGFDb250ZW50VG9VaW50OEFycmF5KGF1ZGlvKTtcblxuICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXRyeSgoKSA9PlxuICAgIG1vZGVsLmRvR2VuZXJhdGUoe1xuICAgICAgYXVkaW86IGF1ZGlvRGF0YSxcbiAgICAgIGFib3J0U2lnbmFsLFxuICAgICAgaGVhZGVycyxcbiAgICAgIHByb3ZpZGVyT3B0aW9ucyxcbiAgICAgIG1lZGlhVHlwZTpcbiAgICAgICAgZGV0ZWN0TWVkaWFUeXBlKHtcbiAgICAgICAgICBkYXRhOiBhdWRpb0RhdGEsXG4gICAgICAgICAgc2lnbmF0dXJlczogYXVkaW9NZWRpYVR5cGVTaWduYXR1cmVzLFxuICAgICAgICB9KSA/PyAnYXVkaW8vd2F2JyxcbiAgICB9KSxcbiAgKTtcblxuICBpZiAoIXJlc3VsdC50ZXh0KSB7XG4gICAgdGhyb3cgbmV3IE5vVHJhbnNjcmlwdEdlbmVyYXRlZEVycm9yKHsgcmVzcG9uc2VzOiBbcmVzdWx0LnJlc3BvbnNlXSB9KTtcbiAgfVxuXG4gIHJldHVybiBuZXcgRGVmYXVsdFRyYW5zY3JpcHRpb25SZXN1bHQoe1xuICAgIHRleHQ6IHJlc3VsdC50ZXh0LFxuICAgIHNlZ21lbnRzOiByZXN1bHQuc2VnbWVudHMsXG4gICAgbGFuZ3VhZ2U6IHJlc3VsdC5sYW5ndWFnZSxcbiAgICBkdXJhdGlvbkluU2Vjb25kczogcmVzdWx0LmR1cmF0aW9uSW5TZWNvbmRzLFxuICAgIHdhcm5pbmdzOiByZXN1bHQud2FybmluZ3MsXG4gICAgcmVzcG9uc2VzOiBbcmVzdWx0LnJlc3BvbnNlXSxcbiAgICBwcm92aWRlck1ldGFkYXRhOiByZXN1bHQucHJvdmlkZXJNZXRhZGF0YSxcbiAgfSk7XG59XG5cbmNsYXNzIERlZmF1bHRUcmFuc2NyaXB0aW9uUmVzdWx0IGltcGxlbWVudHMgVHJhbnNjcmlwdGlvblJlc3VsdCB7XG4gIHJlYWRvbmx5IHRleHQ6IHN0cmluZztcbiAgcmVhZG9ubHkgc2VnbWVudHM6IEFycmF5PHtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgc3RhcnRTZWNvbmQ6IG51bWJlcjtcbiAgICBlbmRTZWNvbmQ6IG51bWJlcjtcbiAgfT47XG4gIHJlYWRvbmx5IGxhbmd1YWdlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IGR1cmF0aW9uSW5TZWNvbmRzOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IHdhcm5pbmdzOiBBcnJheTxUcmFuc2NyaXB0aW9uV2FybmluZz47XG4gIHJlYWRvbmx5IHJlc3BvbnNlczogQXJyYXk8VHJhbnNjcmlwdGlvbk1vZGVsUmVzcG9uc2VNZXRhZGF0YT47XG4gIHJlYWRvbmx5IHByb3ZpZGVyTWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIEpTT05WYWx1ZT4+O1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IHtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgc2VnbWVudHM6IEFycmF5PHtcbiAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgIHN0YXJ0U2Vjb25kOiBudW1iZXI7XG4gICAgICBlbmRTZWNvbmQ6IG51bWJlcjtcbiAgICB9PjtcbiAgICBsYW5ndWFnZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIGR1cmF0aW9uSW5TZWNvbmRzOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gICAgd2FybmluZ3M6IEFycmF5PFRyYW5zY3JpcHRpb25XYXJuaW5nPjtcbiAgICByZXNwb25zZXM6IEFycmF5PFRyYW5zY3JpcHRpb25Nb2RlbFJlc3BvbnNlTWV0YWRhdGE+O1xuICAgIHByb3ZpZGVyTWV0YWRhdGE6IFJlY29yZDxzdHJpbmcsIFJlY29yZDxzdHJpbmcsIEpTT05WYWx1ZT4+IHwgdW5kZWZpbmVkO1xuICB9KSB7XG4gICAgdGhpcy50ZXh0ID0gb3B0aW9ucy50ZXh0O1xuICAgIHRoaXMuc2VnbWVudHMgPSBvcHRpb25zLnNlZ21lbnRzO1xuICAgIHRoaXMubGFuZ3VhZ2UgPSBvcHRpb25zLmxhbmd1YWdlO1xuICAgIHRoaXMuZHVyYXRpb25JblNlY29uZHMgPSBvcHRpb25zLmR1cmF0aW9uSW5TZWNvbmRzO1xuICAgIHRoaXMud2FybmluZ3MgPSBvcHRpb25zLndhcm5pbmdzO1xuICAgIHRoaXMucmVzcG9uc2VzID0gb3B0aW9ucy5yZXNwb25zZXM7XG4gICAgdGhpcy5wcm92aWRlck1ldGFkYXRhID0gb3B0aW9ucy5wcm92aWRlck1ldGFkYXRhID8/IHt9O1xuICB9XG59XG4iLCAiaW1wb3J0IHsgcGFyc2VKc29uRXZlbnRTdHJlYW0sIFBhcnNlUmVzdWx0IH0gZnJvbSAnQGFpLXNkay9wcm92aWRlci11dGlscyc7XG5pbXBvcnQge1xuICBVSU1lc3NhZ2VDaHVuayxcbiAgdWlNZXNzYWdlQ2h1bmtTY2hlbWEsXG59IGZyb20gJy4uL3VpLW1lc3NhZ2Utc3RyZWFtL3VpLW1lc3NhZ2UtY2h1bmtzJztcbmltcG9ydCB7IGNvbnN1bWVTdHJlYW0gfSBmcm9tICcuLi91dGlsL2NvbnN1bWUtc3RyZWFtJztcbmltcG9ydCB7IHByb2Nlc3NUZXh0U3RyZWFtIH0gZnJvbSAnLi9wcm9jZXNzLXRleHQtc3RyZWFtJztcblxuLy8gdXNlIGZ1bmN0aW9uIHRvIGFsbG93IGZvciBtb2NraW5nIGluIHRlc3RzOlxuY29uc3QgZ2V0T3JpZ2luYWxGZXRjaCA9ICgpID0+IGZldGNoO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsbENvbXBsZXRpb25BcGkoe1xuICBhcGksXG4gIHByb21wdCxcbiAgY3JlZGVudGlhbHMsXG4gIGhlYWRlcnMsXG4gIGJvZHksXG4gIHN0cmVhbVByb3RvY29sID0gJ2RhdGEnLFxuICBzZXRDb21wbGV0aW9uLFxuICBzZXRMb2FkaW5nLFxuICBzZXRFcnJvcixcbiAgc2V0QWJvcnRDb250cm9sbGVyLFxuICBvbkZpbmlzaCxcbiAgb25FcnJvcixcbiAgZmV0Y2ggPSBnZXRPcmlnaW5hbEZldGNoKCksXG59OiB7XG4gIGFwaTogc3RyaW5nO1xuICBwcm9tcHQ6IHN0cmluZztcbiAgY3JlZGVudGlhbHM6IFJlcXVlc3RDcmVkZW50aWFscyB8IHVuZGVmaW5lZDtcbiAgaGVhZGVyczogSGVhZGVyc0luaXQgfCB1bmRlZmluZWQ7XG4gIGJvZHk6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIHN0cmVhbVByb3RvY29sOiAnZGF0YScgfCAndGV4dCcgfCB1bmRlZmluZWQ7XG4gIHNldENvbXBsZXRpb246IChjb21wbGV0aW9uOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHNldExvYWRpbmc6IChsb2FkaW5nOiBib29sZWFuKSA9PiB2b2lkO1xuICBzZXRFcnJvcjogKGVycm9yOiBFcnJvciB8IHVuZGVmaW5lZCkgPT4gdm9pZDtcbiAgc2V0QWJvcnRDb250cm9sbGVyOiAoYWJvcnRDb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXIgfCBudWxsKSA9PiB2b2lkO1xuICBvbkZpbmlzaDogKChwcm9tcHQ6IHN0cmluZywgY29tcGxldGlvbjogc3RyaW5nKSA9PiB2b2lkKSB8IHVuZGVmaW5lZDtcbiAgb25FcnJvcjogKChlcnJvcjogRXJyb3IpID0+IHZvaWQpIHwgdW5kZWZpbmVkO1xuICBmZXRjaDogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0T3JpZ2luYWxGZXRjaD4gfCB1bmRlZmluZWQ7XG59KSB7XG4gIHRyeSB7XG4gICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICBzZXRFcnJvcih1bmRlZmluZWQpO1xuXG4gICAgY29uc3QgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIHNldEFib3J0Q29udHJvbGxlcihhYm9ydENvbnRyb2xsZXIpO1xuXG4gICAgLy8gRW1wdHkgdGhlIGNvbXBsZXRpb24gaW1tZWRpYXRlbHkuXG4gICAgc2V0Q29tcGxldGlvbignJyk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaSwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHByb21wdCxcbiAgICAgICAgLi4uYm9keSxcbiAgICAgIH0pLFxuICAgICAgY3JlZGVudGlhbHMsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIC4uLmhlYWRlcnMsXG4gICAgICB9LFxuICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsLFxuICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIChhd2FpdCByZXNwb25zZS50ZXh0KCkpID8/ICdGYWlsZWQgdG8gZmV0Y2ggdGhlIGNoYXQgcmVzcG9uc2UuJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSByZXNwb25zZSBib2R5IGlzIGVtcHR5LicpO1xuICAgIH1cblxuICAgIGxldCByZXN1bHQgPSAnJztcblxuICAgIHN3aXRjaCAoc3RyZWFtUHJvdG9jb2wpIHtcbiAgICAgIGNhc2UgJ3RleHQnOiB7XG4gICAgICAgIGF3YWl0IHByb2Nlc3NUZXh0U3RyZWFtKHtcbiAgICAgICAgICBzdHJlYW06IHJlc3BvbnNlLmJvZHksXG4gICAgICAgICAgb25UZXh0UGFydDogY2h1bmsgPT4ge1xuICAgICAgICAgICAgcmVzdWx0ICs9IGNodW5rO1xuICAgICAgICAgICAgc2V0Q29tcGxldGlvbihyZXN1bHQpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2RhdGEnOiB7XG4gICAgICAgIGF3YWl0IGNvbnN1bWVTdHJlYW0oe1xuICAgICAgICAgIHN0cmVhbTogcGFyc2VKc29uRXZlbnRTdHJlYW0oe1xuICAgICAgICAgICAgc3RyZWFtOiByZXNwb25zZS5ib2R5LFxuICAgICAgICAgICAgc2NoZW1hOiB1aU1lc3NhZ2VDaHVua1NjaGVtYSxcbiAgICAgICAgICB9KS5waXBlVGhyb3VnaChcbiAgICAgICAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08UGFyc2VSZXN1bHQ8VUlNZXNzYWdlQ2h1bms+LCBVSU1lc3NhZ2VDaHVuaz4oe1xuICAgICAgICAgICAgICBhc3luYyB0cmFuc2Zvcm0ocGFydCkge1xuICAgICAgICAgICAgICAgIGlmICghcGFydC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICB0aHJvdyBwYXJ0LmVycm9yO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbVBhcnQgPSBwYXJ0LnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1QYXJ0LnR5cGUgPT09ICd0ZXh0LWRlbHRhJykge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHN0cmVhbVBhcnQuZGVsdGE7XG4gICAgICAgICAgICAgICAgICBzZXRDb21wbGV0aW9uKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdHJlYW1QYXJ0LnR5cGUgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihzdHJlYW1QYXJ0LmVycm9yVGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKSxcbiAgICAgICAgICBvbkVycm9yOiBlcnJvciA9PiB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIGNvbnN0IGV4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBzdHJlYW1Qcm90b2NvbDtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHN0cmVhbSBwcm90b2NvbDogJHtleGhhdXN0aXZlQ2hlY2t9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9uRmluaXNoKSB7XG4gICAgICBvbkZpbmlzaChwcm9tcHQsIHJlc3VsdCk7XG4gICAgfVxuXG4gICAgc2V0QWJvcnRDb250cm9sbGVyKG51bGwpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIC8vIElnbm9yZSBhYm9ydCBlcnJvcnMgYXMgdGhleSBhcmUgZXhwZWN0ZWQuXG4gICAgaWYgKChlcnIgYXMgYW55KS5uYW1lID09PSAnQWJvcnRFcnJvcicpIHtcbiAgICAgIHNldEFib3J0Q29udHJvbGxlcihudWxsKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgb25FcnJvcihlcnIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNldEVycm9yKGVyciBhcyBFcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gIH1cbn1cbiIsICJleHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1RleHRTdHJlYW0oe1xuICBzdHJlYW0sXG4gIG9uVGV4dFBhcnQsXG59OiB7XG4gIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VWludDhBcnJheT47XG4gIG9uVGV4dFBhcnQ6IChjaHVuazogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZDtcbn0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgcmVhZGVyID0gc3RyZWFtLnBpcGVUaHJvdWdoKG5ldyBUZXh0RGVjb2RlclN0cmVhbSgpKS5nZXRSZWFkZXIoKTtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgIGlmIChkb25lKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgYXdhaXQgb25UZXh0UGFydCh2YWx1ZSk7XG4gIH1cbn1cbiIsICJpbXBvcnQge1xuICBnZW5lcmF0ZUlkIGFzIGdlbmVyYXRlSWRGdW5jLFxuICBJZEdlbmVyYXRvcixcbiAgU3RhbmRhcmRTY2hlbWFWMSxcbiAgVmFsaWRhdG9yLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IFVJTWVzc2FnZUNodW5rIH0gZnJvbSAnLi4vdWktbWVzc2FnZS1zdHJlYW0vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHsgY29uc3VtZVN0cmVhbSB9IGZyb20gJy4uL3V0aWwvY29uc3VtZS1zdHJlYW0nO1xuaW1wb3J0IHsgU2VyaWFsSm9iRXhlY3V0b3IgfSBmcm9tICcuLi91dGlsL3NlcmlhbC1qb2ItZXhlY3V0b3InO1xuaW1wb3J0IHsgQ2hhdFRyYW5zcG9ydCB9IGZyb20gJy4vY2hhdC10cmFuc3BvcnQnO1xuaW1wb3J0IHsgY29udmVydEZpbGVMaXN0VG9GaWxlVUlQYXJ0cyB9IGZyb20gJy4vY29udmVydC1maWxlLWxpc3QtdG8tZmlsZS11aS1wYXJ0cyc7XG5pbXBvcnQgeyBEZWZhdWx0Q2hhdFRyYW5zcG9ydCB9IGZyb20gJy4vZGVmYXVsdC1jaGF0LXRyYW5zcG9ydCc7XG5pbXBvcnQge1xuICBjcmVhdGVTdHJlYW1pbmdVSU1lc3NhZ2VTdGF0ZSxcbiAgcHJvY2Vzc1VJTWVzc2FnZVN0cmVhbSxcbiAgU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGUsXG59IGZyb20gJy4vcHJvY2Vzcy11aS1tZXNzYWdlLXN0cmVhbSc7XG5pbXBvcnQge1xuICBJbmZlclVJTWVzc2FnZVRvb2xDYWxsLFxuICBpc1Rvb2xVSVBhcnQsXG4gIHR5cGUgRGF0YVVJUGFydCxcbiAgdHlwZSBGaWxlVUlQYXJ0LFxuICB0eXBlIEluZmVyVUlNZXNzYWdlRGF0YSxcbiAgdHlwZSBJbmZlclVJTWVzc2FnZU1ldGFkYXRhLFxuICB0eXBlIEluZmVyVUlNZXNzYWdlVG9vbHMsXG4gIHR5cGUgVUlEYXRhVHlwZXMsXG4gIHR5cGUgVUlNZXNzYWdlLFxufSBmcm9tICcuL3VpLW1lc3NhZ2VzJztcblxuZXhwb3J0IHR5cGUgQ3JlYXRlVUlNZXNzYWdlPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+ID0gT21pdDxcbiAgVUlfTUVTU0FHRSxcbiAgJ2lkJyB8ICdyb2xlJ1xuPiAmIHtcbiAgaWQ/OiBVSV9NRVNTQUdFWydpZCddO1xuICByb2xlPzogVUlfTUVTU0FHRVsncm9sZSddO1xufTtcblxuZXhwb3J0IHR5cGUgVUlEYXRhUGFydFNjaGVtYXMgPSBSZWNvcmQ8XG4gIHN0cmluZyxcbiAgVmFsaWRhdG9yPGFueT4gfCBTdGFuZGFyZFNjaGVtYVYxPGFueT5cbj47XG5cbmV4cG9ydCB0eXBlIFVJRGF0YVR5cGVzVG9TY2hlbWFzPFQgZXh0ZW5kcyBVSURhdGFUeXBlcz4gPSB7XG4gIFtLIGluIGtleW9mIFRdOiBWYWxpZGF0b3I8VFtLXT4gfCBTdGFuZGFyZFNjaGVtYVYxPFRbS10+O1xufTtcblxuZXhwb3J0IHR5cGUgSW5mZXJVSURhdGFQYXJ0czxUIGV4dGVuZHMgVUlEYXRhUGFydFNjaGVtYXM+ID0ge1xuICBbSyBpbiBrZXlvZiBUXTogVFtLXSBleHRlbmRzIFZhbGlkYXRvcjxpbmZlciBVPlxuICAgID8gVVxuICAgIDogVFtLXSBleHRlbmRzIFN0YW5kYXJkU2NoZW1hVjE8aW5mZXIgVT5cbiAgICAgID8gVVxuICAgICAgOiB1bmtub3duO1xufTtcblxuZXhwb3J0IHR5cGUgQ2hhdFJlcXVlc3RPcHRpb25zID0ge1xuICAvKipcbiAgQWRkaXRpb25hbCBoZWFkZXJzIHRoYXQgc2hvdWxkIGJlIHRvIGJlIHBhc3NlZCB0byB0aGUgQVBJIGVuZHBvaW50LlxuICAgKi9cbiAgaGVhZGVycz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCBIZWFkZXJzO1xuXG4gIC8qKlxuICBBZGRpdGlvbmFsIGJvZHkgSlNPTiBwcm9wZXJ0aWVzIHRoYXQgc2hvdWxkIGJlIHNlbnQgdG8gdGhlIEFQSSBlbmRwb2ludC5cbiAgICovXG4gIGJvZHk/OiBvYmplY3Q7IC8vIFRPRE8gSlNPTlN0cmluZ2lmeWFibGVcblxuICBtZXRhZGF0YT86IHVua25vd247XG59O1xuXG5leHBvcnQgdHlwZSBDaGF0U3RhdHVzID0gJ3N1Ym1pdHRlZCcgfCAnc3RyZWFtaW5nJyB8ICdyZWFkeScgfCAnZXJyb3InO1xuXG50eXBlIEFjdGl2ZVJlc3BvbnNlPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+ID0ge1xuICBzdGF0ZTogU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGU8VUlfTUVTU0FHRT47XG4gIGFib3J0Q29udHJvbGxlcjogQWJvcnRDb250cm9sbGVyO1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBDaGF0U3RhdGU8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4ge1xuICBzdGF0dXM6IENoYXRTdGF0dXM7XG5cbiAgZXJyb3I6IEVycm9yIHwgdW5kZWZpbmVkO1xuXG4gIG1lc3NhZ2VzOiBVSV9NRVNTQUdFW107XG4gIHB1c2hNZXNzYWdlOiAobWVzc2FnZTogVUlfTUVTU0FHRSkgPT4gdm9pZDtcbiAgcG9wTWVzc2FnZTogKCkgPT4gdm9pZDtcbiAgcmVwbGFjZU1lc3NhZ2U6IChpbmRleDogbnVtYmVyLCBtZXNzYWdlOiBVSV9NRVNTQUdFKSA9PiB2b2lkO1xuXG4gIHNuYXBzaG90OiA8VD4odGhpbmc6IFQpID0+IFQ7XG59XG5cbmV4cG9ydCB0eXBlIENoYXRPbkVycm9yQ2FsbGJhY2sgPSAoZXJyb3I6IEVycm9yKSA9PiB2b2lkO1xuXG5leHBvcnQgdHlwZSBDaGF0T25Ub29sQ2FsbENhbGxiYWNrPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2UgPSBVSU1lc3NhZ2U+ID1cbiAgKG9wdGlvbnM6IHtcbiAgICB0b29sQ2FsbDogSW5mZXJVSU1lc3NhZ2VUb29sQ2FsbDxVSV9NRVNTQUdFPjtcbiAgfSkgPT4gdm9pZCB8IFByb21pc2VMaWtlPHZvaWQ+O1xuXG5leHBvcnQgdHlwZSBDaGF0T25EYXRhQ2FsbGJhY2s8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4gPSAoXG4gIGRhdGFQYXJ0OiBEYXRhVUlQYXJ0PEluZmVyVUlNZXNzYWdlRGF0YTxVSV9NRVNTQUdFPj4sXG4pID0+IHZvaWQ7XG5cbmV4cG9ydCB0eXBlIENoYXRPbkZpbmlzaENhbGxiYWNrPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+ID0gKG9wdGlvbnM6IHtcbiAgbWVzc2FnZTogVUlfTUVTU0FHRTtcbn0pID0+IHZvaWQ7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdEluaXQ8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4ge1xuICAvKipcbiAgICogQSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIGNoYXQuIElmIG5vdCBwcm92aWRlZCwgYSByYW5kb20gb25lIHdpbGwgYmVcbiAgICogZ2VuZXJhdGVkLlxuICAgKi9cbiAgaWQ/OiBzdHJpbmc7XG5cbiAgbWVzc2FnZU1ldGFkYXRhU2NoZW1hPzpcbiAgICB8IFZhbGlkYXRvcjxJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFVJX01FU1NBR0U+PlxuICAgIHwgU3RhbmRhcmRTY2hlbWFWMTxJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFVJX01FU1NBR0U+PjtcbiAgZGF0YVBhcnRTY2hlbWFzPzogVUlEYXRhVHlwZXNUb1NjaGVtYXM8SW5mZXJVSU1lc3NhZ2VEYXRhPFVJX01FU1NBR0U+PjtcblxuICBtZXNzYWdlcz86IFVJX01FU1NBR0VbXTtcblxuICAvKipcbiAgICogQSB3YXkgdG8gcHJvdmlkZSBhIGZ1bmN0aW9uIHRoYXQgaXMgZ29pbmcgdG8gYmUgdXNlZCBmb3IgaWRzIGZvciBtZXNzYWdlcyBhbmQgdGhlIGNoYXQuXG4gICAqIElmIG5vdCBwcm92aWRlZCB0aGUgZGVmYXVsdCBBSSBTREsgYGdlbmVyYXRlSWRgIGlzIHVzZWQuXG4gICAqL1xuICBnZW5lcmF0ZUlkPzogSWRHZW5lcmF0b3I7XG5cbiAgdHJhbnNwb3J0PzogQ2hhdFRyYW5zcG9ydDxVSV9NRVNTQUdFPjtcblxuICAvKipcbiAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIHdoZW4gYW4gZXJyb3IgaXMgZW5jb3VudGVyZWQuXG4gICAqL1xuICBvbkVycm9yPzogQ2hhdE9uRXJyb3JDYWxsYmFjaztcblxuICAvKipcbiAgT3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBpbnZva2VkIHdoZW4gYSB0b29sIGNhbGwgaXMgcmVjZWl2ZWQuXG4gIEludGVuZGVkIGZvciBhdXRvbWF0aWMgY2xpZW50LXNpZGUgdG9vbCBleGVjdXRpb24uXG5cbiAgWW91IGNhbiBvcHRpb25hbGx5IHJldHVybiBhIHJlc3VsdCBmb3IgdGhlIHRvb2wgY2FsbCxcbiAgZWl0aGVyIHN5bmNocm9ub3VzbHkgb3IgYXN5bmNocm9ub3VzbHkuXG4gICAgICovXG4gIG9uVG9vbENhbGw/OiBDaGF0T25Ub29sQ2FsbENhbGxiYWNrPFVJX01FU1NBR0U+O1xuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIHRoZSBhc3Npc3RhbnQgbWVzc2FnZSBpcyBmaW5pc2hlZCBzdHJlYW1pbmcuXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRoYXQgd2FzIHN0cmVhbWVkLlxuICAgKi9cbiAgb25GaW5pc2g/OiBDaGF0T25GaW5pc2hDYWxsYmFjazxVSV9NRVNTQUdFPjtcblxuICAvKipcbiAgICogT3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIGRhdGEgcGFydCBpcyByZWNlaXZlZC5cbiAgICpcbiAgICogQHBhcmFtIGRhdGEgVGhlIGRhdGEgcGFydCB0aGF0IHdhcyByZWNlaXZlZC5cbiAgICovXG4gIG9uRGF0YT86IENoYXRPbkRhdGFDYWxsYmFjazxVSV9NRVNTQUdFPjtcblxuICAvKipcbiAgICogV2hlbiBwcm92aWRlZCwgdGhpcyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBzdHJlYW0gaXMgZmluaXNoZWQgb3IgYSB0b29sIGNhbGwgaXMgYWRkZWRcbiAgICogdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IG1lc3NhZ2VzIHNob3VsZCBiZSByZXN1Ym1pdHRlZC5cbiAgICovXG4gIHNlbmRBdXRvbWF0aWNhbGx5V2hlbj86IChvcHRpb25zOiB7XG4gICAgbWVzc2FnZXM6IFVJX01FU1NBR0VbXTtcbiAgfSkgPT4gYm9vbGVhbiB8IFByb21pc2VMaWtlPGJvb2xlYW4+O1xufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RDaGF0PFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+IHtcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcbiAgcmVhZG9ubHkgZ2VuZXJhdGVJZDogSWRHZW5lcmF0b3I7XG5cbiAgcHJvdGVjdGVkIHN0YXRlOiBDaGF0U3RhdGU8VUlfTUVTU0FHRT47XG5cbiAgcHJpdmF0ZSBtZXNzYWdlTWV0YWRhdGFTY2hlbWE6XG4gICAgfCBWYWxpZGF0b3I8SW5mZXJVSU1lc3NhZ2VNZXRhZGF0YTxVSV9NRVNTQUdFPj5cbiAgICB8IFN0YW5kYXJkU2NoZW1hVjE8SW5mZXJVSU1lc3NhZ2VNZXRhZGF0YTxVSV9NRVNTQUdFPj5cbiAgICB8IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBkYXRhUGFydFNjaGVtYXM6XG4gICAgfCBVSURhdGFUeXBlc1RvU2NoZW1hczxJbmZlclVJTWVzc2FnZURhdGE8VUlfTUVTU0FHRT4+XG4gICAgfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgcmVhZG9ubHkgdHJhbnNwb3J0OiBDaGF0VHJhbnNwb3J0PFVJX01FU1NBR0U+O1xuICBwcml2YXRlIG9uRXJyb3I/OiBDaGF0SW5pdDxVSV9NRVNTQUdFPlsnb25FcnJvciddO1xuICBwcml2YXRlIG9uVG9vbENhbGw/OiBDaGF0SW5pdDxVSV9NRVNTQUdFPlsnb25Ub29sQ2FsbCddO1xuICBwcml2YXRlIG9uRmluaXNoPzogQ2hhdEluaXQ8VUlfTUVTU0FHRT5bJ29uRmluaXNoJ107XG4gIHByaXZhdGUgb25EYXRhPzogQ2hhdEluaXQ8VUlfTUVTU0FHRT5bJ29uRGF0YSddO1xuICBwcml2YXRlIHNlbmRBdXRvbWF0aWNhbGx5V2hlbj86IENoYXRJbml0PFVJX01FU1NBR0U+WydzZW5kQXV0b21hdGljYWxseVdoZW4nXTtcblxuICBwcml2YXRlIGFjdGl2ZVJlc3BvbnNlOiBBY3RpdmVSZXNwb25zZTxVSV9NRVNTQUdFPiB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBqb2JFeGVjdXRvciA9IG5ldyBTZXJpYWxKb2JFeGVjdXRvcigpO1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBnZW5lcmF0ZUlkID0gZ2VuZXJhdGVJZEZ1bmMsXG4gICAgaWQgPSBnZW5lcmF0ZUlkKCksXG4gICAgdHJhbnNwb3J0ID0gbmV3IERlZmF1bHRDaGF0VHJhbnNwb3J0KCksXG4gICAgbWVzc2FnZU1ldGFkYXRhU2NoZW1hLFxuICAgIGRhdGFQYXJ0U2NoZW1hcyxcbiAgICBzdGF0ZSxcbiAgICBvbkVycm9yLFxuICAgIG9uVG9vbENhbGwsXG4gICAgb25GaW5pc2gsXG4gICAgb25EYXRhLFxuICAgIHNlbmRBdXRvbWF0aWNhbGx5V2hlbixcbiAgfTogT21pdDxDaGF0SW5pdDxVSV9NRVNTQUdFPiwgJ21lc3NhZ2VzJz4gJiB7XG4gICAgc3RhdGU6IENoYXRTdGF0ZTxVSV9NRVNTQUdFPjtcbiAgfSkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDtcbiAgICB0aGlzLmdlbmVyYXRlSWQgPSBnZW5lcmF0ZUlkO1xuICAgIHRoaXMubWVzc2FnZU1ldGFkYXRhU2NoZW1hID0gbWVzc2FnZU1ldGFkYXRhU2NoZW1hO1xuICAgIHRoaXMuZGF0YVBhcnRTY2hlbWFzID0gZGF0YVBhcnRTY2hlbWFzO1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICB0aGlzLm9uRXJyb3IgPSBvbkVycm9yO1xuICAgIHRoaXMub25Ub29sQ2FsbCA9IG9uVG9vbENhbGw7XG4gICAgdGhpcy5vbkZpbmlzaCA9IG9uRmluaXNoO1xuICAgIHRoaXMub25EYXRhID0gb25EYXRhO1xuICAgIHRoaXMuc2VuZEF1dG9tYXRpY2FsbHlXaGVuID0gc2VuZEF1dG9tYXRpY2FsbHlXaGVuO1xuICB9XG5cbiAgLyoqXG4gICAqIEhvb2sgc3RhdHVzOlxuICAgKlxuICAgKiAtIGBzdWJtaXR0ZWRgOiBUaGUgbWVzc2FnZSBoYXMgYmVlbiBzZW50IHRvIHRoZSBBUEkgYW5kIHdlJ3JlIGF3YWl0aW5nIHRoZSBzdGFydCBvZiB0aGUgcmVzcG9uc2Ugc3RyZWFtLlxuICAgKiAtIGBzdHJlYW1pbmdgOiBUaGUgcmVzcG9uc2UgaXMgYWN0aXZlbHkgc3RyZWFtaW5nIGluIGZyb20gdGhlIEFQSSwgcmVjZWl2aW5nIGNodW5rcyBvZiBkYXRhLlxuICAgKiAtIGByZWFkeWA6IFRoZSBmdWxsIHJlc3BvbnNlIGhhcyBiZWVuIHJlY2VpdmVkIGFuZCBwcm9jZXNzZWQ7IGEgbmV3IHVzZXIgbWVzc2FnZSBjYW4gYmUgc3VibWl0dGVkLlxuICAgKiAtIGBlcnJvcmA6IEFuIGVycm9yIG9jY3VycmVkIGR1cmluZyB0aGUgQVBJIHJlcXVlc3QsIHByZXZlbnRpbmcgc3VjY2Vzc2Z1bCBjb21wbGV0aW9uLlxuICAgKi9cbiAgZ2V0IHN0YXR1cygpOiBDaGF0U3RhdHVzIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5zdGF0dXM7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2V0U3RhdHVzKHtcbiAgICBzdGF0dXMsXG4gICAgZXJyb3IsXG4gIH06IHtcbiAgICBzdGF0dXM6IENoYXRTdGF0dXM7XG4gICAgZXJyb3I/OiBFcnJvcjtcbiAgfSkge1xuICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gc3RhdHVzKSByZXR1cm47XG5cbiAgICB0aGlzLnN0YXRlLnN0YXR1cyA9IHN0YXR1cztcbiAgICB0aGlzLnN0YXRlLmVycm9yID0gZXJyb3I7XG4gIH1cblxuICBnZXQgZXJyb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuZXJyb3I7XG4gIH1cblxuICBnZXQgbWVzc2FnZXMoKTogVUlfTUVTU0FHRVtdIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5tZXNzYWdlcztcbiAgfVxuXG4gIGdldCBsYXN0TWVzc2FnZSgpOiBVSV9NRVNTQUdFIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5tZXNzYWdlc1t0aGlzLnN0YXRlLm1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICB9XG5cbiAgc2V0IG1lc3NhZ2VzKG1lc3NhZ2VzOiBVSV9NRVNTQUdFW10pIHtcbiAgICB0aGlzLnN0YXRlLm1lc3NhZ2VzID0gbWVzc2FnZXM7XG4gIH1cblxuICAvKipcbiAgICogQXBwZW5kcyBvciByZXBsYWNlcyBhIHVzZXIgbWVzc2FnZSB0byB0aGUgY2hhdCBsaXN0LiBUaGlzIHRyaWdnZXJzIHRoZSBBUEkgY2FsbCB0byBmZXRjaFxuICAgKiB0aGUgYXNzaXN0YW50J3MgcmVzcG9uc2UuXG4gICAqXG4gICAqIElmIGEgbWVzc2FnZUlkIGlzIHByb3ZpZGVkLCB0aGUgbWVzc2FnZSB3aWxsIGJlIHJlcGxhY2VkLlxuICAgKi9cbiAgc2VuZE1lc3NhZ2UgPSBhc3luYyAoXG4gICAgbWVzc2FnZT86XG4gICAgICB8IChDcmVhdGVVSU1lc3NhZ2U8VUlfTUVTU0FHRT4gJiB7XG4gICAgICAgICAgdGV4dD86IG5ldmVyO1xuICAgICAgICAgIGZpbGVzPzogbmV2ZXI7XG4gICAgICAgICAgbWVzc2FnZUlkPzogc3RyaW5nO1xuICAgICAgICB9KVxuICAgICAgfCB7XG4gICAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICAgIGZpbGVzPzogRmlsZUxpc3QgfCBGaWxlVUlQYXJ0W107XG4gICAgICAgICAgbWV0YWRhdGE/OiBJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFVJX01FU1NBR0U+O1xuICAgICAgICAgIHBhcnRzPzogbmV2ZXI7XG4gICAgICAgICAgbWVzc2FnZUlkPzogc3RyaW5nO1xuICAgICAgICB9XG4gICAgICB8IHtcbiAgICAgICAgICBmaWxlczogRmlsZUxpc3QgfCBGaWxlVUlQYXJ0W107XG4gICAgICAgICAgbWV0YWRhdGE/OiBJbmZlclVJTWVzc2FnZU1ldGFkYXRhPFVJX01FU1NBR0U+O1xuICAgICAgICAgIHBhcnRzPzogbmV2ZXI7XG4gICAgICAgICAgbWVzc2FnZUlkPzogc3RyaW5nO1xuICAgICAgICB9LFxuICAgIG9wdGlvbnM/OiBDaGF0UmVxdWVzdE9wdGlvbnMsXG4gICk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGlmIChtZXNzYWdlID09IG51bGwpIHtcbiAgICAgIGF3YWl0IHRoaXMubWFrZVJlcXVlc3Qoe1xuICAgICAgICB0cmlnZ2VyOiAnc3VibWl0LW1lc3NhZ2UnLFxuICAgICAgICBtZXNzYWdlSWQ6IHRoaXMubGFzdE1lc3NhZ2U/LmlkLFxuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHVpTWVzc2FnZTogQ3JlYXRlVUlNZXNzYWdlPFVJX01FU1NBR0U+O1xuXG4gICAgaWYgKCd0ZXh0JyBpbiBtZXNzYWdlIHx8ICdmaWxlcycgaW4gbWVzc2FnZSkge1xuICAgICAgY29uc3QgZmlsZVBhcnRzID0gQXJyYXkuaXNBcnJheShtZXNzYWdlLmZpbGVzKVxuICAgICAgICA/IG1lc3NhZ2UuZmlsZXNcbiAgICAgICAgOiBhd2FpdCBjb252ZXJ0RmlsZUxpc3RUb0ZpbGVVSVBhcnRzKG1lc3NhZ2UuZmlsZXMpO1xuXG4gICAgICB1aU1lc3NhZ2UgPSB7XG4gICAgICAgIHBhcnRzOiBbXG4gICAgICAgICAgLi4uZmlsZVBhcnRzLFxuICAgICAgICAgIC4uLigndGV4dCcgaW4gbWVzc2FnZSAmJiBtZXNzYWdlLnRleHQgIT0gbnVsbFxuICAgICAgICAgICAgPyBbeyB0eXBlOiAndGV4dCcgYXMgY29uc3QsIHRleHQ6IG1lc3NhZ2UudGV4dCB9XVxuICAgICAgICAgICAgOiBbXSksXG4gICAgICAgIF0sXG4gICAgICB9IGFzIFVJX01FU1NBR0U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVpTWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgaWYgKG1lc3NhZ2UubWVzc2FnZUlkICE9IG51bGwpIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2VJbmRleCA9IHRoaXMuc3RhdGUubWVzc2FnZXMuZmluZEluZGV4KFxuICAgICAgICBtID0+IG0uaWQgPT09IG1lc3NhZ2UubWVzc2FnZUlkLFxuICAgICAgKTtcblxuICAgICAgaWYgKG1lc3NhZ2VJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBtZXNzYWdlIHdpdGggaWQgJHttZXNzYWdlLm1lc3NhZ2VJZH0gbm90IGZvdW5kYCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnN0YXRlLm1lc3NhZ2VzW21lc3NhZ2VJbmRleF0ucm9sZSAhPT0gJ3VzZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgbWVzc2FnZSB3aXRoIGlkICR7bWVzc2FnZS5tZXNzYWdlSWR9IGlzIG5vdCBhIHVzZXIgbWVzc2FnZWAsXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIHJlbW92ZSBhbGwgbWVzc2FnZXMgYWZ0ZXIgdGhlIG1lc3NhZ2Ugd2l0aCB0aGUgZ2l2ZW4gaWRcbiAgICAgIHRoaXMuc3RhdGUubWVzc2FnZXMgPSB0aGlzLnN0YXRlLm1lc3NhZ2VzLnNsaWNlKDAsIG1lc3NhZ2VJbmRleCArIDEpO1xuXG4gICAgICAvLyB1cGRhdGUgdGhlIG1lc3NhZ2Ugd2l0aCB0aGUgbmV3IGNvbnRlbnRcbiAgICAgIHRoaXMuc3RhdGUucmVwbGFjZU1lc3NhZ2UobWVzc2FnZUluZGV4LCB7XG4gICAgICAgIC4uLnVpTWVzc2FnZSxcbiAgICAgICAgaWQ6IG1lc3NhZ2UubWVzc2FnZUlkLFxuICAgICAgICByb2xlOiB1aU1lc3NhZ2Uucm9sZSA/PyAndXNlcicsXG4gICAgICAgIG1ldGFkYXRhOiBtZXNzYWdlLm1ldGFkYXRhLFxuICAgICAgfSBhcyBVSV9NRVNTQUdFKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGF0ZS5wdXNoTWVzc2FnZSh7XG4gICAgICAgIC4uLnVpTWVzc2FnZSxcbiAgICAgICAgaWQ6IHVpTWVzc2FnZS5pZCA/PyB0aGlzLmdlbmVyYXRlSWQoKSxcbiAgICAgICAgcm9sZTogdWlNZXNzYWdlLnJvbGUgPz8gJ3VzZXInLFxuICAgICAgICBtZXRhZGF0YTogbWVzc2FnZS5tZXRhZGF0YSxcbiAgICAgIH0gYXMgVUlfTUVTU0FHRSk7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCh7XG4gICAgICB0cmlnZ2VyOiAnc3VibWl0LW1lc3NhZ2UnLFxuICAgICAgbWVzc2FnZUlkOiBtZXNzYWdlLm1lc3NhZ2VJZCxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlZ2VuZXJhdGUgdGhlIGFzc2lzdGFudCBtZXNzYWdlIHdpdGggdGhlIHByb3ZpZGVkIG1lc3NhZ2UgaWQuXG4gICAqIElmIG5vIG1lc3NhZ2UgaWQgaXMgcHJvdmlkZWQsIHRoZSBsYXN0IGFzc2lzdGFudCBtZXNzYWdlIHdpbGwgYmUgcmVnZW5lcmF0ZWQuXG4gICAqL1xuICByZWdlbmVyYXRlID0gYXN5bmMgKHtcbiAgICBtZXNzYWdlSWQsXG4gICAgLi4ub3B0aW9uc1xuICB9OiB7XG4gICAgbWVzc2FnZUlkPzogc3RyaW5nO1xuICB9ICYgQ2hhdFJlcXVlc3RPcHRpb25zID0ge30pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBjb25zdCBtZXNzYWdlSW5kZXggPVxuICAgICAgbWVzc2FnZUlkID09IG51bGxcbiAgICAgICAgPyB0aGlzLnN0YXRlLm1lc3NhZ2VzLmxlbmd0aCAtIDFcbiAgICAgICAgOiB0aGlzLnN0YXRlLm1lc3NhZ2VzLmZpbmRJbmRleChtZXNzYWdlID0+IG1lc3NhZ2UuaWQgPT09IG1lc3NhZ2VJZCk7XG5cbiAgICBpZiAobWVzc2FnZUluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBtZXNzYWdlICR7bWVzc2FnZUlkfSBub3QgZm91bmRgKTtcbiAgICB9XG5cbiAgICAvLyBzZXQgdGhlIG1lc3NhZ2VzIHRvIHRoZSBtZXNzYWdlIGJlZm9yZSB0aGUgYXNzaXN0YW50IG1lc3NhZ2VcbiAgICB0aGlzLnN0YXRlLm1lc3NhZ2VzID0gdGhpcy5zdGF0ZS5tZXNzYWdlcy5zbGljZShcbiAgICAgIDAsXG4gICAgICAvLyBpZiB0aGUgbWVzc2FnZSBpcyBhIHVzZXIgbWVzc2FnZSwgd2UgbmVlZCB0byBpbmNsdWRlIGl0IGluIHRoZSByZXF1ZXN0OlxuICAgICAgdGhpcy5tZXNzYWdlc1ttZXNzYWdlSW5kZXhdLnJvbGUgPT09ICdhc3Npc3RhbnQnXG4gICAgICAgID8gbWVzc2FnZUluZGV4XG4gICAgICAgIDogbWVzc2FnZUluZGV4ICsgMSxcbiAgICApO1xuXG4gICAgYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCh7XG4gICAgICB0cmlnZ2VyOiAncmVnZW5lcmF0ZS1tZXNzYWdlJyxcbiAgICAgIG1lc3NhZ2VJZCxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEF0dGVtcHQgdG8gcmVzdW1lIGFuIG9uZ29pbmcgc3RyZWFtaW5nIHJlc3BvbnNlLlxuICAgKi9cbiAgcmVzdW1lU3RyZWFtID0gYXN5bmMgKG9wdGlvbnM6IENoYXRSZXF1ZXN0T3B0aW9ucyA9IHt9KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCh7IHRyaWdnZXI6ICdyZXN1bWUtc3RyZWFtJywgLi4ub3B0aW9ucyB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQ2xlYXIgdGhlIGVycm9yIHN0YXRlIGFuZCBzZXQgdGhlIHN0YXR1cyB0byByZWFkeSBpZiB0aGUgY2hhdCBpcyBpbiBhbiBlcnJvciBzdGF0ZS5cbiAgICovXG4gIGNsZWFyRXJyb3IgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuc3RhdHVzID09PSAnZXJyb3InKSB7XG4gICAgICB0aGlzLnN0YXRlLmVycm9yID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5zZXRTdGF0dXMoeyBzdGF0dXM6ICdyZWFkeScgfSk7XG4gICAgfVxuICB9O1xuXG4gIGFkZFRvb2xSZXN1bHQgPSBhc3luYyA8VE9PTCBleHRlbmRzIGtleW9mIEluZmVyVUlNZXNzYWdlVG9vbHM8VUlfTUVTU0FHRT4+KHtcbiAgICB0b29sLFxuICAgIHRvb2xDYWxsSWQsXG4gICAgb3V0cHV0LFxuICB9OiB7XG4gICAgdG9vbDogVE9PTDtcbiAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgb3V0cHV0OiBJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+W1RPT0xdWydvdXRwdXQnXTtcbiAgfSkgPT5cbiAgICB0aGlzLmpvYkV4ZWN1dG9yLnJ1bihhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMuc3RhdGUubWVzc2FnZXM7XG4gICAgICBjb25zdCBsYXN0TWVzc2FnZSA9IG1lc3NhZ2VzW21lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuXG4gICAgICB0aGlzLnN0YXRlLnJlcGxhY2VNZXNzYWdlKG1lc3NhZ2VzLmxlbmd0aCAtIDEsIHtcbiAgICAgICAgLi4ubGFzdE1lc3NhZ2UsXG4gICAgICAgIHBhcnRzOiBsYXN0TWVzc2FnZS5wYXJ0cy5tYXAocGFydCA9PlxuICAgICAgICAgIGlzVG9vbFVJUGFydChwYXJ0KSAmJiBwYXJ0LnRvb2xDYWxsSWQgPT09IHRvb2xDYWxsSWRcbiAgICAgICAgICAgID8geyAuLi5wYXJ0LCBzdGF0ZTogJ291dHB1dC1hdmFpbGFibGUnLCBvdXRwdXQgfVxuICAgICAgICAgICAgOiBwYXJ0LFxuICAgICAgICApLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIHVwZGF0ZSB0aGUgYWN0aXZlIHJlc3BvbnNlIGlmIGl0IGV4aXN0c1xuICAgICAgaWYgKHRoaXMuYWN0aXZlUmVzcG9uc2UpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVSZXNwb25zZS5zdGF0ZS5tZXNzYWdlLnBhcnRzID1cbiAgICAgICAgICB0aGlzLmFjdGl2ZVJlc3BvbnNlLnN0YXRlLm1lc3NhZ2UucGFydHMubWFwKHBhcnQgPT5cbiAgICAgICAgICAgIGlzVG9vbFVJUGFydChwYXJ0KSAmJiBwYXJ0LnRvb2xDYWxsSWQgPT09IHRvb2xDYWxsSWRcbiAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAuLi5wYXJ0LFxuICAgICAgICAgICAgICAgICAgc3RhdGU6ICdvdXRwdXQtYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICAgIG91dHB1dCxcbiAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiBwYXJ0LFxuICAgICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIGF1dG9tYXRpY2FsbHkgc2VuZCB0aGUgbWVzc2FnZSBpZiB0aGUgc2VuZEF1dG9tYXRpY2FsbHlXaGVuIGZ1bmN0aW9uIHJldHVybnMgdHJ1ZVxuICAgICAgaWYgKFxuICAgICAgICB0aGlzLnN0YXR1cyAhPT0gJ3N0cmVhbWluZycgJiZcbiAgICAgICAgdGhpcy5zdGF0dXMgIT09ICdzdWJtaXR0ZWQnICYmXG4gICAgICAgIHRoaXMuc2VuZEF1dG9tYXRpY2FsbHlXaGVuPy4oeyBtZXNzYWdlczogdGhpcy5zdGF0ZS5tZXNzYWdlcyB9KVxuICAgICAgKSB7XG4gICAgICAgIC8vIG5vIGF3YWl0IHRvIGF2b2lkIGRlYWRsb2NraW5nXG4gICAgICAgIHRoaXMubWFrZVJlcXVlc3Qoe1xuICAgICAgICAgIHRyaWdnZXI6ICdzdWJtaXQtbWVzc2FnZScsXG4gICAgICAgICAgbWVzc2FnZUlkOiB0aGlzLmxhc3RNZXNzYWdlPy5pZCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgLyoqXG4gICAqIEFib3J0IHRoZSBjdXJyZW50IHJlcXVlc3QgaW1tZWRpYXRlbHksIGtlZXAgdGhlIGdlbmVyYXRlZCB0b2tlbnMgaWYgYW55LlxuICAgKi9cbiAgc3RvcCA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAodGhpcy5zdGF0dXMgIT09ICdzdHJlYW1pbmcnICYmIHRoaXMuc3RhdHVzICE9PSAnc3VibWl0dGVkJykgcmV0dXJuO1xuXG4gICAgaWYgKHRoaXMuYWN0aXZlUmVzcG9uc2U/LmFib3J0Q29udHJvbGxlcikge1xuICAgICAgdGhpcy5hY3RpdmVSZXNwb25zZS5hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICB9XG4gIH07XG5cbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVxdWVzdCh7XG4gICAgdHJpZ2dlcixcbiAgICBtZXRhZGF0YSxcbiAgICBoZWFkZXJzLFxuICAgIGJvZHksXG4gICAgbWVzc2FnZUlkLFxuICB9OiB7XG4gICAgdHJpZ2dlcjogJ3N1Ym1pdC1tZXNzYWdlJyB8ICdyZXN1bWUtc3RyZWFtJyB8ICdyZWdlbmVyYXRlLW1lc3NhZ2UnO1xuICAgIG1lc3NhZ2VJZD86IHN0cmluZztcbiAgfSAmIENoYXRSZXF1ZXN0T3B0aW9ucykge1xuICAgIHRoaXMuc2V0U3RhdHVzKHsgc3RhdHVzOiAnc3VibWl0dGVkJywgZXJyb3I6IHVuZGVmaW5lZCB9KTtcblxuICAgIGNvbnN0IGxhc3RNZXNzYWdlID0gdGhpcy5sYXN0TWVzc2FnZTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBhY3RpdmVSZXNwb25zZSA9IHtcbiAgICAgICAgc3RhdGU6IGNyZWF0ZVN0cmVhbWluZ1VJTWVzc2FnZVN0YXRlKHtcbiAgICAgICAgICBsYXN0TWVzc2FnZTogdGhpcy5zdGF0ZS5zbmFwc2hvdChsYXN0TWVzc2FnZSksXG4gICAgICAgICAgbWVzc2FnZUlkOiB0aGlzLmdlbmVyYXRlSWQoKSxcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0Q29udHJvbGxlcjogbmV3IEFib3J0Q29udHJvbGxlcigpLFxuICAgICAgfSBhcyBBY3RpdmVSZXNwb25zZTxVSV9NRVNTQUdFPjtcblxuICAgICAgdGhpcy5hY3RpdmVSZXNwb25zZSA9IGFjdGl2ZVJlc3BvbnNlO1xuXG4gICAgICBsZXQgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVSU1lc3NhZ2VDaHVuaz47XG5cbiAgICAgIGlmICh0cmlnZ2VyID09PSAncmVzdW1lLXN0cmVhbScpIHtcbiAgICAgICAgY29uc3QgcmVjb25uZWN0ID0gYXdhaXQgdGhpcy50cmFuc3BvcnQucmVjb25uZWN0VG9TdHJlYW0oe1xuICAgICAgICAgIGNoYXRJZDogdGhpcy5pZCxcbiAgICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIGJvZHksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChyZWNvbm5lY3QgPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuc2V0U3RhdHVzKHsgc3RhdHVzOiAncmVhZHknIH0pO1xuICAgICAgICAgIHJldHVybjsgLy8gbm8gYWN0aXZlIHN0cmVhbSBmb3VuZCwgc28gd2UgZG8gbm90IHJlc3VtZVxuICAgICAgICB9XG5cbiAgICAgICAgc3RyZWFtID0gcmVjb25uZWN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyZWFtID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZE1lc3NhZ2VzKHtcbiAgICAgICAgICBjaGF0SWQ6IHRoaXMuaWQsXG4gICAgICAgICAgbWVzc2FnZXM6IHRoaXMuc3RhdGUubWVzc2FnZXMsXG4gICAgICAgICAgYWJvcnRTaWduYWw6IGFjdGl2ZVJlc3BvbnNlLmFib3J0Q29udHJvbGxlci5zaWduYWwsXG4gICAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICBib2R5LFxuICAgICAgICAgIHRyaWdnZXIsXG4gICAgICAgICAgbWVzc2FnZUlkLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcnVuVXBkYXRlTWVzc2FnZUpvYiA9IChcbiAgICAgICAgam9iOiAob3B0aW9uczoge1xuICAgICAgICAgIHN0YXRlOiBTdHJlYW1pbmdVSU1lc3NhZ2VTdGF0ZTxVSV9NRVNTQUdFPjtcbiAgICAgICAgICB3cml0ZTogKCkgPT4gdm9pZDtcbiAgICAgICAgfSkgPT4gUHJvbWlzZTx2b2lkPixcbiAgICAgICkgPT5cbiAgICAgICAgLy8gc2VyaWFsaXplIHRoZSBqb2IgZXhlY3V0aW9uIHRvIGF2b2lkIHJhY2UgY29uZGl0aW9uczpcbiAgICAgICAgdGhpcy5qb2JFeGVjdXRvci5ydW4oKCkgPT5cbiAgICAgICAgICBqb2Ioe1xuICAgICAgICAgICAgc3RhdGU6IGFjdGl2ZVJlc3BvbnNlLnN0YXRlLFxuICAgICAgICAgICAgd3JpdGU6ICgpID0+IHtcbiAgICAgICAgICAgICAgLy8gc3RyZWFtaW5nIGlzIHNldCBvbiBmaXJzdCB3cml0ZSAoYmVmb3JlIGl0IHNob3VsZCBiZSBcInN1Ym1pdHRlZFwiKVxuICAgICAgICAgICAgICB0aGlzLnNldFN0YXR1cyh7IHN0YXR1czogJ3N0cmVhbWluZycgfSk7XG5cbiAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZUxhc3RNZXNzYWdlID1cbiAgICAgICAgICAgICAgICBhY3RpdmVSZXNwb25zZS5zdGF0ZS5tZXNzYWdlLmlkID09PSB0aGlzLmxhc3RNZXNzYWdlPy5pZDtcblxuICAgICAgICAgICAgICBpZiAocmVwbGFjZUxhc3RNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5yZXBsYWNlTWVzc2FnZShcbiAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUubWVzc2FnZXMubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgIGFjdGl2ZVJlc3BvbnNlLnN0YXRlLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnB1c2hNZXNzYWdlKGFjdGl2ZVJlc3BvbnNlLnN0YXRlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICBhd2FpdCBjb25zdW1lU3RyZWFtKHtcbiAgICAgICAgc3RyZWFtOiBwcm9jZXNzVUlNZXNzYWdlU3RyZWFtKHtcbiAgICAgICAgICBzdHJlYW0sXG4gICAgICAgICAgb25Ub29sQ2FsbDogdGhpcy5vblRvb2xDYWxsLFxuICAgICAgICAgIG9uRGF0YTogdGhpcy5vbkRhdGEsXG4gICAgICAgICAgbWVzc2FnZU1ldGFkYXRhU2NoZW1hOiB0aGlzLm1lc3NhZ2VNZXRhZGF0YVNjaGVtYSxcbiAgICAgICAgICBkYXRhUGFydFNjaGVtYXM6IHRoaXMuZGF0YVBhcnRTY2hlbWFzLFxuICAgICAgICAgIHJ1blVwZGF0ZU1lc3NhZ2VKb2IsXG4gICAgICAgICAgb25FcnJvcjogZXJyb3IgPT4ge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSksXG4gICAgICAgIG9uRXJyb3I6IGVycm9yID0+IHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLm9uRmluaXNoPy4oeyBtZXNzYWdlOiBhY3RpdmVSZXNwb25zZS5zdGF0ZS5tZXNzYWdlIH0pO1xuXG4gICAgICB0aGlzLnNldFN0YXR1cyh7IHN0YXR1czogJ3JlYWR5JyB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIC8vIElnbm9yZSBhYm9ydCBlcnJvcnMgYXMgdGhleSBhcmUgZXhwZWN0ZWQuXG4gICAgICBpZiAoKGVyciBhcyBhbnkpLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICB0aGlzLnNldFN0YXR1cyh7IHN0YXR1czogJ3JlYWR5JyB9KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9uRXJyb3IgJiYgZXJyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhpcy5vbkVycm9yKGVycik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2V0U3RhdHVzKHsgc3RhdHVzOiAnZXJyb3InLCBlcnJvcjogZXJyIGFzIEVycm9yIH0pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmFjdGl2ZVJlc3BvbnNlID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8vIGF1dG9tYXRpY2FsbHkgc2VuZCB0aGUgbWVzc2FnZSBpZiB0aGUgc2VuZEF1dG9tYXRpY2FsbHlXaGVuIGZ1bmN0aW9uIHJldHVybnMgdHJ1ZVxuICAgIGlmICh0aGlzLnNlbmRBdXRvbWF0aWNhbGx5V2hlbj8uKHsgbWVzc2FnZXM6IHRoaXMuc3RhdGUubWVzc2FnZXMgfSkpIHtcbiAgICAgIGF3YWl0IHRoaXMubWFrZVJlcXVlc3Qoe1xuICAgICAgICB0cmlnZ2VyOiAnc3VibWl0LW1lc3NhZ2UnLFxuICAgICAgICBtZXNzYWdlSWQ6IHRoaXMubGFzdE1lc3NhZ2U/LmlkLFxuICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgYm9keSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuIiwgImltcG9ydCB7IEZpbGVVSVBhcnQgfSBmcm9tICcuL3VpLW1lc3NhZ2VzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRGaWxlTGlzdFRvRmlsZVVJUGFydHMoXG4gIGZpbGVzOiBGaWxlTGlzdCB8IHVuZGVmaW5lZCxcbik6IFByb21pc2U8QXJyYXk8RmlsZVVJUGFydD4+IHtcbiAgaWYgKGZpbGVzID09IG51bGwpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvLyBSZWFjdC1uYXRpdmUgZG9lc24ndCBoYXZlIGEgRmlsZUxpc3QgZ2xvYmFsOlxuICBpZiAoIWdsb2JhbFRoaXMuRmlsZUxpc3QgfHwgIShmaWxlcyBpbnN0YW5jZW9mIGdsb2JhbFRoaXMuRmlsZUxpc3QpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlTGlzdCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50Jyk7XG4gIH1cblxuICByZXR1cm4gUHJvbWlzZS5hbGwoXG4gICAgQXJyYXkuZnJvbShmaWxlcykubWFwKGFzeW5jIGZpbGUgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lLCB0eXBlIH0gPSBmaWxlO1xuXG4gICAgICBjb25zdCBkYXRhVXJsID0gYXdhaXQgbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSByZWFkZXJFdmVudCA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZWFkZXJFdmVudC50YXJnZXQ/LnJlc3VsdCBhcyBzdHJpbmcpO1xuICAgICAgICB9O1xuICAgICAgICByZWFkZXIub25lcnJvciA9IGVycm9yID0+IHJlamVjdChlcnJvcik7XG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdmaWxlJyxcbiAgICAgICAgbWVkaWFUeXBlOiB0eXBlLFxuICAgICAgICBmaWxlbmFtZTogbmFtZSxcbiAgICAgICAgdXJsOiBkYXRhVXJsLFxuICAgICAgfTtcbiAgICB9KSxcbiAgKTtcbn1cbiIsICJpbXBvcnQgeyBwYXJzZUpzb25FdmVudFN0cmVhbSwgUGFyc2VSZXN1bHQgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7XG4gIFVJTWVzc2FnZUNodW5rLFxuICB1aU1lc3NhZ2VDaHVua1NjaGVtYSxcbn0gZnJvbSAnLi4vdWktbWVzc2FnZS1zdHJlYW0vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHtcbiAgSHR0cENoYXRUcmFuc3BvcnQsXG4gIEh0dHBDaGF0VHJhbnNwb3J0SW5pdE9wdGlvbnMsXG59IGZyb20gJy4vaHR0cC1jaGF0LXRyYW5zcG9ydCc7XG5pbXBvcnQgeyBVSU1lc3NhZ2UgfSBmcm9tICcuL3VpLW1lc3NhZ2VzJztcblxuZXhwb3J0IGNsYXNzIERlZmF1bHRDaGF0VHJhbnNwb3J0PFxuICBVSV9NRVNTQUdFIGV4dGVuZHMgVUlNZXNzYWdlLFxuPiBleHRlbmRzIEh0dHBDaGF0VHJhbnNwb3J0PFVJX01FU1NBR0U+IHtcbiAgY29uc3RydWN0b3Iob3B0aW9uczogSHR0cENoYXRUcmFuc3BvcnRJbml0T3B0aW9uczxVSV9NRVNTQUdFPiA9IHt9KSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgcHJvY2Vzc1Jlc3BvbnNlU3RyZWFtKFxuICAgIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VWludDhBcnJheTxBcnJheUJ1ZmZlckxpa2U+PixcbiAgKTogUmVhZGFibGVTdHJlYW08VUlNZXNzYWdlQ2h1bms+IHtcbiAgICByZXR1cm4gcGFyc2VKc29uRXZlbnRTdHJlYW0oe1xuICAgICAgc3RyZWFtLFxuICAgICAgc2NoZW1hOiB1aU1lc3NhZ2VDaHVua1NjaGVtYSxcbiAgICB9KS5waXBlVGhyb3VnaChcbiAgICAgIG5ldyBUcmFuc2Zvcm1TdHJlYW08UGFyc2VSZXN1bHQ8VUlNZXNzYWdlQ2h1bms+LCBVSU1lc3NhZ2VDaHVuaz4oe1xuICAgICAgICBhc3luYyB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICBpZiAoIWNodW5rLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IGNodW5rLmVycm9yO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoY2h1bmsudmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgfSksXG4gICAgKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEZldGNoRnVuY3Rpb24sIFJlc29sdmFibGUsIHJlc29sdmUgfSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IFVJTWVzc2FnZUNodW5rIH0gZnJvbSAnLi4vdWktbWVzc2FnZS1zdHJlYW0vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHsgQ2hhdFRyYW5zcG9ydCB9IGZyb20gJy4vY2hhdC10cmFuc3BvcnQnO1xuaW1wb3J0IHsgVUlNZXNzYWdlIH0gZnJvbSAnLi91aS1tZXNzYWdlcyc7XG5cbmV4cG9ydCB0eXBlIFByZXBhcmVTZW5kTWVzc2FnZXNSZXF1ZXN0PFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+ID0gKFxuICBvcHRpb25zOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBtZXNzYWdlczogVUlfTUVTU0FHRVtdO1xuICAgIHJlcXVlc3RNZXRhZGF0YTogdW5rbm93bjtcbiAgICBib2R5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgdW5kZWZpbmVkO1xuICAgIGNyZWRlbnRpYWxzOiBSZXF1ZXN0Q3JlZGVudGlhbHMgfCB1bmRlZmluZWQ7XG4gICAgaGVhZGVyczogSGVhZGVyc0luaXQgfCB1bmRlZmluZWQ7XG4gICAgYXBpOiBzdHJpbmc7XG4gIH0gJiB7XG4gICAgdHJpZ2dlcjogJ3N1Ym1pdC1tZXNzYWdlJyB8ICdyZWdlbmVyYXRlLW1lc3NhZ2UnO1xuICAgIG1lc3NhZ2VJZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICB9LFxuKSA9PlxuICB8IHtcbiAgICAgIGJvZHk6IG9iamVjdDtcbiAgICAgIGhlYWRlcnM/OiBIZWFkZXJzSW5pdDtcbiAgICAgIGNyZWRlbnRpYWxzPzogUmVxdWVzdENyZWRlbnRpYWxzO1xuICAgICAgYXBpPzogc3RyaW5nO1xuICAgIH1cbiAgfCBQcm9taXNlTGlrZTx7XG4gICAgICBib2R5OiBvYmplY3Q7XG4gICAgICBoZWFkZXJzPzogSGVhZGVyc0luaXQ7XG4gICAgICBjcmVkZW50aWFscz86IFJlcXVlc3RDcmVkZW50aWFscztcbiAgICAgIGFwaT86IHN0cmluZztcbiAgICB9PjtcblxuZXhwb3J0IHR5cGUgUHJlcGFyZVJlY29ubmVjdFRvU3RyZWFtUmVxdWVzdCA9IChvcHRpb25zOiB7XG4gIGlkOiBzdHJpbmc7XG4gIHJlcXVlc3RNZXRhZGF0YTogdW5rbm93bjtcbiAgYm9keTogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZDtcbiAgY3JlZGVudGlhbHM6IFJlcXVlc3RDcmVkZW50aWFscyB8IHVuZGVmaW5lZDtcbiAgaGVhZGVyczogSGVhZGVyc0luaXQgfCB1bmRlZmluZWQ7XG4gIGFwaTogc3RyaW5nO1xufSkgPT5cbiAgfCB7XG4gICAgICBoZWFkZXJzPzogSGVhZGVyc0luaXQ7XG4gICAgICBjcmVkZW50aWFscz86IFJlcXVlc3RDcmVkZW50aWFscztcbiAgICAgIGFwaT86IHN0cmluZztcbiAgICB9XG4gIHwgUHJvbWlzZUxpa2U8e1xuICAgICAgaGVhZGVycz86IEhlYWRlcnNJbml0O1xuICAgICAgY3JlZGVudGlhbHM/OiBSZXF1ZXN0Q3JlZGVudGlhbHM7XG4gICAgICBhcGk/OiBzdHJpbmc7XG4gICAgfT47XG5cbi8qKlxuICogT3B0aW9ucyBmb3IgdGhlIGBIdHRwQ2hhdFRyYW5zcG9ydGAgY2xhc3MuXG4gKlxuICogQHBhcmFtIFVJX01FU1NBR0UgLSBUaGUgdHlwZSBvZiBtZXNzYWdlIHRvIGJlIHVzZWQgaW4gdGhlIGNoYXQuXG4gKi9cbmV4cG9ydCB0eXBlIEh0dHBDaGF0VHJhbnNwb3J0SW5pdE9wdGlvbnM8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4gPSB7XG4gIC8qKlxuICAgKiBUaGUgQVBJIFVSTCB0byBiZSB1c2VkIGZvciB0aGUgY2hhdCB0cmFuc3BvcnQuXG4gICAqIERlZmF1bHRzIHRvICcvYXBpL2NoYXQnLlxuICAgKi9cbiAgYXBpPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgY3JlZGVudGlhbHMgbW9kZSB0byBiZSB1c2VkIGZvciB0aGUgZmV0Y2ggcmVxdWVzdC5cbiAgICogUG9zc2libGUgdmFsdWVzIGFyZTogJ29taXQnLCAnc2FtZS1vcmlnaW4nLCAnaW5jbHVkZScuXG4gICAqIERlZmF1bHRzIHRvICdzYW1lLW9yaWdpbicuXG4gICAqL1xuICBjcmVkZW50aWFscz86IFJlc29sdmFibGU8UmVxdWVzdENyZWRlbnRpYWxzPjtcblxuICAvKipcbiAgICogSFRUUCBoZWFkZXJzIHRvIGJlIHNlbnQgd2l0aCB0aGUgQVBJIHJlcXVlc3QuXG4gICAqL1xuICBoZWFkZXJzPzogUmVzb2x2YWJsZTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgSGVhZGVycz47XG5cbiAgLyoqXG4gICAqIEV4dHJhIGJvZHkgb2JqZWN0IHRvIGJlIHNlbnQgd2l0aCB0aGUgQVBJIHJlcXVlc3QuXG4gICAqIEBleGFtcGxlXG4gICAqIFNlbmQgYSBgc2Vzc2lvbklkYCB0byB0aGUgQVBJIGFsb25nIHdpdGggdGhlIG1lc3NhZ2VzLlxuICAgKiBgYGBqc1xuICAgKiB1c2VDaGF0KHtcbiAgICogICBib2R5OiB7XG4gICAqICAgICBzZXNzaW9uSWQ6ICcxMjMnLFxuICAgKiAgIH1cbiAgICogfSlcbiAgICogYGBgXG4gICAqL1xuICBib2R5PzogUmVzb2x2YWJsZTxvYmplY3Q+O1xuXG4gIC8qKlxuICBDdXN0b20gZmV0Y2ggaW1wbGVtZW50YXRpb24uIFlvdSBjYW4gdXNlIGl0IGFzIGEgbWlkZGxld2FyZSB0byBpbnRlcmNlcHQgcmVxdWVzdHMsXG4gIG9yIHRvIHByb3ZpZGUgYSBjdXN0b20gZmV0Y2ggaW1wbGVtZW50YXRpb24gZm9yIGUuZy4gdGVzdGluZy5cbiAgICAgICovXG4gIGZldGNoPzogRmV0Y2hGdW5jdGlvbjtcblxuICAvKipcbiAgICogV2hlbiBhIGZ1bmN0aW9uIGlzIHByb3ZpZGVkLCBpdCB3aWxsIGJlIHVzZWRcbiAgICogdG8gcHJlcGFyZSB0aGUgcmVxdWVzdCBib2R5IGZvciB0aGUgY2hhdCBBUEkuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3JcbiAgICogY3VzdG9taXppbmcgdGhlIHJlcXVlc3QgYm9keSBiYXNlZCBvbiB0aGUgbWVzc2FnZXMgYW5kIGRhdGEgaW4gdGhlIGNoYXQuXG4gICAqXG4gICAqIEBwYXJhbSBpZCBUaGUgaWQgb2YgdGhlIGNoYXQuXG4gICAqIEBwYXJhbSBtZXNzYWdlcyBUaGUgY3VycmVudCBtZXNzYWdlcyBpbiB0aGUgY2hhdC5cbiAgICogQHBhcmFtIHJlcXVlc3RCb2R5IFRoZSByZXF1ZXN0IGJvZHkgb2JqZWN0IHBhc3NlZCBpbiB0aGUgY2hhdCByZXF1ZXN0LlxuICAgKi9cbiAgcHJlcGFyZVNlbmRNZXNzYWdlc1JlcXVlc3Q/OiBQcmVwYXJlU2VuZE1lc3NhZ2VzUmVxdWVzdDxVSV9NRVNTQUdFPjtcblxuICAvKipcbiAgICogV2hlbiBhIGZ1bmN0aW9uIGlzIHByb3ZpZGVkLCBpdCB3aWxsIGJlIHVzZWRcbiAgICogdG8gcHJlcGFyZSB0aGUgcmVxdWVzdCBib2R5IGZvciB0aGUgY2hhdCBBUEkuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3JcbiAgICogY3VzdG9taXppbmcgdGhlIHJlcXVlc3QgYm9keSBiYXNlZCBvbiB0aGUgbWVzc2FnZXMgYW5kIGRhdGEgaW4gdGhlIGNoYXQuXG4gICAqXG4gICAqIEBwYXJhbSBpZCBUaGUgaWQgb2YgdGhlIGNoYXQuXG4gICAqIEBwYXJhbSBtZXNzYWdlcyBUaGUgY3VycmVudCBtZXNzYWdlcyBpbiB0aGUgY2hhdC5cbiAgICogQHBhcmFtIHJlcXVlc3RCb2R5IFRoZSByZXF1ZXN0IGJvZHkgb2JqZWN0IHBhc3NlZCBpbiB0aGUgY2hhdCByZXF1ZXN0LlxuICAgKi9cbiAgcHJlcGFyZVJlY29ubmVjdFRvU3RyZWFtUmVxdWVzdD86IFByZXBhcmVSZWNvbm5lY3RUb1N0cmVhbVJlcXVlc3Q7XG59O1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgSHR0cENoYXRUcmFuc3BvcnQ8VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT5cbiAgaW1wbGVtZW50cyBDaGF0VHJhbnNwb3J0PFVJX01FU1NBR0U+XG57XG4gIHByb3RlY3RlZCBhcGk6IHN0cmluZztcbiAgcHJvdGVjdGVkIGNyZWRlbnRpYWxzOiBIdHRwQ2hhdFRyYW5zcG9ydEluaXRPcHRpb25zPFVJX01FU1NBR0U+WydjcmVkZW50aWFscyddO1xuICBwcm90ZWN0ZWQgaGVhZGVyczogSHR0cENoYXRUcmFuc3BvcnRJbml0T3B0aW9uczxVSV9NRVNTQUdFPlsnaGVhZGVycyddO1xuICBwcm90ZWN0ZWQgYm9keTogSHR0cENoYXRUcmFuc3BvcnRJbml0T3B0aW9uczxVSV9NRVNTQUdFPlsnYm9keSddO1xuICBwcm90ZWN0ZWQgZmV0Y2g/OiBGZXRjaEZ1bmN0aW9uO1xuICBwcm90ZWN0ZWQgcHJlcGFyZVNlbmRNZXNzYWdlc1JlcXVlc3Q/OiBQcmVwYXJlU2VuZE1lc3NhZ2VzUmVxdWVzdDxVSV9NRVNTQUdFPjtcbiAgcHJvdGVjdGVkIHByZXBhcmVSZWNvbm5lY3RUb1N0cmVhbVJlcXVlc3Q/OiBQcmVwYXJlUmVjb25uZWN0VG9TdHJlYW1SZXF1ZXN0O1xuXG4gIGNvbnN0cnVjdG9yKHtcbiAgICBhcGkgPSAnL2FwaS9jaGF0JyxcbiAgICBjcmVkZW50aWFscyxcbiAgICBoZWFkZXJzLFxuICAgIGJvZHksXG4gICAgZmV0Y2gsXG4gICAgcHJlcGFyZVNlbmRNZXNzYWdlc1JlcXVlc3QsXG4gICAgcHJlcGFyZVJlY29ubmVjdFRvU3RyZWFtUmVxdWVzdCxcbiAgfTogSHR0cENoYXRUcmFuc3BvcnRJbml0T3B0aW9uczxVSV9NRVNTQUdFPikge1xuICAgIHRoaXMuYXBpID0gYXBpO1xuICAgIHRoaXMuY3JlZGVudGlhbHMgPSBjcmVkZW50aWFscztcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIHRoaXMuYm9keSA9IGJvZHk7XG4gICAgdGhpcy5mZXRjaCA9IGZldGNoO1xuICAgIHRoaXMucHJlcGFyZVNlbmRNZXNzYWdlc1JlcXVlc3QgPSBwcmVwYXJlU2VuZE1lc3NhZ2VzUmVxdWVzdDtcbiAgICB0aGlzLnByZXBhcmVSZWNvbm5lY3RUb1N0cmVhbVJlcXVlc3QgPSBwcmVwYXJlUmVjb25uZWN0VG9TdHJlYW1SZXF1ZXN0O1xuICB9XG5cbiAgYXN5bmMgc2VuZE1lc3NhZ2VzKHtcbiAgICBhYm9ydFNpZ25hbCxcbiAgICAuLi5vcHRpb25zXG4gIH06IFBhcmFtZXRlcnM8Q2hhdFRyYW5zcG9ydDxVSV9NRVNTQUdFPlsnc2VuZE1lc3NhZ2VzJ10+WzBdKSB7XG4gICAgY29uc3QgcmVzb2x2ZWRCb2R5ID0gYXdhaXQgcmVzb2x2ZSh0aGlzLmJvZHkpO1xuICAgIGNvbnN0IHJlc29sdmVkSGVhZGVycyA9IGF3YWl0IHJlc29sdmUodGhpcy5oZWFkZXJzKTtcbiAgICBjb25zdCByZXNvbHZlZENyZWRlbnRpYWxzID0gYXdhaXQgcmVzb2x2ZSh0aGlzLmNyZWRlbnRpYWxzKTtcblxuICAgIGNvbnN0IHByZXBhcmVkUmVxdWVzdCA9IGF3YWl0IHRoaXMucHJlcGFyZVNlbmRNZXNzYWdlc1JlcXVlc3Q/Lih7XG4gICAgICBhcGk6IHRoaXMuYXBpLFxuICAgICAgaWQ6IG9wdGlvbnMuY2hhdElkLFxuICAgICAgbWVzc2FnZXM6IG9wdGlvbnMubWVzc2FnZXMsXG4gICAgICBib2R5OiB7IC4uLnJlc29sdmVkQm9keSwgLi4ub3B0aW9ucy5ib2R5IH0sXG4gICAgICBoZWFkZXJzOiB7IC4uLnJlc29sdmVkSGVhZGVycywgLi4ub3B0aW9ucy5oZWFkZXJzIH0sXG4gICAgICBjcmVkZW50aWFsczogcmVzb2x2ZWRDcmVkZW50aWFscyxcbiAgICAgIHJlcXVlc3RNZXRhZGF0YTogb3B0aW9ucy5tZXRhZGF0YSxcbiAgICAgIHRyaWdnZXI6IG9wdGlvbnMudHJpZ2dlcixcbiAgICAgIG1lc3NhZ2VJZDogb3B0aW9ucy5tZXNzYWdlSWQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBhcGkgPSBwcmVwYXJlZFJlcXVlc3Q/LmFwaSA/PyB0aGlzLmFwaTtcbiAgICBjb25zdCBoZWFkZXJzID1cbiAgICAgIHByZXBhcmVkUmVxdWVzdD8uaGVhZGVycyAhPT0gdW5kZWZpbmVkXG4gICAgICAgID8gcHJlcGFyZWRSZXF1ZXN0LmhlYWRlcnNcbiAgICAgICAgOiB7IC4uLnJlc29sdmVkSGVhZGVycywgLi4ub3B0aW9ucy5oZWFkZXJzIH07XG4gICAgY29uc3QgYm9keSA9XG4gICAgICBwcmVwYXJlZFJlcXVlc3Q/LmJvZHkgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IHByZXBhcmVkUmVxdWVzdC5ib2R5XG4gICAgICAgIDoge1xuICAgICAgICAgICAgLi4ucmVzb2x2ZWRCb2R5LFxuICAgICAgICAgICAgLi4ub3B0aW9ucy5ib2R5LFxuICAgICAgICAgICAgaWQ6IG9wdGlvbnMuY2hhdElkLFxuICAgICAgICAgICAgbWVzc2FnZXM6IG9wdGlvbnMubWVzc2FnZXMsXG4gICAgICAgICAgICB0cmlnZ2VyOiBvcHRpb25zLnRyaWdnZXIsXG4gICAgICAgICAgICBtZXNzYWdlSWQ6IG9wdGlvbnMubWVzc2FnZUlkLFxuICAgICAgICAgIH07XG4gICAgY29uc3QgY3JlZGVudGlhbHMgPSBwcmVwYXJlZFJlcXVlc3Q/LmNyZWRlbnRpYWxzID8/IHJlc29sdmVkQ3JlZGVudGlhbHM7XG5cbiAgICAvLyBhdm9pZCBjYWNoaW5nIGdsb2JhbFRoaXMuZmV0Y2ggaW4gY2FzZSBpdCBpcyBwYXRjaGVkIGJ5IG90aGVyIGxpYnJhcmllc1xuICAgIGNvbnN0IGZldGNoID0gdGhpcy5mZXRjaCA/PyBnbG9iYWxUaGlzLmZldGNoO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChhcGksIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAuLi5oZWFkZXJzLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgY3JlZGVudGlhbHMsXG4gICAgICBzaWduYWw6IGFib3J0U2lnbmFsLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAoYXdhaXQgcmVzcG9uc2UudGV4dCgpKSA/PyAnRmFpbGVkIHRvIGZldGNoIHRoZSBjaGF0IHJlc3BvbnNlLicsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgcmVzcG9uc2UgYm9keSBpcyBlbXB0eS4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzUmVzcG9uc2VTdHJlYW0ocmVzcG9uc2UuYm9keSk7XG4gIH1cblxuICBhc3luYyByZWNvbm5lY3RUb1N0cmVhbShcbiAgICBvcHRpb25zOiBQYXJhbWV0ZXJzPENoYXRUcmFuc3BvcnQ8VUlfTUVTU0FHRT5bJ3JlY29ubmVjdFRvU3RyZWFtJ10+WzBdLFxuICApOiBQcm9taXNlPFJlYWRhYmxlU3RyZWFtPFVJTWVzc2FnZUNodW5rPiB8IG51bGw+IHtcbiAgICBjb25zdCByZXNvbHZlZEJvZHkgPSBhd2FpdCByZXNvbHZlKHRoaXMuYm9keSk7XG4gICAgY29uc3QgcmVzb2x2ZWRIZWFkZXJzID0gYXdhaXQgcmVzb2x2ZSh0aGlzLmhlYWRlcnMpO1xuICAgIGNvbnN0IHJlc29sdmVkQ3JlZGVudGlhbHMgPSBhd2FpdCByZXNvbHZlKHRoaXMuY3JlZGVudGlhbHMpO1xuXG4gICAgY29uc3QgcHJlcGFyZWRSZXF1ZXN0ID0gYXdhaXQgdGhpcy5wcmVwYXJlUmVjb25uZWN0VG9TdHJlYW1SZXF1ZXN0Py4oe1xuICAgICAgYXBpOiB0aGlzLmFwaSxcbiAgICAgIGlkOiBvcHRpb25zLmNoYXRJZCxcbiAgICAgIGJvZHk6IHsgLi4ucmVzb2x2ZWRCb2R5LCAuLi5vcHRpb25zLmJvZHkgfSxcbiAgICAgIGhlYWRlcnM6IHsgLi4ucmVzb2x2ZWRIZWFkZXJzLCAuLi5vcHRpb25zLmhlYWRlcnMgfSxcbiAgICAgIGNyZWRlbnRpYWxzOiByZXNvbHZlZENyZWRlbnRpYWxzLFxuICAgICAgcmVxdWVzdE1ldGFkYXRhOiBvcHRpb25zLm1ldGFkYXRhLFxuICAgIH0pO1xuXG4gICAgY29uc3QgYXBpID0gcHJlcGFyZWRSZXF1ZXN0Py5hcGkgPz8gYCR7dGhpcy5hcGl9LyR7b3B0aW9ucy5jaGF0SWR9L3N0cmVhbWA7XG4gICAgY29uc3QgaGVhZGVycyA9XG4gICAgICBwcmVwYXJlZFJlcXVlc3Q/LmhlYWRlcnMgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IHByZXBhcmVkUmVxdWVzdC5oZWFkZXJzXG4gICAgICAgIDogeyAuLi5yZXNvbHZlZEhlYWRlcnMsIC4uLm9wdGlvbnMuaGVhZGVycyB9O1xuICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gcHJlcGFyZWRSZXF1ZXN0Py5jcmVkZW50aWFscyA/PyByZXNvbHZlZENyZWRlbnRpYWxzO1xuXG4gICAgLy8gYXZvaWQgY2FjaGluZyBnbG9iYWxUaGlzLmZldGNoIGluIGNhc2UgaXQgaXMgcGF0Y2hlZCBieSBvdGhlciBsaWJyYXJpZXNcbiAgICBjb25zdCBmZXRjaCA9IHRoaXMuZmV0Y2ggPz8gZ2xvYmFsVGhpcy5mZXRjaDtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYXBpLCB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgaGVhZGVycyxcbiAgICAgIGNyZWRlbnRpYWxzLFxuICAgIH0pO1xuXG4gICAgLy8gbm8gYWN0aXZlIHN0cmVhbSBmb3VuZCwgc28gd2UgZG8gbm90IHJlc3VtZVxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwNCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAoYXdhaXQgcmVzcG9uc2UudGV4dCgpKSA/PyAnRmFpbGVkIHRvIGZldGNoIHRoZSBjaGF0IHJlc3BvbnNlLicsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghcmVzcG9uc2UuYm9keSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgcmVzcG9uc2UgYm9keSBpcyBlbXB0eS4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9jZXNzUmVzcG9uc2VTdHJlYW0ocmVzcG9uc2UuYm9keSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgcHJvY2Vzc1Jlc3BvbnNlU3RyZWFtKFxuICAgIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VWludDhBcnJheTxBcnJheUJ1ZmZlckxpa2U+PixcbiAgKTogUmVhZGFibGVTdHJlYW08VUlNZXNzYWdlQ2h1bms+O1xufVxuIiwgImltcG9ydCB7XG4gIEFzc2lzdGFudENvbnRlbnQsXG4gIE1vZGVsTWVzc2FnZSxcbiAgVG9vbFJlc3VsdFBhcnQsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgVG9vbFNldCB9IGZyb20gJy4uL2dlbmVyYXRlLXRleHQvdG9vbC1zZXQnO1xuaW1wb3J0IHsgY3JlYXRlVG9vbE1vZGVsT3V0cHV0IH0gZnJvbSAnLi4vcHJvbXB0L2NyZWF0ZS10b29sLW1vZGVsLW91dHB1dCc7XG5pbXBvcnQgeyBNZXNzYWdlQ29udmVyc2lvbkVycm9yIH0gZnJvbSAnLi4vcHJvbXB0L21lc3NhZ2UtY29udmVyc2lvbi1lcnJvcic7XG5pbXBvcnQge1xuICBEeW5hbWljVG9vbFVJUGFydCxcbiAgRmlsZVVJUGFydCxcbiAgZ2V0VG9vbE5hbWUsXG4gIGlzVG9vbFVJUGFydCxcbiAgUmVhc29uaW5nVUlQYXJ0LFxuICBUZXh0VUlQYXJ0LFxuICBUb29sVUlQYXJ0LFxuICBVSU1lc3NhZ2UsXG4gIFVJVG9vbHMsXG59IGZyb20gJy4vdWktbWVzc2FnZXMnO1xuXG4vKipcbkNvbnZlcnRzIGFuIGFycmF5IG9mIG1lc3NhZ2VzIGZyb20gdXNlQ2hhdCBpbnRvIGFuIGFycmF5IG9mIENvcmVNZXNzYWdlcyB0aGF0IGNhbiBiZSB1c2VkXG53aXRoIHRoZSBBSSBjb3JlIGZ1bmN0aW9ucyAoZS5nLiBgc3RyZWFtVGV4dGApLlxuXG5AcGFyYW0gbWVzc2FnZXMgLSBUaGUgbWVzc2FnZXMgdG8gY29udmVydC5cbkBwYXJhbSBvcHRpb25zLnRvb2xzIC0gVGhlIHRvb2xzIHRvIHVzZS5cbkBwYXJhbSBvcHRpb25zLmlnbm9yZUluY29tcGxldGVUb29sQ2FsbHMgLSBXaGV0aGVyIHRvIGlnbm9yZSBpbmNvbXBsZXRlIHRvb2wgY2FsbHMuIERlZmF1bHQgaXMgYGZhbHNlYC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRUb01vZGVsTWVzc2FnZXMoXG4gIG1lc3NhZ2VzOiBBcnJheTxPbWl0PFVJTWVzc2FnZSwgJ2lkJz4+LFxuICBvcHRpb25zPzoge1xuICAgIHRvb2xzPzogVG9vbFNldDtcbiAgICBpZ25vcmVJbmNvbXBsZXRlVG9vbENhbGxzPzogYm9vbGVhbjtcbiAgfSxcbik6IE1vZGVsTWVzc2FnZVtdIHtcbiAgY29uc3QgbW9kZWxNZXNzYWdlczogTW9kZWxNZXNzYWdlW10gPSBbXTtcblxuICBpZiAob3B0aW9ucz8uaWdub3JlSW5jb21wbGV0ZVRvb2xDYWxscykge1xuICAgIG1lc3NhZ2VzID0gbWVzc2FnZXMubWFwKG1lc3NhZ2UgPT4gKHtcbiAgICAgIC4uLm1lc3NhZ2UsXG4gICAgICBwYXJ0czogbWVzc2FnZS5wYXJ0cy5maWx0ZXIoXG4gICAgICAgIHBhcnQgPT5cbiAgICAgICAgICAhaXNUb29sVUlQYXJ0KHBhcnQpIHx8XG4gICAgICAgICAgKHBhcnQuc3RhdGUgIT09ICdpbnB1dC1zdHJlYW1pbmcnICYmXG4gICAgICAgICAgICBwYXJ0LnN0YXRlICE9PSAnaW5wdXQtYXZhaWxhYmxlJyksXG4gICAgICApLFxuICAgIH0pKTtcbiAgfVxuXG4gIGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuICAgIHN3aXRjaCAobWVzc2FnZS5yb2xlKSB7XG4gICAgICBjYXNlICdzeXN0ZW0nOiB7XG4gICAgICAgIGNvbnN0IHRleHRQYXJ0cyA9IG1lc3NhZ2UucGFydHMuZmlsdGVyKHBhcnQgPT4gcGFydC50eXBlID09PSAndGV4dCcpO1xuXG4gICAgICAgIGNvbnN0IHByb3ZpZGVyTWV0YWRhdGEgPSB0ZXh0UGFydHMucmVkdWNlKChhY2MsIHBhcnQpID0+IHtcbiAgICAgICAgICBpZiAocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgLi4ucGFydC5wcm92aWRlck1ldGFkYXRhIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIHt9KTtcblxuICAgICAgICBtb2RlbE1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgIGNvbnRlbnQ6IHRleHRQYXJ0cy5tYXAocGFydCA9PiBwYXJ0LnRleHQpLmpvaW4oJycpLFxuICAgICAgICAgIC4uLihPYmplY3Qua2V5cyhwcm92aWRlck1ldGFkYXRhKS5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IHsgcHJvdmlkZXJPcHRpb25zOiBwcm92aWRlck1ldGFkYXRhIH1cbiAgICAgICAgICAgIDoge30pLFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ3VzZXInOiB7XG4gICAgICAgIG1vZGVsTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UucGFydHNcbiAgICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAgIChwYXJ0KTogcGFydCBpcyBUZXh0VUlQYXJ0IHwgRmlsZVVJUGFydCA9PlxuICAgICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3RleHQnIHx8IHBhcnQudHlwZSA9PT0gJ2ZpbGUnLFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLm1hcChwYXJ0ID0+IHtcbiAgICAgICAgICAgICAgc3dpdGNoIChwYXJ0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0ZXh0JzpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogcGFydC50ZXh0LFxuICAgICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjYXNlICdmaWxlJzpcbiAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmaWxlJyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgICAgICAgbWVkaWFUeXBlOiBwYXJ0Lm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHBhcnQuZmlsZW5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHBhcnQudXJsLFxuICAgICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICA/IHsgcHJvdmlkZXJPcHRpb25zOiBwYXJ0LnByb3ZpZGVyTWV0YWRhdGEgfVxuICAgICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcblxuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY2FzZSAnYXNzaXN0YW50Jzoge1xuICAgICAgICBpZiAobWVzc2FnZS5wYXJ0cyAhPSBudWxsKSB7XG4gICAgICAgICAgbGV0IGJsb2NrOiBBcnJheTxcbiAgICAgICAgICAgIHwgVGV4dFVJUGFydFxuICAgICAgICAgICAgfCBUb29sVUlQYXJ0PFVJVG9vbHM+XG4gICAgICAgICAgICB8IFJlYXNvbmluZ1VJUGFydFxuICAgICAgICAgICAgfCBGaWxlVUlQYXJ0XG4gICAgICAgICAgICB8IER5bmFtaWNUb29sVUlQYXJ0XG4gICAgICAgICAgPiA9IFtdO1xuXG4gICAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc0Jsb2NrKCkge1xuICAgICAgICAgICAgaWYgKGJsb2NrLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQ6IEFzc2lzdGFudENvbnRlbnQgPSBbXTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGJsb2NrKSB7XG4gICAgICAgICAgICAgIGlmIChwYXJ0LnR5cGUgPT09ICd0ZXh0Jykge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcgYXMgY29uc3QsXG4gICAgICAgICAgICAgICAgICB0ZXh0OiBwYXJ0LnRleHQsXG4gICAgICAgICAgICAgICAgICAuLi4ocGFydC5wcm92aWRlck1ldGFkYXRhICE9IG51bGxcbiAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyT3B0aW9uczogcGFydC5wcm92aWRlck1ldGFkYXRhIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydC50eXBlID09PSAnZmlsZScpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ2ZpbGUnIGFzIGNvbnN0LFxuICAgICAgICAgICAgICAgICAgbWVkaWFUeXBlOiBwYXJ0Lm1lZGlhVHlwZSxcbiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBwYXJ0LmZpbGVuYW1lLFxuICAgICAgICAgICAgICAgICAgZGF0YTogcGFydC51cmwsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydC50eXBlID09PSAncmVhc29uaW5nJykge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgICAgICAgICAgICB0eXBlOiAncmVhc29uaW5nJyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgICAgIHRleHQ6IHBhcnQudGV4dCxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyT3B0aW9uczogcGFydC5wcm92aWRlck1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnQudHlwZSA9PT0gJ2R5bmFtaWMtdG9vbCcpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0b29sTmFtZSA9IHBhcnQudG9vbE5hbWU7XG5cbiAgICAgICAgICAgICAgICBpZiAocGFydC5zdGF0ZSA9PT0gJ2lucHV0LXN0cmVhbWluZycpIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXNzYWdlQ29udmVyc2lvbkVycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxNZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBgaW5jb21wbGV0ZSB0b29sIGlucHV0IGlzIG5vdCBzdXBwb3J0ZWQ6ICR7cGFydC50b29sQ2FsbElkfWAsXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtY2FsbCcgYXMgY29uc3QsXG4gICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHBhcnQudG9vbENhbGxJZCxcbiAgICAgICAgICAgICAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBwYXJ0LmlucHV0LFxuICAgICAgICAgICAgICAgICAgICAuLi4ocGFydC5jYWxsUHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyT3B0aW9uczogcGFydC5jYWxsUHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNUb29sVUlQYXJ0KHBhcnQpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9vbE5hbWUgPSBnZXRUb29sTmFtZShwYXJ0KTtcblxuICAgICAgICAgICAgICAgIGlmIChwYXJ0LnN0YXRlID09PSAnaW5wdXQtc3RyZWFtaW5nJykge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VDb252ZXJzaW9uRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbE1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBpbmNvbXBsZXRlIHRvb2wgaW5wdXQgaXMgbm90IHN1cHBvcnRlZDogJHtwYXJ0LnRvb2xDYWxsSWR9YCxcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndG9vbC1jYWxsJyBhcyBjb25zdCxcbiAgICAgICAgICAgICAgICAgICAgdG9vbENhbGxJZDogcGFydC50b29sQ2FsbElkLFxuICAgICAgICAgICAgICAgICAgICB0b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6XG4gICAgICAgICAgICAgICAgICAgICAgcGFydC5zdGF0ZSA9PT0gJ291dHB1dC1lcnJvcidcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKHBhcnQuaW5wdXQgPz8gcGFydC5yYXdJbnB1dClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogcGFydC5pbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJFeGVjdXRlZDogcGFydC5wcm92aWRlckV4ZWN1dGVkLFxuICAgICAgICAgICAgICAgICAgICAuLi4ocGFydC5jYWxsUHJvdmlkZXJNZXRhZGF0YSAhPSBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgPyB7IHByb3ZpZGVyT3B0aW9uczogcGFydC5jYWxsUHJvdmlkZXJNZXRhZGF0YSB9XG4gICAgICAgICAgICAgICAgICAgICAgOiB7fSksXG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJ0LnByb3ZpZGVyRXhlY3V0ZWQgPT09IHRydWUgJiZcbiAgICAgICAgICAgICAgICAgICAgKHBhcnQuc3RhdGUgPT09ICdvdXRwdXQtYXZhaWxhYmxlJyB8fFxuICAgICAgICAgICAgICAgICAgICAgIHBhcnQuc3RhdGUgPT09ICdvdXRwdXQtZXJyb3InKVxuICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgICB0b29sQ2FsbElkOiBwYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgdG9vbE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiBjcmVhdGVUb29sTW9kZWxPdXRwdXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LnN0YXRlID09PSAnb3V0cHV0LWVycm9yJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcGFydC5lcnJvclRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHBhcnQub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbDogb3B0aW9ucz8udG9vbHM/Llt0b29sTmFtZV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1vZGU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnQuc3RhdGUgPT09ICdvdXRwdXQtZXJyb3InID8gJ2pzb24nIDogJ25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgX2V4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBwYXJ0O1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgcGFydDogJHtfZXhoYXVzdGl2ZUNoZWNrfWApO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vZGVsTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlIGFyZSB0b29sIGludm9jYXRpb25zIHdpdGggcmVzdWx0cyBpbiB0aGUgYmxvY2tcbiAgICAgICAgICAgIGNvbnN0IHRvb2xQYXJ0cyA9IGJsb2NrLmZpbHRlcihcbiAgICAgICAgICAgICAgcGFydCA9PlxuICAgICAgICAgICAgICAgIChpc1Rvb2xVSVBhcnQocGFydCkgJiYgcGFydC5wcm92aWRlckV4ZWN1dGVkICE9PSB0cnVlKSB8fFxuICAgICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ2R5bmFtaWMtdG9vbCcsXG4gICAgICAgICAgICApIGFzIChUb29sVUlQYXJ0PFVJVG9vbHM+IHwgRHluYW1pY1Rvb2xVSVBhcnQpW107XG5cbiAgICAgICAgICAgIC8vIHRvb2wgbWVzc2FnZSB3aXRoIHRvb2wgcmVzdWx0c1xuICAgICAgICAgICAgaWYgKHRvb2xQYXJ0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIG1vZGVsTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgcm9sZTogJ3Rvb2wnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRvb2xQYXJ0cy5tYXAoKHRvb2xQYXJ0KTogVG9vbFJlc3VsdFBhcnQgPT4ge1xuICAgICAgICAgICAgICAgICAgc3dpdGNoICh0b29sUGFydC5zdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdvdXRwdXQtZXJyb3InOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdvdXRwdXQtYXZhaWxhYmxlJzoge1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvb2xOYW1lID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xQYXJ0LnR5cGUgPT09ICdkeW5hbWljLXRvb2wnXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gdG9vbFBhcnQudG9vbE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgOiBnZXRUb29sTmFtZSh0b29sUGFydCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Rvb2wtcmVzdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xDYWxsSWQ6IHRvb2xQYXJ0LnRvb2xDYWxsSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogY3JlYXRlVG9vbE1vZGVsT3V0cHV0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xQYXJ0LnN0YXRlID09PSAnb3V0cHV0LWVycm9yJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0b29sUGFydC5lcnJvclRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdG9vbFBhcnQub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sOiBvcHRpb25zPy50b29scz8uW3Rvb2xOYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNb2RlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xQYXJ0LnN0YXRlID09PSAnb3V0cHV0LWVycm9yJyA/ICd0ZXh0JyA6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VDb252ZXJzaW9uRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxNZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYFVuc3VwcG9ydGVkIHRvb2wgcGFydCBzdGF0ZTogJHt0b29sUGFydC5zdGF0ZX1gLFxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB1cGRhdGVzIGZvciBuZXh0IGJsb2NrXG4gICAgICAgICAgICBibG9jayA9IFtdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBtZXNzYWdlLnBhcnRzKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3RleHQnIHx8XG4gICAgICAgICAgICAgIHBhcnQudHlwZSA9PT0gJ3JlYXNvbmluZycgfHxcbiAgICAgICAgICAgICAgcGFydC50eXBlID09PSAnZmlsZScgfHxcbiAgICAgICAgICAgICAgcGFydC50eXBlID09PSAnZHluYW1pYy10b29sJyB8fFxuICAgICAgICAgICAgICBpc1Rvb2xVSVBhcnQocGFydClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICBibG9jay5wdXNoKHBhcnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0LnR5cGUgPT09ICdzdGVwLXN0YXJ0Jykge1xuICAgICAgICAgICAgICBwcm9jZXNzQmxvY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwcm9jZXNzQmxvY2soKTtcblxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgY29uc3QgX2V4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBtZXNzYWdlLnJvbGU7XG4gICAgICAgIHRocm93IG5ldyBNZXNzYWdlQ29udmVyc2lvbkVycm9yKHtcbiAgICAgICAgICBvcmlnaW5hbE1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgbWVzc2FnZTogYFVuc3VwcG9ydGVkIHJvbGU6ICR7X2V4aGF1c3RpdmVDaGVja31gLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbW9kZWxNZXNzYWdlcztcbn1cblxuLyoqXG5AZGVwcmVjYXRlZCBVc2UgYGNvbnZlcnRUb01vZGVsTWVzc2FnZXNgIGluc3RlYWQuXG4gKi9cbi8vIFRPRE8gcmVtb3ZlIGluIEFJIFNESyA2XG5leHBvcnQgY29uc3QgY29udmVydFRvQ29yZU1lc3NhZ2VzID0gY29udmVydFRvTW9kZWxNZXNzYWdlcztcbiIsICJpbXBvcnQgeyBpc1Rvb2xVSVBhcnQsIFVJTWVzc2FnZSB9IGZyb20gJy4vdWktbWVzc2FnZXMnO1xuXG4vKipcbkNoZWNrIGlmIHRoZSBtZXNzYWdlIGlzIGFuIGFzc2lzdGFudCBtZXNzYWdlIHdpdGggY29tcGxldGVkIHRvb2wgY2FsbHMuXG5UaGUgbGFzdCBzdGVwIG9mIHRoZSBtZXNzYWdlIG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgdG9vbCBpbnZvY2F0aW9uIGFuZFxuYWxsIHRvb2wgaW52b2NhdGlvbnMgbXVzdCBoYXZlIGEgcmVzdWx0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gbGFzdEFzc2lzdGFudE1lc3NhZ2VJc0NvbXBsZXRlV2l0aFRvb2xDYWxscyh7XG4gIG1lc3NhZ2VzLFxufToge1xuICBtZXNzYWdlczogVUlNZXNzYWdlW107XG59KTogYm9vbGVhbiB7XG4gIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1ttZXNzYWdlcy5sZW5ndGggLSAxXTtcblxuICBpZiAoIW1lc3NhZ2UpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAobWVzc2FnZS5yb2xlICE9PSAnYXNzaXN0YW50Jykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGxhc3RTdGVwU3RhcnRJbmRleCA9IG1lc3NhZ2UucGFydHMucmVkdWNlKChsYXN0SW5kZXgsIHBhcnQsIGluZGV4KSA9PiB7XG4gICAgcmV0dXJuIHBhcnQudHlwZSA9PT0gJ3N0ZXAtc3RhcnQnID8gaW5kZXggOiBsYXN0SW5kZXg7XG4gIH0sIC0xKTtcblxuICBjb25zdCBsYXN0U3RlcFRvb2xJbnZvY2F0aW9ucyA9IG1lc3NhZ2UucGFydHNcbiAgICAuc2xpY2UobGFzdFN0ZXBTdGFydEluZGV4ICsgMSlcbiAgICAuZmlsdGVyKHBhcnQgPT4gaXNUb29sVUlQYXJ0KHBhcnQpIHx8IHBhcnQudHlwZSA9PT0gJ2R5bmFtaWMtdG9vbCcpO1xuXG4gIHJldHVybiAoXG4gICAgbGFzdFN0ZXBUb29sSW52b2NhdGlvbnMubGVuZ3RoID4gMCAmJlxuICAgIGxhc3RTdGVwVG9vbEludm9jYXRpb25zLmV2ZXJ5KHBhcnQgPT4gcGFydC5zdGF0ZSA9PT0gJ291dHB1dC1hdmFpbGFibGUnKVxuICApO1xufVxuIiwgImltcG9ydCB7IFVJTWVzc2FnZUNodW5rIH0gZnJvbSAnLi4vdWktbWVzc2FnZS1zdHJlYW0vdWktbWVzc2FnZS1jaHVua3MnO1xuXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNmb3JtVGV4dFRvVWlNZXNzYWdlU3RyZWFtKHtcbiAgc3RyZWFtLFxufToge1xuICBzdHJlYW06IFJlYWRhYmxlU3RyZWFtPHN0cmluZz47XG59KSB7XG4gIHJldHVybiBzdHJlYW0ucGlwZVRocm91Z2goXG4gICAgbmV3IFRyYW5zZm9ybVN0cmVhbTxzdHJpbmcsIFVJTWVzc2FnZUNodW5rPih7XG4gICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICdzdGFydCcgfSk7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICdzdGFydC1zdGVwJyB9KTtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ3RleHQtc3RhcnQnLCBpZDogJ3RleHQtMScgfSk7XG4gICAgICB9LFxuXG4gICAgICBhc3luYyB0cmFuc2Zvcm0ocGFydCwgY29udHJvbGxlcikge1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoeyB0eXBlOiAndGV4dC1kZWx0YScsIGlkOiAndGV4dC0xJywgZGVsdGE6IHBhcnQgfSk7XG4gICAgICB9LFxuXG4gICAgICBhc3luYyBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh7IHR5cGU6ICd0ZXh0LWVuZCcsIGlkOiAndGV4dC0xJyB9KTtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ2ZpbmlzaC1zdGVwJyB9KTtcbiAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogJ2ZpbmlzaCcgfSk7XG4gICAgICB9LFxuICAgIH0pLFxuICApO1xufVxuIiwgImltcG9ydCB7IFVJTWVzc2FnZUNodW5rIH0gZnJvbSAnLi4vdWktbWVzc2FnZS1zdHJlYW0vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHtcbiAgSHR0cENoYXRUcmFuc3BvcnQsXG4gIEh0dHBDaGF0VHJhbnNwb3J0SW5pdE9wdGlvbnMsXG59IGZyb20gJy4vaHR0cC1jaGF0LXRyYW5zcG9ydCc7XG5pbXBvcnQgeyB0cmFuc2Zvcm1UZXh0VG9VaU1lc3NhZ2VTdHJlYW0gfSBmcm9tICcuL3RyYW5zZm9ybS10ZXh0LXRvLXVpLW1lc3NhZ2Utc3RyZWFtJztcbmltcG9ydCB7IFVJTWVzc2FnZSB9IGZyb20gJy4vdWktbWVzc2FnZXMnO1xuXG5leHBvcnQgY2xhc3MgVGV4dFN0cmVhbUNoYXRUcmFuc3BvcnQ8XG4gIFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2UsXG4+IGV4dGVuZHMgSHR0cENoYXRUcmFuc3BvcnQ8VUlfTUVTU0FHRT4ge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBIdHRwQ2hhdFRyYW5zcG9ydEluaXRPcHRpb25zPFVJX01FU1NBR0U+ID0ge30pIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwcm9jZXNzUmVzcG9uc2VTdHJlYW0oXG4gICAgc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5PEFycmF5QnVmZmVyTGlrZT4+LFxuICApOiBSZWFkYWJsZVN0cmVhbTxVSU1lc3NhZ2VDaHVuaz4ge1xuICAgIHJldHVybiB0cmFuc2Zvcm1UZXh0VG9VaU1lc3NhZ2VTdHJlYW0oe1xuICAgICAgc3RyZWFtOiBzdHJlYW0ucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKCkpLFxuICAgIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgVHlwZVZhbGlkYXRpb25FcnJvciB9IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXInO1xuaW1wb3J0IHtcbiAgU3RhbmRhcmRTY2hlbWFWMSxcbiAgVG9vbCxcbiAgdmFsaWRhdGVUeXBlcyxcbiAgVmFsaWRhdG9yLFxufSBmcm9tICdAYWktc2RrL3Byb3ZpZGVyLXV0aWxzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgcHJvdmlkZXJNZXRhZGF0YVNjaGVtYSB9IGZyb20gJy4uL3R5cGVzL3Byb3ZpZGVyLW1ldGFkYXRhJztcbmltcG9ydCB7XG4gIERhdGFVSVBhcnQsXG4gIEluZmVyVUlNZXNzYWdlRGF0YSxcbiAgSW5mZXJVSU1lc3NhZ2VUb29scyxcbiAgVG9vbFVJUGFydCxcbiAgVUlNZXNzYWdlLFxufSBmcm9tICcuL3VpLW1lc3NhZ2VzJztcblxuY29uc3QgdGV4dFVJUGFydFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKCd0ZXh0JyksXG4gIHRleHQ6IHouc3RyaW5nKCksXG4gIHN0YXRlOiB6LmVudW0oWydzdHJlYW1pbmcnLCAnZG9uZSddKS5vcHRpb25hbCgpLFxuICBwcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG59KTtcblxuY29uc3QgcmVhc29uaW5nVUlQYXJ0U2NoZW1hID0gei5vYmplY3Qoe1xuICB0eXBlOiB6LmxpdGVyYWwoJ3JlYXNvbmluZycpLFxuICB0ZXh0OiB6LnN0cmluZygpLFxuICBzdGF0ZTogei5lbnVtKFsnc3RyZWFtaW5nJywgJ2RvbmUnXSkub3B0aW9uYWwoKSxcbiAgcHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxufSk7XG5cbmNvbnN0IHNvdXJjZVVybFVJUGFydFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKCdzb3VyY2UtdXJsJyksXG4gIHNvdXJjZUlkOiB6LnN0cmluZygpLFxuICB1cmw6IHouc3RyaW5nKCksXG4gIHRpdGxlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG5jb25zdCBzb3VyY2VEb2N1bWVudFVJUGFydFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5saXRlcmFsKCdzb3VyY2UtZG9jdW1lbnQnKSxcbiAgc291cmNlSWQ6IHouc3RyaW5nKCksXG4gIG1lZGlhVHlwZTogei5zdHJpbmcoKSxcbiAgdGl0bGU6IHouc3RyaW5nKCksXG4gIGZpbGVuYW1lOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG5jb25zdCBmaWxlVUlQYXJ0U2NoZW1hID0gei5vYmplY3Qoe1xuICB0eXBlOiB6LmxpdGVyYWwoJ2ZpbGUnKSxcbiAgbWVkaWFUeXBlOiB6LnN0cmluZygpLFxuICBmaWxlbmFtZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB1cmw6IHouc3RyaW5nKCksXG4gIHByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbn0pO1xuXG5jb25zdCBzdGVwU3RhcnRVSVBhcnRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbCgnc3RlcC1zdGFydCcpLFxufSk7XG5cbmNvbnN0IGRhdGFVSVBhcnRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHouc3RyaW5nKCkuc3RhcnRzV2l0aCgnZGF0YS0nKSxcbiAgaWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZGF0YTogei51bmtub3duKCksXG59KTtcblxuY29uc3QgZHluYW1pY1Rvb2xVSVBhcnRTY2hlbWFzID0gW1xuICB6Lm9iamVjdCh7XG4gICAgdHlwZTogei5saXRlcmFsKCdkeW5hbWljLXRvb2wnKSxcbiAgICB0b29sTmFtZTogei5zdHJpbmcoKSxcbiAgICB0b29sQ2FsbElkOiB6LnN0cmluZygpLFxuICAgIHN0YXRlOiB6LmxpdGVyYWwoJ2lucHV0LXN0cmVhbWluZycpLFxuICAgIGlucHV0OiB6LnVua25vd24oKS5vcHRpb25hbCgpLFxuICAgIG91dHB1dDogei5uZXZlcigpLm9wdGlvbmFsKCksXG4gICAgZXJyb3JUZXh0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHoub2JqZWN0KHtcbiAgICB0eXBlOiB6LmxpdGVyYWwoJ2R5bmFtaWMtdG9vbCcpLFxuICAgIHRvb2xOYW1lOiB6LnN0cmluZygpLFxuICAgIHRvb2xDYWxsSWQ6IHouc3RyaW5nKCksXG4gICAgc3RhdGU6IHoubGl0ZXJhbCgnaW5wdXQtYXZhaWxhYmxlJyksXG4gICAgaW5wdXQ6IHoudW5rbm93bigpLFxuICAgIG91dHB1dDogei5uZXZlcigpLm9wdGlvbmFsKCksXG4gICAgZXJyb3JUZXh0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgICBjYWxsUHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5vYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgnZHluYW1pYy10b29sJyksXG4gICAgdG9vbE5hbWU6IHouc3RyaW5nKCksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBzdGF0ZTogei5saXRlcmFsKCdvdXRwdXQtYXZhaWxhYmxlJyksXG4gICAgaW5wdXQ6IHoudW5rbm93bigpLFxuICAgIG91dHB1dDogei51bmtub3duKCksXG4gICAgZXJyb3JUZXh0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgICBjYWxsUHJvdmlkZXJNZXRhZGF0YTogcHJvdmlkZXJNZXRhZGF0YVNjaGVtYS5vcHRpb25hbCgpLFxuICAgIHByZWxpbWluYXJ5OiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLFxuICB9KSxcbiAgei5vYmplY3Qoe1xuICAgIHR5cGU6IHoubGl0ZXJhbCgnZHluYW1pYy10b29sJyksXG4gICAgdG9vbE5hbWU6IHouc3RyaW5nKCksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBzdGF0ZTogei5saXRlcmFsKCdvdXRwdXQtZXJyb3InKSxcbiAgICBpbnB1dDogei51bmtub3duKCksXG4gICAgb3V0cHV0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgICBlcnJvclRleHQ6IHouc3RyaW5nKCksXG4gICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbiAgfSksXG5dO1xuXG5jb25zdCB0b29sVUlQYXJ0U2NoZW1hcyA9IFtcbiAgei5vYmplY3Qoe1xuICAgIHR5cGU6IHouc3RyaW5nKCkuc3RhcnRzV2l0aCgndG9vbC0nKSxcbiAgICB0b29sQ2FsbElkOiB6LnN0cmluZygpLFxuICAgIHN0YXRlOiB6LmxpdGVyYWwoJ2lucHV0LXN0cmVhbWluZycpLFxuICAgIGlucHV0OiB6LnVua25vd24oKS5vcHRpb25hbCgpLFxuICAgIG91dHB1dDogei5uZXZlcigpLm9wdGlvbmFsKCksXG4gICAgZXJyb3JUZXh0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHoub2JqZWN0KHtcbiAgICB0eXBlOiB6LnN0cmluZygpLnN0YXJ0c1dpdGgoJ3Rvb2wtJyksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBzdGF0ZTogei5saXRlcmFsKCdpbnB1dC1hdmFpbGFibGUnKSxcbiAgICBpbnB1dDogei51bmtub3duKCksXG4gICAgb3V0cHV0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgICBlcnJvclRleHQ6IHoubmV2ZXIoKS5vcHRpb25hbCgpLFxuICAgIGNhbGxQcm92aWRlck1ldGFkYXRhOiBwcm92aWRlck1ldGFkYXRhU2NoZW1hLm9wdGlvbmFsKCksXG4gIH0pLFxuICB6Lm9iamVjdCh7XG4gICAgdHlwZTogei5zdHJpbmcoKS5zdGFydHNXaXRoKCd0b29sLScpLFxuICAgIHRvb2xDYWxsSWQ6IHouc3RyaW5nKCksXG4gICAgc3RhdGU6IHoubGl0ZXJhbCgnb3V0cHV0LWF2YWlsYWJsZScpLFxuICAgIGlucHV0OiB6LnVua25vd24oKSxcbiAgICBvdXRwdXQ6IHoudW5rbm93bigpLFxuICAgIGVycm9yVGV4dDogei5uZXZlcigpLm9wdGlvbmFsKCksXG4gICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbiAgICBwcmVsaW1pbmFyeTogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHoub2JqZWN0KHtcbiAgICB0eXBlOiB6LnN0cmluZygpLnN0YXJ0c1dpdGgoJ3Rvb2wtJyksXG4gICAgdG9vbENhbGxJZDogei5zdHJpbmcoKSxcbiAgICBzdGF0ZTogei5saXRlcmFsKCdvdXRwdXQtZXJyb3InKSxcbiAgICBpbnB1dDogei51bmtub3duKCksXG4gICAgb3V0cHV0OiB6Lm5ldmVyKCkub3B0aW9uYWwoKSxcbiAgICBlcnJvclRleHQ6IHouc3RyaW5nKCksXG4gICAgY2FsbFByb3ZpZGVyTWV0YWRhdGE6IHByb3ZpZGVyTWV0YWRhdGFTY2hlbWEub3B0aW9uYWwoKSxcbiAgfSksXG5dO1xuXG5jb25zdCB1aU1lc3NhZ2VTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLFxuICByb2xlOiB6LmVudW0oWydzeXN0ZW0nLCAndXNlcicsICdhc3Npc3RhbnQnXSksXG4gIG1ldGFkYXRhOiB6LnVua25vd24oKS5vcHRpb25hbCgpLFxuICBwYXJ0czogei5hcnJheShcbiAgICB6LnVuaW9uKFtcbiAgICAgIHRleHRVSVBhcnRTY2hlbWEsXG4gICAgICByZWFzb25pbmdVSVBhcnRTY2hlbWEsXG4gICAgICBzb3VyY2VVcmxVSVBhcnRTY2hlbWEsXG4gICAgICBzb3VyY2VEb2N1bWVudFVJUGFydFNjaGVtYSxcbiAgICAgIGZpbGVVSVBhcnRTY2hlbWEsXG4gICAgICBzdGVwU3RhcnRVSVBhcnRTY2hlbWEsXG4gICAgICBkYXRhVUlQYXJ0U2NoZW1hLFxuICAgICAgLi4uZHluYW1pY1Rvb2xVSVBhcnRTY2hlbWFzLFxuICAgICAgLi4udG9vbFVJUGFydFNjaGVtYXMsXG4gICAgXSksXG4gICksXG59KTtcblxuLyoqXG4gKiBWYWxpZGF0ZXMgYSBsaXN0IG9mIFVJIG1lc3NhZ2VzLlxuICpcbiAqIE1ldGFkYXRhLCBkYXRhIHBhcnRzLCBhbmQgZ2VuZXJpYyB0b29sIGNhbGwgc3RydWN0dXJlcyBhcmUgb25seSB2YWxpZGF0ZWQgaWZcbiAqIHRoZSBjb3JyZXNwb25kaW5nIHNjaGVtYXMgYXJlIHByb3ZpZGVkLiBPdGhlcndpc2UsIHRoZXkgYXJlIGFzc3VtZWQgdG8gYmVcbiAqIHZhbGlkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVVSU1lc3NhZ2VzPFVJX01FU1NBR0UgZXh0ZW5kcyBVSU1lc3NhZ2U+KHtcbiAgbWVzc2FnZXMsXG4gIG1ldGFkYXRhU2NoZW1hLFxuICBkYXRhU2NoZW1hcyxcbiAgdG9vbHMsXG59OiB7XG4gIG1lc3NhZ2VzOiB1bmtub3duO1xuICBtZXRhZGF0YVNjaGVtYT86XG4gICAgfCBWYWxpZGF0b3I8VUlNZXNzYWdlWydtZXRhZGF0YSddPlxuICAgIHwgU3RhbmRhcmRTY2hlbWFWMTx1bmtub3duLCBVSV9NRVNTQUdFWydtZXRhZGF0YSddPjtcbiAgZGF0YVNjaGVtYXM/OiB7XG4gICAgW05BTUUgaW4ga2V5b2YgSW5mZXJVSU1lc3NhZ2VEYXRhPFVJX01FU1NBR0U+ICYgc3RyaW5nXT86XG4gICAgICB8IFZhbGlkYXRvcjxJbmZlclVJTWVzc2FnZURhdGE8VUlfTUVTU0FHRT5bTkFNRV0+XG4gICAgICB8IFN0YW5kYXJkU2NoZW1hVjE8dW5rbm93biwgSW5mZXJVSU1lc3NhZ2VEYXRhPFVJX01FU1NBR0U+W05BTUVdPjtcbiAgfTtcbiAgdG9vbHM/OiB7XG4gICAgW05BTUUgaW4ga2V5b2YgSW5mZXJVSU1lc3NhZ2VUb29sczxVSV9NRVNTQUdFPiAmIHN0cmluZ10/OiBUb29sPFxuICAgICAgSW5mZXJVSU1lc3NhZ2VUb29sczxVSV9NRVNTQUdFPltOQU1FXVsnaW5wdXQnXSxcbiAgICAgIEluZmVyVUlNZXNzYWdlVG9vbHM8VUlfTUVTU0FHRT5bTkFNRV1bJ291dHB1dCddXG4gICAgPjtcbiAgfTtcbn0pOiBQcm9taXNlPEFycmF5PFVJX01FU1NBR0U+PiB7XG4gIGNvbnN0IHZhbGlkYXRlZE1lc3NhZ2VzID0gYXdhaXQgdmFsaWRhdGVUeXBlcyh7XG4gICAgdmFsdWU6IG1lc3NhZ2VzLFxuICAgIHNjaGVtYTogei5hcnJheSh1aU1lc3NhZ2VTY2hlbWEpLFxuICB9KTtcblxuICBpZiAobWV0YWRhdGFTY2hlbWEpIHtcbiAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgdmFsaWRhdGVkTWVzc2FnZXMpIHtcbiAgICAgIGF3YWl0IHZhbGlkYXRlVHlwZXMoe1xuICAgICAgICB2YWx1ZTogbWVzc2FnZS5tZXRhZGF0YSxcbiAgICAgICAgc2NoZW1hOiBtZXRhZGF0YVNjaGVtYSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmIChkYXRhU2NoZW1hcykge1xuICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiB2YWxpZGF0ZWRNZXNzYWdlcykge1xuICAgICAgY29uc3QgZGF0YVBhcnRzID0gbWVzc2FnZS5wYXJ0cy5maWx0ZXIocGFydCA9PlxuICAgICAgICBwYXJ0LnR5cGUuc3RhcnRzV2l0aCgnZGF0YS0nKSxcbiAgICAgICkgYXMgRGF0YVVJUGFydDxJbmZlclVJTWVzc2FnZURhdGE8VUlfTUVTU0FHRT4+W107XG5cbiAgICAgIGZvciAoY29uc3QgZGF0YVBhcnQgb2YgZGF0YVBhcnRzKSB7XG4gICAgICAgIGNvbnN0IGRhdGFOYW1lID0gZGF0YVBhcnQudHlwZS5zbGljZSg1KTtcbiAgICAgICAgY29uc3QgZGF0YVNjaGVtYSA9IGRhdGFTY2hlbWFzW2RhdGFOYW1lXTtcblxuICAgICAgICBpZiAoIWRhdGFTY2hlbWEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZVZhbGlkYXRpb25FcnJvcih7XG4gICAgICAgICAgICB2YWx1ZTogZGF0YVBhcnQuZGF0YSxcbiAgICAgICAgICAgIGNhdXNlOiBgTm8gZGF0YSBzY2hlbWEgZm91bmQgZm9yIGRhdGEgcGFydCAke2RhdGFOYW1lfWAsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB2YWxpZGF0ZVR5cGVzKHtcbiAgICAgICAgICB2YWx1ZTogZGF0YVBhcnQuZGF0YSxcbiAgICAgICAgICBzY2hlbWE6IGRhdGFTY2hlbWEsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmICh0b29scykge1xuICAgIGZvciAoY29uc3QgbWVzc2FnZSBvZiB2YWxpZGF0ZWRNZXNzYWdlcykge1xuICAgICAgY29uc3QgdG9vbFBhcnRzID0gbWVzc2FnZS5wYXJ0cy5maWx0ZXIocGFydCA9PlxuICAgICAgICBwYXJ0LnR5cGUuc3RhcnRzV2l0aCgndG9vbC0nKSxcbiAgICAgICkgYXMgVG9vbFVJUGFydDxJbmZlclVJTWVzc2FnZVRvb2xzPFVJX01FU1NBR0U+PltdO1xuXG4gICAgICBmb3IgKGNvbnN0IHRvb2xQYXJ0IG9mIHRvb2xQYXJ0cykge1xuICAgICAgICBjb25zdCB0b29sTmFtZSA9IHRvb2xQYXJ0LnR5cGUuc2xpY2UoNSk7XG4gICAgICAgIGNvbnN0IHRvb2wgPSB0b29sc1t0b29sTmFtZV07XG5cbiAgICAgICAgaWYgKCF0b29sKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVWYWxpZGF0aW9uRXJyb3Ioe1xuICAgICAgICAgICAgdmFsdWU6IHRvb2xQYXJ0LmlucHV0LFxuICAgICAgICAgICAgY2F1c2U6IGBObyB0b29sIHNjaGVtYSBmb3VuZCBmb3IgdG9vbCBwYXJ0ICR7dG9vbE5hbWV9YCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICB0b29sUGFydC5zdGF0ZSA9PT0gJ2lucHV0LWF2YWlsYWJsZScgfHxcbiAgICAgICAgICB0b29sUGFydC5zdGF0ZSA9PT0gJ291dHB1dC1hdmFpbGFibGUnIHx8XG4gICAgICAgICAgdG9vbFBhcnQuc3RhdGUgPT09ICdvdXRwdXQtZXJyb3InXG4gICAgICAgICkge1xuICAgICAgICAgIGF3YWl0IHZhbGlkYXRlVHlwZXMoe1xuICAgICAgICAgICAgdmFsdWU6IHRvb2xQYXJ0LmlucHV0LFxuICAgICAgICAgICAgc2NoZW1hOiB0b29sLmlucHV0U2NoZW1hLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRvb2xQYXJ0LnN0YXRlID09PSAnb3V0cHV0LWF2YWlsYWJsZScgJiYgdG9vbC5vdXRwdXRTY2hlbWEpIHtcbiAgICAgICAgICBhd2FpdCB2YWxpZGF0ZVR5cGVzKHtcbiAgICAgICAgICAgIHZhbHVlOiB0b29sUGFydC5vdXRwdXQsXG4gICAgICAgICAgICBzY2hlbWE6IHRvb2wub3V0cHV0U2NoZW1hLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHZhbGlkYXRlZE1lc3NhZ2VzIGFzIEFycmF5PFVJX01FU1NBR0U+O1xufVxuIiwgImltcG9ydCB7XG4gIGdlbmVyYXRlSWQgYXMgZ2VuZXJhdGVJZEZ1bmMsXG4gIGdldEVycm9yTWVzc2FnZSxcbiAgSWRHZW5lcmF0b3IsXG59IGZyb20gJ0BhaS1zZGsvcHJvdmlkZXItdXRpbHMnO1xuaW1wb3J0IHsgVUlNZXNzYWdlIH0gZnJvbSAnLi4vdWkvdWktbWVzc2FnZXMnO1xuaW1wb3J0IHsgaGFuZGxlVUlNZXNzYWdlU3RyZWFtRmluaXNoIH0gZnJvbSAnLi9oYW5kbGUtdWktbWVzc2FnZS1zdHJlYW0tZmluaXNoJztcbmltcG9ydCB7IEluZmVyVUlNZXNzYWdlQ2h1bmsgfSBmcm9tICcuL3VpLW1lc3NhZ2UtY2h1bmtzJztcbmltcG9ydCB7IFVJTWVzc2FnZVN0cmVhbU9uRmluaXNoQ2FsbGJhY2sgfSBmcm9tICcuL3VpLW1lc3NhZ2Utc3RyZWFtLW9uLWZpbmlzaC1jYWxsYmFjayc7XG5pbXBvcnQgeyBVSU1lc3NhZ2VTdHJlYW1Xcml0ZXIgfSBmcm9tICcuL3VpLW1lc3NhZ2Utc3RyZWFtLXdyaXRlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVSU1lc3NhZ2VTdHJlYW08VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4oe1xuICBleGVjdXRlLFxuICBvbkVycm9yID0gZ2V0RXJyb3JNZXNzYWdlLFxuICBvcmlnaW5hbE1lc3NhZ2VzLFxuICBvbkZpbmlzaCxcbiAgZ2VuZXJhdGVJZCA9IGdlbmVyYXRlSWRGdW5jLFxufToge1xuICBleGVjdXRlOiAob3B0aW9uczoge1xuICAgIHdyaXRlcjogVUlNZXNzYWdlU3RyZWFtV3JpdGVyPFVJX01FU1NBR0U+O1xuICB9KSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZDtcbiAgb25FcnJvcj86IChlcnJvcjogdW5rbm93bikgPT4gc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb3JpZ2luYWwgbWVzc2FnZXMuIElmIHRoZXkgYXJlIHByb3ZpZGVkLCBwZXJzaXN0ZW5jZSBtb2RlIGlzIGFzc3VtZWQsXG4gICAqIGFuZCBhIG1lc3NhZ2UgSUQgaXMgcHJvdmlkZWQgZm9yIHRoZSByZXNwb25zZSBtZXNzYWdlLlxuICAgKi9cbiAgb3JpZ2luYWxNZXNzYWdlcz86IFVJX01FU1NBR0VbXTtcblxuICBvbkZpbmlzaD86IFVJTWVzc2FnZVN0cmVhbU9uRmluaXNoQ2FsbGJhY2s8VUlfTUVTU0FHRT47XG5cbiAgZ2VuZXJhdGVJZD86IElkR2VuZXJhdG9yO1xufSk6IFJlYWRhYmxlU3RyZWFtPEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT4+IHtcbiAgbGV0IGNvbnRyb2xsZXIhOiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyPFxuICAgIEluZmVyVUlNZXNzYWdlQ2h1bms8VUlfTUVTU0FHRT5cbiAgPjtcblxuICBjb25zdCBvbmdvaW5nU3RyZWFtUHJvbWlzZXM6IFByb21pc2U8dm9pZD5bXSA9IFtdO1xuXG4gIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgc3RhcnQoY29udHJvbGxlckFyZykge1xuICAgICAgY29udHJvbGxlciA9IGNvbnRyb2xsZXJBcmc7XG4gICAgfSxcbiAgfSk7XG5cbiAgZnVuY3Rpb24gc2FmZUVucXVldWUoZGF0YTogSW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPikge1xuICAgIHRyeSB7XG4gICAgICBjb250cm9sbGVyLmVucXVldWUoZGF0YSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIHN1cHByZXNzIGVycm9ycyB3aGVuIHRoZSBzdHJlYW0gaGFzIGJlZW4gY2xvc2VkXG4gICAgfVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBleGVjdXRlKHtcbiAgICAgIHdyaXRlcjoge1xuICAgICAgICB3cml0ZShwYXJ0OiBJbmZlclVJTWVzc2FnZUNodW5rPFVJX01FU1NBR0U+KSB7XG4gICAgICAgICAgc2FmZUVucXVldWUocGFydCk7XG4gICAgICAgIH0sXG4gICAgICAgIG1lcmdlKHN0cmVhbUFyZykge1xuICAgICAgICAgIG9uZ29pbmdTdHJlYW1Qcm9taXNlcy5wdXNoKFxuICAgICAgICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gc3RyZWFtQXJnLmdldFJlYWRlcigpO1xuICAgICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICAgICAgaWYgKGRvbmUpIGJyZWFrO1xuICAgICAgICAgICAgICAgIHNhZmVFbnF1ZXVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgIHNhZmVFbnF1ZXVlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgIGVycm9yVGV4dDogb25FcnJvcihlcnJvciksXG4gICAgICAgICAgICAgIH0gYXMgSW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPik7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICBvbkVycm9yLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIG9uZ29pbmdTdHJlYW1Qcm9taXNlcy5wdXNoKFxuICAgICAgICByZXN1bHQuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIHNhZmVFbnF1ZXVlKHtcbiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgICBlcnJvclRleHQ6IG9uRXJyb3IoZXJyb3IpLFxuICAgICAgICAgIH0gYXMgSW5mZXJVSU1lc3NhZ2VDaHVuazxVSV9NRVNTQUdFPik7XG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgc2FmZUVucXVldWUoe1xuICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgIGVycm9yVGV4dDogb25FcnJvcihlcnJvciksXG4gICAgfSBhcyBJbmZlclVJTWVzc2FnZUNodW5rPFVJX01FU1NBR0U+KTtcbiAgfVxuXG4gIC8vIFdhaXQgdW50aWwgYWxsIG9uZ29pbmcgc3RyZWFtcyBhcmUgZG9uZS4gVGhpcyBhcHByb2FjaCBlbmFibGVzIG1lcmdpbmdcbiAgLy8gc3RyZWFtcyBldmVuIGFmdGVyIGV4ZWN1dGUgaGFzIHJldHVybmVkLCBhcyBsb25nIGFzIHRoZXJlIGlzIHN0aWxsIGFuXG4gIC8vIG9wZW4gbWVyZ2VkIHN0cmVhbS4gVGhpcyBpcyBpbXBvcnRhbnQgdG8gZS5nLiBmb3J3YXJkIG5ldyBzdHJlYW1zIGFuZFxuICAvLyBmcm9tIGNhbGxiYWNrcy5cbiAgY29uc3Qgd2FpdEZvclN0cmVhbXM6IFByb21pc2U8dm9pZD4gPSBuZXcgUHJvbWlzZShhc3luYyByZXNvbHZlID0+IHtcbiAgICB3aGlsZSAob25nb2luZ1N0cmVhbVByb21pc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIGF3YWl0IG9uZ29pbmdTdHJlYW1Qcm9taXNlcy5zaGlmdCgpO1xuICAgIH1cbiAgICByZXNvbHZlKCk7XG4gIH0pO1xuXG4gIHdhaXRGb3JTdHJlYW1zLmZpbmFsbHkoKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIHN1cHByZXNzIGVycm9ycyB3aGVuIHRoZSBzdHJlYW0gaGFzIGJlZW4gY2xvc2VkXG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaGFuZGxlVUlNZXNzYWdlU3RyZWFtRmluaXNoPFVJX01FU1NBR0U+KHtcbiAgICBzdHJlYW0sXG4gICAgbWVzc2FnZUlkOiBnZW5lcmF0ZUlkKCksXG4gICAgb3JpZ2luYWxNZXNzYWdlcyxcbiAgICBvbkZpbmlzaCxcbiAgICBvbkVycm9yLFxuICB9KTtcbn1cbiIsICJpbXBvcnQgeyBVSU1lc3NhZ2UgfSBmcm9tICcuLi91aS91aS1tZXNzYWdlcyc7XG5pbXBvcnQgeyBVSU1lc3NhZ2VDaHVuayB9IGZyb20gJy4vdWktbWVzc2FnZS1jaHVua3MnO1xuaW1wb3J0IHtcbiAgY3JlYXRlU3RyZWFtaW5nVUlNZXNzYWdlU3RhdGUsXG4gIHByb2Nlc3NVSU1lc3NhZ2VTdHJlYW0sXG4gIFN0cmVhbWluZ1VJTWVzc2FnZVN0YXRlLFxufSBmcm9tICcuLi91aS9wcm9jZXNzLXVpLW1lc3NhZ2Utc3RyZWFtJztcbmltcG9ydCB7XG4gIEFzeW5jSXRlcmFibGVTdHJlYW0sXG4gIGNyZWF0ZUFzeW5jSXRlcmFibGVTdHJlYW0sXG59IGZyb20gJy4uL3V0aWwvYXN5bmMtaXRlcmFibGUtc3RyZWFtJztcbmltcG9ydCB7IGNvbnN1bWVTdHJlYW0gfSBmcm9tICcuLi91dGlsL2NvbnN1bWUtc3RyZWFtJztcblxuLyoqXG4gKiBUcmFuc2Zvcm1zIGEgc3RyZWFtIG9mIGBVSU1lc3NhZ2VDaHVua2BzIGludG8gYW4gYEFzeW5jSXRlcmFibGVTdHJlYW1gIG9mIGBVSU1lc3NhZ2Vgcy5cbiAqXG4gKiBAcGFyYW0gb3B0aW9ucy5tZXNzYWdlIC0gVGhlIGxhc3QgYXNzaXN0YW50IG1lc3NhZ2UgdG8gdXNlIGFzIGEgc3RhcnRpbmcgcG9pbnQgd2hlbiB0aGUgY29udmVyc2F0aW9uIGlzIHJlc3VtZWQuIE90aGVyd2lzZSB1bmRlZmluZWQuXG4gKiBAcGFyYW0gb3B0aW9ucy5zdHJlYW0gLSBUaGUgc3RyZWFtIG9mIGBVSU1lc3NhZ2VDaHVua2BzIHRvIHJlYWQuXG4gKiBAcGFyYW0gb3B0aW9ucy50ZXJtaW5hdGVPbkVycm9yIC0gV2hldGhlciB0byB0ZXJtaW5hdGUgdGhlIHN0cmVhbSBpZiBhbiBlcnJvciBvY2N1cnMuXG4gKiBAcGFyYW0gb3B0aW9ucy5vbkVycm9yIC0gQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIGFuIGVycm9yIG9jY3Vycy5cbiAqXG4gKiBAcmV0dXJucyBBbiBgQXN5bmNJdGVyYWJsZVN0cmVhbWAgb2YgYFVJTWVzc2FnZWBzLiBFYWNoIHN0cmVhbSBwYXJ0IGlzIGEgZGlmZmVyZW50IHN0YXRlIG9mIHRoZSBzYW1lIG1lc3NhZ2VcbiAqIGFzIGl0IGlzIGJlaW5nIGNvbXBsZXRlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlYWRVSU1lc3NhZ2VTdHJlYW08VUlfTUVTU0FHRSBleHRlbmRzIFVJTWVzc2FnZT4oe1xuICBtZXNzYWdlLFxuICBzdHJlYW0sXG4gIG9uRXJyb3IsXG4gIHRlcm1pbmF0ZU9uRXJyb3IgPSBmYWxzZSxcbn06IHtcbiAgbWVzc2FnZT86IFVJX01FU1NBR0U7XG4gIHN0cmVhbTogUmVhZGFibGVTdHJlYW08VUlNZXNzYWdlQ2h1bms+O1xuICBvbkVycm9yPzogKGVycm9yOiB1bmtub3duKSA9PiB2b2lkO1xuICB0ZXJtaW5hdGVPbkVycm9yPzogYm9vbGVhbjtcbn0pOiBBc3luY0l0ZXJhYmxlU3RyZWFtPFVJX01FU1NBR0U+IHtcbiAgbGV0IGNvbnRyb2xsZXI6IFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXI8VUlfTUVTU0FHRT4gfCB1bmRlZmluZWQ7XG4gIGxldCBoYXNFcnJvcmVkID0gZmFsc2U7XG5cbiAgY29uc3Qgb3V0cHV0U3RyZWFtID0gbmV3IFJlYWRhYmxlU3RyZWFtPFVJX01FU1NBR0U+KHtcbiAgICBzdGFydChjb250cm9sbGVyUGFyYW0pIHtcbiAgICAgIGNvbnRyb2xsZXIgPSBjb250cm9sbGVyUGFyYW07XG4gICAgfSxcbiAgfSk7XG5cbiAgY29uc3Qgc3RhdGUgPSBjcmVhdGVTdHJlYW1pbmdVSU1lc3NhZ2VTdGF0ZTxVSV9NRVNTQUdFPih7XG4gICAgbWVzc2FnZUlkOiBtZXNzYWdlPy5pZCA/PyAnJyxcbiAgICBsYXN0TWVzc2FnZTogbWVzc2FnZSxcbiAgfSk7XG5cbiAgY29uc3QgaGFuZGxlRXJyb3IgPSAoZXJyb3I6IHVua25vd24pID0+IHtcbiAgICBvbkVycm9yPy4oZXJyb3IpO1xuXG4gICAgaWYgKCFoYXNFcnJvcmVkICYmIHRlcm1pbmF0ZU9uRXJyb3IpIHtcbiAgICAgIGhhc0Vycm9yZWQgPSB0cnVlO1xuICAgICAgY29udHJvbGxlcj8uZXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdW1lU3RyZWFtKHtcbiAgICBzdHJlYW06IHByb2Nlc3NVSU1lc3NhZ2VTdHJlYW0oe1xuICAgICAgc3RyZWFtLFxuICAgICAgcnVuVXBkYXRlTWVzc2FnZUpvYihcbiAgICAgICAgam9iOiAob3B0aW9uczoge1xuICAgICAgICAgIHN0YXRlOiBTdHJlYW1pbmdVSU1lc3NhZ2VTdGF0ZTxVSV9NRVNTQUdFPjtcbiAgICAgICAgICB3cml0ZTogKCkgPT4gdm9pZDtcbiAgICAgICAgfSkgPT4gUHJvbWlzZTx2b2lkPixcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gam9iKHtcbiAgICAgICAgICBzdGF0ZSxcbiAgICAgICAgICB3cml0ZTogKCkgPT4ge1xuICAgICAgICAgICAgY29udHJvbGxlcj8uZW5xdWV1ZShzdHJ1Y3R1cmVkQ2xvbmUoc3RhdGUubWVzc2FnZSkpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIG9uRXJyb3I6IGhhbmRsZUVycm9yLFxuICAgIH0pLFxuICAgIG9uRXJyb3I6IGhhbmRsZUVycm9yLFxuICB9KS5maW5hbGx5KCgpID0+IHtcbiAgICAvLyBPbmx5IGNsb3NlIGlmIG5vIGVycm9yIG9jY3VycmVkLiBDYWxsaW5nIGNsb3NlKCkgb24gYW4gZXJyb3JlZCBjb250cm9sbGVyXG4gICAgLy8gdGhyb3dzIFwiSW52YWxpZCBzdGF0ZTogQ29udHJvbGxlciBpcyBhbHJlYWR5IGNsb3NlZFwiIFR5cGVFcnJvci5cbiAgICBpZiAoIWhhc0Vycm9yZWQpIHtcbiAgICAgIGNvbnRyb2xsZXI/LmNsb3NlKCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gY3JlYXRlQXN5bmNJdGVyYWJsZVN0cmVhbShvdXRwdXRTdHJlYW0pO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIjtBQUFBLFNBQVMsdUJBQXVCO0FBQ2hDLFNBQVMsbUJBQW1COzs7QUNHNUIsSUFBTSxTQUFTO0FBQ2YsSUFBTSxTQUFTLE9BQU8sSUFBSSxNQUFNO0FB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QUM7QUFHRCxJQUFNLHFCQUFxQixZQUFZO0FBQUEsRUFDckMsTUFBTTtBQUFBLEVBQ04sUUFBUTtBQUFBO0FBQUE7QUFBQSxFQUdSLE9BQU8sa0JBQWtCO0FBQUEsSUFDdkIsT0FBTyxRQUFRLDRCQUE0QjtBQUFBLEVBQzdDLENBQUM7QUFBQTtBQUVILENBQUM7QUFHRCxJQUFNLHFCQUFxQixZQUFZO0FBQUEsRUFDckMsTUFBTTtBQUFBLEVBQ04sUUFBUTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFRUixPQUFPLGtCQUFrQjtBQUFBLElBQ3ZCLE9BQU8sUUFBUSw0QkFBNEI7QUFBQSxFQUM3QyxDQUFDO0FBQUE7QUFBQTtBQUdILENBQUM7QUFHRCxJQUFNLGNBQWMsWUFBWTtBQUFBLEVBQzlCLE1BQU07QUFBQSxFQUNOLFFBQVE7QUFBQTtBQUFBO0FBQUEsRUFHUixPQUFPLGtCQUFrQjtBQUFBLElBQ3ZCLE9BQU8sUUFBUSxPQUFPO0FBQUEsRUFDeEIsQ0FBQztBQUFBO0FBQUE7QUFHSCxDQUFDO0FBR0QsSUFBTSxZQUFZLGdCQUFnQjtBQUFBLEVBQ2hDLFFBQVE7QUFBQSxJQUNOLGlCQUFpQjtBQUFBLElBQ2pCLGNBQWM7QUFBQSxJQUNkLGFBQWE7QUFBQSxJQUNiLGVBQWU7QUFBQSxJQUNmLGVBQWU7QUFBQSxJQUNmLFVBQVU7QUFBQSxFQUNaO0FBQUEsRUFDQSxVQUFVO0FBQUEsSUFDUixNQUFNO0FBQUEsSUFDTixTQUFTO0FBQUEsSUFDVCxhQUFhO0FBQUEsRUFDZjtBQUFBLEVBQ0EsS0FBSztBQUFBLElBQ0gsTUFBTTtBQUFBLElBQ04sV0FBVztBQUFBLElBQ1gsU0FBUztBQUFBLEVBQ1g7QUFDRixDQUFDO0FBRUQsSUFBTywyQkFBUTsiLAogICJuYW1lcyI6IFsiX0FJU0RLRXJyb3IiLCAibmFtZSIsICJtYXJrZXIiLCAic3ltYm9sIiwgIl9hIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAidGV4dCIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX1R5cGVWYWxpZGF0aW9uRXJyb3IiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAiWm9kRmlyc3RQYXJ0eVR5cGVLaW5kIiwgIlpvZEZpcnN0UGFydHlUeXBlS2luZCIsICJab2RGaXJzdFBhcnR5VHlwZUtpbmQiLCAib2JqZWN0IiwgInR5cGVzIiwgIngiLCAiYmFzZSIsICJab2RGaXJzdFBhcnR5VHlwZUtpbmQiLCAianNvblNjaGVtYSIsICJuYW1lIiwgInNjaGVtYSIsICJmZXRjaCIsICJBUElDYWxsRXJyb3IiLCAidGV4dCIsICJUeXBlVmFsaWRhdGlvbkVycm9yIiwgInZhbGlkYXRvciIsICJnZXRPcmlnaW5hbEZldGNoIiwgImZldGNoIiwgImZldGNoIiwgImdldE9yaWdpbmFsRmV0Y2giLCAiQVBJQ2FsbEVycm9yIiwgIkFQSUNhbGxFcnJvciIsICJBUElDYWxsRXJyb3IiLCAieiIsICJ6IiwgInoiLCAieiIsICJtYXJrZXIiLCAic3ltYm9sIiwgIl9hIiwgIm5hbWUiLCAiX2IiLCAicmVzb2x2ZSIsICJjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyIiwgImNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlciIsICJwb3N0SnNvblRvQXBpIiwgImNvbWJpbmVIZWFkZXJzIiwgIm1hcmtlciIsICJzeW1ib2wiLCAiX2EiLCAiX0FJU0RLRXJyb3IiLCAibmFtZSIsICJBSVNES0Vycm9yIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAiZ2V0RXJyb3JNZXNzYWdlIiwgIm5hbWUiLCAibWFya2VyIiwgIkludmFsaWRBcmd1bWVudEVycm9yIiwgIkFJU0RLRXJyb3IiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJKU09OUGFyc2VFcnJvciIsICJBSVNES0Vycm9yIiwgInRleHQiLCAiZ2V0RXJyb3JNZXNzYWdlIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX1R5cGVWYWxpZGF0aW9uRXJyb3IiLCAiQUlTREtFcnJvciIsICJnZXRFcnJvck1lc3NhZ2UiLCAiVHlwZVZhbGlkYXRpb25FcnJvciIsICJfYSIsICJzeW1ib2wiLCAiejQiLCAiY3JlYXRlSWRHZW5lcmF0b3IiLCAiSW52YWxpZEFyZ3VtZW50RXJyb3IiLCAiZ2VuZXJhdGVJZCIsICJzdXNwZWN0UHJvdG9SeCIsICJzdXNwZWN0Q29uc3RydWN0b3JSeCIsICJfcGFyc2UiLCAidGV4dCIsICJmaWx0ZXIiLCAic2VjdXJlSnNvblBhcnNlIiwgInZhbGlkYXRvclN5bWJvbCIsICJ2YWxpZGF0b3IiLCAiaXNWYWxpZGF0b3IiLCAiYXNWYWxpZGF0b3IiLCAic3RhbmRhcmRTY2hlbWFWYWxpZGF0b3IiLCAiVHlwZVZhbGlkYXRpb25FcnJvciIsICJzYWZlVmFsaWRhdGVUeXBlcyIsICJ2YWxpZGF0b3IiLCAiYXNWYWxpZGF0b3IiLCAiVHlwZVZhbGlkYXRpb25FcnJvciIsICJzYWZlUGFyc2VKU09OIiwgInRleHQiLCAic2VjdXJlSnNvblBhcnNlIiwgInNhZmVWYWxpZGF0ZVR5cGVzIiwgIkpTT05QYXJzZUVycm9yIiwgInpvZFNjaGVtYSIsICJfYSIsICJzY2hlbWFTeW1ib2wiLCAianNvblNjaGVtYSIsICJ2YWxpZGF0b3JTeW1ib2wiLCAiYnRvYSIsICJhdG9iIiwgInoiLCAieiIsICJ6IiwgInoiLCAieiIsICJuYW1lIiwgIm1hcmtlciIsICJzeW1ib2wiLCAiX2EiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiQUlTREtFcnJvciIsICJ0ZXh0IiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgInN5bWJvbCIsICJfYSIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgIm5hbWUiLCAibWFya2VyIiwgIl9hIiwgInN5bWJvbCIsICJuYW1lIiwgIm1hcmtlciIsICJfYSIsICJzeW1ib2wiLCAibmFtZSIsICJtYXJrZXIiLCAiX2EiLCAic3ltYm9sIiwgInoiLCAiX2EiLCAiX2IiLCAieiIsICJ6IiwgInoiLCAieiIsICJ6IiwgImNyZWF0ZUlkR2VuZXJhdG9yIiwgInoiLCAic2FmZVBhcnNlSlNPTiIsICJvcmlnaW5hbEdlbmVyYXRlSWQiLCAiY3JlYXRlSWRHZW5lcmF0b3IiLCAib3JpZ2luYWxHZW5lcmF0ZUlkIiwgImNyZWF0ZUlkR2VuZXJhdG9yIiwgIm9yaWdpbmFsR2VuZXJhdGVJZCIsICJjcmVhdGVJZEdlbmVyYXRvciIsICJ0ZXh0IiwgImFzU2NoZW1hIiwgInNhZmVQYXJzZUpTT04iLCAic2FmZVZhbGlkYXRlVHlwZXMiLCAiX2EiLCAiX2IiLCAibmFtZSIsICJtYXJrZXIiLCAic3ltYm9sIiwgIl9hIiwgIl9hIiwgInN5bWJvbCIsICJ6IiwgInoiXQp9Cg==
