---
date: 2025-12-17T05:47:08Z
researcher: Claude
git_commit: 72ccdd2ccccd4b68af67fce7901e4e7cae4775ef
branch: feat/memory-layer-foundation
repository: lightfastai/lightfast
topic: "Changelog SEO Output Structure and Generation System"
tags: [research, codebase, changelog, seo, basehub, cms]
status: complete
last_updated: 2025-12-17
last_updated_by: Claude
---

# Research: Changelog SEO Output Structure and Generation System

**Date**: 2025-12-17T05:47:08Z
**Researcher**: Claude
**Git Commit**: 72ccdd2ccccd4b68af67fce7901e4e7cae4775ef
**Branch**: feat/memory-layer-foundation
**Repository**: lightfastai/lightfast

## Research Question

Document the current SEO output structure in the changelog generation system, including:
1. Command and skill file structure
2. SEO fields and their usage
3. Output format for generated changelog files
4. How SEO data flows from generated drafts to BaseHub to rendered pages

Note: Featured images are to be omitted completely from future outputs.

## Summary

The changelog generation system consists of three layers:

1. **Generation Layer**: `/changelog` command + `changelog-writer` skill generates draft files in `thoughts/changelog/`
2. **CMS Layer**: BaseHub stores changelog entries with SEO component (metaTitle, metaDescription, focusKeyword, secondaryKeyword, canonicalUrl, noIndex, faq)
3. **Rendering Layer**: Next.js pages generate meta tags, Open Graph, Twitter cards, JSON-LD structured data, and RSS/Atom feeds

The current draft output format includes YAML frontmatter with `title`, `slug`, `description`, `date`, `status`, and `source_prs`. SEO elements are inline in the markdown body, not as structured frontmatter fields.

## Detailed Findings

### 1. Command and Skill Structure

**Command File**: `.claude/commands/changelog.md`

Location: `/Users/jeevanpillay/Code/@lightfastai/lightfast/.claude/commands/changelog.md`

Key elements:
- Frontmatter: `description`, `model: opus`
- Input parsing for PR numbers, URLs, manual text
- Spawns parallel sub-agents for fact-checking (codebase-locator, codebase-analyzer, codebase-pattern-finder)
- Output path: `thoughts/changelog/{title-slug}-{YYYYMMDD-HHMMSS}.md`

Workflow steps (lines 63-158):
1. Parse input and gather PR information
2. Create tracking plan using TodoWrite
3. Spawn parallel sub-agents for fact-checking
4. Wait for all sub-agents and synthesize findings
5. Categorize changes
6. Generate changelog using skill templates
7. Save output
8. Present results

**Skill Structure**: `.claude/skills/changelog-writer/`

```
.claude/skills/changelog-writer/
├── SKILL.md                    # Core instructions (76 lines)
└── resources/
    ├── templates.md            # Document structure templates
    ├── examples.md             # Good/bad examples + v0.1 example
    ├── seo-requirements.md     # SEO checklist and keywords
    └── checklist.md            # Pre-publish validation
```

### 2. Current SEO Requirements (`resources/seo-requirements.md`)

The SEO requirements document (lines 1-75) specifies:

**Target Keywords**:
- Technical terms: webhook-driven sync, vector search, semantic code search, incremental sync, knowledge base
- Use cases: search codebase, code retrieval, team memory
- Integration names: GitHub integration, repository sync

**Meta Description**:
- 150-160 characters exactly
- Include version number
- Top 2-3 features
- Target keyword

**Internal Links**:
- 3-5 related docs required
- Setup guides, API docs, Configuration, Quick start

**Code Examples**:
- At least one config snippet or API example per major feature

**Unique Insight**:
- One "Why we built it this way" paragraph per release

**Structured Data**:
- JSON-LD automatically generated by page template (line 63-66)
- No manual action needed in draft

### 3. Current Output Format (Draft Files)

**Frontmatter Structure** (from `observation-pipeline-semantic-classification-20251217-165000.md`):

```yaml
---
title: "Feature Names Here"
slug: "url-slug"
description: "150-160 char SEO meta description"
date: "YYYY-MM-DD"
status: draft
source_prs: ["#123", "commit-hash"]
---
```

**Body Structure**:

```markdown
# Title · Month Year

**Subtitle with 2-3 key features**

---

### Feature Name

Description paragraph.

**What's included:**
- Bullet list
- Technical details

**Code Example:**
```language
code here
```

**Why we built it this way:** Rationale paragraph.

[Link to docs](/docs/path)

---

### Improvements (N)

<details>
<summary>View all improvements</summary>

- Item 1
- Item 2

</details>

---

### Infrastructure

<details>
<summary>View technical details</summary>

- Technical item

</details>

---

### Limitations

- Current limitation 1
- Current limitation 2

---

### Resources

- [Link 1](/docs/path1)
- [Link 2](/docs/path2)

---

## Metadata

- **Generated**: ISO timestamp
- **Source commits**: list
- **Status**: Draft
- **Fact-checked files**: list
```

### 4. BaseHub CMS Integration

**SEO Component Fields** (from `vendor/cms/index.ts:399-412`):

```typescript
seo: {
  metaTitle: true,
  metaDescription: true,
  focusKeyword: true,
  secondaryKeyword: true,
  canonicalUrl: true,
  noIndex: true,
  faq: {
    items: {
      question: true,
      answer: true,
    },
  },
},
```

**AEO Fields** (added at line 394-398):
- `featuredImage` (url, width, height, alt, blurDataURL)
- `publishedAt`
- `excerpt`
- `tldr`

**TypeScript Types** (`vendor/cms/index.ts:443-456`):

```typescript
seo?: {
  metaTitle?: string | null;
  metaDescription?: string | null;
  focusKeyword?: string | null;
  secondaryKeyword?: string | null;
  canonicalUrl?: string | null;
  noIndex?: boolean | null;
  faq?: {
    items?: Array<{
      question?: string | null;
      answer?: string | null;
    }>;
  } | null;
} | null;
```

### 5. Page Rendering (SEO Output)

**Metadata Generation** (`apps/www/src/app/(app)/(marketing)/(content)/changelog/[slug]/page.tsx:30-91`):

Fallback chains:
- Title: `seo.metaTitle` → `_title` → `"Changelog"`
- Description: `seo.metaDescription` → `excerpt` → `tldr` → `body.plainText` (160 chars) → template string
- Canonical: `seo.canonicalUrl` → `https://lightfast.ai/changelog/${slug}`
- Image: `featuredImage.url` → `https://lightfast.ai/og.jpg`

**Open Graph Output** (lines 66-81):
- Type: `article`
- publishedTime from entry
- Image with dimensions

**Twitter Card** (lines 82-88):
- Card type: `summary_large_image`
- Creator: `@lightfastai`

**JSON-LD Structured Data** (lines 133-196):

SoftwareApplication schema:
```json
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Lightfast",
  "applicationCategory": "DeveloperApplication",
  "releaseNotes": "https://lightfast.ai/changelog/{slug}",
  "datePublished": "ISO date",
  "softwareVersion": "slug",
  "description": "...",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
}
```

FAQPage schema (if faq.items exist):
```json
{
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "question text",
      "acceptedAnswer": { "@type": "Answer", "text": "answer text" }
    }
  ]
}
```

**Feed Alternates** (lines 55-64):
- RSS 2.0: `https://lightfast.ai/changelog/rss.xml`
- Atom: `https://lightfast.ai/changelog/atom.xml`

### 6. RSS/Atom Feed Generation

**Feed Builder** (`apps/www/src/lib/feeds/generate-changelog-feed.ts`):

Feed items include (lines 36-62):
- Title: `entry._title`
- URL: `https://lightfast.ai/changelog/{slug}`
- Date: `publishedAt` or `_sys.createdAt`
- Description: `excerpt` → `tldr` → `body.plainText` (300 chars)
- Image: `featuredImage.url` (if available)

Limits: First 50 entries only.

### 7. Gap Analysis: Draft vs. BaseHub Fields

**Fields in Draft Frontmatter**:
- `title` → maps to BaseHub `_title`
- `slug` → maps to BaseHub `slug`
- `description` → maps to BaseHub `seo.metaDescription`
- `date` → maps to BaseHub `publishedAt`
- `status` → not in BaseHub (draft tracking only)
- `source_prs` → not in BaseHub (metadata for audit)

**Fields Missing from Draft Frontmatter**:
- `seo.metaTitle` (distinct from title)
- `seo.focusKeyword`
- `seo.secondaryKeyword`
- `seo.canonicalUrl`
- `seo.noIndex`
- `seo.faq[]`
- `excerpt` (distinct from description)
- `tldr`
- `featuredImage` (TO BE OMITTED per requirements)

**Body Content Not Structured**:
- Internal links are inline markdown, not extracted as structured data
- Code examples are inline, not counted/tracked
- "Why we built it" sections not marked up

## Code References

- `.claude/commands/changelog.md` - Command orchestration
- `.claude/skills/changelog-writer/SKILL.md` - Core skill instructions
- `.claude/skills/changelog-writer/resources/seo-requirements.md:1-75` - SEO requirements
- `.claude/skills/changelog-writer/resources/templates.md:1-111` - Document templates
- `.claude/skills/changelog-writer/resources/checklist.md:1-59` - Validation checklist
- `.claude/skills/changelog-writer/resources/examples.md:1-154` - Writing examples
- `vendor/cms/index.ts:380-413` - Changelog fragment with SEO fields
- `vendor/cms/index.ts:443-456` - TypeScript types for SEO
- `apps/www/src/app/(app)/(marketing)/(content)/changelog/[slug]/page.tsx:30-91` - Metadata generation
- `apps/www/src/app/(app)/(marketing)/(content)/changelog/[slug]/page.tsx:133-196` - JSON-LD generation
- `apps/www/src/lib/feeds/generate-changelog-feed.ts:36-62` - RSS/Atom feed items

## Architecture Documentation

### Data Flow

```
1. User runs /changelog command
   ↓
2. Command parses input (PRs, URLs, manual text)
   ↓
3. Sub-agents fact-check against codebase
   ↓
4. Skill templates applied
   ↓
5. Draft saved to thoughts/changelog/{slug}.md
   ↓
6. Manual review and editing
   ↓
7. createChangelogEntry() mutation to BaseHub
   ↓
8. BaseHub stores entry with SEO component
   ↓
9. Next.js page fetches via Pump/Feed component
   ↓
10. generateMetadata() produces meta tags
   ↓
11. JSON-LD structured data rendered in page
   ↓
12. RSS/Atom feeds updated on revalidation
```

### SEO Field Mapping

| Draft Field | BaseHub Field | Page Output |
|-------------|---------------|-------------|
| title | _title | `<title>`, og:title |
| slug | slug | canonical URL |
| description | seo.metaDescription | meta description |
| date | publishedAt | article:published_time |
| - | seo.metaTitle | `<title>` (if different) |
| - | seo.focusKeyword | (used for content optimization) |
| - | seo.secondaryKeyword | (used for content optimization) |
| - | seo.canonicalUrl | canonical link |
| - | seo.noIndex | robots meta |
| - | seo.faq[] | JSON-LD FAQPage |
| - | excerpt | meta description fallback |
| - | tldr | meta description fallback |
| - | featuredImage | og:image (TO BE OMITTED) |

## Historical Context (from thoughts/)

Related plans and research documents:
- `thoughts/shared/plans/2025-12-17-changelog-skill-migration.md` - Migration plan from vendor/cms/agents to skill system
- `thoughts/shared/plans/2025-12-17-changelog-programmatic-creation-and-rss-feeds.md` - RSS/Atom feed implementation
- `thoughts/shared/research/2025-12-17-web-analysis-changelog-skill-profound-optimization.md` - External research on changelog optimization

## Related Research

- BaseHub mutation API: `packages/cms-workflows/src/mutations/changelog.ts`
- Rich text rendering: `vendor/cms/components/body.tsx`

## Open Questions

1. **Should draft frontmatter include all SEO fields?**
   - Currently only `title`, `slug`, `description`, `date`, `status`, `source_prs`
   - Missing: `metaTitle`, `focusKeyword`, `secondaryKeyword`, `canonicalUrl`, `excerpt`, `tldr`, `faq[]`

2. **How to handle FAQ generation?**
   - Currently not in draft output
   - FAQPage schema supports multiple Q&A pairs
   - Could be extracted from feature sections or explicitly authored

3. **Should internal links be structured data?**
   - Currently inline markdown links
   - SEO requirements specify 3-5 links minimum
   - Could be frontmatter array for validation

4. **How to validate SEO requirements?**
   - Checklist exists but is manual
   - Could be automated: char count, link count, code block count

5. **Featured image handling?**
   - TO BE OMITTED per requirements
   - Fallback to `https://lightfast.ai/og.jpg` in page rendering
   - Remove from draft template and mutation
